<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 3: Geometric Priors â€” å‡ ä½•æ·±åº¦å­¦ä¹ è“å›¾</title>

<!-- KaTeX for math rendering -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
  onload="renderMathInElement(document.body, {
    delimiters: [
      {left: '$$', right: '$$', display: true},
      {left: '$', right: '$', display: false}
    ],
    throwOnError: false
  });"></script>

<style>
/* ===== CSS Variables (Light Theme) ===== */
:root {
  --bg-primary: #ffffff;
  --bg-secondary: #f8f9fa;
  --bg-code: #f4f5f7;
  --bg-sidebar: #f0f2f5;
  --text-primary: #1a1a2e;
  --text-secondary: #4a4a6a;
  --text-muted: #8888aa;
  --border-color: #e0e0e8;
  --accent: #6366f1;
  --accent-light: #eef2ff;
  --link: #4f46e5;
  --shadow: 0 2px 12px rgba(0,0,0,0.06);
  --shadow-hover: 0 4px 20px rgba(0,0,0,0.1);
  --radius: 12px;
  --sidebar-width: 300px;

  /* Colored boxes */
  --def-bg: #eff6ff;
  --def-border: #3b82f6;
  --def-title: #1d4ed8;
  --thm-bg: #ecfdf5;
  --thm-border: #10b981;
  --thm-title: #047857;
  --example-bg: #fffbeb;
  --example-border: #f59e0b;
  --example-title: #b45309;
  --warn-bg: #fef2f2;
  --warn-border: #ef4444;
  --warn-title: #b91c1c;
  --robot-bg: #f0fdf4;
  --robot-border: #22c55e;
  --robot-title: #15803d;

  /* Code highlighting */
  --code-keyword: #d73a49;
  --code-string: #032f62;
  --code-comment: #6a737d;
  --code-function: #6f42c1;
  --code-number: #005cc5;
  --code-class: #e36209;
  --code-builtin: #005cc5;
  --code-decorator: #6f42c1;
  --code-self: #d73a49;
}

/* ===== Dark Theme ===== */
[data-theme="dark"] {
  --bg-primary: #0d1117;
  --bg-secondary: #161b22;
  --bg-code: #1c2333;
  --bg-sidebar: #0d1117;
  --text-primary: #e6edf3;
  --text-secondary: #8b949e;
  --text-muted: #6e7681;
  --border-color: #30363d;
  --accent: #818cf8;
  --accent-light: #1e1b4b;
  --link: #818cf8;
  --shadow: 0 2px 12px rgba(0,0,0,0.3);
  --shadow-hover: 0 4px 20px rgba(0,0,0,0.4);

  --def-bg: #0c1929;
  --def-border: #3b82f6;
  --def-title: #60a5fa;
  --thm-bg: #052e16;
  --thm-border: #22c55e;
  --thm-title: #4ade80;
  --example-bg: #271a00;
  --example-border: #f59e0b;
  --example-title: #fbbf24;
  --warn-bg: #2a0a0a;
  --warn-border: #ef4444;
  --warn-title: #f87171;
  --robot-bg: #052e16;
  --robot-border: #22c55e;
  --robot-title: #4ade80;

  --code-keyword: #ff7b72;
  --code-string: #a5d6ff;
  --code-comment: #8b949e;
  --code-function: #d2a8ff;
  --code-number: #79c0ff;
  --code-class: #ffa657;
  --code-builtin: #79c0ff;
  --code-decorator: #d2a8ff;
  --code-self: #ff7b72;
}

/* ===== Reset & Base ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; scroll-padding-top: 80px; }
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans SC", "PingFang SC", sans-serif;
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.85;
  font-size: 16px;
  transition: background 0.3s, color 0.3s;
}

/* ===== Progress Bar ===== */
.progress-bar {
  position: fixed;
  top: 0;
  left: 0;
  width: 0%;
  height: 3px;
  background: linear-gradient(90deg, #6366f1, #a855f7, #ec4899);
  z-index: 9999;
  transition: width 0.1s;
}

/* ===== Sidebar ===== */
.sidebar {
  position: fixed;
  left: 0; top: 0;
  width: var(--sidebar-width);
  height: 100vh;
  background: var(--bg-sidebar);
  border-right: 1px solid var(--border-color);
  overflow-y: auto;
  z-index: 100;
  padding: 20px 0;
  transition: transform 0.3s ease, background 0.3s;
}
.sidebar-header {
  padding: 10px 20px 20px;
  border-bottom: 1px solid var(--border-color);
  margin-bottom: 10px;
}
.sidebar-header h2 {
  font-size: 17px;
  color: var(--accent);
  margin-bottom: 4px;
}
.sidebar-header p {
  font-size: 12px;
  color: var(--text-muted);
}
.sidebar nav { padding: 0 12px; }
.sidebar nav a {
  display: block;
  padding: 6px 12px;
  color: var(--text-secondary);
  text-decoration: none;
  font-size: 13px;
  border-radius: 6px;
  transition: all 0.2s;
  border-left: 2px solid transparent;
}
.sidebar nav a:hover {
  background: var(--accent-light);
  color: var(--accent);
}
.sidebar nav a.active {
  background: var(--accent-light);
  color: var(--accent);
  border-left-color: var(--accent);
  font-weight: 600;
}
.sidebar nav .sub { padding-left: 24px; font-size: 12px; }
.sidebar nav .sep { height: 1px; background: var(--border-color); margin: 8px 12px; }

/* Mobile sidebar toggle */
.sidebar-toggle {
  display: none;
  position: fixed;
  bottom: 20px; left: 20px;
  width: 48px; height: 48px;
  border-radius: 50%;
  background: var(--accent);
  color: #fff;
  border: none;
  font-size: 20px;
  cursor: pointer;
  z-index: 200;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

/* ===== Main Content ===== */
.main-content {
  margin-left: var(--sidebar-width);
  max-width: 900px;
  padding: 40px 48px 80px;
}

/* ===== Theme Toggle ===== */
.theme-toggle {
  position: fixed;
  top: 16px; right: 16px;
  width: 42px; height: 42px;
  border-radius: 50%;
  border: 1px solid var(--border-color);
  background: var(--bg-secondary);
  color: var(--text-primary);
  font-size: 18px;
  cursor: pointer;
  z-index: 200;
  transition: all 0.2s;
}
.theme-toggle:hover { box-shadow: var(--shadow-hover); }

/* ===== Typography ===== */
h1 { font-size: 2.2em; margin: 1em 0 0.6em; line-height: 1.3; color: var(--accent); }
h2 { font-size: 1.7em; margin: 2em 0 0.8em; padding-bottom: 8px; border-bottom: 2px solid var(--border-color); }
h3 { font-size: 1.35em; margin: 1.6em 0 0.6em; color: var(--accent); }
h4 { font-size: 1.1em; margin: 1.3em 0 0.5em; }
p { margin-bottom: 1em; }
a { color: var(--link); text-decoration: none; }
a:hover { text-decoration: underline; }
strong { color: var(--text-primary); }
blockquote {
  border-left: 4px solid var(--accent);
  padding: 12px 20px;
  margin: 1em 0;
  background: var(--bg-secondary);
  border-radius: 0 var(--radius) var(--radius) 0;
  color: var(--text-secondary);
  font-style: italic;
}

/* ===== Colored Boxes ===== */
.box {
  border-radius: var(--radius);
  padding: 20px 24px;
  margin: 1.5em 0;
  border-left: 5px solid;
  position: relative;
}
.box-title {
  font-weight: 700;
  margin-bottom: 8px;
  font-size: 1.05em;
  display: flex;
  align-items: center;
  gap: 8px;
}
.box.def { background: var(--def-bg); border-color: var(--def-border); }
.box.def .box-title { color: var(--def-title); }
.box.thm { background: var(--thm-bg); border-color: var(--thm-border); }
.box.thm .box-title { color: var(--thm-title); }
.box.example { background: var(--example-bg); border-color: var(--example-border); }
.box.example .box-title { color: var(--example-title); }
.box.warn { background: var(--warn-bg); border-color: var(--warn-border); }
.box.warn .box-title { color: var(--warn-title); }
.box.robot { background: var(--robot-bg); border-color: var(--robot-border); }
.box.robot .box-title { color: var(--robot-title); }

/* ===== Code Blocks ===== */
.code-block {
  position: relative;
  margin: 1.2em 0;
  border-radius: var(--radius);
  overflow: hidden;
  border: 1px solid var(--border-color);
}
.code-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 16px;
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border-color);
  font-size: 13px;
  color: var(--text-muted);
}
.copy-btn {
  background: transparent;
  border: 1px solid var(--border-color);
  color: var(--text-muted);
  padding: 3px 10px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
  transition: all 0.2s;
}
.copy-btn:hover { background: var(--accent-light); color: var(--accent); }
pre {
  background: var(--bg-code);
  padding: 16px 20px;
  overflow-x: auto;
  font-size: 14px;
  line-height: 1.6;
  margin: 0;
}
code {
  font-family: "SF Mono", "Fira Code", "JetBrains Mono", Menlo, monospace;
}
:not(pre) > code {
  background: var(--bg-code);
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 0.9em;
  color: var(--accent);
}

/* ===== Syntax Highlighting ===== */
.kw { color: var(--code-keyword); font-weight: 600; }
.str { color: var(--code-string); }
.cm { color: var(--code-comment); font-style: italic; }
.fn { color: var(--code-function); }
.num { color: var(--code-number); }
.cls { color: var(--code-class); }
.bi { color: var(--code-builtin); }
.dec { color: var(--code-decorator); }
.sf { color: var(--code-self); }
.op { color: var(--text-secondary); }

/* ===== Images ===== */
.figure {
  margin: 2em 0;
  text-align: center;
}
.figure img {
  max-width: 100%;
  border-radius: var(--radius);
  box-shadow: var(--shadow);
}
.figure .caption {
  margin-top: 10px;
  font-size: 14px;
  color: var(--text-muted);
  line-height: 1.6;
}

/* ===== Table ===== */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.5em 0;
  font-size: 15px;
}
th, td {
  padding: 10px 14px;
  border: 1px solid var(--border-color);
  text-align: left;
}
th { background: var(--bg-secondary); font-weight: 600; }

/* ===== Exercises ===== */
.exercises {
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: var(--radius);
  padding: 24px;
  margin: 2em 0;
}
.exercises h4 {
  color: var(--accent);
  margin-bottom: 16px;
}
.exercises ol { padding-left: 24px; }
.exercises li { margin-bottom: 12px; line-height: 1.7; }

/* ===== Key Takeaway ===== */
.takeaway {
  background: linear-gradient(135deg, var(--accent-light), var(--bg-secondary));
  border: 2px solid var(--accent);
  border-radius: var(--radius);
  padding: 20px 24px;
  margin: 2em 0;
}
.takeaway h4 { color: var(--accent); margin-bottom: 10px; }

/* ===== Symbol Table ===== */
.symbol-table {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 6px 20px;
  margin: 1em 0;
  font-size: 15px;
}
.symbol-table .sym {
  font-family: "SF Mono", monospace;
  color: var(--accent);
  text-align: right;
  padding: 2px 0;
}
.symbol-table .desc {
  padding: 2px 0;
  color: var(--text-secondary);
}

/* ===== Responsive ===== */
@media (max-width: 1024px) {
  .sidebar { transform: translateX(-100%); }
  .sidebar.open { transform: translateX(0); }
  .sidebar-toggle { display: flex; align-items: center; justify-content: center; }
  .main-content { margin-left: 0; padding: 30px 20px 80px; }
}

/* ===== Smooth animations ===== */
.fade-in {
  animation: fadeIn 0.5s ease-out;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===== Chapter Navigation ===== */
.chapter-nav {
  display: flex;
  justify-content: space-between;
  margin-top: 60px;
  padding-top: 30px;
  border-top: 2px solid var(--border-color);
}
.chapter-nav a {
  padding: 12px 24px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: var(--radius);
  font-weight: 600;
  transition: all 0.2s;
}
.chapter-nav a:hover {
  background: var(--accent-light);
  border-color: var(--accent);
  text-decoration: none;
}

/* SVG diagrams */
.svg-diagram {
  margin: 1.5em auto;
  display: block;
  max-width: 100%;
}
</style>
</head>
<body>

<!-- Progress Bar -->
<div class="progress-bar" id="progressBar"></div>

<!-- Theme Toggle -->
<button class="theme-toggle" id="themeToggle" title="åˆ‡æ¢æ·±è‰²/æµ…è‰²ä¸»é¢˜">ğŸŒ™</button>

<!-- Mobile Sidebar Toggle -->
<button class="sidebar-toggle" id="sidebarToggle">â˜°</button>

<!-- ===== Sidebar ===== -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <h2>ğŸ“ Chapter 3</h2>
    <p>Geometric Priors å‡ ä½•å…ˆéªŒ</p>
  </div>
  <nav>
    <a href="#intro">å¼•è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦å‡ ä½•å…ˆéªŒ</a>
    <div class="sep"></div>

    <a href="#sec3-1">3.1 å¯¹ç§°æ€§ã€è¡¨ç¤ºå’Œä¸å˜æ€§</a>
    <a href="#sec3-1-groups" class="sub">ç¾¤çš„å®šä¹‰ä¸å…¬ç†</a>
    <a href="#sec3-1-examples" class="sub">å¸¸è§å¯¹ç§°ç¾¤å®ä¾‹</a>
    <a href="#sec3-1-actions" class="sub">ç¾¤ä½œç”¨ä¸ç¾¤è¡¨ç¤º</a>
    <a href="#sec3-1-invariance" class="sub">ä¸å˜æ€§ vs ç­‰å˜æ€§</a>
    <a href="#sec3-1-code" class="sub">ğŸ ä»£ç ï¼šç­‰å˜æ€§éªŒè¯</a>
    <a href="#sec3-1-exercises" class="sub">â“ ç»ƒä¹ é¢˜</a>
    <div class="sep"></div>

    <a href="#sec3-2">3.2 åŒæ„å’Œè‡ªåŒæ„</a>
    <a href="#sec3-2-levels" class="sub">ç»“æ„å±‚æ¬¡ä¸å­ç¾¤</a>
    <a href="#sec3-2-iso" class="sub">åŒæ„ vs è‡ªåŒæ„</a>
    <a href="#sec3-2-graph" class="sub">å›¾åŒæ„ä¸å›¾è‡ªåŒæ„</a>
    <a href="#sec3-2-wl" class="sub">Weisfeiler-Leman æµ‹è¯•</a>
    <a href="#sec3-2-code" class="sub">ğŸ ä»£ç ï¼šWL æµ‹è¯•</a>
    <a href="#sec3-2-exercises" class="sub">â“ ç»ƒä¹ é¢˜</a>
    <div class="sep"></div>

    <a href="#sec3-3">3.3 å½¢å˜ç¨³å®šæ€§</a>
    <a href="#sec3-3-signal" class="sub">ä¿¡å·å½¢å˜çš„ç¨³å®šæ€§</a>
    <a href="#sec3-3-domain" class="sub">åŸŸå½¢å˜çš„ç¨³å®šæ€§</a>
    <a href="#sec3-3-math" class="sub">ğŸ“ ç¨³å®šæ€§ç•Œé™æ¨å¯¼</a>
    <a href="#sec3-3-code" class="sub">ğŸ ä»£ç ï¼šLipschitz éªŒè¯</a>
    <a href="#sec3-3-exercises" class="sub">â“ ç»ƒä¹ é¢˜</a>
    <div class="sep"></div>

    <a href="#sec3-4">3.4 å°ºåº¦åˆ†ç¦»</a>
    <a href="#sec3-4-fourier" class="sub">å‚…é‡Œå¶å˜æ¢</a>
    <a href="#sec3-4-wavelet" class="sub">å°æ³¢å˜æ¢ä¸å¤šå°ºåº¦</a>
    <a href="#sec3-4-stability" class="sub">å¤šå°ºåº¦çš„å½¢å˜ç¨³å®šæ€§</a>
    <a href="#sec3-4-coarsening" class="sub">å›¾ç²—ç²’åº¦åŒ–</a>
    <a href="#sec3-4-code" class="sub">ğŸ ä»£ç ï¼šå›¾ç²—ç²’åº¦åŒ–</a>
    <a href="#sec3-4-exercises" class="sub">â“ ç»ƒä¹ é¢˜</a>
    <div class="sep"></div>

    <a href="#sec3-5">3.5 GDL è“å›¾ â­</a>
    <a href="#sec3-5-motivation" class="sub">ä¸ºä»€ä¹ˆéœ€è¦è“å›¾</a>
    <a href="#sec3-5-blocks" class="sub">å››å¤§æ„å»ºå—</a>
    <a href="#sec3-5-blueprint" class="sub">è“å›¾å…¬å¼</a>
    <a href="#sec3-5-5g" class="sub">5G ç»Ÿä¸€æ¡†æ¶</a>
    <a href="#sec3-5-table" class="sub">GDL å…¨å®¶æ—å¯¹ç…§è¡¨</a>
    <a href="#sec3-5-code" class="sub">ğŸ ä»£ç ï¼šè“å›¾å®ç°</a>
    <a href="#sec3-5-exercises" class="sub">â“ ç»ƒä¹ é¢˜</a>
    <div class="sep"></div>

    <a href="#summary">å…¨ç« æ€»ç»“</a>
    <a href="#references">å‚è€ƒæ–‡çŒ®</a>
  </nav>
</aside>

<!-- ===== Main Content ===== -->
<div class="main-content" id="mainContent">

<!-- ======================================== -->
<!-- CHAPTER HEADER -->
<!-- ======================================== -->
<h1 id="intro">Chapter 3: Geometric Priors<br><span style="font-size:0.6em; color:var(--text-secondary)">å‡ ä½•å…ˆéªŒ â€” å¯¹ç§°æ€§ã€ç¨³å®šæ€§ä¸æ·±åº¦å­¦ä¹ è“å›¾</span></h1>

<blockquote>
  <strong>"The unreasonable effectiveness of geometric priors."</strong><br>
  ç°ä»£æ•°æ®åˆ†æçš„æœ¬è´¨å°±æ˜¯é«˜ç»´å­¦ä¹ ã€‚è™½ç„¶ç»´åº¦ç¾éš¾å‘Šè¯‰æˆ‘ä»¬ï¼Œåœ¨é€šç”¨é«˜ç»´æ•°æ®ä¸Šå­¦ä¹ æ˜¯ä¸å¯èƒ½çš„ï¼ˆå‚è§ç¬¬2ç« ï¼‰ï¼Œ
  ä½†å¯¹äº<strong>ç‰©ç†ç»“æ„åŒ–çš„æ•°æ®</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸¤ä¸ªæ ¹æœ¬åŸåˆ™ï¼š<strong>å¯¹ç§°æ€§ (Symmetry)</strong> å’Œ <strong>å°ºåº¦åˆ†ç¦» (Scale Separation)</strong>ã€‚
  è¿™ä¸¤ä¸ªåŸåˆ™å°±æ˜¯æœ¬ç« çš„"å‡ ä½•å…ˆéªŒ"(Geometric Priors)ã€‚
</blockquote>

<p>æœ¬ç« æ˜¯å…¨ä¹¦æœ€æ ¸å¿ƒçš„ç†è®ºåŸºç¡€ã€‚æˆ‘ä»¬å°†å»ºç«‹ä¸€å¥—å®Œæ•´çš„æ•°å­¦è¯­è¨€ï¼Œç”¨æ¥æè¿°æ·±åº¦å­¦ä¹ æ¶æ„ä¸­çš„å‡ ä½•ç»“æ„ã€‚
åœ¨æœ¬ç« ç»“æŸæ—¶ï¼Œä½ ä¼šçœ‹åˆ°ï¼š<strong>CNNã€GNNã€Transformerã€DeepSets</strong> ç­‰çœ‹ä¼¼ä¸åŒçš„æ¶æ„ï¼Œ
å…¶å®éƒ½æ˜¯åŒä¸€ä¸ª"å‡ ä½•è“å›¾"çš„ä¸åŒå®ä¾‹åŒ– (instantiation)ã€‚</p>

<div class="takeaway">
<h4>ğŸ¯ æœ¬ç« æ ¸å¿ƒç›®æ ‡</h4>
<p>çœ‹å®Œæœ¬ç« åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š</p>
<ol>
  <li>ç”¨<strong>ç¾¤è®ºè¯­è¨€</strong>ç²¾ç¡®æè¿°å¯¹ç§°æ€§ã€ä¸å˜æ€§å’Œç­‰å˜æ€§</li>
  <li>ç†è§£<strong>å½¢å˜ç¨³å®šæ€§</strong>ä¸ºä»€ä¹ˆæ¯”ç²¾ç¡®ä¸å˜æ€§æ›´å®é™…</li>
  <li>è§£é‡Š<strong>å¤šå°ºåº¦åˆ†æ</strong>å¦‚ä½•å…‹æœç»´åº¦ç¾éš¾</li>
  <li>å†™å‡º<strong>GDL è“å›¾</strong>çš„å››å¤§æ„å»ºå—ï¼Œå¹¶æ˜ å°„åˆ°å…·ä½“æ¶æ„</li>
  <li>ç”¨ Python/PyTorch <strong>ä»£ç éªŒè¯</strong>æ¯ä¸ªæ•°å­¦æ¦‚å¿µ</li>
</ol>
</div>

<p><strong>å‰ç½®çŸ¥è¯†</strong>ï¼šçº¿æ€§ä»£æ•°åŸºç¡€ï¼ˆçŸ©é˜µä¹˜æ³•ã€ç‰¹å¾å€¼ï¼‰ã€Python/PyTorch åŸºç¡€ã€å›¾çš„åŸºæœ¬æ¦‚å¿µã€‚</p>

<div class="figure">
  <img src="../assets/ch3_p13_img0.png" alt="ç»´åº¦ç¾éš¾ä¸Lipschitzå‡½æ•°">
  <div class="caption"><strong>å›¾ 3.1</strong>ï¼šç»´åº¦ç¾éš¾çš„å‡ ä½•ç›´è§‰ã€‚åœ¨ $d$ ç»´ç©ºé—´ä¸­ï¼Œç”¨ Lipschitz å‡½æ•°é€¼è¿‘éœ€è¦ $N = \Theta(\epsilon^{-d})$ ä¸ªæ ·æœ¬ï¼Œ
  å³æ ·æœ¬å¤æ‚åº¦éšç»´åº¦å‘ˆæŒ‡æ•°å¢é•¿ã€‚å‡ ä½•å…ˆéªŒæ­£æ˜¯ä¸ºäº†æ‰“ç ´è¿™ä¸ªè¯…å’’ã€‚</div>
</div>

<!-- ======================================== -->
<!-- SECTION 3.1: SYMMETRIES -->
<!-- ======================================== -->
<h2 id="sec3-1">3.1 å¯¹ç§°æ€§ã€è¡¨ç¤ºå’Œä¸å˜æ€§<br><span style="font-size:0.55em; color:var(--text-secondary)">Symmetries, Representations, and Invariance</span></h2>

<p>éæ­£å¼åœ°è¯´ï¼Œä¸€ä¸ª<strong>å¯¹ç§°æ€§ (symmetry)</strong> å°±æ˜¯ä¸€ä¸ªä½¿æŸä¸ªå±æ€§ä¿æŒä¸å˜çš„å˜æ¢ã€‚
å¯¹ç§°æ€§åœ¨æœºå™¨å­¦ä¹ ä¸­æ— å¤„ä¸åœ¨ï¼š</p>
<ul>
  <li><strong>è®¡ç®—æœºè§†è§‰</strong>ï¼šå›¾åƒåˆ†ç±»ç»“æœä¸åº”éšç‰©ä½“ä½ç½®æ”¹å˜ â†’ å¹³ç§»å¯¹ç§°æ€§</li>
  <li><strong>è®¡ç®—åŒ–å­¦</strong>ï¼šåˆ†å­æ€§è´¨ä¸éšç©ºé—´æœå‘æ”¹å˜ â†’ æ—‹è½¬å¯¹ç§°æ€§</li>
  <li><strong>ç²’å­ç³»ç»Ÿ</strong>ï¼šç²’å­æ²¡æœ‰å›ºæœ‰é¡ºåº â†’ ç½®æ¢å¯¹ç§°æ€§</li>
  <li><strong>ç‰©ç†æ¨¡æ‹Ÿ</strong>ï¼šç‰›é¡¿ç¬¬äºŒå®šå¾‹å…·æœ‰æ—¶é—´åæ¼”å¯¹ç§°æ€§</li>
</ul>

<!-- 3.1.1 ç¾¤è®ºåŸºç¡€ -->
<h3 id="sec3-1-groups">ç¾¤çš„å®šä¹‰ä¸å…¬ç† (Group Axioms)</h3>

<p>å¯¹ç§°æ€§çš„é›†åˆæ»¡è¶³ä¸€äº›æ¼‚äº®çš„ä»£æ•°æ€§è´¨ï¼šä¸¤ä¸ªå¯¹ç§°æ€§çš„å¤åˆä»æ˜¯å¯¹ç§°æ€§ï¼Œæ¯ä¸ªå¯¹ç§°æ€§éƒ½æ˜¯å¯é€†çš„ã€‚
è¿™äº›æ€§è´¨æ°å¥½æ„æˆä¸€ä¸ª<strong>ç¾¤ (Group)</strong> çš„å®šä¹‰ã€‚</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.1ï¼šç¾¤ (Group)</div>
  <p>ä¸€ä¸ª<strong>ç¾¤</strong>æ˜¯ä¸€ä¸ªé›†åˆ $\mathfrak{G}$ åŠ ä¸Šä¸€ä¸ªäºŒå…ƒè¿ç®— $\circ : \mathfrak{G} \times \mathfrak{G} \to \mathfrak{G}$ï¼ˆç®€è®°ä¸º $\mathfrak{g}\mathfrak{h}$ï¼‰ï¼Œæ»¡è¶³ä»¥ä¸‹å››æ¡å…¬ç†ï¼š</p>
  <ol>
    <li><strong>å°é—­æ€§ (Closure)</strong>ï¼šå¯¹ä»»æ„ $\mathfrak{g}, \mathfrak{h} \in \mathfrak{G}$ï¼Œæœ‰ $\mathfrak{g}\mathfrak{h} \in \mathfrak{G}$</li>
    <li><strong>ç»“åˆå¾‹ (Associativity)</strong>ï¼š$(\mathfrak{g}\mathfrak{h})\mathfrak{k} = \mathfrak{g}(\mathfrak{h}\mathfrak{k})$ï¼Œå¯¹æ‰€æœ‰ $\mathfrak{g}, \mathfrak{h}, \mathfrak{k} \in \mathfrak{G}$</li>
    <li><strong>å•ä½å…ƒ (Identity)</strong>ï¼šå­˜åœ¨å”¯ä¸€çš„ $\mathfrak{e} \in \mathfrak{G}$ï¼Œä½¿å¾— $\mathfrak{e}\mathfrak{g} = \mathfrak{g}\mathfrak{e} = \mathfrak{g}$</li>
    <li><strong>é€†å…ƒ (Inverse)</strong>ï¼šå¯¹æ¯ä¸ª $\mathfrak{g} \in \mathfrak{G}$ï¼Œå­˜åœ¨å”¯ä¸€çš„ $\mathfrak{g}^{-1} \in \mathfrak{G}$ï¼Œä½¿å¾— $\mathfrak{g}\mathfrak{g}^{-1} = \mathfrak{g}^{-1}\mathfrak{g} = \mathfrak{e}$</li>
  </ol>
  <div class="symbol-table" style="margin-top: 12px;">
    <span class="sym">$\mathfrak{G}$</span><span class="desc">ç¾¤çš„é›†åˆ</span>
    <span class="sym">$\circ$</span><span class="desc">ç¾¤è¿ç®—ï¼ˆå¤åˆæ“ä½œï¼‰</span>
    <span class="sym">$\mathfrak{e}$</span><span class="desc">å•ä½å…ƒï¼ˆä»€ä¹ˆä¹Ÿä¸åšçš„å˜æ¢ï¼‰</span>
    <span class="sym">$\mathfrak{g}^{-1}$</span><span class="desc">$\mathfrak{g}$ çš„é€†å…ƒï¼ˆæ’¤é”€ $\mathfrak{g}$ çš„å˜æ¢ï¼‰</span>
  </div>
</div>

<div class="box example">
  <div class="box-title">ğŸ’¡ ç›´è§‰ï¼šç¾¤å°±åƒ"å¯æ’¤é”€çš„æ“ä½œé›†åˆ"</div>
  <p>æƒ³è±¡ä½ åœ¨ç©é­”æ–¹ï¼š</p>
  <ul>
    <li>æ¯æ¬¡è½¬åŠ¨æ˜¯ä¸€ä¸ªç¾¤å…ƒç´ </li>
    <li>ä¸¤æ¬¡è½¬åŠ¨çš„è¿ç»­æ“ä½œä»æ˜¯ä¸€ç§æ“ä½œï¼ˆå°é—­æ€§ï¼‰</li>
    <li>ä¸‰æ­¥è¿ç»­è½¬åŠ¨ä¸ç®¡æ€ä¹ˆåŠ æ‹¬å·ç»“æœä¸€æ ·ï¼ˆç»“åˆå¾‹ï¼‰</li>
    <li>ä»€ä¹ˆéƒ½ä¸è½¬ = å•ä½å…ƒ</li>
    <li>æ¯æ­¥è½¬åŠ¨éƒ½å¯ä»¥é€šè¿‡åå‘è½¬åŠ¨æ’¤é”€ = é€†å…ƒ</li>
  </ul>
  <p><strong>æ³¨æ„</strong>ï¼šç¾¤ä¸è¦æ±‚äº¤æ¢å¾‹ï¼å…ˆå·¦è½¬å†å³è½¬ â‰  å…ˆå³è½¬å†å·¦è½¬ã€‚æ»¡è¶³äº¤æ¢å¾‹çš„ç¾¤å«<strong>é˜¿è´å°”ç¾¤ (Abelian Group)</strong>ã€‚</p>
</div>

<div class="box warn">
  <div class="box-title">âš ï¸ æ³¨æ„ï¼šç¬¦å·çº¦å®š</div>
  <p>æœ¬ä¹¦ä½¿ç”¨å“¥ç‰¹ä½“å­—æ¯ï¼ˆFraktur fontï¼‰$\mathfrak{g}, \mathfrak{h}$ è¡¨ç¤ºç¾¤å…ƒç´ ï¼Œé‡‡ç”¨<strong>å³åˆ°å·¦</strong>çš„å¤åˆçº¦å®šï¼š
  $\mathfrak{g}\mathfrak{h}$ æ„å‘³ç€<strong>å…ˆæ–½åŠ  $\mathfrak{h}$ï¼Œå†æ–½åŠ  $\mathfrak{g}$</strong>ã€‚è¿™ä¸å‡½æ•°å¤åˆ $g \circ h$ ä¸€è‡´ã€‚</p>
</div>

<h4>ç¾¤çš„ç”Ÿæˆå…ƒ (Group Generators)</h4>

<p>è™½ç„¶æœ‰äº›ç¾¤å¯ä»¥éå¸¸å¤§ç”šè‡³æ— é™å¤§ï¼Œä½†å®ƒä»¬é€šå¸¸å¯ä»¥ç”±å°‘é‡å…ƒç´ <strong>ç”Ÿæˆ</strong>ã€‚</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.2ï¼šç¾¤ç”Ÿæˆå…ƒ (Group Generator)</div>
  <p>è‹¥ç¾¤ $\mathfrak{G}$ çš„æ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥å†™æˆå­é›† $S \subseteq \mathfrak{G}$ ä¸­å…ƒç´ åŠå…¶é€†çš„æœ‰é™å¤åˆï¼Œ
  åˆ™ç§° $S$ æ˜¯ $\mathfrak{G}$ çš„<strong>ç”Ÿæˆé›† (generator set)</strong>ã€‚</p>
</div>

<div class="box example">
  <div class="box-title">ğŸ’¡ ä¾‹ï¼šç­‰è¾¹ä¸‰è§’å½¢çš„äºŒé¢ä½“ç¾¤ $D_3$</div>
  <p>ç­‰è¾¹ä¸‰è§’å½¢çš„å¯¹ç§°ç¾¤ $D_3$ ç”±<strong>ä¸¤ä¸ª</strong>ç”Ÿæˆå…ƒå®Œå…¨ç¡®å®šï¼š</p>
  <ul>
    <li>$R$ï¼šæ—‹è½¬ $120Â°$</li>
    <li>$F$ï¼šå…³äºæŸæ¡å¯¹ç§°è½´çš„åå°„</li>
  </ul>
  <p>é€šè¿‡ $R$ å’Œ $F$ çš„ç»„åˆï¼Œå¯ä»¥å¾—åˆ°å…¨éƒ¨ $|D_3| = 6$ ä¸ªå…ƒç´ ï¼š$\{e, R, R^2, F, RF, R^2F\}$ã€‚</p>
  <p>æœ‰è¶£çš„æ˜¯ï¼Œ$D_3$ åŒæ„äºä¸‰å…ƒç´ çš„ç½®æ¢ç¾¤ $\Sigma_3$ï¼ˆä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹çš„æ‰€æœ‰å¯èƒ½æ’åˆ—ï¼‰ã€‚</p>
</div>

<div class="figure">
  <img src="../assets/ch3_p18_img0.png" alt="ç­‰è¾¹ä¸‰è§’å½¢çš„äºŒé¢ä½“ç¾¤D3">
  <div class="caption"><strong>å›¾ 3.2</strong>ï¼šå·¦ï¼šç­‰è¾¹ä¸‰è§’å½¢çš„æ‰€æœ‰æ—‹è½¬å’Œåå°„ã€‚$D_3$ ç¾¤ç”±æ—‹è½¬ $R$ å’Œåå°„ $F$ ä¸¤ä¸ªç”Ÿæˆå…ƒç”Ÿæˆï¼Œ
  ç­‰åŒäºä¸‰å…ƒç´ çš„ç½®æ¢ç¾¤ $\Sigma_3$ã€‚å³ï¼š$D_3$ ç¾¤çš„ä¹˜æ³•è¡¨ã€‚</div>
</div>

<!-- 3.1.2 å¸¸è§å¯¹ç§°ç¾¤ -->
<h3 id="sec3-1-examples">å¸¸è§å¯¹ç§°ç¾¤å®ä¾‹</h3>

<p>åœ¨å‡ ä½•æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä¼šåå¤é‡åˆ°ä»¥ä¸‹å‡ ç±»ç¾¤ï¼š</p>

<table>
  <thead>
    <tr><th>ç¾¤</th><th>ç¬¦å·</th><th>å…ƒç´ </th><th>åº”ç”¨åœºæ™¯</th></tr>
  </thead>
  <tbody>
    <tr>
      <td>å¯¹ç§°ç¾¤ / ç½®æ¢ç¾¤</td>
      <td>$\Sigma_n$ (æˆ– $S_n$)</td>
      <td>$n$ ä¸ªå…ƒç´ çš„æ‰€æœ‰æ’åˆ—ï¼Œ$|S_n| = n!$</td>
      <td>é›†åˆã€å›¾ã€ç‚¹äº‘</td>
    </tr>
    <tr>
      <td>å¾ªç¯ç¾¤</td>
      <td>$\mathbb{Z}_n$</td>
      <td>æ¨¡ $n$ çš„æ•´æ•°åŠ æ³•</td>
      <td>ç¦»æ•£æ—‹è½¬</td>
    </tr>
    <tr>
      <td>å¹³ç§»ç¾¤</td>
      <td>$(\mathbb{R}^d, +)$</td>
      <td>$d$ ç»´ç©ºé—´ä¸­çš„æ‰€æœ‰å¹³ç§»</td>
      <td>å›¾åƒã€ä¿¡å·å¤„ç†</td>
    </tr>
    <tr>
      <td>æ—‹è½¬ç¾¤</td>
      <td>$\mathrm{SO}(d)$</td>
      <td>$d$ ç»´ç©ºé—´ä¸­çš„æ‰€æœ‰æ—‹è½¬<br>$\det(R)=1, R^\top R = I$</td>
      <td>3D åˆ†å­ã€ç²’å­ç‰©ç†</td>
    </tr>
    <tr>
      <td>æ­£äº¤ç¾¤</td>
      <td>$\mathrm{O}(d)$</td>
      <td>æ—‹è½¬ + åå°„</td>
      <td>æ™¶ä½“å­¦</td>
    </tr>
    <tr>
      <td>ç‰¹æ®Šæ¬§å‡ é‡Œå¾—ç¾¤</td>
      <td>$\mathrm{SE}(d)$</td>
      <td>æ—‹è½¬ + å¹³ç§»ï¼ˆä¿å‘ç­‰è·ï¼‰</td>
      <td>æœºå™¨äººå­¦ã€ç‰©ç†æ¨¡æ‹Ÿ</td>
    </tr>
    <tr>
      <td>æ¬§å‡ é‡Œå¾—ç¾¤</td>
      <td>$\mathrm{E}(d)$</td>
      <td>æ—‹è½¬ + å¹³ç§» + åå°„</td>
      <td>é€šç”¨åˆšä½“è¿åŠ¨</td>
    </tr>
  </tbody>
</table>

<div class="box thm">
  <div class="box-title">ğŸ”‘ å…³é”®å…³ç³»é“¾</div>
  $$\text{å¹³ç§»ç¾¤} \;\subset\; \mathrm{SE}(d) \;\subset\; \mathrm{E}(d) \;\subset\; \mathrm{Diff}(\Omega)$$
  <p>ä»å·¦åˆ°å³ï¼Œç¾¤è¶Šæ¥è¶Šå¤§ï¼Œä¿æŒçš„ç»“æ„è¶Šæ¥è¶Šå°‘ã€‚è¿™æ­£æ˜¯ Klein çš„<strong>çˆ±å°”å…°æ ¹çº²é¢† (Erlangen Programme)</strong> çš„æ ¸å¿ƒæ€æƒ³ã€‚</p>
</div>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.3ï¼šæç¾¤ (Lie Group)</div>
  <p>ä¸€ä¸ª<strong>æç¾¤</strong>æ˜¯æ—¢æ˜¯ç¾¤åˆæ˜¯å…‰æ»‘æµå½¢ (smooth manifold) çš„æ•°å­¦å¯¹è±¡ï¼Œç¾¤è¿ç®—ï¼ˆä¹˜æ³•å’Œæ±‚é€†ï¼‰éƒ½æ˜¯å…‰æ»‘æ˜ å°„ã€‚
  æ¢è¨€ä¹‹ï¼Œæç¾¤æ˜¯<strong>å¯å¾®åˆ†çš„è¿ç»­å¯¹ç§°ç¾¤</strong>ã€‚</p>
  <p>å…¸å‹ä¾‹å­ï¼š$\mathrm{SO}(3)$ æ˜¯ä¸€ä¸ª 3 ç»´æµå½¢ï¼ˆæ‹“æ‰‘ä¸Šç­‰ä»·äº $\mathbb{RP}^3$ï¼‰ï¼Œæ¯ä¸ª"ç‚¹"å¯¹åº”ä¸€ä¸ª 3D æ—‹è½¬ã€‚</p>
</div>

<!-- 3.1.3 ç¾¤ä½œç”¨ä¸ç¾¤è¡¨ç¤º -->
<h3 id="sec3-1-actions">ç¾¤ä½œç”¨ä¸ç¾¤è¡¨ç¤º (Group Actions & Representations)</h3>

<p>æŠ½è±¡ç¾¤çš„å®šä¹‰åªå‘Šè¯‰æˆ‘ä»¬å…ƒç´ å¦‚ä½•<strong>å¤åˆ</strong>ã€‚ä½†åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬æ›´å…³å¿ƒç¾¤å¦‚ä½•<strong>ä½œç”¨äºæ•°æ®</strong>ã€‚
è¿™å°±å¼•å‡ºäº†<strong>ç¾¤ä½œç”¨ (group action)</strong> å’Œ<strong>ç¾¤è¡¨ç¤º (group representation)</strong> çš„æ¦‚å¿µã€‚</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.4ï¼šç¾¤ä½œç”¨ (Group Action)</div>
  <p>ç¾¤ $\mathfrak{G}$ åœ¨é›†åˆ $\Omega$ ä¸Šçš„<strong>ï¼ˆå·¦ï¼‰ç¾¤ä½œç”¨</strong>æ˜¯ä¸€ä¸ªæ˜ å°„ $(\mathfrak{g}, u) \mapsto \mathfrak{g}.u$ï¼Œ
  å°†ç¾¤å…ƒç´  $\mathfrak{g} \in \mathfrak{G}$ å’Œç‚¹ $u \in \Omega$ å…³è”åˆ° $\Omega$ ä¸Šçš„å¦ä¸€ä¸ªç‚¹ï¼Œä¸”æ»¡è¶³ç›¸å®¹æ€§ï¼š</p>
  $$\mathfrak{g}.(\mathfrak{h}.u) = (\mathfrak{g}\mathfrak{h}).u \quad \forall\, \mathfrak{g}, \mathfrak{h} \in \mathfrak{G},\; u \in \Omega$$
  <div class="symbol-table" style="margin-top: 12px;">
    <span class="sym">$\Omega$</span><span class="desc">åŸŸ (domain)ï¼šæ•°æ®çš„åº•å±‚å‡ ä½•ç©ºé—´</span>
    <span class="sym">$\mathfrak{g}.u$</span><span class="desc">ç¾¤å…ƒç´  $\mathfrak{g}$ å°†ç‚¹ $u$ å˜æ¢åˆ°æ–°ä½ç½®</span>
  </div>
</div>

<div class="box example">
  <div class="box-title">ğŸ’¡ å¤šå±‚æ¬¡çš„ç¾¤ä½œç”¨</div>
  <p>åŒä¸€ä¸ªç¾¤å¯ä»¥åœ¨ä¸åŒå±‚æ¬¡ä¸Šå‘æŒ¥ä½œç”¨ã€‚ä»¥æ¬§å‡ é‡Œå¾—ç¾¤ $\mathrm{E}(2)$ ä¸ºä¾‹ï¼š</p>
  <ol>
    <li><strong>ä½œç”¨äºåŸŸ $\Omega = \mathbb{R}^2$</strong>ï¼šå¹³ç§»ã€æ—‹è½¬ã€åå°„åƒç´ ç½‘æ ¼ä¸Šçš„ç‚¹</li>
    <li><strong>ä½œç”¨äºä¿¡å·ç©ºé—´ $\mathcal{X}(\Omega)$</strong>ï¼šå¹³ç§»ã€æ—‹è½¬ã€ç¿»è½¬æ•´å¹…å›¾åƒ</li>
    <li><strong>ä½œç”¨äºç‰¹å¾ç©ºé—´</strong>ï¼šå˜æ¢ç¥ç»ç½‘ç»œå­¦åˆ°çš„ä¸­é—´è¡¨ç¤º</li>
  </ol>
</div>

<p>å½“ç¾¤ $\mathfrak{G}$ ä½œç”¨äºåŸŸ $\Omega$ æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥<strong>è‡ªç„¶åœ°</strong>æ¨å¯¼å‡ºå®ƒåœ¨ä¿¡å·ç©ºé—´ $\mathcal{X}(\Omega)$ ä¸Šçš„ä½œç”¨ï¼š</p>

<div class="box thm">
  <div class="box-title">ğŸ“— ä¿¡å·ç©ºé—´ä¸Šçš„ç¾¤ä½œç”¨</div>
  <p>ç»™å®š $\mathfrak{G}$ åœ¨ $\Omega$ ä¸Šçš„ä½œç”¨ï¼Œä¿¡å· $x \in \mathcal{X}(\Omega)$ çš„å˜æ¢å®šä¹‰ä¸ºï¼š</p>
  $$(\mathfrak{g}.x)(u) = x(\mathfrak{g}^{-1}u) \tag{3}$$
  <div class="symbol-table" style="margin-top: 8px;">
    <span class="sym">$x$</span><span class="desc">ä¿¡å·ï¼ˆå¦‚å›¾åƒï¼‰ï¼š$x : \Omega \to \mathcal{C}$</span>
    <span class="sym">$\mathfrak{g}^{-1}$</span><span class="desc">é€†å˜æ¢â€”â€”ä½¿å¾—è¿™ç¡®å®æ„æˆä¸€ä¸ªæœ‰æ•ˆçš„ç¾¤ä½œç”¨</span>
    <span class="sym">$u$</span><span class="desc">åŸŸä¸Šçš„ä¸€ä¸ªç‚¹ï¼ˆå¦‚åƒç´ åæ ‡ï¼‰</span>
  </div>
  <p style="margin-top: 8px;"><strong>ä¸ºä»€ä¹ˆç”¨ $\mathfrak{g}^{-1}$ï¼Ÿ</strong> ä¸ºäº†ä¿è¯ $\mathfrak{g}.(\mathfrak{h}.x) = (\mathfrak{g}\mathfrak{h}).x$ã€‚
  ç›´è§‰ä¸Šï¼šè¦çŸ¥é“å˜æ¢åçš„ä¿¡å·åœ¨ $u$ å¤„çš„å€¼ï¼Œå°±å»çœ‹å˜æ¢å‰ $u$ åŸæœ¬å¯¹åº”çš„ä½ç½® $\mathfrak{g}^{-1}u$ ä¸Šçš„å€¼ã€‚</p>
</div>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¼•å…¥æœ€é‡è¦çš„æ¦‚å¿µâ€”â€”<strong>ç¾¤è¡¨ç¤º (Group Representation)</strong>ï¼š</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.5ï¼šç¾¤è¡¨ç¤º (Group Representation)</div>
  <p>ç¾¤ $\mathfrak{G}$ çš„ä¸€ä¸ª $n$ ç»´å®è¡¨ç¤ºæ˜¯ä¸€ä¸ªæ˜ å°„ $\rho : \mathfrak{G} \to \mathbb{R}^{n \times n}$ï¼Œ
  å°†æ¯ä¸ªç¾¤å…ƒç´  $\mathfrak{g}$ æ˜ å°„ä¸ºä¸€ä¸ªå¯é€†çŸ©é˜µ $\rho(\mathfrak{g})$ï¼Œå¹¶æ»¡è¶³ï¼š</p>
  $$\rho(\mathfrak{g}\mathfrak{h}) = \rho(\mathfrak{g})\rho(\mathfrak{h}) \quad \forall\, \mathfrak{g}, \mathfrak{h} \in \mathfrak{G} \tag{4}$$
  <div class="symbol-table" style="margin-top: 8px;">
    <span class="sym">$\rho$</span><span class="desc">è¡¨ç¤ºæ˜ å°„ï¼ˆç¾¤å…ƒç´  â†’ çŸ©é˜µï¼‰</span>
    <span class="sym">$n$</span><span class="desc">è¡¨ç¤ºçš„ç»´åº¦ï¼ˆé€šå¸¸æ˜¯ç‰¹å¾ç©ºé—´çš„ç»´åº¦ï¼‰</span>
    <span class="sym">$\rho(\mathfrak{g})$</span><span class="desc">ä¸€ä¸ª $n \times n$ å¯é€†çŸ©é˜µï¼Œä»£è¡¨ç¾¤å…ƒç´  $\mathfrak{g}$ åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„åŠ¨ä½œ</span>
  </div>
  <p style="margin-top: 8px;">å¦‚æœ $\rho(\mathfrak{g})$ å¯¹æ‰€æœ‰ $\mathfrak{g}$ éƒ½æ˜¯æ­£äº¤çŸ©é˜µï¼ˆ$\rho(\mathfrak{g})^\top = \rho(\mathfrak{g})^{-1}$ï¼‰ï¼Œ
  åˆ™ç§°è¿™æ˜¯ä¸€ä¸ª<strong>æ­£äº¤è¡¨ç¤º (orthogonal representation)</strong>ã€‚</p>
</div>

<div class="box example">
  <div class="box-title">ğŸ’¡ ç›´è§‰ï¼šè¡¨ç¤ºå°±æ˜¯"ç¾¤çš„çŸ©é˜µåŒ–"</div>
  <p>ç¾¤æœ¬èº«æ˜¯æŠ½è±¡çš„ï¼ˆåªå®šä¹‰äº†å¤åˆè§„åˆ™ï¼‰ï¼Œä½†é€šè¿‡<strong>è¡¨ç¤º $\rho$</strong>ï¼Œæˆ‘ä»¬æŠŠæ¯ä¸ªç¾¤å…ƒç´ "ç¼–ç "ä¸ºä¸€ä¸ªå…·ä½“çš„çŸ©é˜µï¼Œ
  è¿™æ ·å°±å¯ä»¥ç”¨çŸ©é˜µä¹˜æ³•æ¥å®ç°ç¾¤è¿ç®—ã€‚ä¸åŒçš„è¡¨ç¤ºå°±åƒä¸åŒçš„"ç¿»è¯‘"æ–¹å¼â€”â€”
  åŒä¸€ä¸ªç¾¤å¯ä»¥æœ‰ä¸åŒç»´åº¦çš„è¡¨ç¤ºã€‚</p>
  <p><strong>ä¾‹å­</strong>ï¼šå¹³é¢æ—‹è½¬ç¾¤ $\mathrm{SO}(2)$ ä¸­ï¼Œè§’åº¦ $\theta$ çš„æ—‹è½¬å¯ä»¥è¡¨ç¤ºä¸º $2 \times 2$ æ—‹è½¬çŸ©é˜µï¼š</p>
  $$\rho(\theta) = \begin{pmatrix} \cos\theta & -\sin\theta \\ \sin\theta & \cos\theta \end{pmatrix}$$
</div>

<div class="figure">
  <img src="../assets/ch3_p20_img0.png" alt="åŸŸã€ä¿¡å·ç©ºé—´å’Œå‡è®¾ç±»">
  <div class="caption"><strong>å›¾ 3.3</strong>ï¼šå‡ ä½•æ·±åº¦å­¦ä¹ ä¸­çš„ä¸‰ä¸ªå…³é”®ç©ºé—´ã€‚åŸŸ $\Omega$ çš„å¯¹ç§°æ€§ï¼ˆç”±ç¾¤ $\mathfrak{G}$ æ•è·ï¼‰é€šè¿‡ç¾¤è¡¨ç¤º $\rho(\mathfrak{g})$ ä½œç”¨äºä¿¡å· $x \in \mathcal{X}(\Omega)$ï¼Œè¿›è€Œçº¦æŸä½œç”¨äºä¿¡å·çš„å‡½æ•° $f \in \mathcal{F}(\mathcal{X}(\Omega))$ çš„å½¢å¼ã€‚</div>
</div>

<!-- 3.1.4 ä¸å˜æ€§å’Œç­‰å˜æ€§ -->
<h3 id="sec3-1-invariance">ä¸å˜æ€§ vs ç­‰å˜æ€§ (Invariance vs Equivariance)</h3>

<p>åŸŸ $\Omega$ çš„å¯¹ç§°æ€§å¯¹å®šä¹‰åœ¨ä¿¡å·ä¸Šçš„å‡½æ•° $f$ æ–½åŠ äº†ç»“æ„çº¦æŸã€‚
ä¸¤ä¸ªæœ€é‡è¦çš„çº¦æŸå½¢å¼æ˜¯<strong>ä¸å˜æ€§</strong>å’Œ<strong>ç­‰å˜æ€§</strong>ï¼š</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.6ï¼šä¸å˜æ€§ (Invariance)</div>
  <p>å‡½æ•° $f : \mathcal{X}(\Omega) \to \mathcal{Y}$ æ˜¯ <strong>$\mathfrak{G}$-ä¸å˜çš„</strong>ï¼Œå¦‚æœï¼š</p>
  $$\boxed{f(\rho(\mathfrak{g})x) = f(x)} \quad \forall\, \mathfrak{g} \in \mathfrak{G},\; x \in \mathcal{X}(\Omega) \tag{5}$$
  <p>ç¾¤ä½œç”¨<strong>ä¸æ”¹å˜</strong>å‡½æ•°çš„è¾“å‡ºã€‚</p>
</div>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.7ï¼šç­‰å˜æ€§ (Equivariance)</div>
  <p>å‡½æ•° $f : \mathcal{X}(\Omega) \to \mathcal{X}(\Omega')$ æ˜¯ <strong>$\mathfrak{G}$-ç­‰å˜çš„</strong>ï¼Œå¦‚æœï¼š</p>
  $$\boxed{f(\rho(\mathfrak{g})x) = \rho'(\mathfrak{g})f(x)} \quad \forall\, \mathfrak{g} \in \mathfrak{G},\; x \in \mathcal{X}(\Omega) \tag{6}$$
  <p>ç¾¤ä½œç”¨äºè¾“å…¥ï¼Œè¾“å‡ºä»¥<strong>ç›¸åŒæ–¹å¼</strong>ï¼ˆå¯èƒ½æ˜¯ä¸åŒçš„è¡¨ç¤º $\rho'$ï¼‰è¢«å˜æ¢ã€‚</p>
  <div class="symbol-table" style="margin-top: 8px;">
    <span class="sym">$\rho(\mathfrak{g})$</span><span class="desc">ç¾¤åœ¨è¾“å…¥ç©ºé—´ä¸Šçš„è¡¨ç¤º</span>
    <span class="sym">$\rho'(\mathfrak{g})$</span><span class="desc">ç¾¤åœ¨è¾“å‡ºç©ºé—´ä¸Šçš„è¡¨ç¤ºï¼ˆå¯ä»¥ä¸åŒï¼ï¼‰</span>
  </div>
</div>

<!-- SVG: Invariance vs Equivariance -->
<svg class="svg-diagram" viewBox="0 0 800 260" xmlns="http://www.w3.org/2000/svg" style="max-width: 700px;">
  <!-- Invariance diagram -->
  <text x="200" y="25" text-anchor="middle" font-size="16" font-weight="bold" fill="#4f46e5">ä¸å˜æ€§ (Invariance)</text>
  <rect x="30" y="40" width="80" height="50" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="2"/>
  <text x="70" y="70" text-anchor="middle" font-size="14" fill="#1d4ed8">x</text>
  <line x1="110" y1="65" x2="160" y2="65" stroke="#64748b" stroke-width="2" marker-end="url(#arrow1)"/>
  <rect x="160" y="40" width="80" height="50" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
  <text x="200" y="70" text-anchor="middle" font-size="14" fill="#1d4ed8">f</text>
  <line x1="240" y1="65" x2="290" y2="65" stroke="#64748b" stroke-width="2" marker-end="url(#arrow1)"/>
  <rect x="290" y="40" width="80" height="50" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="2"/>
  <text x="330" y="70" text-anchor="middle" font-size="14" fill="#1d4ed8">y</text>

  <rect x="30" y="130" width="80" height="50" rx="8" fill="#fef9c3" stroke="#f59e0b" stroke-width="2"/>
  <text x="70" y="160" text-anchor="middle" font-size="14" fill="#b45309">Ï(g)x</text>
  <line x1="110" y1="155" x2="160" y2="155" stroke="#64748b" stroke-width="2" marker-end="url(#arrow1)"/>
  <rect x="160" y="130" width="80" height="50" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
  <text x="200" y="160" text-anchor="middle" font-size="14" fill="#1d4ed8">f</text>
  <line x1="240" y1="155" x2="290" y2="155" stroke="#64748b" stroke-width="2" marker-end="url(#arrow1)"/>
  <rect x="290" y="130" width="80" height="50" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="2"/>
  <text x="330" y="160" text-anchor="middle" font-size="14" fill="#1d4ed8">y</text>
  <text x="345" y="200" text-anchor="middle" font-size="13" fill="#6b7280">è¾“å‡ºç›¸åŒï¼</text>

  <!-- Arrow between x and rho(g)x -->
  <line x1="70" y1="90" x2="70" y2="130" stroke="#f59e0b" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrow2)"/>
  <text x="85" y="115" font-size="11" fill="#b45309">Ï(g)</text>

  <!-- Equivariance diagram -->
  <text x="600" y="25" text-anchor="middle" font-size="16" font-weight="bold" fill="#059669">ç­‰å˜æ€§ (Equivariance)</text>
  <rect x="430" y="40" width="80" height="50" rx="8" fill="#eff6ff" stroke="#3b82f6" stroke-width="2"/>
  <text x="470" y="70" text-anchor="middle" font-size="14" fill="#1d4ed8">x</text>
  <line x1="510" y1="65" x2="560" y2="65" stroke="#64748b" stroke-width="2" marker-end="url(#arrow1)"/>
  <rect x="560" y="40" width="80" height="50" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
  <text x="600" y="70" text-anchor="middle" font-size="14" fill="#047857">f</text>
  <line x1="640" y1="65" x2="690" y2="65" stroke="#64748b" stroke-width="2" marker-end="url(#arrow1)"/>
  <rect x="690" y="40" width="80" height="50" rx="8" fill="#ecfdf5" stroke="#10b981" stroke-width="2"/>
  <text x="730" y="70" text-anchor="middle" font-size="14" fill="#047857">f(x)</text>

  <rect x="430" y="130" width="80" height="50" rx="8" fill="#fef9c3" stroke="#f59e0b" stroke-width="2"/>
  <text x="470" y="160" text-anchor="middle" font-size="14" fill="#b45309">Ï(g)x</text>
  <line x1="510" y1="155" x2="560" y2="155" stroke="#64748b" stroke-width="2" marker-end="url(#arrow1)"/>
  <rect x="560" y="130" width="80" height="50" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
  <text x="600" y="160" text-anchor="middle" font-size="14" fill="#047857">f</text>
  <line x1="640" y1="155" x2="690" y2="155" stroke="#64748b" stroke-width="2" marker-end="url(#arrow1)"/>
  <rect x="690" y="130" width="80" height="50" rx="8" fill="#fef9c3" stroke="#f59e0b" stroke-width="2"/>
  <text x="730" y="160" text-anchor="middle" font-size="13" fill="#b45309">Ï'(g)f(x)</text>
  <text x="745" y="200" text-anchor="middle" font-size="13" fill="#6b7280">è¾“å‡ºè¢«åŒæ­¥å˜æ¢ï¼</text>

  <line x1="470" y1="90" x2="470" y2="130" stroke="#f59e0b" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrow2)"/>
  <text x="485" y="115" font-size="11" fill="#b45309">Ï(g)</text>
  <line x1="730" y1="90" x2="730" y2="130" stroke="#f59e0b" stroke-width="2" stroke-dasharray="4,4" marker-end="url(#arrow2)"/>
  <text x="750" y="115" font-size="11" fill="#b45309">Ï'(g)</text>

  <defs>
    <marker id="arrow1" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#64748b"/></marker>
    <marker id="arrow2" markerWidth="8" markerHeight="6" refX="4" refY="3" orient="auto"><path d="M0,0 L8,3 L0,6" fill="#f59e0b"/></marker>
  </defs>
</svg>

<div class="box example">
  <div class="box-title">ğŸ’¡ å›¾åƒåˆ†ç±» vs å›¾åƒåˆ†å‰²</div>
  <p><strong>å›¾åƒåˆ†ç±»</strong>ï¼ˆå¦‚çŒ«/ç‹—è¯†åˆ«ï¼‰éœ€è¦<strong>ä¸å˜æ€§</strong>ï¼šä¸ç®¡çŒ«åœ¨å›¾åƒçš„å“ªä¸ªä½ç½®ï¼Œåˆ†ç±»ç»“æœéƒ½æ˜¯"çŒ«"ã€‚</p>
  <p><strong>å›¾åƒåˆ†å‰²</strong>ï¼ˆåƒç´ çº§æ ‡æ³¨ï¼‰éœ€è¦<strong>ç­‰å˜æ€§</strong>ï¼šå¦‚æœè¾“å…¥å›¾åƒå¹³ç§»äº† 10 ä¸ªåƒç´ ï¼Œè¾“å‡ºçš„åˆ†å‰²è’™ç‰ˆä¹Ÿè¦å¹³ç§» 10 ä¸ªåƒç´ ã€‚</p>
  <p>å®é™…ä¸Šï¼ŒCNN çš„<strong>å·ç§¯å±‚æ˜¯ç­‰å˜çš„</strong>ï¼Œè€Œæœ€åçš„<strong>å…¨å±€æ± åŒ–å±‚ (global pooling) å®ç°äº†ä¸å˜æ€§</strong>ã€‚
  è¿™ä¸ª"å…ˆç­‰å˜åä¸å˜"çš„æ¨¡å¼å°±æ˜¯ç¬¬ 3.5 èŠ‚ GDL è“å›¾çš„æ ¸å¿ƒï¼</p>
</div>

<div class="box thm">
  <div class="box-title">ğŸ“— å®šç†ï¼šä¸å˜æ€§æ˜¯ç­‰å˜æ€§çš„ç‰¹æ®Šæƒ…å†µ</div>
  <p>å¦‚æœè¾“å‡ºç©ºé—´ $\mathcal{Y}$ ä¸Šçš„ç¾¤è¡¨ç¤ºæ˜¯<strong>å¹³å‡¡è¡¨ç¤º</strong>ï¼ˆå³ $\rho'(\mathfrak{g}) = \mathrm{Id}$ å¯¹æ‰€æœ‰ $\mathfrak{g}$ï¼‰ï¼Œ
  åˆ™ç­‰å˜æ€§é€€åŒ–ä¸ºä¸å˜æ€§ï¼š</p>
  $$f(\rho(\mathfrak{g})x) = \rho'(\mathfrak{g})f(x) = \mathrm{Id} \cdot f(x) = f(x)$$
</div>

<div class="box robot">
  <div class="box-title">ğŸ¤– ä¸ PhysRobot çš„å…³è”</div>
  <p>åœ¨æˆ‘ä»¬çš„ PhysRobot ç²’å­æ¨¡æ‹Ÿé¡¹ç›®ä¸­ï¼Œ<strong>EdgeFrame</strong> æ¨¡å—æ­£æ˜¯åˆ©ç”¨äº†å¹³ç§»ä¸å˜æ€§ï¼š</p>
  <ul>
    <li>ç²’å­ä¹‹é—´çš„ç›¸äº’ä½œç”¨åªå–å†³äº<strong>ç›¸å¯¹ä½ç½®</strong> $\Delta \mathbf{r}_{ij} = \mathbf{r}_j - \mathbf{r}_i$ï¼Œè€Œä¸æ˜¯ç»å¯¹åæ ‡</li>
    <li>è¿™ç­‰ä»·äºè¯´æ¶ˆæ¯ä¼ é€’å‡½æ•° $\phi_e$ æ˜¯<strong>å¹³ç§»ç¾¤ $T(\mathbb{R}^3)$-ä¸å˜çš„</strong></li>
    <li>GNS è®ºæ–‡ä¸­ä½¿ç”¨çš„ edge feature å°±æ˜¯ $[\Delta \mathbf{r}_{ij}, \|\Delta \mathbf{r}_{ij}\|]$â€”â€”çº¯ç²¹çš„ç›¸å¯¹é‡ï¼</li>
  </ul>
  <p>å¦‚æœæˆ‘ä»¬æƒ³è¿›ä¸€æ­¥å®ç°æ—‹è½¬ä¸å˜/ç­‰å˜æ€§ï¼Œå°±éœ€è¦ä½¿ç”¨ EGNN æˆ– TFN ç­‰æ›´é«˜çº§çš„æ¶æ„ï¼ˆå‚è§ç¬¬5ç« ï¼‰ã€‚</p>
</div>

<!-- 3.1.5 ä»£ç ç¤ºä¾‹ -->
<h3 id="sec3-1-code">ğŸ ä»£ç ç¤ºä¾‹ï¼šéªŒè¯ç­‰å˜æ€§</h3>

<p>è®©æˆ‘ä»¬ç”¨ PyTorch æ¥<strong>å®é™…éªŒè¯</strong>å·ç§¯å±‚çš„å¹³ç§»ç­‰å˜æ€§å’Œå…¨è¿æ¥å±‚çš„éç­‰å˜æ€§ã€‚</p>

<div class="code-block">
  <div class="code-header">
    <span>Python / PyTorch â€” ç­‰å˜æ€§éªŒè¯</span>
    <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
  </div>
<pre><code><span class="kw">import</span> torch
<span class="kw">import</span> torch.nn <span class="kw">as</span> nn
<span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># =====================================================</span>
<span class="cm"># å®éªŒ1ï¼šéªŒè¯å·ç§¯å±‚çš„å¹³ç§»ç­‰å˜æ€§</span>
<span class="cm"># =====================================================</span>

<span class="kw">def</span> <span class="fn">check_equivariance</span>(layer, x, shift_amount=<span class="num">3</span>):
    <span class="str">"""
    éªŒè¯: layer(shift(x)) == shift(layer(x)) ?
    shift = æ²¿å®½åº¦æ–¹å‘å¾ªç¯å¹³ç§» shift_amount ä¸ªåƒç´ 
    """</span>
    <span class="cm"># 1. å®šä¹‰å¹³ç§»æ“ä½œ Ï(g): å¾ªç¯å³ç§»</span>
    <span class="kw">def</span> <span class="fn">shift</span>(tensor, amount):
        <span class="kw">return</span> torch.roll(tensor, shifts=amount, dims=-<span class="num">1</span>)

    <span class="cm"># 2. è·¯å¾„A: å…ˆå¹³ç§»è¾“å…¥, å†é€šè¿‡ç½‘ç»œå±‚</span>
    shifted_x = shift(x, shift_amount)         <span class="cm"># Ï(g)x</span>
    path_a = layer(shifted_x)                   <span class="cm"># f(Ï(g)x)</span>

    <span class="cm"># 3. è·¯å¾„B: å…ˆé€šè¿‡ç½‘ç»œå±‚, å†å¹³ç§»è¾“å‡º</span>
    output = layer(x)                           <span class="cm"># f(x)</span>
    path_b = shift(output, shift_amount)        <span class="cm"># Ï'(g)f(x)</span>

    <span class="cm"># 4. æ¯”è¾ƒä¸¤æ¡è·¯å¾„: ç­‰å˜ âŸº path_a â‰ˆ path_b</span>
    diff = (path_a - path_b).abs().max().item()
    <span class="kw">return</span> diff

<span class="cm"># åˆ›å»ºéšæœºè¾“å…¥å›¾åƒ: batch=1, channels=3, H=32, W=32</span>
torch.manual_seed(<span class="num">42</span>)
x = torch.randn(<span class="num">1</span>, <span class="num">3</span>, <span class="num">32</span>, <span class="num">32</span>)

<span class="cm"># æµ‹è¯•å·ç§¯å±‚ (åº”è¯¥æ˜¯ç­‰å˜çš„)</span>
conv = nn.Conv2d(<span class="num">3</span>, <span class="num">16</span>, kernel_size=<span class="num">3</span>, padding=<span class="num">1</span>, bias=<span class="kw">False</span>)
diff_conv = check_equivariance(conv, x)
<span class="bi">print</span>(<span class="str">f"å·ç§¯å±‚çš„ç­‰å˜è¯¯å·®: {diff_conv:.2e}"</span>)
<span class="cm"># è¾“å‡º: å·ç§¯å±‚çš„ç­‰å˜è¯¯å·®: 5.96e-08  â† å‡ ä¹ä¸ºé›¶! âœ…</span>

<span class="cm"># æµ‹è¯•å…¨è¿æ¥å±‚ (ä¸æ˜¯ç­‰å˜çš„)</span>
fc = nn.Linear(<span class="num">32</span>, <span class="num">32</span>, bias=<span class="kw">False</span>)
<span class="cm"># å¯¹å®½åº¦ç»´åº¦åº”ç”¨çº¿æ€§å±‚</span>
<span class="kw">def</span> <span class="fn">fc_on_width</span>(tensor):
    <span class="kw">return</span> fc(tensor)  <span class="cm"># ä½œç”¨äºæœ€åä¸€ä¸ªç»´åº¦</span>

diff_fc = check_equivariance(fc_on_width, x)
<span class="bi">print</span>(<span class="str">f"å…¨è¿æ¥å±‚çš„ç­‰å˜è¯¯å·®: {diff_fc:.2e}"</span>)
<span class="cm"># è¾“å‡º: å…¨è¿æ¥å±‚çš„ç­‰å˜è¯¯å·®: 1.23e+00  â† å¾ˆå¤§! âŒ</span>

<span class="cm"># =====================================================</span>
<span class="cm"># å®éªŒ2ï¼šéªŒè¯å…¨å±€å¹³å‡æ± åŒ–çš„ä¸å˜æ€§</span>
<span class="cm"># =====================================================</span>

gap = nn.AdaptiveAvgPool2d(<span class="num">1</span>)  <span class="cm"># Global Average Pooling</span>

<span class="kw">def</span> <span class="fn">check_invariance</span>(layer, x, shift_amount=<span class="num">5</span>):
    <span class="str">"""éªŒè¯: layer(shift(x)) == layer(x) ?"""</span>
    shifted_x = torch.roll(x, shifts=shift_amount, dims=-<span class="num">1</span>)
    out_original = layer(x)
    out_shifted = layer(shifted_x)
    diff = (out_original - out_shifted).abs().max().item()
    <span class="kw">return</span> diff

diff_gap = check_invariance(gap, x)
<span class="bi">print</span>(<span class="str">f"å…¨å±€æ± åŒ–çš„ä¸å˜æ€§è¯¯å·®: {diff_gap:.2e}"</span>)
<span class="cm"># è¾“å‡º: å…¨å±€æ± åŒ–çš„ä¸å˜æ€§è¯¯å·®: 2.98e-08  â† å‡ ä¹ä¸ºé›¶! âœ…</span>

<span class="cm"># =====================================================</span>
<span class="cm"># å®éªŒ3ï¼šéªŒè¯ç½®æ¢ç­‰å˜æ€§ (ç”¨äºé›†åˆ/å›¾)</span>
<span class="cm"># =====================================================</span>

<span class="kw">def</span> <span class="fn">check_permutation_equivariance</span>(layer, x):
    <span class="str">"""
    éªŒè¯: layer(Px) == PÂ·layer(x) ?
    å…¶ä¸­ P æ˜¯éšæœºç½®æ¢çŸ©é˜µ, x çš„ shape = (batch, N, features)
    """</span>
    N = x.shape[<span class="num">1</span>]
    perm = torch.randperm(N)  <span class="cm"># éšæœºç½®æ¢</span>

    <span class="cm"># è·¯å¾„A: å…ˆç½®æ¢èŠ‚ç‚¹, å†è¿‡ç½‘ç»œ</span>
    x_perm = x[:, perm, :]
    path_a = layer(x_perm)

    <span class="cm"># è·¯å¾„B: å…ˆè¿‡ç½‘ç»œ, å†ç½®æ¢èŠ‚ç‚¹</span>
    output = layer(x)
    path_b = output[:, perm, :]

    diff = (path_a - path_b).abs().max().item()
    <span class="kw">return</span> diff

<span class="cm"># DeepSets çš„ âˆ‘ èšåˆæ˜¯ç½®æ¢ä¸å˜çš„</span>
x_set = torch.randn(<span class="num">1</span>, <span class="num">10</span>, <span class="num">8</span>)  <span class="cm"># batch=1, 10ä¸ªå…ƒç´ , 8ç»´ç‰¹å¾</span>

<span class="cm"># å…±äº«æƒé‡çš„ MLP (é€å…ƒç´ ) æ˜¯ç½®æ¢ç­‰å˜çš„</span>
shared_mlp = nn.Linear(<span class="num">8</span>, <span class="num">16</span>)  <span class="cm"># å¯¹æ¯ä¸ªå…ƒç´ ç‹¬ç«‹åº”ç”¨</span>
diff_shared = check_permutation_equivariance(shared_mlp, x_set)
<span class="bi">print</span>(<span class="str">f"å…±äº«MLPçš„ç½®æ¢ç­‰å˜è¯¯å·®: {diff_shared:.2e}"</span>)
<span class="cm"># è¾“å‡º: å…±äº«MLPçš„ç½®æ¢ç­‰å˜è¯¯å·®: 0.00e+00  â† ç²¾ç¡®ç­‰å˜! âœ…</span>

<span class="bi">print</span>(<span class="str">"\nâœ¨ ç»“è®º:"</span>)
<span class="bi">print</span>(<span class="str">"  Conv2d â†’ å¹³ç§»ç­‰å˜ âœ…"</span>)
<span class="bi">print</span>(<span class="str">"  Linear â†’ å¹³ç§»ä¸ç­‰å˜ âŒ"</span>)
<span class="bi">print</span>(<span class="str">"  GAP â†’ å¹³ç§»ä¸å˜ âœ…"</span>)
<span class="bi">print</span>(<span class="str">"  SharedMLP â†’ ç½®æ¢ç­‰å˜ âœ…"</span>)</code></pre>
</div>

<div class="box thm">
  <div class="box-title">ğŸ”‘ ä»£ç æ­ç¤ºçš„æ·±å±‚é“ç†</div>
  <p>å·ç§¯å±‚çš„å¹³ç§»ç­‰å˜æ€§ä¸æ˜¯å·§åˆâ€”â€”å®ƒæ˜¯<strong>æƒé‡å…±äº«</strong>çš„æ•°å­¦å¿…ç„¶ç»“æœã€‚
  å½“å·ç§¯æ ¸åœ¨æ‰€æœ‰ä½ç½®ä½¿ç”¨ç›¸åŒçš„æƒé‡æ—¶ï¼Œè¾“å‡ºè‡ªç„¶åœ°"è·Ÿéš"è¾“å…¥çš„å¹³ç§»ã€‚
  è€Œå…¨è¿æ¥å±‚çš„æ¯ä¸ªè¾“å‡ºç¥ç»å…ƒè¿æ¥ä¸åŒä½ç½®çš„æƒé‡ä¸åŒï¼Œæ‰€ä»¥ä¸å…·å¤‡è¿™ç§æ€§è´¨ã€‚</p>
  <p>è¿™æ­£æ˜¯ç¬¬ 3.5 èŠ‚è“å›¾çš„æ ¸å¿ƒæ´å¯Ÿï¼š<strong>é€‰æ‹©æ­£ç¡®çš„ç­‰å˜æ˜ å°„ = åˆ©ç”¨å¯¹ç§°æ€§å…ˆéªŒ = å‡å°å‡è®¾ç©ºé—´ = æ›´å¥½çš„æ³›åŒ–</strong>ã€‚</p>
</div>

<!-- Exercises 3.1 -->
<div class="exercises" id="sec3-1-exercises">
  <h4>â“ 3.1 èŠ‚ç»ƒä¹ é¢˜</h4>
  <ol>
    <li><strong>ç¾¤å…¬ç†éªŒè¯</strong>ï¼šè¯æ˜æ•´æ•°é›†åˆ $(\mathbb{Z}, +)$ æ„æˆä¸€ä¸ªç¾¤ã€‚å®ƒæ˜¯é˜¿è´å°”ç¾¤å—ï¼Ÿ$(\mathbb{Z}, \times)$ å‘¢ï¼Ÿ</li>
    <li><strong>è¡¨ç¤ºçš„ç»´åº¦</strong>ï¼š$\mathrm{SO}(2)$ ç¾¤å¯ä»¥æœ‰ $1 \times 1$ çš„è¡¨ç¤ºå—ï¼Ÿï¼ˆæç¤ºï¼šè€ƒè™‘å¤æ•° $e^{i\theta}$ï¼‰</li>
    <li><strong>ç¼–ç¨‹ç»ƒä¹ </strong>ï¼šä¿®æ”¹ä¸Šé¢çš„ä»£ç ï¼ŒéªŒè¯ $\mathrm{SO}(2)$ æ—‹è½¬ç¾¤ä½œç”¨ä¸‹ï¼Œæåæ ‡è¡¨ç¤ºçš„è§’åº¦æ˜¯ç­‰å˜é‡ï¼ŒåŠå¾„æ˜¯ä¸å˜é‡ã€‚</li>
    <li><strong>æ€è€ƒé¢˜</strong>ï¼šä¸ºä»€ä¹ˆ CNN åœ¨å›¾åƒåˆ†ç±»ä¸­æ¯” MLP è¡¨ç°å¥½å¾—å¤šï¼Ÿç”¨æœ¬èŠ‚çš„è¯­è¨€ç»™å‡ºæ•°å­¦è§£é‡Šã€‚</li>
    <li><strong>è¿›é˜¶</strong>ï¼šå¦‚æœ $\rho_1$ å’Œ $\rho_2$ éƒ½æ˜¯ç¾¤ $\mathfrak{G}$ çš„è¡¨ç¤ºï¼Œè¯æ˜ç›´å’Œ $\rho_1 \oplus \rho_2$ ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨ç¤ºã€‚</li>
  </ol>
</div>


<!-- ======================================== -->
<!-- SECTION 3.2: ISOMORPHISMS & AUTOMORPHISMS -->
<!-- ======================================== -->
<h2 id="sec3-2">3.2 åŒæ„å’Œè‡ªåŒæ„<br><span style="font-size:0.55em; color:var(--text-secondary)">Isomorphisms and Automorphisms</span></h2>

<p>åœ¨ 3.1 èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä»æŠ½è±¡çš„è§’åº¦å®šä¹‰äº†ç¾¤å’Œå¯¹ç§°æ€§ã€‚ç°åœ¨æˆ‘ä»¬è¦é—®ä¸€ä¸ªæ›´ç»†è‡´çš„é—®é¢˜ï¼š
<strong>æˆ‘ä»¬åˆ°åº•è¦ä¿æŒä»€ä¹ˆç»“æ„ä¸å˜ï¼Ÿ</strong> ç­”æ¡ˆå–å†³äºæˆ‘ä»¬è€ƒè™‘çš„"ç»“æ„å±‚æ¬¡"ã€‚</p>

<h3 id="sec3-2-levels">ç»“æ„å±‚æ¬¡ä¸å­ç¾¤ (Levels of Structure)</h3>

<p>åŸŸ $\Omega$ å¯ä»¥æ‹¥æœ‰ä¸åŒå±‚æ¬¡çš„ç»“æ„ï¼Œè€Œæ¯ä¸ªå±‚æ¬¡å¯¹åº”ä¸åŒçš„å¯¹ç§°ç¾¤ã€‚
å½“æˆ‘ä»¬æ·»åŠ æ›´å¤šè¦ä¿æŒçš„ç»“æ„æ—¶ï¼Œå¯¹ç§°ç¾¤ä¼š<strong>ç¼©å°</strong>ï¼š</p>

<table>
  <thead>
    <tr><th>ç»“æ„å±‚æ¬¡</th><th>ä¿ç»“æ„æ˜ å°„</th><th>å¯¹ç§°ç¾¤</th><th>ä¿æŒçš„æ€§è´¨</th></tr>
  </thead>
  <tbody>
    <tr>
      <td>é›†åˆ (Set)</td>
      <td>åŒå°„ (Bijection)</td>
      <td>$\mathrm{Aut}(\Omega)$ï¼ˆå…¨éƒ¨å¯é€†æ˜ å°„ï¼‰</td>
      <td>åŸºæ•°ï¼ˆå…ƒç´ ä¸ªæ•°ï¼‰</td>
    </tr>
    <tr>
      <td>æ‹“æ‰‘ç©ºé—´</td>
      <td>åŒèƒš (Homeomorphism)</td>
      <td>$\mathrm{Homeo}(\Omega)$</td>
      <td>è¿ç»­æ€§ã€é‚»åŸŸ</td>
    </tr>
    <tr>
      <td>å…‰æ»‘æµå½¢</td>
      <td>å¾®åˆ†åŒèƒš (Diffeomorphism)</td>
      <td>$\mathrm{Diff}(\Omega)$</td>
      <td>å¯å¾®æ€§</td>
    </tr>
    <tr>
      <td>åº¦é‡ç©ºé—´</td>
      <td>ç­‰è·æ˜ å°„ (Isometry)</td>
      <td>$\mathrm{Iso}(\Omega)$</td>
      <td>è·ç¦»</td>
    </tr>
  </tbody>
</table>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.8ï¼šåº¦é‡ (Metric / Distance)</div>
  <p>ä¸€ä¸ª<strong>åº¦é‡</strong>æ˜¯å‡½æ•° $d : \Omega \times \Omega \to [0, \infty)$ï¼Œæ»¡è¶³å¯¹æ‰€æœ‰ $u, v, w \in \Omega$ï¼š</p>
  <ol>
    <li><strong>ä¸å¯åŒºåˆ†åŒä¸€æ€§ (Identity of indiscernibles)</strong>: $d(u,v) = 0 \iff u = v$</li>
    <li><strong>å¯¹ç§°æ€§ (Symmetry)</strong>: $d(u,v) = d(v,u)$</li>
    <li><strong>ä¸‰è§’ä¸ç­‰å¼ (Triangle inequality)</strong>: $d(u,v) \leq d(u,w) + d(w,v)$</li>
  </ol>
</div>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.9ï¼šå­ç¾¤ (Subgroup)</div>
  <p>è®¾ $(\mathfrak{G}, \circ)$ æ˜¯ä¸€ä¸ªç¾¤ï¼Œ$\mathfrak{H} \subseteq \mathfrak{G}$ æ˜¯ä¸€ä¸ªå­é›†ã€‚
  å¦‚æœ $(\mathfrak{H}, \circ)$ åœ¨åŒä¸€è¿ç®—ä¸‹ä¹Ÿæ„æˆä¸€ä¸ªç¾¤ï¼Œåˆ™ç§° $\mathfrak{H}$ æ˜¯ $\mathfrak{G}$ çš„<strong>å­ç¾¤</strong>ã€‚</p>
</div>

<div class="box thm">
  <div class="box-title">ğŸ“— ç»“æ„å±‚æ¬¡çš„å­ç¾¤å…³ç³»</div>
  <p>æ·»åŠ æ›´å¤šç»“æ„ = é€‰æ‹©ä¸€ä¸ªæ›´å°çš„å­ç¾¤ï¼š</p>
  $$\mathrm{Iso}(\Omega) \;\subseteq\; \mathrm{Diff}(\Omega) \;\subseteq\; \mathrm{Homeo}(\Omega) \;\subseteq\; \mathrm{Aut}(\Omega)$$
  <p>ä¾‹å¦‚ï¼Œå¹³é¢ä¸Šï¼š$\mathrm{SE}(2) \subset \mathrm{E}(2) \subset \mathrm{Diff}(\mathbb{R}^2)$</p>
  <p>è¿™æ­£æ˜¯ Klein çš„<strong>çˆ±å°”å…°æ ¹çº²é¢†</strong>ï¼šå°„å½±å‡ ä½•ã€ä»¿å°„å‡ ä½•ã€æ¬§æ°å‡ ä½•æ‹¥æœ‰è¶Šæ¥è¶Šå¤šçš„ä¸å˜é‡ï¼Œå¯¹åº”è¶Šæ¥è¶Šå°çš„ç¾¤ã€‚</p>
</div>

<h3 id="sec3-2-iso">åŒæ„ vs è‡ªåŒæ„ (Isomorphism vs Automorphism)</h3>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.10ï¼šåŒæ„ä¸è‡ªåŒæ„</div>
  <p><strong>è‡ªåŒæ„ (Automorphism)</strong>ï¼šä»å¯¹è±¡åˆ°<strong>è‡ªèº«</strong>çš„ä¿ç»“æ„åŒå°„ã€‚æè¿°å¯¹è±¡çš„<strong>è‡ªå¯¹ç§°æ€§</strong>ã€‚</p>
  <p><strong>åŒæ„ (Isomorphism)</strong>ï¼šä»ä¸€ä¸ªå¯¹è±¡åˆ°<strong>å¦ä¸€ä¸ª</strong>å¯¹è±¡çš„ä¿ç»“æ„åŒå°„ã€‚æè¿°ä¸¤ä¸ªå¯¹è±¡çš„<strong>ç­‰ä»·æ€§</strong>ã€‚</p>
</div>

<div class="box example">
  <div class="box-title">ğŸ’¡ é›†åˆå±‚é¢çš„ä¾‹å­</div>
  <p>è®¾ $\Omega = \{0, 1, 2\}$ã€‚</p>
  <ul>
    <li><strong>è‡ªåŒæ„</strong>ï¼šå¾ªç¯ä½ç§» $\tau(u) = (u+1) \bmod 3$ï¼Œå°† $\Omega$ æ˜ å›è‡ªèº«</li>
    <li><strong>åŒæ„</strong>ï¼šè®¾ $\Omega' = \{a, b, c\}$ï¼Œåˆ™ $\eta(0)=a, \eta(1)=b, \eta(2)=c$ æ˜¯ä¸€ä¸ªé›†åˆåŒæ„</li>
  </ul>
</div>

<h3 id="sec3-2-graph">å›¾åŒæ„ä¸å›¾è‡ªåŒæ„ (Graph Isomorphism & Automorphism)</h3>

<p>å¯¹äºå›¾ç»“æ„çš„æ•°æ®ï¼Œ"ç»“æ„"ä¸ä»…åŒ…æ‹¬èŠ‚ç‚¹æ•°é‡ï¼Œè¿˜åŒ…æ‹¬<strong>è¿æ¥æ–¹å¼ï¼ˆè¾¹ï¼‰</strong>ã€‚</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.11ï¼šå›¾åŒæ„ (Graph Isomorphism)</div>
  <p>ä¸¤ä¸ªå›¾ $G = (V, E)$ å’Œ $G' = (V', E')$ ä¹‹é—´çš„<strong>åŒæ„</strong>æ˜¯ä¸€ä¸ªåŒå°„ $\eta : V \to V'$ï¼Œæ»¡è¶³ï¼š</p>
  $$(u, v) \in E \iff (\eta(u), \eta(v)) \in E'$$
  <p>æ¢è¨€ä¹‹ï¼ŒåŒæ„ä¿æŒ<strong>é‚»æ¥å…³ç³»</strong>ã€‚ä¸¤ä¸ªåŒæ„çš„å›¾ç»“æ„å®Œå…¨ç›¸åŒï¼Œåªæ˜¯èŠ‚ç‚¹çš„"ç¼–å·"ä¸åŒã€‚</p>
</div>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.12ï¼šå›¾è‡ªåŒæ„ (Graph Automorphism)</div>
  <p>å›¾ $G$ çš„<strong>è‡ªåŒæ„</strong>æ˜¯ä» $G$ åˆ°è‡ªèº«çš„åŒæ„ $\tau : V \to V$ã€‚
  å¦‚æœå­˜åœ¨éå¹³å‡¡çš„è‡ªåŒæ„ï¼ˆ$\tau \neq \mathrm{id}$ï¼‰ï¼Œåˆ™å›¾å…·æœ‰<strong>å¯¹ç§°æ€§</strong>ã€‚
  æ‰€æœ‰è‡ªåŒæ„æ„æˆ<strong>è‡ªåŒæ„ç¾¤</strong> $\mathrm{Aut}(G)$ã€‚</p>
</div>

<div class="figure">
  <img src="../assets/ch3_p18_img1.png" alt="å›¾åŒæ„ç¤ºä¾‹">
  <div class="caption"><strong>å›¾ 3.4</strong>ï¼šä¸¤ä¸ªçœ‹èµ·æ¥ä¸åŒä½†å®é™…ä¸ŠåŒæ„çš„å›¾ã€‚èŠ‚ç‚¹çš„æ’åˆ—æ–¹å¼ä¸åŒï¼Œä½†è¿æ¥ç»“æ„å®Œå…¨ç›¸åŒã€‚
  å›¾åŒæ„é—®é¢˜ï¼ˆåˆ¤æ–­ä¸¤ä¸ªå›¾æ˜¯å¦åŒæ„ï¼‰æ˜¯å›¾è®ºä¸­çš„ç»å…¸éš¾é¢˜ã€‚</div>
</div>

<div class="box example">
  <div class="box-title">ğŸ’¡ å›¾åŒæ„çš„ç›´è§‰</div>
  <p>æƒ³è±¡ä¸¤å¼ åœ°é“è·¯çº¿å›¾ï¼šä¸€å¼ æ˜¯å®˜æ–¹è®¾è®¡çš„"ç¾åŒ–ç‰ˆ"ï¼Œå¦ä¸€å¼ æ˜¯æŒ‰åœ°ç†ä½ç½®ç»˜åˆ¶çš„ã€‚
  è™½ç„¶çœ‹èµ·æ¥å®Œå…¨ä¸åŒï¼Œä½†å¦‚æœç«™ç‚¹ä¹‹é—´çš„è¿æ¥å…³ç³»å®Œå…¨ä¸€æ ·ï¼Œå®ƒä»¬å°±æ˜¯<strong>åŒæ„çš„</strong>ã€‚</p>
  <p><strong>å›¾åŒæ„é—®é¢˜ (GI)</strong>æ˜¯è®¡ç®—å¤æ‚æ€§ç†è®ºä¸­çš„è‘—åé—®é¢˜ï¼šå®ƒ"å¯èƒ½"ä¸æ˜¯ NP-å®Œå…¨çš„ï¼Œä½†ä¹Ÿæ²¡æœ‰å·²çŸ¥çš„å¤šé¡¹å¼æ—¶é—´ç®—æ³•ï¼ˆé™¤äº†ç‰¹æ®Šå›¾ç±»ï¼‰ã€‚</p>
</div>

<h3 id="sec3-2-wl">Weisfeiler-Leman (WL) æµ‹è¯•</h3>

<p>Weisfeiler-Leman æµ‹è¯•æ˜¯åˆ¤æ–­ä¸¤ä¸ªå›¾æ˜¯å¦åŒæ„çš„ç»å…¸ç®—æ³•ã€‚è™½ç„¶å®ƒä¸èƒ½è§£å†³æ‰€æœ‰æƒ…å†µï¼ˆå­˜åœ¨åä¾‹ï¼‰ï¼Œ
ä½†å®ƒä¸<strong>å›¾ç¥ç»ç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›</strong>æœ‰ç€æ·±åˆ»çš„è”ç³»â€”â€”è¿™æ˜¯è¿‘å¹´æ¥ GNN ç†è®ºçš„é‡å¤§å‘ç°ã€‚</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ 1-WL (Weisfeiler-Leman) é¢œè‰²ç²¾åŒ–ç®—æ³•</div>
  <p>ç»™å®šå›¾ $G = (V, E)$ï¼š</p>
  <ol>
    <li><strong>åˆå§‹åŒ–</strong>ï¼šç»™æ¯ä¸ªèŠ‚ç‚¹åˆ†é…ä¸€ä¸ªåˆå§‹"é¢œè‰²"ï¼ˆæ ‡ç­¾ï¼‰ï¼Œé€šå¸¸æ‰€æœ‰èŠ‚ç‚¹åˆå§‹é¢œè‰²ç›¸åŒ</li>
    <li><strong>ç²¾åŒ–</strong>ï¼šå¯¹æ¯ä¸ªèŠ‚ç‚¹ $v$ï¼Œå°†å…¶æ–°é¢œè‰²å®šä¹‰ä¸ºï¼š
      $$c^{(t+1)}(v) = \mathrm{HASH}\!\left(c^{(t)}(v),\; \{\!\{c^{(t)}(u) : u \in \mathcal{N}(v)\}\!\}\right)$$
    </li>
    <li><strong>ç»ˆæ­¢</strong>ï¼šå½“é¢œè‰²ä¸å†å˜åŒ–æ—¶åœæ­¢</li>
    <li><strong>åˆ¤æ–­</strong>ï¼šå¦‚æœä¸¤ä¸ªå›¾æœ€ç»ˆçš„é¢œè‰²åˆ†å¸ƒä¸åŒï¼Œåˆ™å®ƒä»¬<strong>ä¸åŒæ„</strong>ã€‚å¦‚æœç›¸åŒï¼Œ<strong>å¯èƒ½åŒæ„</strong>ï¼ˆä¸ç¡®å®šï¼‰</li>
  </ol>
  <div class="symbol-table" style="margin-top: 12px;">
    <span class="sym">$c^{(t)}(v)$</span><span class="desc">ç¬¬ $t$ è½®è¿­ä»£æ—¶èŠ‚ç‚¹ $v$ çš„é¢œè‰²ï¼ˆæ ‡ç­¾ï¼‰</span>
    <span class="sym">$\mathcal{N}(v)$</span><span class="desc">èŠ‚ç‚¹ $v$ çš„é‚»å±…é›†åˆ</span>
    <span class="sym">$\{\!\{\cdot\}\!\}$</span><span class="desc">å¤šé‡é›† (multiset)â€”â€”å…è®¸é‡å¤å…ƒç´ çš„é›†åˆ</span>
    <span class="sym">$\mathrm{HASH}$</span><span class="desc">å°† (é¢œè‰², é‚»å±…é¢œè‰²å¤šé‡é›†) æ˜ å°„ä¸ºæ–°é¢œè‰²çš„å•å°„å‡½æ•°</span>
  </div>
</div>

<div class="box thm">
  <div class="box-title">ğŸ“— WL æµ‹è¯•ä¸ GNN çš„ç­‰ä»·æ€§ [Xu et al., 2019; Morris et al., 2019]</div>
  <p><strong>æ¶ˆæ¯ä¼ é€’ç¥ç»ç½‘ç»œ (MPNN)</strong> çš„è¡¨è¾¾èƒ½åŠ›<strong>è‡³å¤šç­‰äº</strong> 1-WL æµ‹è¯•ï¼š</p>
  <ul>
    <li>å¦‚æœ 1-WL åˆ¤æ–­ä¸¤ä¸ªå›¾ä¸åŒæ„ï¼Œåˆ™å­˜åœ¨æŸä¸ª MPNN å¯ä»¥åŒºåˆ†å®ƒä»¬</li>
    <li>å¦‚æœ 1-WL <strong>æ— æ³•</strong>åŒºåˆ†ä¸¤ä¸ªå›¾ï¼Œåˆ™<strong>æ²¡æœ‰</strong> MPNN èƒ½åŒºåˆ†å®ƒä»¬</li>
    <li><strong>GIN (Graph Isomorphism Network)</strong> è¾¾åˆ°äº†è¿™ä¸ªç†è®ºä¸Šç•Œ</li>
  </ul>
  <p>è¿™ä¸ªç»“æœæ·±åˆ»åœ°æ­ç¤ºäº†æ ‡å‡† GNN çš„å±€é™æ€§â€”â€”å®ƒä»¬æ— æ³•åŒºåˆ†æŸäº›éåŒæ„å›¾ï¼ˆå¦‚æ­£åˆ™å›¾ï¼‰ã€‚</p>
</div>

<div class="box warn">
  <div class="box-title">âš ï¸ WL æµ‹è¯•çš„å±€é™</div>
  <p>1-WL æ— æ³•åŒºåˆ†æ‰€æœ‰éåŒæ„å›¾ã€‚ç»å…¸åä¾‹ï¼š<strong>æŸäº›æ­£åˆ™å›¾</strong>ï¼ˆæ‰€æœ‰èŠ‚ç‚¹åº¦æ•°ç›¸åŒçš„å›¾ï¼‰ã€‚
  æ›´é«˜é˜¶çš„ $k$-WL æµ‹è¯•æ›´å¼ºå¤§ä½†è®¡ç®—ä»£ä»·æ›´é«˜ã€‚è¿™æ¨åŠ¨äº† <strong>é«˜é˜¶ GNN</strong>ï¼ˆå¦‚ $k$-GNNï¼‰çš„ç ”ç©¶ã€‚</p>
</div>

<!-- 3.2 Code: WL Test -->
<h3 id="sec3-2-code">ğŸ ä»£ç ç¤ºä¾‹ï¼šWL é¢œè‰²ç²¾åŒ–æµ‹è¯•</h3>

<div class="code-block">
  <div class="code-header">
    <span>Python â€” Weisfeiler-Leman 1-WL æµ‹è¯•å®ç°</span>
    <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
  </div>
<pre><code><span class="kw">from</span> collections <span class="kw">import</span> Counter, defaultdict

<span class="kw">class</span> <span class="cls">WeisfeilerLeman</span>:
    <span class="str">"""
    1-WL (Weisfeiler-Leman) é¢œè‰²ç²¾åŒ–ç®—æ³•
    ç”¨äºå›¾åŒæ„æµ‹è¯•: å¦‚æœ WL è¯´"ä¸åŒæ„", åˆ™ç¡®å®ä¸åŒæ„
                    å¦‚æœ WL è¯´"å¯èƒ½åŒæ„", åˆ™ä¸ç¡®å®š
    """</span>

    <span class="kw">def</span> <span class="fn">__init__</span>(<span class="sf">self</span>):
        <span class="sf">self</span>.color_map = {}     <span class="cm"># (æ—§é¢œè‰², é‚»å±…å¤šé‡é›†) -> æ–°é¢œè‰²</span>
        <span class="sf">self</span>.next_color = <span class="num">0</span>

    <span class="kw">def</span> <span class="fn">_get_color</span>(<span class="sf">self</span>, key):
        <span class="str">"""å°† (å½“å‰é¢œè‰², æ’åºé‚»å±…é¢œè‰²å…ƒç»„) æ˜ å°„ä¸ºå”¯ä¸€æ•´æ•°é¢œè‰²"""</span>
        <span class="kw">if</span> key <span class="kw">not in</span> <span class="sf">self</span>.color_map:
            <span class="sf">self</span>.color_map[key] = <span class="sf">self</span>.next_color
            <span class="sf">self</span>.next_color += <span class="num">1</span>
        <span class="kw">return</span> <span class="sf">self</span>.color_map[key]

    <span class="kw">def</span> <span class="fn">run</span>(<span class="sf">self</span>, adj_list, max_iter=<span class="num">10</span>, initial_colors=<span class="kw">None</span>):
        <span class="str">"""
        è¿è¡Œ 1-WL é¢œè‰²ç²¾åŒ–

        Parameters
        ----------
        adj_list : dict
            é‚»æ¥è¡¨ {node: [neighbors]}
        max_iter : int
            æœ€å¤§è¿­ä»£æ¬¡æ•°
        initial_colors : dict or None
            åˆå§‹èŠ‚ç‚¹é¢œè‰², None åˆ™æ‰€æœ‰èŠ‚ç‚¹åŒè‰²

        Returns
        -------
        color_histogram : Counter
            æœ€ç»ˆé¢œè‰²çš„ç›´æ–¹å›¾ (ä½œä¸ºå›¾çš„"æŒ‡çº¹")
        history : list of dict
            æ¯è½®è¿­ä»£çš„é¢œè‰²åˆ†é…å†å²
        """</span>
        nodes = <span class="bi">list</span>(adj_list.keys())

        <span class="cm"># Step 1: åˆå§‹åŒ–é¢œè‰²</span>
        <span class="kw">if</span> initial_colors <span class="kw">is</span> <span class="kw">None</span>:
            colors = {v: <span class="num">0</span> <span class="kw">for</span> v <span class="kw">in</span> nodes}
        <span class="kw">else</span>:
            colors = dict(initial_colors)

        history = [dict(colors)]

        <span class="cm"># Step 2: è¿­ä»£ç²¾åŒ–</span>
        <span class="kw">for</span> iteration <span class="kw">in</span> <span class="bi">range</span>(max_iter):
            new_colors = {}
            <span class="kw">for</span> v <span class="kw">in</span> nodes:
                <span class="cm"># æ”¶é›†é‚»å±…é¢œè‰²çš„å¤šé‡é›† (æ’åºåå˜ä¸ºå…ƒç»„ï¼Œç”¨ä½œ hash key)</span>
                neighbor_colors = <span class="bi">tuple</span>(<span class="bi">sorted</span>(
                    colors[u] <span class="kw">for</span> u <span class="kw">in</span> adj_list[v]
                ))
                <span class="cm"># å°† (è‡ªèº«é¢œè‰², é‚»å±…é¢œè‰²å¤šé‡é›†) æ˜ å°„ä¸ºæ–°é¢œè‰²</span>
                key = (colors[v], neighbor_colors)
                new_colors[v] = <span class="sf">self</span>._get_color(key)

            <span class="cm"># æ£€æŸ¥æ˜¯å¦æ”¶æ•› (é¢œè‰²ä¸å†å˜åŒ–)</span>
            <span class="kw">if</span> <span class="bi">set</span>(new_colors.values()) == <span class="bi">set</span>(colors.values()):
                old_partition = defaultdict(<span class="bi">set</span>)
                new_partition = defaultdict(<span class="bi">set</span>)
                <span class="kw">for</span> v <span class="kw">in</span> nodes:
                    old_partition[colors[v]].add(v)
                    new_partition[new_colors[v]].add(v)
                <span class="kw">if</span> <span class="bi">len</span>(old_partition) == <span class="bi">len</span>(new_partition):
                    <span class="bi">print</span>(<span class="str">f"  æ”¶æ•›äºç¬¬ {iteration} è½®"</span>)
                    <span class="kw">break</span>

            colors = new_colors
            history.append(dict(colors))

        <span class="kw">return</span> Counter(colors.values()), history

    <span class="kw">def</span> <span class="fn">are_possibly_isomorphic</span>(<span class="sf">self</span>, adj1, adj2,
                                 init1=<span class="kw">None</span>, init2=<span class="kw">None</span>):
        <span class="str">"""æ¯”è¾ƒä¸¤ä¸ªå›¾çš„ WL æŒ‡çº¹"""</span>
        <span class="sf">self</span>.color_map = {}
        <span class="sf">self</span>.next_color = <span class="num">0</span>
        hist1, _ = <span class="sf">self</span>.run(adj1, initial_colors=init1)
        hist2, _ = <span class="sf">self</span>.run(adj2, initial_colors=init2)
        <span class="kw">return</span> hist1 == hist2

<span class="cm"># =====================================================</span>
<span class="cm"># ç¤ºä¾‹ 1: ä¸¤ä¸ªåŒæ„çš„å›¾</span>
<span class="cm"># =====================================================</span>

<span class="cm">#  å›¾ G1:  0 - 1 - 2     (è·¯å¾„å›¾ P3)</span>
<span class="cm">#  å›¾ G2:  a - b - c     (åŒæ„äº G1)</span>

G1 = {<span class="num">0</span>: [<span class="num">1</span>], <span class="num">1</span>: [<span class="num">0</span>, <span class="num">2</span>], <span class="num">2</span>: [<span class="num">1</span>]}
G2 = {<span class="str">'a'</span>: [<span class="str">'b'</span>], <span class="str">'b'</span>: [<span class="str">'a'</span>, <span class="str">'c'</span>], <span class="str">'c'</span>: [<span class="str">'b'</span>]}

wl = WeisfeilerLeman()
result = wl.are_possibly_isomorphic(G1, G2)
<span class="bi">print</span>(<span class="str">f"G1 â‰… G2 ? {result}"</span>)  <span class="cm"># True âœ…</span>

<span class="cm"># =====================================================</span>
<span class="cm"># ç¤ºä¾‹ 2: ä¸¤ä¸ªä¸åŒæ„çš„å›¾</span>
<span class="cm"># =====================================================</span>

<span class="cm"># G3: ä¸‰è§’å½¢ (ç¯)    G4: è·¯å¾„ P3</span>
G3 = {<span class="num">0</span>: [<span class="num">1</span>, <span class="num">2</span>], <span class="num">1</span>: [<span class="num">0</span>, <span class="num">2</span>], <span class="num">2</span>: [<span class="num">0</span>, <span class="num">1</span>]}
G4 = {<span class="num">0</span>: [<span class="num">1</span>], <span class="num">1</span>: [<span class="num">0</span>, <span class="num">2</span>], <span class="num">2</span>: [<span class="num">1</span>]}

wl2 = WeisfeilerLeman()
result2 = wl2.are_possibly_isomorphic(G3, G4)
<span class="bi">print</span>(<span class="str">f"ä¸‰è§’å½¢ â‰… è·¯å¾„P3 ? {result2}"</span>)  <span class="cm"># False âœ…</span>

<span class="cm"># =====================================================</span>
<span class="cm"># ç¤ºä¾‹ 3: WL å¤±è´¥çš„ç»å…¸åä¾‹ (ä¸¤ä¸ªéåŒæ„çš„ 3-æ­£åˆ™å›¾)</span>
<span class="cm"># =====================================================</span>

<span class="cm"># Shrikhande graph vs 4x4 Rook's graph (å‡ä¸ºå¼ºæ­£åˆ™å›¾)</span>
<span class="cm"># ç®€åŒ–ç¤ºä¾‹: ä¸¤ä¸ª 6 èŠ‚ç‚¹çš„éåŒæ„å›¾, 1-WL æ— æ³•åŒºåˆ†</span>
<span class="cm"># å…­ç¯ C6  vs  ä¸¤ä¸ªä¸‰è§’å½¢ K3 + K3</span>

C6 = {<span class="num">0</span>: [<span class="num">1</span>,<span class="num">5</span>], <span class="num">1</span>: [<span class="num">0</span>,<span class="num">2</span>], <span class="num">2</span>: [<span class="num">1</span>,<span class="num">3</span>],
      <span class="num">3</span>: [<span class="num">2</span>,<span class="num">4</span>], <span class="num">4</span>: [<span class="num">3</span>,<span class="num">5</span>], <span class="num">5</span>: [<span class="num">4</span>,<span class="num">0</span>]}

K3_K3 = {<span class="num">0</span>: [<span class="num">1</span>,<span class="num">2</span>], <span class="num">1</span>: [<span class="num">0</span>,<span class="num">2</span>], <span class="num">2</span>: [<span class="num">0</span>,<span class="num">1</span>],
         <span class="num">3</span>: [<span class="num">4</span>,<span class="num">5</span>], <span class="num">4</span>: [<span class="num">3</span>,<span class="num">5</span>], <span class="num">5</span>: [<span class="num">3</span>,<span class="num">4</span>]}

wl3 = WeisfeilerLeman()
result3 = wl3.are_possibly_isomorphic(C6, K3_K3)
<span class="bi">print</span>(<span class="str">f"C6 â‰… K3+K3 ? WL says: {result3}"</span>)
<span class="cm"># True â€” ä½†å®ƒä»¬ä¸åŒæ„! (C6 è¿é€š, K3+K3 ä¸è¿é€š)</span>
<span class="cm"># è¿™è¯´æ˜ 1-WL å¹¶éä¸‡èƒ½çš„ âš ï¸</span>

<span class="bi">print</span>(<span class="str">"\nğŸ’¡ æ³¨æ„: 1-WL æ— æ³•åŒºåˆ†æ‰€æœ‰æ­£åˆ™å›¾!"</span>)
<span class="bi">print</span>(<span class="str">"   è¿™ä¹Ÿæ˜¯æ ‡å‡† MPNN/GCN çš„ç†è®ºä¸Šç•Œ"</span>)</code></pre>
</div>

<div class="box robot">
  <div class="box-title">ğŸ¤– ä¸ PhysRobot çš„å…³è”</div>
  <p>åœ¨ PhysRobot ä¸­ï¼Œæˆ‘ä»¬çš„ç²’å­å›¾é€šå¸¸<strong>æ²¡æœ‰å›ºæœ‰çš„èŠ‚ç‚¹é¡ºåº</strong>â€”â€”ç²’å­å¯ä»¥éšæ„ç¼–å·ã€‚
  è¿™æ„å‘³ç€æˆ‘ä»¬çš„ GNN å¿…é¡»æ˜¯<strong>ç½®æ¢ç­‰å˜çš„</strong>ã€‚</p>
  <p>WL æµ‹è¯•å‘Šè¯‰æˆ‘ä»¬ï¼Œæ ‡å‡†æ¶ˆæ¯ä¼ é€’ GNN çš„è¡¨è¾¾èƒ½åŠ›æ˜¯æœ‰é™çš„ã€‚
  å¯¹äºç‰©ç†æ¨¡æ‹Ÿæ¥è¯´ï¼Œè¿™é€šå¸¸ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºç²’å­éƒ½å¸¦æœ‰ä¸°å¯Œçš„<strong>è¿ç»­ç‰¹å¾</strong>ï¼ˆä½ç½®ã€é€Ÿåº¦ç­‰ï¼‰ï¼Œ
  è€Œ WL çš„å±€é™ä¸»è¦å‡ºç°åœ¨<strong>çº¯ç»“æ„ï¼ˆæ— ç‰¹å¾ï¼‰</strong>çš„å›¾ä¸Šã€‚</p>
</div>

<div class="exercises" id="sec3-2-exercises">
  <h4>â“ 3.2 èŠ‚ç»ƒä¹ é¢˜</h4>
  <ol>
    <li><strong>æ‰‹ç®— WL</strong>ï¼šå¯¹è·¯å¾„å›¾ $P_4$ï¼ˆ4ä¸ªèŠ‚ç‚¹çš„è·¯å¾„ï¼‰æ‰‹åŠ¨æ‰§è¡Œ WL ç²¾åŒ–ï¼Œç”»å‡ºæ¯ä¸€è½®çš„é¢œè‰²åˆ†é…ã€‚</li>
    <li><strong>è‡ªåŒæ„ç¾¤</strong>ï¼šå®Œå…¨å›¾ $K_n$ çš„è‡ªåŒæ„ç¾¤æ˜¯ä»€ä¹ˆï¼Ÿå¤§å°æ˜¯å¤šå°‘ï¼Ÿ</li>
    <li><strong>ç¼–ç¨‹ç»ƒä¹ </strong>ï¼šä¿®æ”¹ä¸Šé¢çš„ WL ä»£ç ï¼Œä½¿å…¶æ”¯æŒ<strong>èŠ‚ç‚¹ç‰¹å¾</strong>ï¼ˆç”¨åˆå§‹é¢œè‰²åŒºåˆ†ä¸åŒç±»å‹çš„èŠ‚ç‚¹ï¼‰ï¼Œ
    å¹¶éªŒè¯åŠ å…¥ç‰¹å¾åæ˜¯å¦èƒ½åŒºåˆ†ä¹‹å‰çš„åä¾‹ã€‚</li>
    <li><strong>æ€è€ƒé¢˜</strong>ï¼šä¸ºä»€ä¹ˆè¯´"GNN çš„è¡¨è¾¾èƒ½åŠ› â‰¤ 1-WL"ï¼Ÿç»™å‡ºç›´è§‰è§£é‡Šã€‚</li>
    <li><strong>è¿›é˜¶</strong>ï¼šæŸ¥é˜… 2-WL å’Œ 3-WL çš„å®šä¹‰ï¼Œæè¿°å®ƒä»¬ä¸ 1-WL çš„åŒºåˆ«ã€‚</li>
  </ol>
</div>


<!-- ======================================== -->
<!-- SECTION 3.3: DEFORMATION STABILITY -->
<!-- ======================================== -->
<h2 id="sec3-3">3.3 å½¢å˜ç¨³å®šæ€§<br><span style="font-size:0.55em; color:var(--text-secondary)">Deformation Stability</span></h2>

<p>3.1â€“3.2 èŠ‚å»ºç«‹äº†ä¸€ä¸ª<strong>ç†æƒ³åŒ–çš„</strong>å¯¹ç§°æ€§æ¡†æ¶ï¼šæˆ‘ä»¬ç²¾ç¡®åœ°çŸ¥é“å“ªäº›å˜æ¢æ˜¯å¯¹ç§°æ€§ï¼Œå¹¶è¦æ±‚ç²¾ç¡®åœ°å°Šé‡å®ƒä»¬ã€‚
ä½†ç°å®ä¸–ç•Œæ˜¯<strong>å˜ˆæ‚çš„</strong>ï¼Œç†æƒ³æ¨¡å‹åœ¨ä¸¤ä¸ªæ–¹é¢ä¸å¤Ÿï¼š</p>

<ol>
  <li><strong>å±€éƒ¨å¯¹ç§°æ€§ vs å…¨å±€å¯¹ç§°æ€§</strong>ï¼šè§†é¢‘ä¸­å¤šä¸ªç‰©ä½“å„è‡ªæ²¿ä¸åŒæ–¹å‘è¿åŠ¨â€”â€”æ²¡æœ‰å…¨å±€å¹³ç§»èƒ½è§£é‡Šæ•´ä¸ªå˜æ¢</li>
  <li><strong>éš¾ä»¥æè¿°çš„å˜æ¢ç¾¤</strong>ï¼šå¯å˜å½¢ 3D ç‰©ä½“åœ¨ç›¸æœºå‰çš„å½¢å˜å¾ˆéš¾ç”¨ç®€å•ç¾¤æè¿°</li>
</ol>

<div class="box example">
  <div class="box-title">ğŸ’¡ ç›´è§‰ï¼šä»ç²¾ç¡®å¯¹ç§°åˆ°è¿‘ä¼¼ä¸å˜</div>
  <p>æƒ³è±¡ä½ åœ¨è¯†åˆ«æ‰‹å†™æ•°å­—"7"ã€‚ä¸¥æ ¼æ¥è¯´ï¼Œæ¯ä¸ªäººå†™çš„"7"éƒ½ä¸å®Œå…¨ä¸€æ ·â€”â€”
  æœ‰äº›äººå†™å¾—ç•¥å¾®å€¾æ–œï¼Œæœ‰äº›äººç¬”ç”»æœ‰å¼§åº¦ã€‚è¿™äº›éƒ½æ˜¯<strong>å°å½¢å˜</strong>ï¼Œå®ƒä»¬ä¸æ„æˆä¸€ä¸ªç¾¤ï¼ˆä¸¤ä¸ªå°å½¢å˜çš„å¤åˆå¯èƒ½æ˜¯å¤§å½¢å˜ï¼‰ï¼Œ
  ä½†æˆ‘ä»¬ä»ç„¶å¸Œæœ›è¯†åˆ«ç³»ç»Ÿå¯¹å®ƒä»¬<strong>ä¿æŒç¨³å®š</strong>ã€‚</p>
</div>

<h3 id="sec3-3-signal">ä¿¡å·å½¢å˜çš„ç¨³å®šæ€§ (Stability to Signal Deformations)</h3>

<p>å…³é”®æ€è·¯ï¼šç”¨ä¸€ä¸ª<strong>å¤æ‚åº¦åº¦é‡ (complexity measure)</strong> $c(\tau)$ æ¥é‡åŒ–å˜æ¢ $\tau$ ç¦»å¯¹ç§°ç¾¤ $\mathfrak{G}$ æœ‰å¤šè¿œã€‚</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.13ï¼šå‡ ä½•ç¨³å®šæ€§ (Geometric Stability)</div>
  <p>è®¾ $\tau \in \mathrm{Diff}(\Omega)$ æ˜¯ä¸€ä¸ªå¾®åˆ†åŒèƒšï¼Œ$\mathfrak{G} \subset \mathrm{Diff}(\Omega)$ æ˜¯å¯¹ç§°å­ç¾¤ï¼Œ
  $c(\tau)$ æ˜¯ä¸€ä¸ª<strong>å¤æ‚åº¦åº¦é‡</strong>æ»¡è¶³ $c(\tau) = 0 \iff \tau \in \mathfrak{G}$ã€‚
  å‡½æ•° $f \in \mathcal{F}(\mathcal{X}(\Omega))$ æ˜¯<strong>å‡ ä½•ç¨³å®šçš„</strong>ï¼Œå¦‚æœï¼š</p>
  $$\boxed{\|f(\rho(\tau)x) - f(x)\| \leq C \cdot c(\tau) \cdot \|x\|} \quad \forall\, x \in \mathcal{X}(\Omega) \tag{7}$$
  <div class="symbol-table" style="margin-top: 12px;">
    <span class="sym">$\tau$</span><span class="desc">åŸŸä¸Šçš„å¾®åˆ†åŒèƒšï¼ˆå¯ä»¥çœ‹ä½œ"å˜å½¢"æˆ–"æ‰­æ›²"ï¼‰</span>
    <span class="sym">$\rho(\tau)x(u) = x(\tau^{-1}u)$</span><span class="desc">å˜å½¢ä½œç”¨äºä¿¡å·</span>
    <span class="sym">$c(\tau)$</span><span class="desc">å˜å½¢å¤æ‚åº¦ï¼šè¡¡é‡ $\tau$ åç¦»å¯¹ç§°ç¾¤ $\mathfrak{G}$ çš„ç¨‹åº¦</span>
    <span class="sym">$C$</span><span class="desc">ä¸ä¿¡å· $x$ æ— å…³çš„å¸¸æ•°</span>
    <span class="sym">$\|x\|$</span><span class="desc">ä¿¡å·çš„èŒƒæ•°</span>
  </div>
</div>

<div class="box thm">
  <div class="box-title">ğŸ“— å‡ ä½•ç¨³å®šæ€§æ¨å¹¿äº†ä¸å˜æ€§</div>
  <p>å½“ $\tau \in \mathfrak{G}$ æ—¶ï¼Œ$c(\tau) = 0$ï¼Œä¸ç­‰å¼å³è¾¹ä¸ºé›¶ï¼Œæ‰€ä»¥ï¼š</p>
  $$\|f(\rho(\tau)x) - f(x)\| \leq 0 \implies f(\rho(\tau)x) = f(x)$$
  <p>è¿™æ­£æ˜¯ $\mathfrak{G}$-ä¸å˜æ€§ï¼å‡ ä½•ç¨³å®šæ€§æ˜¯ä¸å˜æ€§çš„<strong>è¿ç»­æ¨å¹¿</strong>ï¼š"è¶Šæ¥è¿‘å¯¹ç§°ç¾¤ï¼Œè¾“å‡ºå˜åŒ–è¶Šå°"ã€‚</p>
</div>

<h4>å˜å½¢å¤æ‚åº¦çš„å…¸å‹é€‰æ‹©</h4>

<p>å¯¹äºå®šä¹‰åœ¨è¿ç»­æ¬§å‡ é‡Œå¾—å¹³é¢ä¸Šçš„å›¾åƒï¼Œä¸€ä¸ªå¸¸è§çš„é€‰æ‹©æ˜¯<strong>Dirichlet èƒ½é‡</strong>ï¼š</p>

$$c^2(\tau) := \int_\Omega \|\nabla \tau(u)\|^2 \, du \tag{8}$$

<p>è¿™ä¸ªåº¦é‡è¡¡é‡äº† $\tau$ çš„"å¼¹æ€§"â€”â€”å®ƒè·ç¦»å¸¸å‘é‡åœºï¼ˆå³å¹³ç§»ï¼‰æœ‰å¤šè¿œã€‚
å½“ $\tau$ æ˜¯ä¸€ä¸ªçº¯å¹³ç§»æ—¶ï¼Œ$\nabla \tau$ æ˜¯å¸¸æ•°ï¼ˆå…¶å˜å½¢é‡ä¸ºé›¶ï¼‰ã€‚</p>

<div class="figure">
  <img src="../assets/ch3_p25_img0.png" alt="å‡ ä½•ç¨³å®šæ€§ç¤ºæ„å›¾">
  <div class="caption"><strong>å›¾ 3.5</strong>ï¼š$\mathrm{Aut}(\Omega)$ ä¸­æ‰€æœ‰åŒå°„æ˜ å°„çš„é›†åˆï¼Œå¯¹ç§°ç¾¤ $\mathfrak{G}$ï¼ˆåœ†åœˆï¼‰æ˜¯å…¶å­ç¾¤ã€‚
  å‡ ä½•ç¨³å®šæ€§å°† $\mathfrak{G}$-ä¸å˜æ€§æ‰©å±•åˆ°"$\mathfrak{G}$ é™„è¿‘çš„å˜æ¢"ï¼ˆç°è‰²ç¯ï¼‰ï¼Œç”¨æŸç§åº¦é‡æ¥é‡åŒ–ç¦» $\mathfrak{G}$ çš„è·ç¦»ã€‚
  åœ¨æ­¤ä¾‹ä¸­ï¼Œå›¾åƒçš„å…‰æ»‘æ‰­æ›²æ¥è¿‘äºä¸€ä¸ªå¹³ç§»ã€‚</div>
</div>

<h3 id="sec3-3-domain">åŸŸå½¢å˜çš„ç¨³å®šæ€§ (Stability to Domain Deformations)</h3>

<p>åœ¨å¾ˆå¤šåº”ç”¨ä¸­ï¼Œè¢«å˜å½¢çš„ä¸æ˜¯ä¿¡å·ï¼Œè€Œæ˜¯<strong>åŸŸ $\Omega$ æœ¬èº«</strong>ã€‚
å…¸å‹ä¾‹å­ï¼šéšæ—¶é—´å˜åŒ–çš„ç¤¾äº¤ç½‘ç»œï¼ˆå›¾ç»“æ„åœ¨å˜åŒ–ï¼‰ï¼Œæˆ–ç»å†éåˆšæ€§å˜å½¢çš„ 3D ç‰©ä½“ã€‚</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.14ï¼šåŸŸå½¢å˜ç¨³å®šæ€§</div>
  <p>è®¾ $\mathcal{D}$ æ˜¯æ‰€æœ‰å¯èƒ½åŸŸçš„ç©ºé—´ï¼Œ$d_\mathcal{D}(\Omega, \tilde\Omega)$ æ˜¯åŸŸä¹‹é—´çš„è·ç¦»ã€‚
  å‡½æ•° $f : \mathcal{X}(\mathcal{D}) \to \mathcal{Y}$ å¯¹åŸŸå½¢å˜æ˜¯<strong>ç¨³å®šçš„</strong>ï¼Œå¦‚æœï¼š</p>
  $$\boxed{\|f(x, \Omega) - f(\tilde{x}, \tilde\Omega)\| \leq C \|x\| \cdot d_\mathcal{D}(\Omega, \tilde\Omega)} \tag{9}$$
  <div class="symbol-table" style="margin-top: 8px;">
    <span class="sym">$d_\mathcal{D}(\Omega, \tilde\Omega)$</span><span class="desc">åŸŸä¹‹é—´çš„è·ç¦»ï¼ˆå¦‚å›¾ç¼–è¾‘è·ç¦»ã€Gromov-Hausdorff è·ç¦»ï¼‰</span>
    <span class="sym">$\tilde{x} = x \circ \eta^{-1}$</span><span class="desc">é€šè¿‡å¯¹é½æ˜ å°„ $\eta : \Omega \to \tilde\Omega$ å¾—åˆ°çš„å˜å½¢ä¿¡å·</span>
  </div>
</div>

<p>åŸŸä¹‹é—´çš„è·ç¦»é€šå¸¸é€šè¿‡å¯»æ‰¾æœ€ä¼˜"å¯¹é½"æ¥å®šä¹‰ï¼š</p>

$$d_\mathcal{D}(\Omega, \tilde\Omega) = \inf_{\eta \in \mathfrak{G}} \|d - \tilde{d} \circ (\eta \times \eta)\| \tag{10}$$

<p>è¿™é‡Œ $\mathfrak{G}$ æ˜¯åŒæ„ç¾¤ï¼ˆå¦‚åŒå°„æˆ–ç­‰è·æ˜ å°„ï¼‰ï¼Œ$d, \tilde{d}$ åˆ†åˆ«æ˜¯ä¸¤ä¸ªåŸŸä¸Šçš„è·ç¦»å‡½æ•°ã€‚
ç›´è§‰ä¸Šï¼šä¸¤ä¸ªåŸŸçš„è·ç¦» = å°†å®ƒä»¬"æœ€ä½³å¯¹é½"åå‰©ä½™çš„ç»“æ„å·®å¼‚ã€‚</p>

<h3 id="sec3-3-math">ğŸ“ æ•°å­¦æ¨å¯¼ï¼šLipschitz ç¨³å®šæ€§ç•Œé™</h3>

<div class="box thm">
  <div class="box-title">ğŸ“— Lipschitz è¿ç»­æ€§ä¸ç¨³å®šæ€§</div>
  <p>å‡ ä½•ç¨³å®šæ€§æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª<strong>Lipschitz æ¡ä»¶</strong>ã€‚å›å¿† Lipschitz è¿ç»­æ€§çš„å®šä¹‰ï¼š</p>
  $$\|f(x_1) - f(x_2)\| \leq L \|x_1 - x_2\|$$
  <p>å…¶ä¸­ $L$ æ˜¯ Lipschitz å¸¸æ•°ã€‚å‡ ä½•ç¨³å®šæ€§ (å…¬å¼ 7) å¯ä»¥æ”¹å†™ä¸ºï¼š</p>
  $$\frac{\|f(\rho(\tau)x) - f(x)\|}{\|x\|} \leq C \cdot c(\tau)$$
  <p>è¿™è¯´æ˜è¾“å‡ºçš„<strong>ç›¸å¯¹å˜åŒ–</strong>è¢«å˜å½¢å¤æ‚åº¦<strong>çº¿æ€§æ§åˆ¶</strong>ã€‚</p>
</div>

<div class="box thm">
  <div class="box-title">ğŸ“— æ¨å¯¼ï¼šä¸ºä»€ä¹ˆ Dirichlet èƒ½é‡æ˜¯å¥½çš„å¤æ‚åº¦åº¦é‡</div>
  <p>è€ƒè™‘ $\Omega = \mathbb{R}^d$ï¼Œ$\tau(u) = u - \tilde\tau(u)$ï¼Œå…¶ä¸­ $\tilde\tau$ æ˜¯ä¸€ä¸ªå°ä½ç§»åœºã€‚</p>
  <p><strong>Step 1</strong>ï¼šå½“ $\tilde\tau(u) = v$ï¼ˆå¸¸æ•°ï¼‰æ—¶ï¼Œ$\tau$ æ˜¯ä¸€ä¸ªçº¯å¹³ç§» $\tau \in T(\mathbb{R}^d)$ã€‚æ­¤æ—¶ $\nabla\tilde\tau = 0$ã€‚</p>
  <p><strong>Step 2</strong>ï¼š$\nabla\tilde\tau$ è¡¡é‡äº† $\tau$ åç¦»å¹³ç§»çš„ç¨‹åº¦ã€‚Dirichlet èƒ½é‡ $\int \|\nabla\tilde\tau\|^2 du$ å°±æ˜¯è¿™ä¸ªåç¦»çš„ $L^2$ èŒƒæ•°ã€‚</p>
  <p><strong>Step 3</strong>ï¼šå¯¹äºä¿¡å· $x$ å’Œå˜å½¢ $\tau$ï¼Œä¸€é˜¶æ³°å‹’å±•å¼€ç»™å‡ºï¼š</p>
  $$\rho(\tau)x(u) = x(\tau^{-1}u) \approx x(u) + \nabla x(u) \cdot \tilde\tau(u)$$
  <p><strong>Step 4</strong>ï¼šå› æ­¤ï¼š</p>
  $$\|\rho(\tau)x - x\|^2 \approx \int_\Omega |\nabla x(u) \cdot \tilde\tau(u)|^2 du \leq \|\nabla x\|^2_\infty \cdot \int_\Omega \|\tilde\tau(u)\|^2 du$$
  <p>è¿™ç»™å‡ºäº†ä¿¡å·å˜åŒ–çš„<strong>ä¸Šç•Œ</strong>ï¼Œå–å†³äºä¿¡å·çš„æ¢¯åº¦å’Œå˜å½¢çš„å¤§å°ã€‚å¦‚æœæˆ‘ä»¬è¿›ä¸€æ­¥ç”¨ PoincarÃ© ä¸ç­‰å¼å°† $\|\tilde\tau\|$ å…³è”åˆ° $\|\nabla\tilde\tau\|$ï¼Œå°±å¾—åˆ°äº†ç”¨ Dirichlet èƒ½é‡æ§åˆ¶çš„ç¨³å®šæ€§ç•Œé™ã€‚</p>
</div>

<h3 id="sec3-3-code">ğŸ ä»£ç ç¤ºä¾‹ï¼šLipschitz è¿ç»­æ€§éªŒè¯</h3>

<div class="code-block">
  <div class="code-header">
    <span>Python / PyTorch â€” Lipschitz å¸¸æ•°ä¼°è®¡ä¸ç¨³å®šæ€§</span>
    <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
  </div>
<pre><code><span class="kw">import</span> torch
<span class="kw">import</span> torch.nn <span class="kw">as</span> nn
<span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># =====================================================</span>
<span class="cm"># å®éªŒ: ä¼°è®¡ç½‘ç»œçš„ Lipschitz å¸¸æ•°</span>
<span class="cm"># =====================================================</span>

<span class="kw">def</span> <span class="fn">estimate_lipschitz</span>(model, input_shape, n_samples=<span class="num">1000</span>, device=<span class="str">'cpu'</span>):
    <span class="str">"""
    é€šè¿‡éšæœºé‡‡æ ·ä¼°è®¡æ¨¡å‹çš„ Lipschitz å¸¸æ•°
    L â‰ˆ max ||f(x1) - f(x2)|| / ||x1 - x2||
    """</span>
    model.eval()
    max_ratio = <span class="num">0.0</span>

    <span class="kw">with</span> torch.no_grad():
        <span class="kw">for</span> _ <span class="kw">in</span> <span class="bi">range</span>(n_samples):
            x1 = torch.randn(*input_shape, device=device)
            <span class="cm"># ç”Ÿæˆ x1 é™„è¿‘çš„å¾®å°æ‰°åŠ¨</span>
            delta = torch.randn_like(x1) * <span class="num">0.01</span>
            x2 = x1 + delta

            y1 = model(x1)
            y2 = model(x2)

            output_diff = (y1 - y2).flatten().norm()
            input_diff = delta.flatten().norm()

            <span class="kw">if</span> input_diff > <span class="num">1e-10</span>:
                ratio = (output_diff / input_diff).item()
                max_ratio = <span class="bi">max</span>(max_ratio, ratio)

    <span class="kw">return</span> max_ratio

<span class="cm"># åˆ›å»ºä¸¤ä¸ªç½‘ç»œ: æœ‰/æ—  Spectral Normalization</span>
<span class="kw">class</span> <span class="cls">SimpleNet</span>(nn.Module):
    <span class="kw">def</span> <span class="fn">__init__</span>(<span class="sf">self</span>, use_spectral_norm=<span class="kw">False</span>):
        <span class="bi">super</span>().__init__()
        layers = [
            nn.Linear(<span class="num">64</span>, <span class="num">128</span>),
            nn.ReLU(),
            nn.Linear(<span class="num">128</span>, <span class="num">128</span>),
            nn.ReLU(),
            nn.Linear(<span class="num">128</span>, <span class="num">10</span>),
        ]
        <span class="kw">if</span> use_spectral_norm:
            <span class="cm"># Spectral Normalization é™åˆ¶æ¯å±‚çš„ Lipschitz å¸¸æ•° â‰¤ 1</span>
            layers[<span class="num">0</span>] = nn.utils.spectral_norm(layers[<span class="num">0</span>])
            layers[<span class="num">2</span>] = nn.utils.spectral_norm(layers[<span class="num">2</span>])
            layers[<span class="num">4</span>] = nn.utils.spectral_norm(layers[<span class="num">4</span>])
        <span class="sf">self</span>.net = nn.Sequential(*layers)

    <span class="kw">def</span> <span class="fn">forward</span>(<span class="sf">self</span>, x):
        <span class="kw">return</span> <span class="sf">self</span>.net(x)

torch.manual_seed(<span class="num">42</span>)
net_normal = SimpleNet(use_spectral_norm=<span class="kw">False</span>)
net_stable = SimpleNet(use_spectral_norm=<span class="kw">True</span>)

L_normal = estimate_lipschitz(net_normal, (<span class="num">1</span>, <span class="num">64</span>))
L_stable = estimate_lipschitz(net_stable, (<span class="num">1</span>, <span class="num">64</span>))

<span class="bi">print</span>(<span class="str">f"æ™®é€šç½‘ç»œçš„ Lipschitz å¸¸æ•° â‰ˆ {L_normal:.2f}"</span>)
<span class="bi">print</span>(<span class="str">f"è°±å½’ä¸€åŒ–ç½‘ç»œçš„ Lipschitz å¸¸æ•° â‰ˆ {L_stable:.2f}"</span>)
<span class="cm"># æ™®é€šç½‘ç»œ: ~5-15 (è¾ƒå¤§, ä¸ç¨³å®š)</span>
<span class="cm"># è°±å½’ä¸€åŒ–: ~1.0 (è¢«æ§åˆ¶, ç¨³å®š)</span>

<span class="cm"># =====================================================</span>
<span class="cm"># éªŒè¯: å°æ‰°åŠ¨ â†’ å°è¾“å‡ºå˜åŒ–</span>
<span class="cm"># =====================================================</span>

x = torch.randn(<span class="num">1</span>, <span class="num">64</span>)
epsilons = [<span class="num">0.001</span>, <span class="num">0.01</span>, <span class="num">0.1</span>, <span class="num">1.0</span>]

<span class="bi">print</span>(<span class="str">"\næ‰°åŠ¨å¤§å° â†’ è¾“å‡ºå˜åŒ–ï¼ˆåº”æ¥è¿‘çº¿æ€§å…³ç³»ï¼‰:"</span>)
<span class="kw">for</span> eps <span class="kw">in</span> epsilons:
    delta = torch.randn_like(x) * eps
    <span class="kw">with</span> torch.no_grad():
        dy_normal = (net_normal(x + delta) - net_normal(x)).norm().item()
        dy_stable = (net_stable(x + delta) - net_stable(x)).norm().item()
    <span class="bi">print</span>(<span class="str">f"  Îµ={eps:.3f}: æ™®é€š={dy_normal:.4f}, è°±å½’ä¸€åŒ–={dy_stable:.4f}"</span>)</code></pre>
</div>

<div class="box robot">
  <div class="box-title">ğŸ¤– ä¸ PhysRobot çš„å…³è”</div>
  <p>å½¢å˜ç¨³å®šæ€§åœ¨ç‰©ç†æ¨¡æ‹Ÿä¸­è‡³å…³é‡è¦ï¼š</p>
  <ul>
    <li><strong>å™ªå£°é²æ£’æ€§</strong>ï¼šçœŸå®ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆå¦‚æ¿€å…‰é›·è¾¾ç‚¹äº‘ï¼‰æ€»æœ‰å™ªå£°â€”â€”ç²’å­ä½ç½®çš„å¾®å°æ‰°åŠ¨ä¸åº”å¯¼è‡´æ¨¡æ‹Ÿç»“æœçš„å‰§çƒˆå˜åŒ–</li>
    <li><strong>GNS ä¸­çš„ noise injection</strong>ï¼šè®­ç»ƒæ—¶å‘è¾“å…¥æ·»åŠ å™ªå£°ï¼ˆ$\mathbf{x} \leftarrow \mathbf{x} + \epsilon$ï¼‰æ­£æ˜¯ä¸ºäº†<strong>éšå¼åœ°</strong>æé«˜æ¨¡å‹çš„å½¢å˜ç¨³å®šæ€§</li>
    <li><strong>Lipschitz çº¦æŸ</strong>ï¼šåœ¨æŸäº›å®‰å…¨å…³é”®çš„æœºå™¨äººæ§åˆ¶ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ˜¾å¼åœ°é™åˆ¶ç½‘ç»œçš„ Lipschitz å¸¸æ•°</li>
  </ul>
</div>

<div class="exercises" id="sec3-3-exercises">
  <h4>â“ 3.3 èŠ‚ç»ƒä¹ é¢˜</h4>
  <ol>
    <li><strong>æ•°å­¦è¯æ˜</strong>ï¼šè¯æ˜ ReLU å‡½æ•° $\sigma(x) = \max(0, x)$ æ˜¯ 1-Lipschitz çš„ã€‚</li>
    <li><strong>Lipschitz ç»„åˆ</strong>ï¼šå¦‚æœ $f$ æ˜¯ $L_1$-Lipschitzï¼Œ$g$ æ˜¯ $L_2$-Lipschitzï¼Œè¯æ˜ $f \circ g$ æ˜¯ $L_1 L_2$-Lipschitzã€‚
    è¿™å¯¹æ·±åº¦ç½‘ç»œçš„ Lipschitz å¸¸æ•°æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</li>
    <li><strong>ç¼–ç¨‹ç»ƒä¹ </strong>ï¼šå®ç°ä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡è®¡ç®—æ‰€æœ‰å±‚æƒé‡çŸ©é˜µçš„è°±èŒƒæ•°ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰æ¥<strong>ä¸Šç•Œä¼°è®¡</strong>ç½‘ç»œçš„ Lipschitz å¸¸æ•°ï¼Œ
    å¹¶ä¸éšæœºé‡‡æ ·æ–¹æ³•å¯¹æ¯”ã€‚</li>
    <li><strong>æ€è€ƒé¢˜</strong>ï¼šBatchNorm å±‚æ˜¯å¦æ˜¯ Lipschitz è¿ç»­çš„ï¼Ÿä¸ºä»€ä¹ˆåœ¨æŸäº›åº”ç”¨ä¸­äººä»¬åå¥½ GroupNormï¼Ÿ</li>
  </ol>
</div>


<!-- ======================================== -->
<!-- SECTION 3.4: SCALE SEPARATION -->
<!-- ======================================== -->
<h2 id="sec3-4">3.4 å°ºåº¦åˆ†ç¦»<br><span style="font-size:0.55em; color:var(--text-secondary)">Scale Separation</span></h2>

<p>è™½ç„¶å½¢å˜ç¨³å®šæ€§å¤§å¤§åŠ å¼ºäº†å…¨å±€å¯¹ç§°å…ˆéªŒï¼Œä½†<strong>ä»…é å®ƒä¸è¶³ä»¥å…‹æœç»´åº¦ç¾éš¾</strong>ï¼š
æ»¡è¶³å…¬å¼ (7) çš„å‡½æ•°åœ¨åŸŸå¢å¤§æ—¶ä»ç„¶"å¤ªå¤š"äº†ã€‚çªç ´å…³é”®åœ¨äºåˆ©ç”¨ç‰©ç†ä»»åŠ¡çš„<strong>å¤šå°ºåº¦ç»“æ„</strong>ã€‚</p>

<div class="box example">
  <div class="box-title">ğŸ’¡ ç›´è§‰ï¼šä»è¿‘çœ‹åˆ°è¿œçœ‹</div>
  <p>æƒ³è±¡ä½ åœ¨è¾¨è®¤ä¸€æ£µæ ‘çš„ç…§ç‰‡ï¼š</p>
  <ul>
    <li><strong>ç»†å°ºåº¦</strong>ï¼ˆè¿‘çœ‹ï¼‰ï¼šä½ çœ‹åˆ°çš„æ˜¯å¶å­çš„çº¹ç†ã€æ ‘çš®çš„çº¹è·¯</li>
    <li><strong>ä¸­å°ºåº¦</strong>ï¼šä½ çœ‹åˆ°çš„æ˜¯æ ‘æçš„å½¢çŠ¶ã€å¶å­çš„åˆ†å¸ƒ</li>
    <li><strong>ç²—å°ºåº¦</strong>ï¼ˆè¿œçœ‹ï¼‰ï¼šä½ çœ‹åˆ°çš„æ˜¯æ ‘çš„æ•´ä½“è½®å»“</li>
  </ul>
  <p>"è¿™æ˜¯ä¸€æ£µæ¾æ ‘"çš„åˆ¤æ–­ä¸»è¦ä¾èµ–ç²—å°ºåº¦å’Œä¸­å°ºåº¦çš„ä¿¡æ¯ã€‚<strong>å°ºåº¦åˆ†ç¦»</strong>å°±æ˜¯å°†ä¿¡æ¯æŒ‰å°ºåº¦ç»„ç»‡ï¼Œ
  å…ˆå¤„ç†å±€éƒ¨ç»†èŠ‚ï¼Œå†é€æ­¥æ•´åˆåˆ°å…¨å±€â€”â€”è¿™æ­£æ˜¯ CNN æ± åŒ–å±‚å’Œ GNN çš„å›¾ç²—åŒ–åœ¨åšçš„äº‹ï¼</p>
</div>

<h3 id="sec3-4-fourier">å‚…é‡Œå¶å˜æ¢ (Fourier Transform)</h3>

<p>åœ¨ä»‹ç»å¤šå°ºåº¦è¡¨ç¤ºä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå›é¡¾ä¿¡å·åˆ†è§£çš„ç»å…¸å·¥å…·â€”â€”<strong>å‚…é‡Œå¶å˜æ¢</strong>ã€‚</p>

<div class="box def">
  <div class="box-title">ğŸ“˜ å®šä¹‰ 3.15ï¼šå‚…é‡Œå¶å˜æ¢ (Fourier Transform)</div>
  <p>ä¸€ç»´å‚…é‡Œå¶å˜æ¢å°†ä¿¡å· $x(u) \in L^2(\mathbb{R})$ åˆ†è§£ä¸ºä¸åŒé¢‘ç‡çš„æŒ¯è¡åŸºå‡½æ•° $\varphi_\xi(u) = e^{i\xi u}$ï¼š</p>
  $$\hat{x}(\xi) = \int_{-\infty}^{+\infty} x(u) e^{-i\xi u} du \tag{11}$$
  <div class="symbol-table" style="margin-top: 8px;">
    <span class="sym">$\hat{x}(\xi)$</span><span class="desc">ä¿¡å· $x$ çš„å‚…é‡Œå¶å˜æ¢ï¼ˆé¢‘ç‡ $\xi$ å¤„çš„æˆåˆ†ï¼‰</span>
    <span class="sym">$\xi$</span><span class="desc">é¢‘ç‡ï¼ˆoscillation rateï¼‰</span>
    <span class="sym">$e^{-i\xi u}$</span><span class="desc">å‚…é‡Œå¶åŸºå‡½æ•°ï¼ˆå¤æŒ‡æ•°ï¼‰</span>
    <span class="sym">$L^2(\mathbb{R})$</span><span class="desc">å¹³æ–¹å¯ç§¯å‡½æ•°ç©ºé—´</span>
  </div>
</div>

<div class="box thm">
  <div class="box-title">ğŸ“— å·ç§¯å®šç† (Convolution Theorem)</div>
  <p>å·ç§¯åœ¨å‚…é‡Œå¶åŸŸä¸­å˜æˆäº†é€ç‚¹ä¹˜æ³•ï¼š</p>
  $$\widehat{(x \star \theta)}(\xi) = \hat{x}(\xi) \cdot \hat{\theta}(\xi) \tag{12}$$
  <p>å…¶ä¸­å·ç§¯å®šä¹‰ä¸ºï¼š$(x \star \theta)(u) = \int_{-\infty}^{+\infty} x(v)\theta(u-v)dv$</p>
  <p>è¿™æ„å‘³ç€å·ç§¯ç®—å­åœ¨å‚…é‡Œå¶åŸºä¸‹è¢«<strong>å¯¹è§’åŒ–</strong>äº†â€”â€”è¿™æ˜¯ä¿¡å·å¤„ç†å’Œè°±å›¾ç†è®ºçš„åŸºçŸ³ã€‚</p>
</div>

<h4>
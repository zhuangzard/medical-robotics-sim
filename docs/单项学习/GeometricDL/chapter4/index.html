<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chapter 4: Geometric Domains â€” the 5 Gs | GDL æ·±åº¦æ•™ç¨‹</title>
  <style>
    /* ===== CSS Variables ===== */
    :root {
      --bg: #ffffff;
      --bg-secondary: #f8f9fa;
      --bg-code: #f4f4f5;
      --text: #1a1a2e;
      --text-secondary: #555;
      --accent: #2563eb;
      --accent-light: #dbeafe;
      --border: #e0e0e0;
      --sidebar-bg: #f0f4f8;
      --sidebar-width: 280px;
      --header-height: 56px;
      --callout-info-bg: #eff6ff;
      --callout-info-border: #3b82f6;
      --callout-warn-bg: #fffbeb;
      --callout-warn-border: #f59e0b;
      --callout-success-bg: #f0fdf4;
      --callout-success-border: #22c55e;
      --callout-robot-bg: #ecfdf5;
      --callout-robot-border: #10b981;
      --callout-math-bg: #faf5ff;
      --callout-math-border: #8b5cf6;
      --callout-exercise-bg: #fff7ed;
      --callout-exercise-border: #f97316;
      --code-keyword: #d73a49;
      --code-string: #032f62;
      --code-comment: #6a737d;
      --code-function: #6f42c1;
      --code-number: #005cc5;
      --progress-color: #2563eb;
      --shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    [data-theme="dark"] {
      --bg: #0f172a;
      --bg-secondary: #1e293b;
      --bg-code: #1e293b;
      --text: #e2e8f0;
      --text-secondary: #94a3b8;
      --accent: #60a5fa;
      --accent-light: #1e3a5f;
      --border: #334155;
      --sidebar-bg: #1e293b;
      --callout-info-bg: #172554;
      --callout-info-border: #3b82f6;
      --callout-warn-bg: #422006;
      --callout-warn-border: #f59e0b;
      --callout-success-bg: #052e16;
      --callout-success-border: #22c55e;
      --callout-robot-bg: #064e3b;
      --callout-robot-border: #10b981;
      --callout-math-bg: #2e1065;
      --callout-math-border: #8b5cf6;
      --callout-exercise-bg: #431407;
      --callout-exercise-border: #f97316;
      --code-keyword: #ff7b72;
      --code-string: #a5d6ff;
      --code-comment: #8b949e;
      --code-function: #d2a8ff;
      --code-number: #79c0ff;
      --shadow: 0 1px 3px rgba(0,0,0,0.4);
    }

    /* ===== Reset & Base ===== */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; scroll-padding-top: calc(var(--header-height) + 16px); }
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.75;
      transition: background 0.3s, color 0.3s;
    }

    /* ===== Progress Bar ===== */
    .progress-bar {
      position: fixed; top: 0; left: 0;
      width: 0%; height: 3px;
      background: linear-gradient(90deg, var(--accent), #8b5cf6);
      z-index: 1001;
      transition: width 0.1s;
    }

    /* ===== Header ===== */
    .header {
      position: fixed; top: 0; left: 0; right: 0;
      height: var(--header-height);
      background: var(--bg);
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 24px;
      z-index: 1000;
      backdrop-filter: blur(10px);
    }
    .header-title a {
      font-weight: 700; font-size: 1.1em;
      color: var(--text); text-decoration: none;
    }
    .header-nav { display: flex; gap: 12px; align-items: center; }
    .header-nav a {
      color: var(--accent); text-decoration: none; font-size: 0.9em;
      padding: 4px 8px; border-radius: 6px;
      transition: background 0.2s;
    }
    .header-nav a:hover { background: var(--accent-light); }
    .theme-toggle {
      background: none; border: 1px solid var(--border);
      border-radius: 8px; padding: 6px 10px;
      cursor: pointer; font-size: 1.1em;
      color: var(--text);
    }

    /* ===== Sidebar ===== */
    .sidebar {
      position: fixed; top: var(--header-height); left: 0;
      width: var(--sidebar-width);
      height: calc(100vh - var(--header-height));
      background: var(--sidebar-bg);
      border-right: 1px solid var(--border);
      overflow-y: auto;
      padding: 16px 12px;
      z-index: 999;
      transition: transform 0.3s;
      font-size: 0.88em;
    }
    .sidebar h3 {
      font-size: 0.8em; text-transform: uppercase;
      letter-spacing: 0.1em; color: var(--text-secondary);
      margin: 16px 0 8px; padding-left: 8px;
    }
    .sidebar h3:first-child { margin-top: 0; }
    .sidebar a {
      display: block; padding: 5px 12px;
      color: var(--text); text-decoration: none;
      border-radius: 6px; margin: 1px 0;
      transition: background 0.2s;
      line-height: 1.5;
    }
    .sidebar a:hover { background: var(--accent-light); color: var(--accent); }
    .sidebar a.sub { padding-left: 28px; font-size: 0.92em; color: var(--text-secondary); }
    .sidebar a.active { background: var(--accent-light); color: var(--accent); font-weight: 600; }
    .sidebar-toggle {
      display: none;
      position: fixed; top: calc(var(--header-height) + 8px); left: 8px;
      z-index: 1001;
      background: var(--bg); border: 1px solid var(--border);
      border-radius: 8px; padding: 8px 12px;
      cursor: pointer; font-size: 1.2em;
      color: var(--text);
    }

    /* ===== Main Content ===== */
    .main {
      margin-left: var(--sidebar-width);
      margin-top: var(--header-height);
      max-width: 900px;
      padding: 32px 40px 80px;
    }
    .main h1 {
      font-size: 2.2em; font-weight: 800;
      margin-bottom: 24px;
      background: linear-gradient(135deg, var(--accent), #8b5cf6);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      background-clip: text;
      line-height: 1.3;
    }
    .main h2 {
      font-size: 1.6em; font-weight: 700;
      margin: 48px 0 16px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--accent);
      color: var(--text);
    }
    .main h3 {
      font-size: 1.25em; font-weight: 600;
      margin: 32px 0 12px;
      color: var(--text);
    }
    .main h4 {
      font-size: 1.05em; font-weight: 600;
      margin: 20px 0 8px;
    }
    .main p { margin-bottom: 12px; }
    .main ul, .main ol { margin: 8px 0 16px 24px; }
    .main li { margin-bottom: 6px; }
    .main strong { color: var(--text); }
    .term { color: var(--accent); font-weight: 600; }
    .main a { color: var(--accent); text-decoration: underline; }

    /* ===== Callout Boxes ===== */
    .callout {
      border-left: 4px solid;
      border-radius: 8px;
      padding: 16px 20px;
      margin: 20px 0;
    }
    .callout h4 { margin-top: 0; margin-bottom: 8px; }
    .callout-info { background: var(--callout-info-bg); border-color: var(--callout-info-border); }
    .callout-warn { background: var(--callout-warn-bg); border-color: var(--callout-warn-border); }
    .callout-success { background: var(--callout-success-bg); border-color: var(--callout-success-border); }
    .callout-robot { background: var(--callout-robot-bg); border-color: var(--callout-robot-border); }
    .callout-math { background: var(--callout-math-bg); border-color: var(--callout-math-border); }
    .callout-exercise { background: var(--callout-exercise-bg); border-color: var(--callout-exercise-border); }

    /* ===== Blueprint Box ===== */
    .blueprint {
      background: var(--bg-secondary);
      border: 2px solid var(--accent);
      border-radius: 12px;
      padding: 20px 24px;
      margin: 20px 0;
    }
    .blueprint h4 { color: var(--accent); margin-bottom: 12px; }

    /* ===== Math ===== */
    .math-block {
      background: var(--bg-secondary);
      border-radius: 8px;
      padding: 16px 20px;
      margin: 16px 0;
      overflow-x: auto;
    }
    .math-explain {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px dashed var(--border);
      font-size: 0.92em;
      color: var(--text-secondary);
    }

    /* ===== Code Blocks ===== */
    .code-container {
      position: relative;
      margin: 16px 0;
      border-radius: 8px;
      overflow: hidden;
      border: 1px solid var(--border);
    }
    .code-header {
      display: flex; justify-content: space-between; align-items: center;
      background: var(--bg-secondary);
      padding: 8px 16px;
      font-size: 0.85em;
      color: var(--text-secondary);
      border-bottom: 1px solid var(--border);
    }
    .copy-btn {
      background: none; border: 1px solid var(--border);
      border-radius: 4px; padding: 2px 10px;
      cursor: pointer; font-size: 0.85em;
      color: var(--text-secondary);
      transition: all 0.2s;
    }
    .copy-btn:hover { background: var(--accent-light); color: var(--accent); }
    pre {
      margin: 0; padding: 16px;
      background: var(--bg-code);
      overflow-x: auto;
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      font-size: 0.88em;
      line-height: 1.6;
      color: var(--text);
    }
    code {
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      font-size: 0.9em;
    }
    p code, li code {
      background: var(--bg-code);
      padding: 2px 6px;
      border-radius: 4px;
    }

    /* ===== Figures ===== */
    .figure {
      margin: 24px 0;
      text-align: center;
    }
    .figure img {
      max-width: 100%;
      border-radius: 8px;
      box-shadow: var(--shadow);
    }
    .figure figcaption {
      margin-top: 8px;
      font-size: 0.9em;
      color: var(--text-secondary);
      font-style: italic;
    }

    /* ===== Bilingual ===== */
    .bilingual {
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
      margin: 12px 0;
    }
    .bilingual .en {
      font-size: 0.9em;
      color: var(--text-secondary);
      font-style: italic;
      padding-left: 16px;
      border-left: 2px solid var(--border);
    }

    /* ===== Table ===== */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0;
      font-size: 0.92em;
    }
    th, td {
      padding: 10px 14px;
      border: 1px solid var(--border);
      text-align: left;
    }
    th {
      background: var(--bg-secondary);
      font-weight: 600;
    }

    /* ===== Responsive ===== */
    @media (max-width: 768px) {
      .sidebar { transform: translateX(-100%); }
      .sidebar.open { transform: translateX(0); }
      .sidebar-toggle { display: block; }
      .main { margin-left: 0; padding: 24px 16px 60px; }
      .main h1 { font-size: 1.6em; }
      .main h2 { font-size: 1.3em; }
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
</head>
<body>
  <div class="progress-bar" id="progressBar"></div>

  <header class="header">
    <div class="header-title"><a href="../index.html">ğŸ“ GDL æ·±åº¦æ•™ç¨‹</a></div>
    <div class="header-nav">
      <a href="../chapter3/index.html">â† Ch.3</a>
      <a href="../index.html">ç›®å½•</a>
      <a href="../chapter5/index.html">Ch.5 â†’</a>
      <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
    </div>
  </header>

  <button class="sidebar-toggle" onclick="toggleSidebar()">â˜°</button>

  <nav class="sidebar" id="sidebar">
    <h3>Chapter 4</h3>
    <a href="#overview">ğŸ“‹ æ¦‚è¿°</a>
    <a href="#five-gs">5G æ€»è§ˆ</a>

    <h3>4.1 å›¾å’Œé›†åˆ</h3>
    <a href="#sec4-1">Graphs & Sets</a>
    <a href="#graph-def" class="sub">å›¾çš„å®šä¹‰</a>
    <a href="#adjacency" class="sub">é‚»æ¥çŸ©é˜µ</a>
    <a href="#laplacian-matrix" class="sub">æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ</a>
    <a href="#graph-signals" class="sub">å›¾ä¸Šçš„ä¿¡å·</a>
    <a href="#permutation-group" class="sub">ç½®æ¢ç¾¤</a>
    <a href="#equivariant-graph" class="sub">ç­‰å˜å‡½æ•°</a>
    <a href="#code-graph" class="sub">ğŸ’» ä»£ç ï¼šæ„å»ºå›¾</a>
    <a href="#robot-graph" class="sub">ğŸ¤– PhysRobot</a>

    <h3>4.2 ç½‘æ ¼å’Œæ¬§å‡ é‡Œå¾—ç©ºé—´</h3>
    <a href="#sec4-2">Grids & Euclidean</a>
    <a href="#translation-group" class="sub">å¹³ç§»ç¾¤</a>
    <a href="#circulant" class="sub">å¾ªç¯çŸ©é˜µ</a>
    <a href="#convolution-shift" class="sub">å·ç§¯ä¸å¹³ç§»</a>
    <a href="#fourier-discrete" class="sub">DFT æ¨å¯¼</a>
    <a href="#fourier-continuous" class="sub">è¿ç»­å‚…é‡Œå¶</a>
    <a href="#code-conv" class="sub">ğŸ’» ä»£ç ï¼šå·ç§¯</a>

    <h3>4.3 ç¾¤å’Œé½æ€§ç©ºé—´</h3>
    <a href="#sec4-3">Groups & Homogeneous</a>
    <a href="#group-conv" class="sub">ç¾¤å·ç§¯</a>
    <a href="#spherical-conv" class="sub">çƒé¢å·ç§¯</a>
    <a href="#lie-groups" class="sub">æç¾¤åŸºç¡€</a>
    <a href="#homogeneous-space" class="sub">é½æ€§ç©ºé—´</a>
    <a href="#code-so3" class="sub">ğŸ’» ä»£ç ï¼šSO(3)</a>

    <h3>4.4 æµ‹åœ°çº¿å’Œæµå½¢</h3>
    <a href="#sec4-4">Geodesics & Manifolds</a>
    <a href="#riemannian" class="sub">é»æ›¼æµå½¢</a>
    <a href="#tangent-space" class="sub">åˆ‡ç©ºé—´</a>
    <a href="#geodesics" class="sub">æµ‹åœ°çº¿</a>
    <a href="#parallel-transport" class="sub">å¹³è¡Œç§»åŠ¨</a>
    <a href="#exponential-map" class="sub">æŒ‡æ•°æ˜ å°„</a>
    <a href="#isometries" class="sub">ç­‰è·å˜æ¢</a>
    <a href="#manifold-fourier" class="sub">æµå½¢å‚…é‡Œå¶</a>
    <a href="#code-geodesic" class="sub">ğŸ’» ä»£ç ï¼šæµ‹åœ°çº¿</a>

    <h3>4.5 è§„èŒƒå’Œçº¤ç»´ä¸›</h3>
    <a href="#sec4-5">Gauges & Bundles</a>
    <a href="#bundle-intuition" class="sub">çº¤ç»´ä¸›ç›´è§‰</a>
    <a href="#gauge-transform" class="sub">è§„èŒƒå˜æ¢</a>
    <a href="#structure-group" class="sub">ç»“æ„ç¾¤</a>
    <a href="#gauge-equivariance" class="sub">è§„èŒƒç­‰å˜æ€§</a>
    <a href="#connection" class="sub">è”ç»œä¸å¹³è¡Œç§»åŠ¨</a>

    <h3>4.6 å‡ ä½•å›¾å’Œç½‘æ ¼</h3>
    <a href="#sec4-6">Geometric Graphs</a>
    <a href="#mesh-def" class="sub">ç½‘æ ¼å®šä¹‰</a>
    <a href="#cotangent-laplacian" class="sub">ä½™åˆ‡æ‹‰æ™®æ‹‰æ–¯</a>
    <a href="#spectral-mesh" class="sub">è°±åˆ†æ</a>
    <a href="#functional-maps" class="sub">å‡½æ•°æ˜ å°„</a>
    <a href="#code-mesh" class="sub">ğŸ’» ä»£ç ï¼šå‡ ä½•å›¾</a>
    <a href="#robot-mesh" class="sub">ğŸ¤– PhysRobot</a>

    <h3>é™„å½•</h3>
    <a href="#exercises-all">ğŸ“ ç»¼åˆç»ƒä¹ </a>
    <a href="#summary">ğŸ“Š ç« èŠ‚æ€»ç»“</a>
    <a href="#references">ğŸ“š å‚è€ƒæ–‡çŒ®</a>

    <h3>å¯¼èˆª</h3>
    <a href="../index.html">ğŸ“š æ€»ç›®å½•</a>
    <a href="../chapter3/index.html">â† Ch.3 å‡ ä½•å…ˆéªŒ</a>
    <a href="../chapter5/index.html">â†’ Ch.5 å®ç°</a>
  </nav>

  <main class="main">
    <!-- ============================================================ -->
    <!-- TITLE & OVERVIEW -->
    <!-- ============================================================ -->
    <h1>Chapter 4: Geometric Domains<br><span style="font-size:0.5em;color:var(--text-secondary)">å‡ ä½•åŸŸï¼šthe 5 Gs â€” Graphs, Grids, Groups, Geodesics, Gauges</span></h1>

    <div class="callout callout-info" id="overview">
      <h4>ğŸ“‹ æœ¬ç« æ¦‚è¿°</h4>
      <p>æœ¬ç« æ˜¯ Geometric Deep Learning çš„<strong>æ ¸å¿ƒåœ°å›¾</strong>â€”â€”æè¿°äº†äº”ç§å…³é”®çš„å‡ ä½•åŸŸï¼ˆdomainï¼‰ï¼Œä»¥åŠåœ¨æ¯ç§åŸŸä¸Šå®šä¹‰å¯¹ç§°æ€§å’Œä¸å˜æ€§çš„æ–¹å¼ã€‚è¿™äº”ç§åŸŸè¢«ç§°ä¸º <strong>"5G"</strong>ï¼š</p>
      <ol>
        <li><strong>Graphs</strong>ï¼ˆå›¾ï¼‰& Setsï¼ˆé›†åˆï¼‰â€” ç½®æ¢å¯¹ç§°æ€§ $\Sigma_n$</li>
        <li><strong>Grids</strong>ï¼ˆç½‘æ ¼ï¼‰& æ¬§å‡ é‡Œå¾—ç©ºé—´ â€” å¹³ç§»å¯¹ç§°æ€§ $T(d)$</li>
        <li><strong>Groups</strong>ï¼ˆç¾¤ï¼‰& é½æ€§ç©ºé—´ â€” å…¨å±€å¯¹ç§°ç¾¤ $G$</li>
        <li><strong>Geodesics</strong>ï¼ˆæµ‹åœ°çº¿ï¼‰& æµå½¢ â€” ç­‰è·å˜æ¢ $\text{Iso}(\Omega)$</li>
        <li><strong>Gauges</strong>ï¼ˆè§„èŒƒï¼‰& çº¤ç»´ä¸› â€” è§„èŒƒå¯¹ç§°ç¾¤ $G$ (å±€éƒ¨)</li>
      </ol>
      <p>ç†è§£è¿™äº”ç§åŸŸï¼Œå°±ç†è§£äº†ä¸ºä»€ä¹ˆ CNNã€GNNã€Transformerã€çƒé¢ CNNã€Mesh CNN ç­‰æ¶æ„å„ä¸ç›¸åŒâ€”â€”å®ƒä»¬åªæ˜¯åœ¨ä¸åŒå‡ ä½•åŸŸä¸Šå®ä¾‹åŒ–äº†åŒä¸€ä¸ª GDL è“å›¾ã€‚</p>
      <p><strong>é¢„è®¡é˜…è¯»æ—¶é—´</strong>ï¼š3-4 å°æ—¶ï¼ˆå«ä»£ç å®éªŒï¼‰</p>
    </div>

    <div class="callout callout-robot" id="five-gs">
      <h4>ğŸ¤– PhysRobot è§†è§’ï¼šä¸ºä»€ä¹ˆéœ€è¦å­¦è¿™ä¸€ç« ï¼Ÿ</h4>
      <p>åœ¨æˆ‘ä»¬çš„ç‰©ç†ä»¿çœŸï¼ˆPhysRobot / GNSï¼‰ä¸­ï¼š</p>
      <ul>
        <li>ç²’å­ç³»ç»Ÿç”¨<strong>å›¾</strong>ï¼ˆGraphï¼‰è¡¨ç¤º â†’ Â§4.1</li>
        <li>å›¾åƒè§‚æµ‹åœ¨<strong>ç½‘æ ¼</strong>ï¼ˆGridï¼‰ä¸Š â†’ Â§4.2</li>
        <li>åˆšä½“æ—‹è½¬æ¶‰åŠ<strong>ç¾¤</strong>ï¼ˆSO(3)ã€SE(3)ï¼‰â†’ Â§4.3</li>
        <li>æŸ”ä½“è¡¨é¢æ˜¯<strong>æµå½¢</strong>ï¼ˆManifoldï¼‰â†’ Â§4.4</li>
        <li>è¡¨é¢ä¸Šçš„åŠ›éœ€è¦<strong>è§„èŒƒ</strong>ï¼ˆGaugeï¼‰å¤„ç†æ–¹å‘ â†’ Â§4.5</li>
        <li>FEM ç½‘æ ¼æ˜¯<strong>å‡ ä½•å›¾</strong>ï¼ˆGeometric Graphï¼‰â†’ Â§4.6</li>
      </ul>
      <p>è¿™äº”ç§åŸŸä¸æ˜¯å­¤ç«‹çš„â€”â€”ç‰©ç†ä¸–ç•ŒåŒæ—¶å…·å¤‡æ‰€æœ‰è¿™äº›ç»“æ„ï¼</p>
    </div>

    <div class="figure">
      <img src="../assets/ch4_p35_img0.png" alt="The 5Gs of Geometric Deep Learning">
      <figcaption>å›¾ 9ï¼šGeometric Deep Learning çš„ 5Gâ€”â€”ç½‘æ ¼ã€ç¾¤ä¸é½æ€§ç©ºé—´ï¼ˆå…¨å±€å¯¹ç§°æ€§ï¼‰ã€å›¾ã€æµ‹åœ°çº¿ä¸æµå½¢ä¸Šçš„åº¦é‡ã€è§„èŒƒï¼ˆåˆ‡ç©ºé—´æˆ–ç‰¹å¾ç©ºé—´çš„å‚è€ƒæ¡†æ¶ï¼‰ã€‚</figcaption>
    </div>

    <table>
      <tr><th>Architecture æ¶æ„</th><th>Domain $\Omega$</th><th>Symmetry Group $\mathfrak{G}$</th><th>PhysRobot åœºæ™¯</th></tr>
      <tr><td>CNN</td><td>ç½‘æ ¼ Grid</td><td>å¹³ç§»ç¾¤ Translation</td><td>å›¾åƒè¾“å…¥</td></tr>
      <tr><td>Spherical CNN</td><td>çƒé¢ $S^2$ / SO(3)</td><td>æ—‹è½¬ç¾¤ SO(3)</td><td>çƒé¢æ•°æ®</td></tr>
      <tr><td>Intrinsic / Mesh CNN</td><td>æµå½¢ Manifold</td><td>ç­‰è·ç¾¤ Iso($\Omega$) / SO(2)</td><td>æŸ”ä½“è¡¨é¢</td></tr>
      <tr><td>GNN</td><td>å›¾ Graph</td><td>ç½®æ¢ç¾¤ $\Sigma_n$</td><td><strong>ç²’å­ç³»ç»Ÿ!</strong></td></tr>
      <tr><td>Deep Sets</td><td>é›†åˆ Set</td><td>ç½®æ¢ç¾¤ $\Sigma_n$</td><td>ç‚¹äº‘è¾“å…¥</td></tr>
      <tr><td>Transformer</td><td>å®Œå…¨å›¾</td><td>ç½®æ¢ç¾¤ $\Sigma_n$</td><td>å…¨å±€æ³¨æ„åŠ›</td></tr>
    </table>


    <!-- ============================================================ -->
    <!-- SECTION 4.1: GRAPHS AND SETS -->
    <!-- ============================================================ -->
    <h2 id="sec4-1">4.1 å›¾å’Œé›†åˆ (Graphs and Sets)</h2>

    <div class="bilingual">
      <div class="zh">
        <p>åœ¨å¤šä¸ªç§‘å­¦åˆ†æ”¯ä¸­â€”â€”ä»ç¤¾ä¼šå­¦åˆ°ç²’å­ç‰©ç†â€”â€”<span class="term">å›¾</span>ï¼ˆgraphï¼‰è¢«ç”¨æ¥å»ºæ¨¡å…³ç³»å’Œäº¤äº’çš„ç³»ç»Ÿã€‚ä»æˆ‘ä»¬çš„è§†è§’æ¥çœ‹ï¼Œå›¾äº§ç”Ÿäº†ä¸€ç§éå¸¸åŸºæœ¬çš„ä¸å˜æ€§ï¼Œç”±<strong>ç½®æ¢ç¾¤</strong>æ‰€å»ºæ¨¡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„å…¶ä»–å¯¹è±¡ï¼ˆå¦‚ç½‘æ ¼å’Œé›†åˆï¼‰å¯ä»¥ä½œä¸ºå›¾çš„ç‰¹ä¾‹è·å¾—ã€‚</p>
      </div>
      <div class="en">
        In multiple branches of science, from sociology to particle physics, graphs are used as models of systems of relations and interactions. Graphs give rise to a very basic type of invariance modelled by the group of permutations.
      </div>
    </div>

    <!-- å›¾çš„å½¢å¼åŒ–å®šä¹‰ -->
    <h3 id="graph-def">å›¾çš„å½¢å¼åŒ–å®šä¹‰</h3>

    <div class="blueprint">
      <h4>å®šä¹‰ï¼šå›¾ (Graph)</h4>
      <p>ä¸€ä¸ª<span class="term">å›¾</span> $\mathcal{G} = (\mathcal{V}, \mathcal{E})$ ç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š</p>
      <ul>
        <li><strong>èŠ‚ç‚¹é›†</strong> $\mathcal{V} = \{1, 2, \ldots, n\}$ï¼š$n$ ä¸ªèŠ‚ç‚¹ï¼ˆvertices / nodesï¼‰</li>
        <li><strong>è¾¹é›†</strong> $\mathcal{E} \subseteq \mathcal{V} \times \mathcal{V}$ï¼šèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ï¼ˆedges / linksï¼‰</li>
        <li><strong>èŠ‚ç‚¹ç‰¹å¾</strong> $\mathbf{x}_u \in \mathbb{R}^s$ï¼šæ¯ä¸ªèŠ‚ç‚¹ $u \in \mathcal{V}$ ä¸Šçš„ $s$ ç»´ç‰¹å¾å‘é‡</li>
      </ul>
    </div>

    <div class="callout callout-info">
      <h4>ğŸ’¡ ç›´è§‰ï¼šä»€ä¹ˆæ˜¯å›¾ï¼Ÿ</h4>
      <p>æƒ³è±¡ç¤¾äº¤ç½‘ç»œï¼šæ¯ä¸ª<strong>ç”¨æˆ·</strong>æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ<strong>å‹è°Šå…³ç³»</strong>æ˜¯è¾¹ï¼Œç”¨æˆ·çš„<strong>å¹´é¾„ã€å¤´åƒ</strong>ç­‰æ˜¯èŠ‚ç‚¹ç‰¹å¾ã€‚å›¾çš„æ ¸å¿ƒæ€§è´¨æ˜¯ï¼šèŠ‚ç‚¹æ²¡æœ‰å›ºå®šé¡ºåºâ€”â€”ä½ å¯ä»¥éšæ„ç»™ç”¨æˆ·ç¼–å·ï¼Œç¤¾äº¤ç½‘ç»œæœ¬èº«ä¸ä¼šæ”¹å˜ã€‚</p>
      <p>æ›´è´´è¿‘æˆ‘ä»¬ PhysRobot çš„ä¾‹å­ï¼šæ¯ä¸ª<strong>ç²’å­</strong>æ˜¯èŠ‚ç‚¹ï¼Œ<strong>è¿‘é‚»å…³ç³»</strong>æ˜¯è¾¹ï¼Œç²’å­çš„<strong>ä½ç½®ã€é€Ÿåº¦</strong>æ˜¯èŠ‚ç‚¹ç‰¹å¾ã€‚ç¼–å·ç²’å­çš„æ–¹å¼ä¸å½±å“ç‰©ç†ï¼</p>
    </div>

    <h3 id="adjacency">é‚»æ¥çŸ©é˜µã€åº¦çŸ©é˜µ</h3>

    <p>å›¾çš„è¿æ¥ç»“æ„å¯ä»¥ç”¨ $n \times n$ çš„<span class="term">é‚»æ¥çŸ©é˜µ</span>ï¼ˆadjacency matrixï¼‰$\mathbf{A}$ è¡¨ç¤ºï¼š</p>

    <div class="math-block">
      $$a_{uv} = \begin{cases} 1 & \text{if } (u, v) \in \mathcal{E} \\ 0 & \text{otherwise} \end{cases}$$
      <div class="math-explain">
        <strong>ç¬¦å·è¯´æ˜</strong>ï¼š$a_{uv}$ æ˜¯ $\mathbf{A}$ çš„ç¬¬ $u$ è¡Œç¬¬ $v$ åˆ—å…ƒç´ ã€‚è‹¥ $(u,v)$ ä¹‹é—´æœ‰è¾¹åˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚å¯¹äº<strong>æ— å‘å›¾</strong>ï¼Œé‚»æ¥çŸ©é˜µå¯¹ç§°ï¼š$\mathbf{A} = \mathbf{A}^\top$ã€‚
      </div>
    </div>

    <p><span class="term">åº¦çŸ©é˜µ</span>ï¼ˆdegree matrixï¼‰$\mathbf{D}$ æ˜¯å¯¹è§’çŸ©é˜µï¼Œè®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„è¿æ¥æ•°ï¼š</p>

    <div class="math-block">
      $$\mathbf{D} = \text{diag}(d_1, d_2, \ldots, d_n), \quad d_u = \sum_{v} a_{uv} = |\mathcal{N}_u|$$
      <div class="math-explain">
        $d_u$ æ˜¯èŠ‚ç‚¹ $u$ çš„åº¦ï¼ˆdegreeï¼‰ï¼Œå³ä¸ä¹‹ç›¸è¿çš„é‚»å±…æ•°é‡ã€‚$\mathcal{N}_u = \{v : (u,v) \in \mathcal{E}\}$ æ˜¯ $u$ çš„é‚»åŸŸã€‚
      </div>
    </div>

    <h3 id="laplacian-matrix">å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ</h3>

    <p><span class="term">å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ</span>ï¼ˆGraph Laplacianï¼‰æ˜¯å›¾åˆ†æä¸­æœ€é‡è¦çš„çŸ©é˜µä¹‹ä¸€ï¼š</p>

    <div class="math-block">
      $$\mathbf{L} = \mathbf{D} - \mathbf{A}$$
      <div class="math-explain">
        <strong>ç»„åˆæ‹‰æ™®æ‹‰æ–¯</strong>ï¼ˆcombinatorial Laplacianï¼‰ã€‚ä½œç”¨åœ¨ä¿¡å· $\mathbf{x}$ ä¸Šæ—¶ï¼š$(\mathbf{L}\mathbf{x})_u = d_u x_u - \sum_{v \in \mathcal{N}_u} x_v = \sum_{v \in \mathcal{N}_u} (x_u - x_v)$ã€‚<br>
        <strong>ç›´è§‰</strong>ï¼šæ‹‰æ™®æ‹‰æ–¯è¡¡é‡ä¸€ä¸ªèŠ‚ç‚¹çš„ä¿¡å·å€¼ä¸é‚»å±…å¹³å‡å€¼çš„åå·®â€”â€”å°±åƒè¿ç»­æƒ…å†µä¸‹çš„"äºŒé˜¶å¯¼æ•°"ã€‚
      </div>
    </div>

    <div class="callout callout-math">
      <h4>ğŸ”® æ‹‰æ™®æ‹‰æ–¯çš„æ€§è´¨</h4>
      <ul>
        <li><strong>åŠæ­£å®š</strong>ï¼š$\mathbf{L} \succeq 0$ï¼Œæ‰€æœ‰ç‰¹å¾å€¼ $\lambda_i \geq 0$</li>
        <li><strong>å¯¹ç§°</strong>ï¼ˆæ— å‘å›¾ï¼‰ï¼š$\mathbf{L} = \mathbf{L}^\top$ï¼Œç‰¹å¾å‘é‡æ­£äº¤</li>
        <li><strong>æœ€å°ç‰¹å¾å€¼ä¸º 0</strong>ï¼šå¯¹åº”å¸¸æ•°å‘é‡ $\mathbf{1}$ï¼ˆæ‰€æœ‰èŠ‚ç‚¹å€¼ç›¸åŒ â†’ æ— "æ¢¯åº¦"ï¼‰</li>
        <li><strong>äºŒæ¬¡å‹æ˜¯ Dirichlet èƒ½é‡</strong>ï¼š$\mathbf{x}^\top \mathbf{L} \mathbf{x} = \sum_{(u,v) \in \mathcal{E}} (x_u - x_v)^2$ï¼Œè¡¡é‡ä¿¡å·çš„"å…‰æ»‘åº¦"</li>
      </ul>
      <p><strong>å½’ä¸€åŒ–æ‹‰æ™®æ‹‰æ–¯</strong>ï¼š$\tilde{\mathbf{L}} = \mathbf{D}^{-1/2} \mathbf{L} \mathbf{D}^{-1/2} = \mathbf{I} - \mathbf{D}^{-1/2} \mathbf{A} \mathbf{D}^{-1/2}$ï¼Œç‰¹å¾å€¼åœ¨ $[0, 2]$ ä¹‹é—´ã€‚</p>
    </div>

    <h3 id="graph-signals">å›¾ä¸Šçš„ä¿¡å·å’Œå‡½æ•°</h3>

    <p>å°†æ‰€æœ‰èŠ‚ç‚¹ç‰¹å¾å †å æˆçŸ©é˜µ $\mathbf{X} = (\mathbf{x}_1, \ldots, \mathbf{x}_n)^\top \in \mathbb{R}^{n \times d}$ï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªèŠ‚ç‚¹çš„ç‰¹å¾ã€‚æ³¨æ„è¿™éšå«åœ°ç»™èŠ‚ç‚¹æŒ‡å®šäº†ä¸€ä¸ªé¡ºåºã€‚</p>

    <p>å›¾ä¸Šçš„<span class="term">ä¿¡å·</span>å°±æ˜¯å®šä¹‰åœ¨èŠ‚ç‚¹é›† $\mathcal{V}$ ä¸Šçš„å‡½æ•° $x : \mathcal{V} \to \mathbb{R}^d$ã€‚åœ¨ GDL è“å›¾ä¸­ï¼ŒåŸŸ $\Omega = \mathcal{G}$ï¼Œä¿¡å·ç©ºé—´ $\mathcal{X}(\mathcal{G}, \mathbb{R}^d)$ æ˜¯ $d$ ç»´çš„é€èŠ‚ç‚¹ä¿¡å·ã€‚</p>

    <h3 id="permutation-group">ç½®æ¢ç¾¤ä½œç”¨åœ¨å›¾ä¸Š</h3>

    <div class="blueprint">
      <h4>ç½®æ¢ç¾¤ $\Sigma_n$ ä½œç”¨åœ¨å›¾ä¸Š</h4>
      <p>å¯¹ç§°ç¾¤ $\Sigma_n$ åŒ…å« $\{1, \ldots, n\}$ çš„æ‰€æœ‰æ’åˆ—ï¼Œå…± $n!$ ä¸ªå…ƒç´ ã€‚æ¯ä¸ªç½®æ¢ $g \in \Sigma_n$ å¯ä»¥è¡¨ç¤ºä¸º $n \times n$ <strong>ç½®æ¢çŸ©é˜µ</strong> $\mathbf{P}$ï¼šæ¯è¡Œæ¯åˆ—æ°å¥½ä¸€ä¸ª 1ï¼Œå…¶ä½™ä¸º 0ã€‚</p>
      <p>ç½®æ¢ $g$ ä½œç”¨åœ¨å›¾ä¸Šæ„å‘³ç€ï¼š</p>
      <ul>
        <li><strong>å¯¹èŠ‚ç‚¹ç‰¹å¾</strong>ï¼šé‡æ’è¡Œ â†’ $\mathbf{X} \mapsto \mathbf{P}\mathbf{X}$</li>
        <li><strong>å¯¹é‚»æ¥çŸ©é˜µ</strong>ï¼šåŒæ—¶é‡æ’è¡Œå’Œåˆ— â†’ $\mathbf{A} \mapsto \mathbf{P}\mathbf{A}\mathbf{P}^\top$</li>
      </ul>
    </div>

    <p>ä¸¤ä¸ªå›¾å¦‚æœé€šè¿‡èŠ‚ç‚¹é‡ç¼–å·å°±èƒ½å˜æˆä¸€æ ·ï¼ˆå³å­˜åœ¨ç½®æ¢çŸ©é˜µ $\mathbf{P}$ ä½¿ $\mathbf{A}' = \mathbf{P}\mathbf{A}\mathbf{P}^\top$ï¼‰ï¼Œå°±ç§°å®ƒä»¬<span class="term">åŒæ„</span>ï¼ˆisomorphicï¼‰ã€‚</p>

    <div class="figure">
      <img src="../assets/ch4_p35_img1.png" alt="Isomorphic graphs">
      <figcaption>åŒæ„çš„ä¸¤ä¸ªå›¾â€”â€”ç»“æ„å®Œå…¨ç›¸åŒï¼Œåªæ˜¯èŠ‚ç‚¹ç¼–å·ä¸åŒã€‚å›¾åŒæ„æ˜¯è¾¹ä¿æŒçš„åŒå°„ã€‚</figcaption>
    </div>

    <h3 id="equivariant-graph">ç½®æ¢ä¸å˜æ€§ä¸ç­‰å˜æ€§</h3>

    <p><strong>é›†åˆ</strong>ï¼ˆsetï¼‰æ˜¯æ²¡æœ‰è¾¹çš„å›¾ï¼ˆ$\mathcal{E} = \emptyset$ï¼‰ã€‚å¯¹é›†åˆä¸Šçš„å‡½æ•°ï¼š</p>

    <div class="math-block">
      $$\text{ç½®æ¢ä¸å˜æ€§ (invariance)ï¼š} \quad f(\mathbf{P}\mathbf{X}) = f(\mathbf{X})$$
      $$\text{ç½®æ¢ç­‰å˜æ€§ (equivariance)ï¼š} \quad \mathbf{F}(\mathbf{P}\mathbf{X}) = \mathbf{P}\mathbf{F}(\mathbf{X})$$
      <div class="math-explain">
        <strong>ä¸å˜æ€§</strong>ï¼šè¾“å‡ºä¸éšèŠ‚ç‚¹æ’åˆ—æ”¹å˜ï¼ˆå¦‚å›¾åˆ†ç±»ï¼‰ã€‚<strong>ç­‰å˜æ€§</strong>ï¼šè¾“å‡ºéšè¾“å…¥ä¸€è‡´åœ°æ’åˆ—ï¼ˆå¦‚é€èŠ‚ç‚¹é¢„æµ‹ï¼‰ã€‚
      </div>
    </div>

    <p>ä¸€ä¸ªç®€å•çš„ç½®æ¢ä¸å˜å‡½æ•°ï¼š</p>

    <div class="math-block">
      $$f(\mathbf{X}) = \phi\left(\sum_{u \in \mathcal{V}} \psi(\mathbf{x}_u)\right)$$
      <div class="math-explain">
        $\psi$ ç‹¬ç«‹ä½œç”¨åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œç„¶å<strong>æ±‚å’Œèšåˆ</strong>ï¼ˆsum ä¸ä¾èµ–é¡ºåºï¼ï¼‰ï¼Œå†é€šè¿‡ $\phi$ å¤„ç†ã€‚è¿™å°±æ˜¯ <strong>Deep Sets</strong> æ¶æ„çš„æ ¸å¿ƒæ€æƒ³ã€‚
      </div>
    </div>

    <p>ä¸€ä¸ªç®€å•çš„ç½®æ¢ç­‰å˜å‡½æ•°ï¼šå…±äº«çš„é€èŠ‚ç‚¹çº¿æ€§å˜æ¢</p>

    <div class="math-block">
      $$\mathbf{F}_\Theta(\mathbf{X}) = \mathbf{X}\Theta, \quad \Theta \in \mathbb{R}^{d \times d'}$$
      <div class="math-explain">
        æ¯ä¸ªèŠ‚ç‚¹ï¼š$\mathbf{h}_u = \Theta^\top \mathbf{x}_u$ã€‚å› ä¸º $\Theta$ åœ¨æ‰€æœ‰èŠ‚ç‚¹é—´<strong>å…±äº«</strong>ï¼Œæ‰€ä»¥ $\mathbf{F}_\Theta(\mathbf{P}\mathbf{X}) = \mathbf{P}\mathbf{X}\Theta = \mathbf{P}\mathbf{F}_\Theta(\mathbf{X})$ âœ“
      </div>
    </div>

    <p>å¯¹äºæœ‰è¾¹çš„å›¾ï¼ˆ$\mathcal{E} \neq \emptyset$ï¼‰ï¼Œä¸å˜æ€§å’Œç­‰å˜æ€§éœ€è¦åŒæ—¶è€ƒè™‘ç‰¹å¾å’Œé‚»æ¥çŸ©é˜µï¼š</p>

    <div class="math-block">
      $$\text{å›¾ä¸å˜æ€§ï¼š} \quad f(\mathbf{P}\mathbf{X}, \mathbf{P}\mathbf{A}\mathbf{P}^\top) = f(\mathbf{X}, \mathbf{A})$$
      $$\text{å›¾ç­‰å˜æ€§ï¼š} \quad \mathbf{F}(\mathbf{P}\mathbf{X}, \mathbf{P}\mathbf{A}\mathbf{P}^\top) = \mathbf{P}\mathbf{F}(\mathbf{X}, \mathbf{A})$$
    </div>

    <h4>å±€éƒ¨ç­‰å˜å‡½æ•°ï¼šGNN çš„åŸºæœ¬æ„é€ </h4>

    <p>èŠ‚ç‚¹ $u$ çš„<span class="term">1-hop é‚»åŸŸ</span>ï¼š</p>

    <div class="math-block">
      $$\mathcal{N}_u = \{v : (u, v) \in \mathcal{E} \text{ or } (v, u) \in \mathcal{E}\}$$
      $$\mathbf{X}_{\mathcal{N}_u} = \{\!\!\{ \mathbf{x}_v : v \in \mathcal{N}_u \}\!\!\}$$
      <div class="math-explain">
        $\{\!\!\{\cdot\}\!\!\}$ è¡¨ç¤º<strong>å¤šé‡é›†</strong>ï¼ˆmultisetï¼‰ï¼Œå…è®¸é‡å¤å…ƒç´ ã€‚é‚»åŸŸç‰¹å¾ä¸æ˜¯ä¸€ä¸ªæœ‰åºçš„åˆ—è¡¨ï¼Œè€Œæ˜¯ä¸€ä¸ªæ— åºçš„å¤šé‡é›†ã€‚
      </div>
    </div>

    <p>GDL è“å›¾ç»™å‡ºäº†æ„é€ ç½®æ¢ç­‰å˜å‡½æ•°çš„é€šç”¨æ–¹æ³•ï¼šå¯¹æ¯ä¸ªèŠ‚ç‚¹åº”ç”¨ä¸€ä¸ª<strong>å±€éƒ¨çš„ã€ç½®æ¢ä¸å˜çš„</strong>å‡½æ•° $\phi$ï¼š</p>

    <div class="math-block">
      $$\mathbf{F}(\mathbf{X}, \mathbf{A}) = \begin{pmatrix} \phi(\mathbf{x}_1, \mathbf{X}_{\mathcal{N}_1}) \\ \phi(\mathbf{x}_2, \mathbf{X}_{\mathcal{N}_2}) \\ \vdots \\ \phi(\mathbf{x}_n, \mathbf{X}_{\mathcal{N}_n}) \end{pmatrix}$$
      <div class="math-explain">
        <strong>å…³é”®æ´å¯Ÿ</strong>ï¼šæ•´ä½“å‡½æ•° $\mathbf{F}$ çš„ç½®æ¢ç­‰å˜æ€§æ¥è‡ªå±€éƒ¨å‡½æ•° $\phi$ çš„ç½®æ¢ä¸å˜æ€§ï¼ˆå› ä¸º $\phi$ çš„è¾“å‡ºä¸ä¾èµ– $\mathcal{N}_u$ ä¸­èŠ‚ç‚¹çš„é¡ºåºï¼‰ã€‚å½“ $\phi$ æ˜¯å•å°„æ—¶ï¼Œè¿™ç­‰ä»·äºä¸€æ­¥ <strong>Weisfeiler-Lehman</strong> å›¾åŒæ„æµ‹è¯•ã€‚
      </div>
    </div>

    <div class="figure">
      <img src="../assets/ch4_p40_img0.png" alt="GNN message passing">
      <figcaption>å›¾ 10ï¼šé€šè¿‡å¯¹æ¯ä¸ªé‚»åŸŸåº”ç”¨ç½®æ¢ä¸å˜å‡½æ•° $\phi$ æ¥æ„é€ å›¾ä¸Šçš„ç½®æ¢ç­‰å˜å‡½æ•°ã€‚$\phi$ ä½œç”¨äºèŠ‚ç‚¹ $b$ çš„ç‰¹å¾ $\mathbf{x}_b$ å’Œé‚»åŸŸç‰¹å¾å¤šé‡é›† $\mathbf{X}_{\mathcal{N}_b} = \{\!\!\{\mathbf{x}_a, \mathbf{x}_b, \mathbf{x}_c, \mathbf{x}_d, \mathbf{x}_e\}\!\!\}$ã€‚</figcaption>
    </div>

    <div class="callout callout-warn">
      <h4>âš ï¸ å›¾ vs é›†åˆ vs ç½‘æ ¼çš„æœ¬è´¨åŒºåˆ«</h4>
      <ul>
        <li><strong>é›†åˆ</strong>ï¼ˆSetï¼‰ï¼šæ— è¾¹ï¼ŒåŸŸå›ºå®šï¼Œåªéœ€å¤„ç†ç‰¹å¾</li>
        <li><strong>å›¾</strong>ï¼ˆGraphï¼‰ï¼šæœ‰è¾¹ï¼Œ<strong>åŸŸæœ¬èº«æ˜¯è¾“å…¥çš„ä¸€éƒ¨åˆ†</strong>ï¼ˆé‚»æ¥ç»“æ„å¯å˜ï¼‰ï¼Œéœ€è¦å‡ ä½•ç¨³å®šæ€§</li>
        <li><strong>ç½‘æ ¼</strong>ï¼ˆGridï¼‰ï¼šæœ‰è¾¹ä¸”<strong>å›ºå®šé¡ºåº</strong>ï¼Œä¸éœ€è¦ç½®æ¢ä¸å˜æ€§</li>
      </ul>
      <p>è¿™ä¸ªåŒºåˆ«æ˜¯ GDL ä¸­åå¤å‡ºç°çš„ä¸»é¢˜ï¼šå›¾çš„åŸŸç»“æ„æ˜¯å˜åŒ–çš„ï¼Œè€Œä¸æ˜¯å›ºå®šçš„ã€‚</p>
    </div>

    <!-- ä»£ç ï¼šæ„å»ºå›¾ -->
    <h3 id="code-graph">ğŸ’» ä»£ç ï¼šç”¨ NetworkX + PyG æ„å»ºå›¾</h3>

    <div class="code-container">
      <div class="code-header">
        <span>Python â€” å›¾çš„åŸºæœ¬æ“ä½œ</span>
        <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      </div>
      <pre><code>import numpy as np
import networkx as nx

# === 1. åˆ›å»ºä¸€ä¸ªç®€å•çš„å›¾ ===
G = nx.karate_club_graph()  # ç»å…¸çš„ç©ºæ‰‹é“ä¿±ä¹éƒ¨å›¾ï¼ˆ34èŠ‚ç‚¹ï¼Œ78è¾¹ï¼‰
print(f"èŠ‚ç‚¹æ•°: {G.number_of_nodes()}, è¾¹æ•°: {G.number_of_edges()}")

# === 2. é‚»æ¥çŸ©é˜µ ===
A = nx.adjacency_matrix(G).toarray()
print(f"é‚»æ¥çŸ©é˜µå½¢çŠ¶: {A.shape}")
print(f"å¯¹ç§°æ€§æ£€æŸ¥: {np.allclose(A, A.T)}")  # True: æ— å‘å›¾

# === 3. åº¦çŸ©é˜µ ===
degrees = np.array([G.degree(i) for i in range(G.number_of_nodes())])
D = np.diag(degrees)
print(f"èŠ‚ç‚¹0çš„åº¦: {degrees[0]}, èŠ‚ç‚¹33çš„åº¦: {degrees[33]}")

# === 4. å›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ ===
L = D - A  # ç»„åˆæ‹‰æ™®æ‹‰æ–¯
eigenvalues = np.linalg.eigvalsh(L)
print(f"æœ€å°ç‰¹å¾å€¼: {eigenvalues[0]:.6f}")  # â‰ˆ 0ï¼ˆå¸¸æ•°å‘é‡ï¼‰
print(f"æ‰€æœ‰ç‰¹å¾å€¼éè´Ÿ: {np.all(eigenvalues >= -1e-10)}")  # True

# === 5. Dirichlet èƒ½é‡ ===
x = np.random.randn(G.number_of_nodes())  # éšæœºä¿¡å·
dirichlet_energy = x @ L @ x
edge_sum = sum((x[u] - x[v])**2 for u, v in G.edges())
print(f"x^T L x = {dirichlet_energy:.4f}")
print(f"Î£(xu-xv)Â² = {edge_sum:.4f}")  # ä¸¤è€…ç›¸ç­‰ï¼

# === 6. éªŒè¯ç½®æ¢ç­‰å˜æ€§ ===
# éšæœºç½®æ¢
perm = np.random.permutation(G.number_of_nodes())
P = np.eye(G.number_of_nodes())[perm]  # ç½®æ¢çŸ©é˜µ

# æ£€éªŒ: P A P^T æ˜¯é‡ç¼–å·åçš„é‚»æ¥çŸ©é˜µ
A_permuted = P @ A @ P.T
# æ„å»ºé‡ç¼–å·çš„å›¾
mapping = {old: new for new, old in enumerate(perm)}
G_permuted = nx.relabel_nodes(G, mapping)
A_relabeled = nx.adjacency_matrix(G_permuted).toarray()
print(f"PAP^T = é‡ç¼–å·é‚»æ¥çŸ©é˜µ: {np.allclose(A_permuted, A_relabeled)}")
</code></pre>
    </div>

    <div class="code-container">
      <div class="code-header">
        <span>Python â€” PyTorch Geometric (PyG) æ„å»ºå›¾</span>
        <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      </div>
      <pre><code>import torch
from torch_geometric.data import Data
from torch_geometric.utils import to_dense_adj, degree

# === ç”¨ PyG æ„å»ºç²’å­ç³»ç»Ÿå›¾ ===
n_particles = 5
# èŠ‚ç‚¹ç‰¹å¾: [ä½ç½®x, ä½ç½®y, é€Ÿåº¦x, é€Ÿåº¦y]
x = torch.tensor([
    [0.0, 0.0, 1.0, 0.5],   # ç²’å­ 0
    [1.0, 0.0, -0.5, 0.3],  # ç²’å­ 1
    [0.5, 1.0, 0.0, -1.0],  # ç²’å­ 2
    [2.0, 1.5, -0.3, 0.1],  # ç²’å­ 3
    [1.5, 0.5, 0.2, -0.4],  # ç²’å­ 4
], dtype=torch.float)

# è¾¹ç´¢å¼•: åŸºäºè·ç¦»é˜ˆå€¼å»ºç«‹çš„è¿æ¥
edge_index = torch.tensor([
    [0, 0, 1, 1, 2, 2, 3, 4],  # æºèŠ‚ç‚¹
    [1, 2, 0, 4, 0, 4, 4, 1],  # ç›®æ ‡èŠ‚ç‚¹
], dtype=torch.long)

# æ„å»º PyG Data å¯¹è±¡
data = Data(x=x, edge_index=edge_index)
print(f"PyG Graph: {data}")
print(f"èŠ‚ç‚¹æ•°: {data.num_nodes}, è¾¹æ•°: {data.num_edges}")

# é‚»æ¥çŸ©é˜µ
A = to_dense_adj(edge_index, max_num_nodes=n_particles).squeeze()
print(f"é‚»æ¥çŸ©é˜µ:\n{A}")

# åº¦
deg = degree(edge_index[0], num_nodes=n_particles)
print(f"å„èŠ‚ç‚¹çš„åº¦: {deg}")

# === éªŒè¯ç½®æ¢ç­‰å˜æ€§ ===
# éšæœºæ’åˆ—èŠ‚ç‚¹
perm = torch.randperm(n_particles)
x_perm = x[perm]
# é‡æ˜ å°„è¾¹ç´¢å¼•
inv_perm = torch.argsort(perm)
edge_index_perm = inv_perm[edge_index]
data_perm = Data(x=x_perm, edge_index=edge_index_perm)
print(f"\næ’åˆ—åçš„å›¾ç»“æ„ä¸åŸå›¾åŒæ„ âœ“")
</code></pre>
    </div>

    <div class="callout callout-robot" id="robot-graph">
      <h4>ğŸ¤– PhysRobot å…³è”ï¼šç²’å­ç³»ç»Ÿå°±æ˜¯å›¾ï¼</h4>
      <p>åœ¨ GNS (Graph Network Simulator) ä¸­ï¼Œç‰©ç†ç³»ç»Ÿè¢«ç¼–ç ä¸ºå›¾ï¼š</p>
      <ul>
        <li><strong>èŠ‚ç‚¹</strong> = ç²’å­ï¼Œç‰¹å¾åŒ…æ‹¬ä½ç½® $\mathbf{p}_i$ã€é€Ÿåº¦ $\dot{\mathbf{p}}_i$ã€ç‰©ç†å±æ€§ï¼ˆè´¨é‡ã€ææ–™ç±»å‹ç­‰ï¼‰</li>
        <li><strong>è¾¹</strong> = åŸºäºè·ç¦»é˜ˆå€¼ $r$ çš„è¿‘é‚»å…³ç³»ï¼š$(i,j) \in \mathcal{E}$ å½“ $\|\mathbf{p}_i - \mathbf{p}_j\| < r$</li>
        <li><strong>GNN æ¶ˆæ¯ä¼ é€’</strong> = åº”ç”¨å±€éƒ¨å‡½æ•° $\phi$ åˆ°æ¯ä¸ªé‚»åŸŸ</li>
      </ul>
      <p>å…³é”®çº¦æŸï¼šç²’å­ç¼–å·æ˜¯<strong>ä»»æ„çš„</strong>â€”â€”æ‰“ä¹±ç¼–å·ä¸åº”è¯¥æ”¹å˜ç‰©ç†ç»“æœã€‚è¿™å°±æ˜¯ç½®æ¢ç­‰å˜æ€§çš„<strong>ç‰©ç†åŠ¨æœº</strong>ï¼</p>
    </div>

    <div class="callout callout-exercise">
      <h4>ğŸ“ ç»ƒä¹  4.1</h4>
      <ol>
        <li><strong>è¯æ˜</strong>ï¼šå¯¹äºå¯¹ç§°é‚»æ¥çŸ©é˜µ $\mathbf{A}$ï¼Œ$\mathbf{L} = \mathbf{D} - \mathbf{A}$ çš„æœ€å°ç‰¹å¾å€¼ä¸º 0ï¼Œå¯¹åº”çš„ç‰¹å¾å‘é‡æ˜¯å¸¸æ•°å‘é‡ $\mathbf{1}$ã€‚</li>
        <li><strong>è®¡ç®—</strong>ï¼šå¯¹äºè·¯å¾„å›¾ $1-2-3-4$ï¼ˆ4 ä¸ªèŠ‚ç‚¹çš„é“¾ï¼‰ï¼Œå†™å‡º $\mathbf{A}$ã€$\mathbf{D}$ã€$\mathbf{L}$ï¼Œå¹¶è®¡ç®— $\mathbf{L}$ çš„ç‰¹å¾å€¼ã€‚</li>
        <li><strong>ç¼–ç¨‹</strong>ï¼šç”¨ NetworkX ç”Ÿæˆä¸€ä¸ªéšæœºå›¾ï¼ˆErdÅ‘sâ€“RÃ©nyi æ¨¡å‹ï¼Œ$n=100, p=0.1$ï¼‰ï¼Œè®¡ç®—æ‹‰æ™®æ‹‰æ–¯çš„å‰ 10 ä¸ªç‰¹å¾å€¼ï¼Œç»˜åˆ¶å‰ 4 ä¸ªç‰¹å¾å‘é‡ã€‚</li>
        <li><strong>æ€è€ƒ</strong>ï¼šä¸ºä»€ä¹ˆ GNN ä¸­çš„æ¶ˆæ¯ä¼ é€’å‡½æ•° $\phi$ å¿…é¡»æ˜¯ç½®æ¢ä¸å˜çš„ï¼Ÿå¦‚æœ $\phi$ ä¾èµ–é‚»å±…çš„é¡ºåºï¼Œä¼šå‡ºä»€ä¹ˆé—®é¢˜ï¼Ÿ</li>
      </ol>
    </div>


    <!-- ============================================================ -->
    <!-- SECTION 4.2: GRIDS AND EUCLIDEAN SPACES -->
    <!-- ============================================================ -->
    <h2 id="sec4-2">4.2 ç½‘æ ¼å’Œæ¬§å‡ é‡Œå¾—ç©ºé—´ (Grids and Euclidean Spaces)</h2>

    <div class="bilingual">
      <div class="zh">
        <p>æ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†å’Œè¯­éŸ³è¯†åˆ«ä¸­çš„å·¨å¤§å½±å“ï¼Œéƒ½æœ‰ä¸€ä¸ª<strong>å‡ ä½•å…¬åˆ†æ¯</strong>ï¼šåº•å±‚çš„<span class="term">ç½‘æ ¼ç»“æ„</span>ã€‚ç½‘æ ¼æ˜¯å›¾çš„ç‰¹ä¾‹ï¼Œä½†ç”±äºèŠ‚ç‚¹æœ‰å›ºå®šé¡ºåºï¼Œä¸å†éœ€è¦ç½®æ¢ä¸å˜æ€§â€”â€”å–è€Œä»£ä¹‹çš„æ˜¯æ›´å¼ºçš„å…ˆéªŒï¼š<strong>å¹³ç§»ä¸å˜æ€§</strong>ã€‚</p>
      </div>
      <div class="en">
        The impact of deep learning was particularly dramatic in computer vision, NLP, and speech recognition â€” all sharing a geometric common denominator: an underlying grid structure. Grids are a particular case of graphs, but with a stronger geometric prior: translation invariance.
      </div>
    </div>

    <h3 id="translation-group">å¹³ç§»ç¾¤ $T(d)$</h3>

    <p>ä¸€ç»´ç½‘æ ¼å¯ä»¥çœ‹ä½œ<strong>ç¯å›¾</strong>ï¼ˆring graphï¼‰ï¼šèŠ‚ç‚¹ $0, 1, \ldots, n-1$ï¼ˆæ¨¡ $n$ï¼‰ï¼Œé‚»æ¥å…³ç³»ä¸º $a_{u, u+1 \bmod n} = 1$ã€‚</p>

    <div class="callout callout-info">
      <h4>ğŸ’¡ ç½‘æ ¼ vs æ™®é€šå›¾çš„ä¸¤ä¸ªå…³é”®åŒºåˆ«</h4>
      <ol>
        <li><strong>å‡åŒ€è¿æ¥</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹æœ‰<strong>ç›¸åŒ</strong>çš„è¿æ¥æ¨¡å¼ï¼ˆéƒ½æœ‰å·¦é‚»å±…å’Œå³é‚»å±…ï¼‰ï¼Œç»“æ„ä¸Šä¸å¯åŒºåˆ† â†’ é½æ€§ç©ºé—´</li>
        <li><strong>é‚»å±…æœ‰å›ºå®šé¡ºåº</strong>ï¼š$u-1$ æ˜¯"å·¦é‚»å±…"ï¼Œ$u+1$ æ˜¯"å³é‚»å±…"â€”â€”è¿™åœ¨ä¸€èˆ¬å›¾ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼</li>
      </ol>
      <p>è¿™æ„å‘³ç€èšåˆå‡½æ•° $\phi(x_{u-1}, x_u, x_{u+1})$ <strong>ä¸éœ€è¦</strong>å¯¹é‚»å±…ç½®æ¢ä¸å˜ã€‚</p>
    </div>

    <h3 id="circulant">å¾ªç¯çŸ©é˜µä¸ç¦»æ•£å·ç§¯</h3>

    <p>é€‰æ‹©çº¿æ€§çš„ $\phi(x_{u-1}, x_u, x_{u+1}) = \theta_{-1} x_{u-1} + \theta_0 x_u + \theta_1 x_{u+1}$ï¼Œæ•´ä¸ªå˜æ¢å¯ä»¥å†™æˆçŸ©é˜µä¹˜æ³•ï¼š</p>

    <div class="math-block">
      $$\mathbf{F}(\mathbf{X}) = \begin{pmatrix} \theta_0 & \theta_1 & & & \theta_{-1} \\ \theta_{-1} & \theta_0 & \theta_1 & & \\ & \ddots & \ddots & \ddots & \\ & & \theta_{-1} & \theta_0 & \theta_1 \\ \theta_1 & & & \theta_{-1} & \theta_0 \end{pmatrix} \begin{pmatrix} x_0 \\ x_1 \\ \vdots \\ x_{n-2} \\ x_{n-1} \end{pmatrix}$$
      <div class="math-explain">
        è¿™ç§æ¯æ¡å¯¹è§’çº¿ä¸Šå…ƒç´ ç›¸åŒçš„çŸ©é˜µå«<span class="term">å¾ªç¯çŸ©é˜µ</span>ï¼ˆcirculant matrixï¼‰ã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå¯¹è§’çº¿å…ƒç´ ç›¸åŒçš„æ€§è´¨è¢«ç§°ä¸º"æƒé‡å…±äº«"ï¼ˆweight sharingï¼‰ã€‚
      </div>
    </div>

    <p>æ›´ä¸€èˆ¬åœ°ï¼Œç»™å®šå‘é‡ $\boldsymbol{\theta} = (\theta_0, \ldots, \theta_{n-1})$ï¼Œå¾ªç¯çŸ©é˜µ $\mathbf{C}(\boldsymbol{\theta})$ å®šä¹‰äº†<span class="term">ç¦»æ•£å·ç§¯</span>ï¼š</p>

    <div class="math-block">
      $$(\mathbf{x} \star \boldsymbol{\theta})_u = \sum_{v=0}^{n-1} x_{v \bmod n} \, \theta_{u-v \bmod n} = \mathbf{C}(\boldsymbol{\theta})\mathbf{x}$$
      <div class="math-explain">
        å·ç§¯ = å¾ªç¯çŸ©é˜µä¸å‘é‡çš„ä¹˜ç§¯ã€‚$\boldsymbol{\theta}$ åœ¨ä¿¡å·å¤„ç†ä¸­ç§°ä¸º"æ»¤æ³¢å™¨"ï¼ˆfilterï¼‰ï¼Œåœ¨ CNN ä¸­æ˜¯<strong>å¯å­¦ä¹ å‚æ•°</strong>ã€‚
      </div>
    </div>

    <h3 id="convolution-shift">å·ç§¯çš„æœ¬è´¨ï¼šå¹³ç§»ç­‰å˜çš„çº¿æ€§æ“ä½œ</h3>

    <p>é€‰æ‹© $\boldsymbol{\theta} = (0, 1, 0, \ldots, 0)^\top$ å¾—åˆ°<span class="term">ä½ç§»ç®—å­</span>ï¼ˆshift operatorï¼‰$\mathbf{S}$â€”â€”å°†å‘é‡å¾ªç¯å³ç§»ä¸€ä½ã€‚</p>

    <div class="math-block">
      $$\mathbf{S}\mathbf{C}(\boldsymbol{\theta})\mathbf{x} = \mathbf{C}(\boldsymbol{\theta})\mathbf{S}\mathbf{x}$$
      <div class="math-explain">
        å¾ªç¯çŸ©é˜µ<strong>ç›¸äº’äº¤æ¢</strong>ï¼š$\mathbf{C}(\boldsymbol{\theta})\mathbf{C}(\boldsymbol{\eta}) = \mathbf{C}(\boldsymbol{\eta})\mathbf{C}(\boldsymbol{\theta})$ã€‚ç‰¹åˆ«åœ°ï¼Œæ¯ä¸ªå¾ªç¯çŸ©é˜µéƒ½ä¸ä½ç§» $\mathbf{S}$ äº¤æ¢ã€‚<br>
        <strong>æ ¸å¿ƒç»“è®º</strong>ï¼šå·ç§¯ $\Leftrightarrow$ å¹³ç§»ç­‰å˜çš„çº¿æ€§æ“ä½œã€‚è¿™æ˜¯ <strong>"å·ç§¯ä»å¯¹ç§°æ€§ç¬¬ä¸€æ€§åŸç†ä¸­æ¶Œç°"</strong> çš„ç²¾å½©ä¾‹è¯ï¼
      </div>
    </div>

    <div class="callout callout-math">
      <h4>ğŸ”® ä¸ºä»€ä¹ˆå¹³ç§»ç¾¤æ˜¯ Abel ç¾¤å¾ˆé‡è¦ï¼Ÿ</h4>
      <p>å¾ªç¯çŸ©é˜µçš„äº¤æ¢æ€§ï¼ˆcommutativityï¼‰ç›´æ¥æ¥è‡ªå¹³ç§»ç¾¤æ˜¯<strong>äº¤æ¢ç¾¤</strong>ï¼ˆAbelian groupï¼‰ï¼š$S_u \circ S_v = S_{u+v} = S_v \circ S_u$ã€‚</p>
      <p>åè¿‡æ¥ï¼Œä¸€ä¸ªçŸ©é˜µæ˜¯å¾ªç¯çš„ï¼Œå½“ä¸”ä»…å½“å®ƒä¸ä½ç§» $\mathbf{S}$ äº¤æ¢ã€‚è¿™è®©æˆ‘ä»¬å¯ä»¥<strong>å®šä¹‰</strong>å·ç§¯ä¸ºå¹³ç§»ç­‰å˜çš„çº¿æ€§æ“ä½œâ€”â€”ä¸éœ€è¦å…ˆ"å‘æ˜"å·ç§¯ï¼Œå®ƒè‡ªç„¶ä»å¯¹ç§°æ€§ä¸­æ¶Œç°ã€‚</p>
    </div>

    <h3 id="fourier-discrete">ä»å¯¹ç§°æ€§æ¨å¯¼ç¦»æ•£å‚…é‡Œå¶å˜æ¢ (DFT)</h3>

    <p>æ‰€æœ‰å¾ªç¯çŸ©é˜µç›¸äº’äº¤æ¢ â†’ å¯ä»¥<strong>è”åˆå¯¹è§’åŒ–</strong>ï¼ˆjointly diagonalisableï¼‰â†’ å­˜åœ¨<strong>å…¬å…±ç‰¹å¾åŸº</strong>ã€‚</p>

    <p>é€‰æ‹©ä½ç§»ç®—å­ $\mathbf{S}$ æ¥è®¡ç®—ç‰¹å¾å‘é‡ï¼ˆå› ä¸ºå®ƒæœ€ç®€å•ï¼‰ã€‚$\mathbf{S}$ çš„ç‰¹å¾å‘é‡æ°å¥½æ˜¯<span class="term">ç¦»æ•£å‚…é‡Œå¶åŸº</span>ï¼š</p>

    <div class="math-block">
      $$\boldsymbol{\phi}_k = \frac{1}{\sqrt{n}} \left(1, e^{\frac{2\pi i k}{n}}, e^{\frac{4\pi i k}{n}}, \ldots, e^{\frac{2\pi i (n-1) k}{n}}\right)^\top, \quad k = 0, 1, \ldots, n-1$$
      <div class="math-explain">
        æ’åˆ—æˆ $n \times n$ å‚…é‡Œå¶çŸ©é˜µ $\boldsymbol{\Phi} = (\boldsymbol{\phi}_0, \ldots, \boldsymbol{\phi}_{n-1})$ã€‚ä¹˜ä»¥ $\boldsymbol{\Phi}^*$ï¼ˆå…±è½­è½¬ç½®ï¼‰= DFTï¼Œä¹˜ä»¥ $\boldsymbol{\Phi}$ = é€† DFTã€‚
      </div>
    </div>

    <div class="math-block">
      $$\hat{x}_k = \frac{1}{\sqrt{n}} \sum_{u=0}^{n-1} x_u \, e^{-\frac{2\pi i k u}{n}} \quad \longleftrightarrow \quad x_u = \frac{1}{\sqrt{n}} \sum_{k=0}^{n-1} \hat{x}_k \, e^{+\frac{2\pi i k u}{n}}$$
      <div class="math-explain">
        å·¦ï¼šæ­£å˜æ¢ï¼ˆæ—¶åŸŸâ†’é¢‘åŸŸï¼‰ã€‚å³ï¼šé€†å˜æ¢ï¼ˆé¢‘åŸŸâ†’æ—¶åŸŸï¼‰ã€‚$\hat{x}_k$ æ˜¯ä¿¡å· $\mathbf{x}$ åœ¨é¢‘ç‡ $k$ ä¸Šçš„åˆ†é‡ã€‚
      </div>
    </div>

    <h4>å·ç§¯å®šç† (Convolution Theorem)</h4>

    <p>æ‰€æœ‰å¾ªç¯çŸ©é˜µè¢«å‚…é‡Œå¶å˜æ¢å¯¹è§’åŒ–ï¼Œä¸”ä»…åœ¨ç‰¹å¾å€¼ä¸Šä¸åŒï¼š</p>

    <div class="math-block">
      $$\mathbf{C}(\boldsymbol{\theta})\mathbf{x} = \boldsymbol{\Phi} \begin{pmatrix} \hat{\theta}_0 & & \\ & \ddots & \\ & & \hat{\theta}_{n-1} \end{pmatrix} \boldsymbol{\Phi}^* \mathbf{x} = \boldsymbol{\Phi}(\hat{\boldsymbol{\theta}} \odot \hat{\mathbf{x}})$$
      <div class="math-explain">
        <strong>å·ç§¯å®šç†</strong>ï¼šæ—¶åŸŸçš„å·ç§¯ = é¢‘åŸŸçš„é€å…ƒç´ ä¹˜æ³•ã€‚è¿™å°±æ˜¯ FFT åŠ é€Ÿå·ç§¯çš„ç†è®ºåŸºç¡€ï¼šç”¨ $O(n \log n)$ çš„ FFT æ›¿ä»£ $O(n^2)$ çš„ç›´æ¥å·ç§¯ã€‚
      </div>
    </div>

    <div class="callout callout-warn">
      <h4>âš ï¸ å›¾å‚…é‡Œå¶å˜æ¢çš„å±€é™</h4>
      <p>åŒæ ·çš„æ€è·¯å¯ä»¥æ¨å¹¿åˆ°å›¾ï¼šç”¨é‚»æ¥çŸ©é˜µï¼ˆæˆ–æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µï¼‰çš„ç‰¹å¾å‘é‡ä½œä¸º"å›¾å‚…é‡Œå¶åŸº"ã€‚ä½†æœ‰ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼š</p>
      <ol>
        <li><strong>åŸºä¾èµ–å›¾ç»“æ„</strong>ï¼šä¸åŒå›¾æœ‰ä¸åŒçš„å‚…é‡Œå¶åŸºï¼Œæ— æ³•ç›´æ¥æ¯”è¾ƒâ€”â€”å¯¼è‡´æ³›åŒ–èƒ½åŠ›å·®</li>
        <li><strong>é¢‘ç‡ç»“æ„æ˜¯ä¸€ç»´çš„</strong>ï¼šå›¾çš„ç‰¹å¾å€¼åªæœ‰å¤§å°ï¼ˆmagnitudeï¼‰ï¼Œæ²¡æœ‰æ–¹å‘â€”â€”å›¾æ»¤æ³¢å™¨å¤©ç„¶æ˜¯<strong>å„å‘åŒæ€§çš„</strong>ï¼ˆisotropicï¼‰</li>
      </ol>
    </div>

    <h3 id="fourier-continuous">è¿ç»­å‚…é‡Œå¶å˜æ¢</h3>

    <p>åœ¨è¿ç»­åŸŸ $\Omega = \mathbb{R}$ ä¸Šï¼Œå¹³ç§»ç®—å­ $(S_v f)(u) = f(u - v)$ ä½œç”¨åœ¨å‚…é‡Œå¶åŸºå‡½æ•° $\phi_\xi(u) = e^{i\xi u}$ ä¸Šï¼š</p>

    <div class="math-block">
      $$S_v e^{i\xi u} = e^{i\xi(u-v)} = e^{-i\xi v} e^{i\xi u}$$
      <div class="math-explain">
        $\phi_\xi$ æ˜¯ $S_v$ çš„ç‰¹å¾å‡½æ•°ï¼Œç‰¹å¾å€¼ä¸º $e^{-i\xi v}$ï¼ˆå¤æ•°ï¼Œæ¨¡ä¸º 1ï¼‰ã€‚ç”±äºè°±æ˜¯ç®€å•çš„ï¼ˆsimple spectrumï¼‰ï¼Œ$e^{i\xi u}$ æ˜¯å”¯ä¸€çš„ç‰¹å¾å‡½æ•°ï¼ˆåˆ°å¸¸æ•°å€æ•°ä¸ºæ­¢ï¼‰ã€‚
      </div>
    </div>

    <p>ç”±æ­¤å¾—åˆ°æ ¸å¿ƒå®šç†ï¼š<strong>æ¯ä¸ªçº¿æ€§å¹³ç§»ç­‰å˜ç®—å­éƒ½æ˜¯å·ç§¯</strong>ã€‚</p>

    <div class="math-block">
      $$(Cx)(u) = \int_{-\infty}^{+\infty} p_C(v) \, x(u-v) \, dv = (x \star p_C)(u)$$
      <div class="math-explain">
        $C$ åœ¨é¢‘åŸŸè¡¨ç¤ºä¸ºä¹˜ä»¥ä¼ é€’å‡½æ•° $\hat{p}_C(\xi)$ã€‚è¿™æ˜¯ Stone å®šç†åœ¨å¹³ç§»ç¾¤ä¸Šçš„ç‰¹ä¾‹ã€‚
      </div>
    </div>

    <!-- ä»£ç ï¼š2D å·ç§¯ -->
    <h3 id="code-conv">ğŸ’» ä»£ç ï¼šå·ç§¯çš„ç¾¤è®ºè§†è§’</h3>

    <div class="code-container">
      <div class="code-header">
        <span>Python â€” å¾ªç¯çŸ©é˜µä¸å·ç§¯</span>
        <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      </div>
      <pre><code>import numpy as np
from scipy.linalg import circulant

n = 8
# åˆ›å»ºæ»¤æ³¢å™¨ï¼ˆåªæœ‰3ä¸ªéé›¶å€¼ï¼Œæ¨¡æ‹Ÿå±€éƒ¨å·ç§¯æ ¸ï¼‰
theta = np.zeros(n)
theta[0], theta[1], theta[-1] = 0.5, 0.25, 0.25  # [ä¸­å¿ƒ, å³é‚», å·¦é‚»]

# å¾ªç¯çŸ©é˜µ
C = circulant(theta)
print("å¾ªç¯çŸ©é˜µ C(Î¸):")
print(np.round(C, 2))

# ä¿¡å·
x = np.random.randn(n)

# æ–¹æ³• 1: ç›´æ¥çŸ©é˜µä¹˜æ³•
y1 = C @ x

# æ–¹æ³• 2: FFT åŠ é€Ÿï¼ˆå·ç§¯å®šç†ï¼‰
x_hat = np.fft.fft(x)
theta_hat = np.fft.fft(theta)
y2 = np.real(np.fft.ifft(theta_hat * x_hat))

print(f"\nç›´æ¥å·ç§¯ä¸ FFT å·ç§¯ä¸€è‡´: {np.allclose(y1, y2)}")

# éªŒè¯ä½ç§»ç­‰å˜æ€§
S = circulant(np.roll(np.eye(n)[0], 1))  # ä½ç§»ç®—å­
print(f"SÂ·C(Î¸)Â·x == C(Î¸)Â·SÂ·x: {np.allclose(S @ C @ x, C @ S @ x)}")
</code></pre>
    </div>

    <div class="code-container">
      <div class="code-header">
        <span>Python â€” 2D å·ç§¯çš„å‡ ä½•è§†è§’</span>
        <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      </div>
      <pre><code>import numpy as np
import torch
import torch.nn.functional as F

# === 2D ç½‘æ ¼ä¸Šçš„å·ç§¯ ===
# åˆ›å»º 8x8 çš„"å›¾åƒ"
H, W = 8, 8
image = torch.randn(1, 1, H, W)  # [batch, channel, height, width]

# 3x3 å·ç§¯æ ¸
kernel = torch.tensor([[[[0.0, 1.0, 0.0],
                          [1.0, -4.0, 1.0],
                          [0.0, 1.0, 0.0]]]])  # æ‹‰æ™®æ‹‰æ–¯ç®—å­ï¼

# åº”ç”¨å·ç§¯
output = F.conv2d(image, kernel, padding=1)  # padding=1 ä¿æŒå°ºå¯¸

# === éªŒè¯å¹³ç§»ç­‰å˜æ€§ ===
# å¹³ç§»å›¾åƒï¼ˆå¾ªç¯ä½ç§»ï¼‰
shifted_image = torch.roll(image, shifts=(2, 3), dims=(2, 3))

# å…ˆå·ç§¯å†å¹³ç§»
conv_then_shift = torch.roll(F.conv2d(image, kernel, padding=1), 
                              shifts=(2, 3), dims=(2, 3))
# å…ˆå¹³ç§»å†å·ç§¯
shift_then_conv = F.conv2d(shifted_image, kernel, padding=1)

# å¯¹äºæœ‰ padding çš„è¾¹ç•Œï¼Œè¿‘ä¼¼ç­‰å˜ï¼ˆå†…éƒ¨ä¸¥æ ¼ç­‰å˜ï¼‰
interior = slice(3, -3)
print(f"å¹³ç§»ç­‰å˜æ€§ï¼ˆå†…éƒ¨åŒºåŸŸï¼‰: "
      f"{torch.allclose(conv_then_shift[:,:,interior,interior], "
      f"shift_then_conv[:,:,interior,interior], atol=1e-5)}")

# === å¯è§†åŒ–ï¼šå·ç§¯æ ¸å°±æ˜¯æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„å±€éƒ¨ ===
print("\n3x3 æ‹‰æ™®æ‹‰æ–¯æ ¸ (ç¦»æ•£ Laplacian):")
print(kernel.squeeze().numpy())
print("æ³¨æ„ï¼šè¿™æ­£æ˜¯è¿ç»­æ‹‰æ™®æ‹‰æ–¯ âˆ‡Â² çš„æœ‰é™å·®åˆ†è¿‘ä¼¼ï¼")
print("ä¸­å¿ƒå€¼ -4 = å‡å»4ä¸ªé‚»å±…çš„è´¡çŒ® = D - A åœ¨ç½‘æ ¼ä¸Šçš„å±€éƒ¨å½¢å¼")
</code></pre>
    </div>

    <div class="callout callout-exercise">
      <h4>ğŸ“ ç»ƒä¹  4.2</h4>
      <ol>
        <li><strong>è¯æ˜</strong>ï¼š$n \times n$ å¾ªç¯çŸ©é˜µ $\mathbf{C}(\boldsymbol{\theta})$ çš„ç‰¹å¾å€¼æ˜¯ $\hat{\theta}_k = \sum_{j=0}^{n-1} \theta_j e^{-2\pi i jk/n}$ï¼Œå³ $\boldsymbol{\theta}$ çš„ DFTã€‚</li>
        <li><strong>è®¡ç®—</strong>ï¼šå†™å‡º $4 \times 4$ çš„å‚…é‡Œå¶çŸ©é˜µ $\boldsymbol{\Phi}$ï¼ŒéªŒè¯ $\boldsymbol{\Phi}^*\boldsymbol{\Phi} = \mathbf{I}$ã€‚</li>
        <li><strong>ç¼–ç¨‹</strong>ï¼šç”Ÿæˆä¸€ä¸ª 1D ä¿¡å·ï¼Œåˆ†åˆ«ç”¨ç›´æ¥å·ç§¯å’Œ FFT è®¡ç®—å·ç§¯ï¼Œæ¯”è¾ƒæ—¶é—´å¤æ‚åº¦ï¼ˆè¯• $n = 10^4$ å’Œ $n = 10^6$ï¼‰ã€‚</li>
        <li><strong>æ€è€ƒ</strong>ï¼šä¸ºä»€ä¹ˆ CNN ç”¨çš„æ˜¯"å±€éƒ¨"å·ç§¯æ ¸ï¼ˆå¦‚ $3 \times 3$ï¼‰è€Œä¸æ˜¯å…¨å±€æ ¸ï¼Ÿä» GDL è“å›¾çš„å°ºåº¦åˆ†ç¦»å…ˆéªŒè§£é‡Šã€‚</li>
      </ol>
    </div>


    <!-- ============================================================ -->
    <!-- SECTION 4.3: GROUPS AND HOMOGENEOUS SPACES -->
    <!-- ============================================================ -->
    <h2 id="sec4-3">4.3 ç¾¤å’Œé½æ€§ç©ºé—´ (Groups and Homogeneous Spaces)</h2>

    <div class="bilingual">
      <div class="zh">
        <p>ä¸Šä¸€èŠ‚æ­ç¤ºäº†ä½ç§»å’Œå·ç§¯çš„ç´§å¯†è”ç³»ã€‚è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ›´å®å¤§æ•…äº‹çš„ä¸€éƒ¨åˆ†ï¼šå·ç§¯å’Œå‚…é‡Œå¶å˜æ¢å¯ä»¥åœ¨<strong>ä»»ä½•å¯ä»¥æ±‚å’Œ/ç§¯åˆ†çš„å¯¹ç§°ç¾¤</strong>ä¸Šå®šä¹‰ã€‚</p>
      </div>
      <div class="en">
        Both convolution and the Fourier transform can be defined for any group of symmetries that we can sum or integrate over. This is part of a far larger story.
      </div>
    </div>

    <h3 id="group-conv">ç¾¤å·ç§¯ (Group Convolution)</h3>

    <p>å›å¿†æ¬§å‡ é‡Œå¾—å·ç§¯å¯ä»¥ç†è§£ä¸º<strong>æ¨¡å¼åŒ¹é…</strong>ï¼šå°†æ»¤æ³¢å™¨çš„å¹³ç§»å‰¯æœ¬ä¸è¾“å…¥ä¿¡å·åšå†…ç§¯ã€‚</p>

    <div class="math-block">
      $$(x \star \theta)(u) = \langle x, S_u \theta \rangle = \int_{\mathbb{R}} x(v) \, \theta(u + v) \, dv$$
      <div class="math-explain">
        $u$ æ—¢æ˜¯åŸŸ $\Omega = \mathbb{R}$ ä¸Šçš„ç‚¹ï¼Œåˆæ˜¯å¹³ç§»ç¾¤ $G = \mathbb{R}$ çš„å…ƒç´ ã€‚å¯¹äºå¹³ç§»ç¾¤ï¼Œ$G = \Omega$ã€‚
      </div>
    </div>

    <p>å°†å¹³ç§»ç¾¤æ›¿æ¢ä¸ºä¸€èˆ¬ç¾¤ $G$ ä½œç”¨åœ¨åŸŸ $\Omega$ ä¸Šï¼Œç¾¤çš„ä½œç”¨è¯±å¯¼è¡¨ç¤º $\rho(g)x(u) = x(g^{-1}u)$ï¼Œå®šä¹‰<span class="term">ç¾¤å·ç§¯</span>ï¼š</p>

    <div class="math-block">
      $$(x \star \theta)(g) = \langle x, \rho(g)\theta \rangle = \int_\Omega x(u) \, \theta(g^{-1}u) \, du$$
      <div class="math-explain">
        <strong>å…³é”®ç‚¹</strong>ï¼š$x \star \theta$ çš„å€¼å®šä¹‰åœ¨<strong>ç¾¤å…ƒç´ </strong> $g \in G$ ä¸Šï¼Œè€ŒéåŸŸ $\Omega$ ä¸Šï¼è¿™æ„å‘³ç€ä¸‹ä¸€å±‚æ“ä½œçš„è¾“å…¥æ˜¯å®šä¹‰åœ¨ $G$ ä¸Šçš„ä¿¡å·ã€‚
      </div>
    </div>

    <div class="callout callout-math">
      <h4>ğŸ”® ç¾¤å·ç§¯çš„ç­‰å˜æ€§è¯æ˜</h4>
      <p>å…³é”®ç­‰å¼ï¼š$\langle x, \rho(g)\theta \rangle = \langle \rho(g^{-1})x, \theta \rangle$ï¼ˆåŒ¹é…ä¿¡å·ä¸å˜æ¢çš„æ»¤æ³¢å™¨ = åŒ¹é…é€†å˜æ¢çš„ä¿¡å·ä¸åŸæ»¤æ³¢å™¨ï¼‰ã€‚</p>
      <p>ç”±æ­¤ï¼š</p>
      $$(\rho(h)x \star \theta)(g) = \langle \rho(h)x, \rho(g)\theta \rangle = \langle x, \rho(h^{-1}g)\theta \rangle = (x \star \theta)(h^{-1}g) = \rho(h)(x \star \theta)(g)$$
      <p>ç¾¤å·ç§¯æ˜¯ $G$-ç­‰å˜çš„ âœ“</p>
    </div>

    <h3 id="spherical-conv">çƒé¢å·ç§¯</h3>

    <p>è€ƒè™‘äºŒç»´çƒé¢ $\Omega = S^2$ï¼Œæ—‹è½¬ç¾¤ $G = \text{SO}(3)$ã€‚ç‚¹ç”¨å•ä½å‘é‡ $\mathbf{u}: \|\mathbf{u}\| = 1$ è¡¨ç¤ºï¼Œç¾¤ä½œç”¨æ˜¯ $3 \times 3$ æ­£äº¤çŸ©é˜µ $\mathbf{R}$ï¼ˆ$\det(\mathbf{R}) = 1$ï¼‰ã€‚</p>

    <div class="math-block">
      $$(x \star \theta)(\mathbf{R}) = \int_{S^2} x(\mathbf{u}) \, \theta(\mathbf{R}^{-1}\mathbf{u}) \, d\mathbf{u}$$
      <div class="math-explain">
        çƒé¢å·ç§¯æ˜¯ä¿¡å·ä¸æ—‹è½¬æ»¤æ³¢å™¨çš„å†…ç§¯ã€‚ç»“æœæ˜¯å®šä¹‰åœ¨ $\text{SO}(3)$ ä¸Šçš„å‡½æ•°â€”â€”è¿™å¾ˆé‡è¦ï¼
      </div>
    </div>

    <div class="figure">
      <img src="../assets/ch4_p46_img0.png" alt="SO(3) action on S2">
      <figcaption>SO(3) ç¾¤åœ¨ $S^2$ ä¸Šçš„ä½œç”¨ã€‚ä¸‰ç§æ—‹è½¬æ˜¯å¯èƒ½çš„ï¼ˆç»•ä¸‰ä¸ªè½´ï¼‰ï¼›SO(3) æ˜¯ä¸€ä¸ª<strong>ä¸‰ç»´æµå½¢</strong>ï¼Œè€Œ $S^2$ æ˜¯äºŒç»´æµå½¢ã€‚</figcaption>
    </div>

    <div class="callout callout-warn">
      <h4>âš ï¸ ç¾¤ â‰  åŸŸï¼šæ·±å±‚ä¹‹é—´çš„å˜åŒ–</h4>
      <p>$S^2$ ä¸Šçš„å·ç§¯è¾“å‡ºæ˜¯ $\text{SO}(3)$ ä¸Šçš„å‡½æ•°ã€‚å› æ­¤ç¬¬äºŒå±‚ä¸èƒ½å†å¯¹ $S^2$ åšå·ç§¯ï¼Œè€Œæ˜¯å¯¹ $\text{SO}(3)$ åšå·ç§¯ï¼š</p>
      $$((x \star \theta) \star \phi)(\mathbf{R}) = \int_{\text{SO}(3)} (x \star \theta)(\mathbf{Q}) \, \phi(\mathbf{R}^{-1}\mathbf{Q}) \, d\mathbf{Q}$$
      <p>$G$ ä½œç”¨åœ¨è‡ªèº«ä¸Šçš„è¡¨ç¤º $\rho(g)x(h) = x(g^{-1}h)$ å«åš<strong>æ­£åˆ™è¡¨ç¤º</strong>ï¼ˆregular representationï¼‰ã€‚</p>
    </div>

    <h3 id="lie-groups">æç¾¤åŸºç¡€ï¼šSO(2), SO(3), SE(3)</h3>

    <div class="blueprint">
      <h4>å…³é”®æç¾¤</h4>
      <table>
        <tr><th>ç¾¤</th><th>ç»´åº¦</th><th>å…ƒç´ </th><th>ç‰©ç†å«ä¹‰</th></tr>
        <tr><td>$\text{SO}(2)$</td><td>1</td><td>$2\times 2$ æ—‹è½¬çŸ©é˜µ $\begin{pmatrix}\cos\alpha & -\sin\alpha \\ \sin\alpha & \cos\alpha\end{pmatrix}$</td><td>å¹³é¢æ—‹è½¬</td></tr>
        <tr><td>$\text{SO}(3)$</td><td>3</td><td>$3\times 3$ æ­£äº¤çŸ©é˜µ ($\det = 1$)</td><td>3D æ—‹è½¬</td></tr>
        <tr><td>$\text{SE}(3)$</td><td>6</td><td>$\begin{pmatrix}\mathbf{R} & \mathbf{t} \\ \mathbf{0} & 1\end{pmatrix}$, $\mathbf{R} \in \text{SO}(3), \mathbf{t} \in \mathbb{R}^3$</td><td>åˆšä½“è¿åŠ¨</td></tr>
        <tr><td>$\text{E}(3)$</td><td>6</td><td>$\text{O}(3) \ltimes \mathbb{R}^3$ï¼ˆåŒ…å«åå°„ï¼‰</td><td>å…¨æ¬§å‡ é‡Œå¾—å˜æ¢</td></tr>
      </table>
    </div>

    <h3 id="homogeneous-space">é½æ€§ç©ºé—´</h3>

    <div class="blueprint">
      <h4>å®šä¹‰ï¼šé½æ€§ç©ºé—´ (Homogeneous Space)</h4>
      <p>åŸŸ $\Omega$ æ˜¯å…³äºç¾¤ $G$ çš„<span class="term">é½æ€§ç©ºé—´</span>ï¼Œå¦‚æœå¯¹ä»»æ„ä¸¤ç‚¹ $u, v \in \Omega$ï¼Œéƒ½å­˜åœ¨ $g \in G$ ä½¿å¾— $g \cdot u = v$ã€‚</p>
      <p>ç›´è§‰ï¼šåŸŸä¸Šçš„æ‰€æœ‰ç‚¹"çœ‹èµ·æ¥ä¸€æ ·"â€”â€”å¯ä»¥é€šè¿‡å¯¹ç§°å˜æ¢ä»ä¸€ä¸ªç‚¹åˆ°è¾¾å¦ä¸€ä¸ªç‚¹ã€‚</p>
    </div>

    <div class="callout callout-info">
      <h4>ğŸ’¡ é½æ€§ç©ºé—´çš„ä¾‹å­</h4>
      <ul>
        <li>$\mathbb{R}^d$ å…³äºå¹³ç§»ç¾¤ $T(d)$ï¼šä»»æ„ä¸¤ç‚¹å¯ä»¥é€šè¿‡å¹³ç§»è¿æ¥</li>
        <li>$S^2$ å…³äº $\text{SO}(3)$ï¼šçƒé¢ä¸Šä»»æ„ä¸¤ç‚¹å¯ä»¥é€šè¿‡æ—‹è½¬è¿æ¥</li>
        <li>$\text{SO}(3)$ å…³äºè‡ªèº«ï¼šç¾¤ä¸Šçš„å·¦ä¹˜è¿æ¥ä»»æ„ä¸¤å…ƒç´ </li>
        <li><strong>é</strong>é½æ€§ç©ºé—´ï¼šä¸€èˆ¬çš„å¼¯æ›²è¡¨é¢ï¼ˆæµå½¢ï¼‰â€”â€”æ²¡æœ‰å…¨å±€å¯¹ç§°æ€§è®©æ‰€æœ‰ç‚¹ç­‰ä»·</li>
      </ul>
    </div>

    <div class="figure">
      <img src="../assets/ch4_p46_img1.png" alt="Cosmic microwave background">
      <figcaption>å®‡å®™å¾®æ³¢èƒŒæ™¯è¾å°„ï¼ˆç”± Planck å¤ªç©ºè§‚æµ‹ç«™æ•è·ï¼‰æ˜¯ $S^2$ ä¸Šçš„ä¿¡å·â€”â€”çƒé¢ CNN çš„å®é™…åº”ç”¨åœºæ™¯ã€‚</figcaption>
    </div>

    <!-- ä»£ç ï¼šSO(3) -->
    <h3 id="code-so3">ğŸ’» ä»£ç ï¼šSO(3) æ—‹è½¬çŸ©é˜µä¸ç¾¤å·ç§¯</h3>

    <div class="code-container">
      <div class="code-header">
        <span>Python â€” SO(2) å’Œ SO(3) æ—‹è½¬çŸ©é˜µ</span>
        <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      </div>
      <pre><code>import numpy as np
from scipy.spatial.transform import Rotation

# === SO(2): 2D æ—‹è½¬ ===
def so2_matrix(alpha):
    """SO(2) æ—‹è½¬çŸ©é˜µï¼Œè§’åº¦ alphaï¼ˆå¼§åº¦ï¼‰"""
    c, s = np.cos(alpha), np.sin(alpha)
    return np.array([[c, -s], [s, c]])

R1 = so2_matrix(np.pi / 4)   # 45Â°
R2 = so2_matrix(np.pi / 3)   # 60Â°
R12 = so2_matrix(np.pi / 4 + np.pi / 3)  # 105Â°

# éªŒè¯ç¾¤æ€§è´¨
print("=== SO(2) ===")
print(f"R1 @ R2 == R(Î±1+Î±2): {np.allclose(R1 @ R2, R12)}")
print(f"R @ R^T = I: {np.allclose(R1 @ R1.T, np.eye(2))}")
print(f"det(R) = 1: {np.isclose(np.linalg.det(R1), 1.0)}")

# === SO(3): 3D æ—‹è½¬ ===
print("\n=== SO(3) ===")
# ç»• z è½´æ—‹è½¬ 90Â°
Rz = Rotation.from_euler('z', 90, degrees=True).as_matrix()
# ç»• x è½´æ—‹è½¬ 45Â°
Rx = Rotation.from_euler('x', 45, degrees=True).as_matrix()

print(f"Rz:\n{np.round(Rz, 3)}")
print(f"det(Rz) = {np.linalg.det(Rz):.4f}")
print(f"Rz @ Rz.T = I: {np.allclose(Rz @ Rz.T, np.eye(3))}")

# éäº¤æ¢æ€§ï¼ï¼ˆSO(3) ä¸æ˜¯ Abel ç¾¤ï¼‰
print(f"\nRz @ Rx == Rx @ Rz: {np.allclose(Rz @ Rx, Rx @ Rz)}")
print("â†’ SO(3) æ˜¯éäº¤æ¢ç¾¤ï¼æ—‹è½¬é¡ºåºå¾ˆé‡è¦ã€‚")

# === SE(3): åˆšä½“è¿åŠ¨ ===
def se3_matrix(R, t):
    """SE(3) é½æ¬¡å˜æ¢çŸ©é˜µ"""
    T = np.eye(4)
    T[:3, :3] = R
    T[:3, 3] = t
    return T

T1 = se3_matrix(Rz, np.array([1.0, 0.0, 0.0]))
T2 = se3_matrix(Rx, np.array([0.0, 2.0, 0.0]))

# å¤åˆå˜æ¢
T12 = T1 @ T2
print(f"\n=== SE(3) ===")
print(f"T1 @ T2:\n{np.round(T12, 3)}")
print(f"T1 @ T2 == T2 @ T1: {np.allclose(T1 @ T2, T2 @ T1)}")

# é€†å˜æ¢
T1_inv = np.linalg.inv(T1)
print(f"T @ T^(-1) = I: {np.allclose(T1 @ T1_inv, np.eye(4))}")
</code></pre>
    </div>

    <div class="code-container">
      <div class="code-header">
        <span>Python â€” çƒé¢ä¸Šçš„ä¿¡å·ä¸å·ç§¯æ¦‚å¿µ</span>
        <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      </div>
      <pre><code>import numpy as np
from scipy.spatial.transform import Rotation

# === çƒé¢é‡‡æ · (Fibonacci lattice) ===
def fibonacci_sphere(n=1000):
    """åœ¨ S^2 ä¸Šå‡åŒ€é‡‡æ · n ä¸ªç‚¹"""
    indices = np.arange(0, n, dtype=float) + 0.5
    phi = np.arccos(1 - 2 * indices / n)   # æè§’
    theta = np.pi * (1 + 5**0.5) * indices  # æ–¹ä½è§’ï¼ˆé»„é‡‘è§’ï¼‰
    x = np.cos(theta) * np.sin(phi)
    y = np.sin(theta) * np.sin(phi)
    z = np.cos(phi)
    return np.stack([x, y, z], axis=-1)  # (n, 3)

points = fibonacci_sphere(500)
print(f"çƒé¢ç‚¹é›†å½¢çŠ¶: {points.shape}")
print(f"æ‰€æœ‰ç‚¹åœ¨å•ä½çƒä¸Š: {np.allclose(np.linalg.norm(points, axis=1), 1.0)}")

# === çƒé¢ä¸Šçš„ä¿¡å· ===
# ç®€å•ä¿¡å·ï¼šåˆ°åŒ—æçš„è·ç¦»
north_pole = np.array([0, 0, 1.0])
signal = np.arccos(np.clip(points @ north_pole, -1, 1))  # æµ‹åœ°è·ç¦»
print(f"ä¿¡å·èŒƒå›´: [{signal.min():.2f}, {signal.max():.2f}]")

# === æ—‹è½¬ä¿¡å·ï¼ˆSO(3) ä½œç”¨ï¼‰===
R = Rotation.from_euler('y', 90, degrees=True).as_matrix()
points_rotated = (R @ points.T).T  # æ—‹è½¬æ‰€æœ‰ç‚¹

# æ—‹è½¬åçš„ä¿¡å·ï¼šÏ(g)x(u) = x(g^{-1}u)
R_inv = R.T  # SO(3) çš„é€†å°±æ˜¯è½¬ç½®
signal_rotated = np.arccos(np.clip((R_inv @ points.T).T @ north_pole, -1, 1))

# éªŒè¯ï¼šæ—‹è½¬ä¿¡å· = åœ¨æ—‹è½¬åçš„ç‚¹ä¸Šæ±‚å€¼åŸä¿¡å·
signal_check = np.arccos(np.clip(points_rotated @ north_pole, -1, 1))
# æ³¨æ„ï¼šè¿™ä¸¤ä¸ªä¸ç›¸ç­‰ï¼å› ä¸º Ï(g)x æ˜¯"æ—‹è½¬è¾“å…¥çš„ä¿¡å·"
# ä½† x(gÂ·u) æ˜¯"åœ¨æ—‹è½¬åçš„ç‚¹ä¸Šæ±‚å€¼"
print(f"\nçƒé¢å·ç§¯çš„æœ¬è´¨ï¼šåŒ¹é…ä¿¡å·ä¸æ—‹è½¬åçš„æ»¤æ³¢å™¨")
print(f"è¾“å‡ºæ˜¯ SO(3) ä¸Šçš„å‡½æ•°ï¼ˆ3ç»´ï¼‰ï¼Œè€Œé S^2 ä¸Šçš„å‡½æ•°ï¼ˆ2ç»´ï¼‰")
</code></pre>
    </div>

    <div class="callout callout-robot">
      <h4>ğŸ¤– PhysRobot å…³è”ï¼šä¸ºä»€ä¹ˆéœ€è¦ SE(3) ç­‰å˜æ€§ï¼Ÿ</h4>
      <p>åœ¨ç‰©ç†ä»¿çœŸä¸­ï¼Œå®šå¾‹ä¸ä¾èµ–äºåæ ‡ç³»çš„é€‰æ‹©ï¼š</p>
      <ul>
        <li><strong>æ—‹è½¬ç­‰å˜</strong>ï¼šæ—‹è½¬æ•´ä¸ªç³»ç»Ÿï¼ŒåŠ é€Ÿåº¦ä¹Ÿæ—‹è½¬ â†’ $\text{SO}(3)$ æˆ– $\text{O}(3)$ ç­‰å˜</li>
        <li><strong>å¹³ç§»ç­‰å˜</strong>ï¼šå¹³ç§»æ•´ä¸ªç³»ç»Ÿï¼Œä½ç§»ä¹Ÿå¹³ç§» â†’ $T(3)$ ç­‰å˜</li>
        <li><strong>SE(3) ç­‰å˜</strong>ï¼šåˆšä½“è¿åŠ¨ä¸æ”¹å˜ç‰©ç† â†’ å®Œæ•´çš„æ¬§å‡ é‡Œå¾—ç­‰å˜æ€§</li>
      </ul>
      <p>GNS ä¸­çš„æ¶ˆæ¯ä¼ é€’ä½¿ç”¨<strong>ç›¸å¯¹ä½ç½®</strong> $\mathbf{p}_j - \mathbf{p}_i$ å’Œ<strong>è·ç¦»</strong> $\|\mathbf{p}_j - \mathbf{p}_i\|$ ä½œä¸ºè¾¹ç‰¹å¾â€”â€”è¿™è‡ªåŠ¨ä¿è¯äº† SE(3) ä¸å˜æ€§ï¼</p>
    </div>

    <div class="callout callout-exercise">
      <h4>ğŸ“ ç»ƒä¹  4.3</h4>
      <ol>
        <li><strong>éªŒè¯</strong>ï¼š$\text{SO}(2)$ æ˜¯ Abel ç¾¤ï¼Œ$\text{SO}(3)$ ä¸æ˜¯ã€‚æ‰¾ä¸¤ä¸ª $3 \times 3$ æ—‹è½¬çŸ©é˜µä½¿å¾— $R_1 R_2 \neq R_2 R_1$ã€‚</li>
        <li><strong>è¯æ˜</strong>ï¼š$S^2$ æ˜¯ $\text{SO}(3)$ çš„é½æ€§ç©ºé—´ï¼šå¯¹çƒé¢ä¸Šä»»æ„ä¸¤ç‚¹ï¼Œå­˜åœ¨æ—‹è½¬å°†ä¸€ä¸ªç‚¹æ˜ åˆ°å¦ä¸€ä¸ªã€‚</li>
        <li><strong>ç¼–ç¨‹</strong>ï¼šå®ç° SE(3) ç¾¤çš„å¤åˆã€é€†è¿ç®—ã€‚éªŒè¯ $(T_1 T_2)^{-1} = T_2^{-1} T_1^{-1}$ã€‚</li>
        <li><strong>æ€è€ƒ</strong>ï¼šä¸ºä»€ä¹ˆçƒé¢å·ç§¯çš„ç¬¬äºŒå±‚å¿…é¡»åœ¨ SO(3) ä¸Šæ“ä½œè€Œä¸æ˜¯åœ¨ $S^2$ ä¸Šï¼Ÿ</li>
      </ol>
    </div>


    <!-- ============================================================ -->
    <!-- SECTION 4.4: GEODESICS AND MANIFOLDS -->
    <!-- ============================================================ -->
    <h2 id="sec4-4">4.4 æµ‹åœ°çº¿å’Œæµå½¢ (Geodesics and Manifolds)</h2>

    <div class="bilingual">
      <div class="zh">
        <p>çƒé¢ $S^2$ æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æµå½¢â€”â€”å®ƒæœ‰å…¨å±€å¯¹ç§°ç¾¤ã€‚ä½†å¤§å¤šæ•°æµå½¢<strong>æ²¡æœ‰</strong>å…¨å±€å¯¹ç§°æ€§ï¼Œä¸èƒ½ç›´æ¥å®šä¹‰ç¾¤ä½œç”¨æ¥"æ»‘åŠ¨"æ»¤æ³¢å™¨ã€‚ä¸è¿‡ï¼Œæµå½¢æœ‰ä¸¤ç§é‡è¦çš„ä¸å˜æ€§ï¼š<strong>ä¿åº¦é‡å˜æ¢</strong>ï¼ˆç­‰è·å˜æ¢ï¼‰å’Œ<strong>å±€éƒ¨å‚è€ƒæ¡†æ¶å˜æ¢</strong>ï¼ˆè§„èŒƒå˜æ¢ï¼‰ã€‚</p>
      </div>
      <div class="en">
        Manifolds typically do not have global symmetries, so we cannot straightforwardly define convolution. Nevertheless, manifolds have two types of invariance: metric-preserving transformations and local reference frame changes.
      </div>
    </div>

    <h3 id="riemannian">é»æ›¼æµå½¢ (Riemannian Manifolds)</h3>

    <div class="blueprint">
      <h4>ç›´è§‰å®šä¹‰ï¼šå¾®åˆ†æµå½¢</h4>
      <p>ä¸€ä¸ª $s$ ç»´<span class="term">ï¼ˆå¾®åˆ†/å…‰æ»‘ï¼‰æµå½¢</span>æ˜¯ä¸€ä¸ªå¼¯æ›²çš„"è¡¨é¢"ï¼Œåœ¨æ¯ä¸ªç‚¹çš„å°é‚»åŸŸå†…"çœ‹èµ·æ¥åƒ" $\mathbb{R}^s$ã€‚</p>
      <ul>
        <li><strong>å±€éƒ¨æ¬§å‡ é‡Œå¾—</strong>ï¼šè¶³å¤Ÿæ”¾å¤§ï¼Œæ›²é¢çœ‹èµ·æ¥æ˜¯å¹³çš„</li>
        <li><strong>å…¨å±€å¯ä»¥å¼¯æ›²</strong>ï¼šæ•´ä½“ç»“æ„å¯ä»¥æœ‰å¤æ‚çš„æ‹“æ‰‘</li>
        <li>ä¸¥æ ¼å®šä¹‰éœ€è¦åæ ‡å¡ï¼ˆchartï¼‰å’Œåæ ‡å¡é›†ï¼ˆatlasï¼‰ï¼Œä½†ç›´è§‰è¶³å¤Ÿ</li>
      </ul>
    </div>

    <h3 id="tangent-space">åˆ‡ç©ºé—´ã€é»æ›¼åº¦é‡</h3>

    <p>åœ¨æµå½¢çš„æ¯ä¸ªç‚¹ $u$ï¼Œéƒ½å¯ä»¥å®šä¹‰ä¸€ä¸ª<span class="term">åˆ‡ç©ºé—´</span> $T_u\Omega$â€”â€”æƒ³è±¡åœ¨çƒé¢ä¸ŠæŸç‚¹æ”¾ä¸€ä¸ªå¹³é¢ï¼š</p>

    <div class="figure">
      <img src="../assets/ch4_p50_img0.png" alt="Tangent space and Riemannian geometry">
      <figcaption>å›¾ 11ï¼šé»æ›¼å‡ ä½•çš„åŸºæœ¬æ¦‚å¿µï¼Œä»¥äºŒç»´çƒé¢ $S^2 = \{\mathbf{u} \in \mathbb{R}^3 : \|\mathbf{u}\| = 1\}$ ä¸ºä¾‹ã€‚åˆ‡ç©ºé—´ $T_uS^2$ æ˜¯ä¸çƒé¢åœ¨ $u$ ç‚¹ç›¸åˆ‡çš„å¹³é¢ã€‚æŒ‡æ•°æ˜ å°„å°†åˆ‡ç©ºé—´æ˜ å°„åˆ°æµå½¢ä¸Šã€‚æµ‹åœ°çº¿æ˜¯çƒé¢ä¸Šçš„å¤§åœ†å¼§ã€‚</figcaption>
    </div>

    <div class="math-block">
      $$g_u : T_u\Omega \times T_u\Omega \to \mathbb{R}$$
      <div class="math-explain">
        <span class="term">é»æ›¼åº¦é‡</span>ï¼ˆRiemannian metricï¼‰$g_u$ æ˜¯åˆ‡ç©ºé—´ä¸Šçš„æ­£å®šåŒçº¿æ€§å‡½æ•°ï¼Œæä¾›å†…ç§¯ç»“æ„ï¼š<br>
        â€¢ å†…ç§¯ï¼š$\langle X, Y \rangle_u = g_u(X, Y)$<br>
        â€¢ èŒƒæ•°ï¼ˆå‘é‡é•¿åº¦ï¼‰ï¼š$\|X\|_u = g_u^{1/2}(X, X)$<br>
        â€¢ è§’åº¦ï¼šé€šè¿‡å†…ç§¯å®šä¹‰<br>
        é»æ›¼åº¦é‡éšç‚¹ $u$ å…‰æ»‘å˜åŒ–ï¼Œæ˜¯"åœ¨å¼¯æ›²ç©ºé—´ä¸­æµ‹é‡è·ç¦»"çš„æ ¸å¿ƒå·¥å…·ã€‚
      </div>
    </div>

    <div class="callout callout-info">
      <h4>ğŸ’¡ ç›´è§‰ï¼šåˆ‡ç©ºé—´ä¸åæ ‡</h4>
      <p>åˆ‡å‘é‡ $X \in T_u\Omega$ æ˜¯<strong>æŠ½è±¡çš„å‡ ä½•å®ä½“</strong>ï¼Œä¸ä¾èµ–åæ ‡ã€‚ä½†è¦åšè®¡ç®—ï¼Œéœ€è¦é€‰æ‹©<strong>å±€éƒ¨åŸº</strong> $\{X_1, \ldots, X_s\} \subset T_u\Omega$ï¼Œå°† $X$ è¡¨ç¤ºä¸ºåæ ‡ $\mathbf{x} = (x^1, \ldots, x^s)$ã€‚</p>
      <p>ç±»æ¯”ï¼šå‘é‡ $\vec{v}$ æœ¬èº«ä¸å˜ï¼Œä½†åœ¨ä¸åŒåŸºä¸‹æœ‰ä¸åŒåæ ‡ã€‚è¿™æ­£æ˜¯ Â§4.5 è§„èŒƒç†è®ºçš„æ ¸å¿ƒæ€æƒ³ï¼</p>
    </div>

    <h4>çƒé¢ä¸Šçš„ä¾‹å­</h4>

    <div class="math-block">
      $$S^2 = \{\mathbf{u} \in \mathbb{R}^3 : \|\mathbf{u}\| = 1\}$$
      $$T_u S^2 = \{\mathbf{x} \in \mathbb{R}^3 : \mathbf{x}^\top \mathbf{u} = 0\}$$
      <div class="math-explain">
        çƒé¢çš„åˆ‡ç©ºé—´ = å‚ç›´äºæ³•å‘é‡ $\mathbf{u}$ çš„å¹³é¢ã€‚é»æ›¼åº¦é‡ = é™åˆ¶åœ¨åˆ‡å¹³é¢ä¸Šçš„æ¬§å‡ é‡Œå¾—å†…ç§¯ $\langle \mathbf{x}, \mathbf{y} \rangle_u = \mathbf{x}^\top \mathbf{y}$ã€‚
      </div>
    </div>

    <h4>æ ‡é‡åœºå’Œå‘é‡åœº</h4>

    <p><span class="term">æ ‡é‡åœº</span>ï¼š$x : \Omega \to \mathbb{R}$ï¼ˆæ¯ç‚¹ä¸€ä¸ªæ•°å€¼ï¼‰ï¼Œå†…ç§¯ä¸ºï¼š</p>
    <div class="math-block">
      $$\langle x, y \rangle = \int_\Omega x(u) y(u) \, du$$
    </div>

    <p><span class="term">åˆ‡å‘é‡åœº</span>ï¼š$X : \Omega \to T\Omega$ï¼ˆæ¯ç‚¹ä¸€ä¸ªåˆ‡å‘é‡ï¼‰ï¼Œå†…ç§¯ä¸ºï¼š</p>
    <div class="math-block">
      $$\langle X, Y \rangle = \int_\Omega g_u(X(u), Y(u)) \, du$$
    </div>

    <p><span class="term">å†…è•´æ¢¯åº¦</span> $\nabla x(u) \in T_u\Omega$ï¼šæ ‡é‡åœº $x$ çš„"æœ€é™¡ä¸Šå‡æ–¹å‘"ï¼Œé€šè¿‡ Riesz è¡¨ç¤ºå®šç†å®šä¹‰ï¼š</p>
    <div class="math-block">
      $$d_u x(Y) = g_u(\nabla x(u), Y), \quad \forall Y \in T_u\Omega$$
      <div class="math-explain">
        å¾®åˆ† $d_u x$ æ˜¯ä½™å‘é‡ï¼ˆcovectorï¼‰ï¼Œæ¢¯åº¦ $\nabla x(u)$ æ˜¯å®ƒé€šè¿‡åº¦é‡çš„å‘é‡è¡¨ç¤ºã€‚æ¢¯åº¦ç®—å­ $\nabla : \mathcal{X}(\Omega, \mathbb{R}) \to \mathcal{X}(\Omega, T\Omega)$ å°†æ ‡é‡åœºæ˜ ä¸ºå‘é‡åœºã€‚
      </div>
    </div>

    <h3 id="geodesics">æµ‹åœ°çº¿ (Geodesics)</h3>

    <div class="blueprint">
      <h4>å®šä¹‰ï¼šæµ‹åœ°çº¿</h4>
      <p>æµå½¢ä¸Šè¿æ¥ä¸¤ç‚¹ $u, v$ çš„<strong>æœ€çŸ­æ›²çº¿</strong>å«åš<span class="term">æµ‹åœ°çº¿</span>ï¼ˆgeodesicï¼‰ã€‚å®šä¹‰ä¸ºæœ€å°åŒ–é•¿åº¦æ³›å‡½ï¼š</p>
      $$\ell(\gamma) = \int_0^T \|\gamma'(t)\|_{\gamma(t)} \, dt = \int_0^T g_{\gamma(t)}^{1/2}(\gamma'(t), \gamma'(t)) \, dt$$
      <p>å…¶ä¸­ $\gamma : [0, T] \to \Omega$ æ˜¯æ›²çº¿ï¼Œ$\gamma'(t) \in T_{\gamma(t)}\Omega$ æ˜¯é€Ÿåº¦å‘é‡ã€‚</p>
      <p><strong>å…³é”®</strong>ï¼šæµ‹åœ°çº¿çš„å®šä¹‰å®Œå…¨æ˜¯<strong>å†…è•´çš„</strong>â€”â€”åªä¾èµ–é»æ›¼åº¦é‡ï¼Œä¸ä¾èµ–åµŒå…¥ç©ºé—´ã€‚</p>
    </div>

    <div class="callout callout-info">
      <h4>ğŸ’¡ æµ‹åœ°çº¿çš„ç›´è§‰</h4>
      <ul>
        <li><strong>å¹³é¢ä¸Š</strong>ï¼šæµ‹åœ°çº¿ = ç›´çº¿</li>
        <li><strong>çƒé¢ä¸Š</strong>ï¼šæµ‹åœ°çº¿ = å¤§åœ†å¼§ï¼ˆå¦‚é£æœºèˆªçº¿ï¼‰</li>
        <li><strong>ä¸€èˆ¬æ›²é¢ä¸Š</strong>ï¼šæµ‹åœ°çº¿ = "å°½å¯èƒ½ç›´"çš„è·¯å¾„</li>
      </ul>
    </div>

    <h3 id="parallel-transport">å¹³è¡Œç§»åŠ¨ (Parallel Transport)</h3>

    <p>ä¸åŒç‚¹çš„åˆ‡ç©ºé—´æ˜¯ä¸åŒçš„å‘é‡ç©ºé—´ï¼Œä¸èƒ½ç›´æ¥æ¯”è¾ƒåˆ‡å‘é‡ã€‚<span class="term">å¹³è¡Œç§»åŠ¨</span>æä¾›äº†æ²¿æ›²çº¿è¿è¾“å‘é‡çš„æœºåˆ¶ï¼š</p>

    <div class="figure">
      <img src="../assets/ch4_p51_img0.png" alt="Parallel transport">
      <figcaption>å¹³è¡Œç§»åŠ¨ç¤ºæ„ã€‚å·¦ï¼šåœ¨çƒé¢ä¸Šå°†å‘é‡ä» A æ²¿å¤§åœ†å¼§ç§»åˆ° Cã€‚"æ¬§å‡ é‡Œå¾—æ¬è¿"ï¼ˆçº¢è‰²ï¼‰ä¸åœ¨åˆ‡å¹³é¢å†…ï¼å¹³è¡Œç§»åŠ¨ï¼ˆè“è‰²ï¼‰æ²¿è·¯å¾„æ—‹è½¬å‘é‡ï¼Œä¿æŒä¸æ›²çº¿çš„å¤¹è§’å’Œé•¿åº¦ä¸å˜ã€‚å³ï¼šå¹³è¡Œç§»åŠ¨æ˜¯<strong>è·¯å¾„ä¾èµ–çš„</strong>â€”â€”æ²¿ BC å’Œ ABC ç§»åŠ¨åˆ°åŒä¸€ç‚¹ä¼šå¾—åˆ°ä¸åŒç»“æœã€‚</figcaption>
    </div>

    <div class="math-block">
      $$g_{\gamma(t)}(X(t), \gamma'(t)) = g_u(X, \gamma'(0)) = \text{const}$$
      $$\|X(t)\|_{\gamma(t)} = \|X\|_u = \text{const}$$
      <div class="math-explain">
        å¹³è¡Œç§»åŠ¨ä¿æŒ<strong>å¤¹è§’</strong>ï¼ˆä¸æ›²çº¿åˆ‡å‘é‡ï¼‰å’Œ<strong>é•¿åº¦</strong>ä¸å˜ã€‚æ˜ å°„ $\Gamma_{u \to v} : T_u\Omega \to T_v\Omega$ æ˜¯ä¸€ä¸ªæ—‹è½¬ï¼Œå±äº $\text{SO}(s)$ï¼ˆç»“æ„ç¾¤ï¼‰ã€‚
      </div>
    </div>

    <h3 id="exponential-map">æŒ‡æ•°æ˜ å°„ (Exponential Map)</h3>

    <div class="math-block">
      $$\exp_u : B_r(\mathbf{0}) \subset T_u\Omega \to \Omega, \quad \exp_u(X) = \gamma_X(1)$$
      <div class="math-explain">
        ä»ç‚¹ $u$ å‡ºå‘ï¼Œæ²¿æ–¹å‘ $X$ èµ°å•ä½æ­¥é•¿åˆ°è¾¾ $\exp_u(X)$ã€‚æŒ‡æ•°æ˜ å°„æ˜¯<strong>åˆ‡ç©ºé—´åˆ°æµå½¢çš„å±€éƒ¨å¾®åˆ†åŒèƒš</strong>â€”â€”å¯ä»¥ç†è§£ä¸ºåœ¨åˆ‡ç©ºé—´åšè®¡ç®—ï¼Œç„¶å"æ˜ å°„å›"æµå½¢ã€‚é€†æ˜ å°„å«<span class="term">å¯¹æ•°æ˜ å°„</span>ï¼ˆlogarithmic mapï¼‰ã€‚
      </div>
    </div>

    <p>çƒé¢ä¸Šçš„æŒ‡æ•°æ˜ å°„æœ‰è§£æè¡¨è¾¾å¼ï¼š</p>
    <div class="math-block">
      $$\exp_\mathbf{u}(\mathbf{x}) = \cos(\|\mathbf{x}\|)\,\mathbf{u} + \frac{\sin(\|\mathbf{x}\|)}{\|\mathbf{x}\|}\,\mathbf{x}, \quad \mathbf{x} \in T_\mathbf{u} S^2$$
    </div>

    <h4>æµ‹åœ°è·ç¦»</h4>
    <div class="math-block">
      $$d_g(u, v) = \min_\gamma \ell(\gamma) \quad \text{s.t.} \quad \gamma(0) = u, \, \gamma(T) = v$$
      <div class="math-explain">
        <strong>Hopf-Rinow å®šç†</strong>ï¼šç´§è‡´æµå½¢ä¸Šï¼Œä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­æµ‹åœ°çº¿å­˜åœ¨ã€‚çƒé¢ä¸Š $d_g(\mathbf{u}, \mathbf{v}) = \arccos(\mathbf{u}^\top \mathbf{v})$ã€‚
      </div>
    </div>

    <h3 id="isometries">ç­‰è·å˜æ¢ (Isometries)</h3>

    <div class="blueprint">
      <h4>å®šä¹‰ï¼šç­‰è·å˜æ¢</h4>
      <p>å¾®åˆ†åŒèƒš $\eta : (\Omega, g) \to (\tilde{\Omega}, h)$ æ˜¯<span class="term">ï¼ˆé»æ›¼ï¼‰ç­‰è·</span>çš„ï¼Œå¦‚æœæ‹‰å›åº¦é‡ï¼ˆpullback metricï¼‰ç­‰äºåŸåº¦é‡ï¼š$g = \eta^* h$ã€‚</p>
      <p>ç­‰ä»·æ¡ä»¶ï¼ˆåº¦é‡ç­‰è·ï¼‰ï¼š$d_g(u, v) = d_h(\eta(u), \eta(v))$ å¯¹æ‰€æœ‰ $u, v \in \Omega$ã€‚</p>
      <p><strong>ç›´è§‰</strong>ï¼šç­‰è·å˜æ¢ = "ä¸æ‹‰ä¼¸ä¸æ’•è£‚"çš„å˜å½¢ï¼ˆå¦‚æŠ˜çº¸ï¼‰ã€‚</p>
    </div>

    <div class="figure">
      <img src="../assets/ch4_p51_img1.png" alt="Isometric embeddings">
      <figcaption>Nash åµŒå…¥å®šç†ï¼šä»»ä½•å…‰æ»‘é»æ›¼æµå½¢éƒ½å¯ä»¥åµŒå…¥åˆ°è¶³å¤Ÿé«˜ç»´çš„æ¬§å‡ é‡Œå¾—ç©ºé—´ä¸­ã€‚æŠ˜çº¸è‰ºæœ¯æ˜¯å¹³é¢çš„ä¸åŒç­‰è·åµŒå…¥ã€‚</figcaption>
    </div>

    <p>ç­‰è·å˜æ¢ä¿æŒæ‰€æœ‰<strong>å†…è•´é‡</strong>ä¸å˜ã€‚è‡ªç­‰è·å˜æ¢å½¢æˆ<span class="term">ç­‰è·ç¾¤</span> $\text{Iso}(\Omega)$ï¼Œåœ¨ GDL è“å›¾ä¸­æ‰®æ¼”å¯¹ç§°ç¾¤çš„è§’è‰²ã€‚</p>

    <div class="callout callout-math">
      <h4>ğŸ”® å‡ ä½•ç¨³å®šæ€§</h4>
      <p>å¯¹äºè¿‘ä¼¼ç­‰è·å˜æ¢ï¼Œå®šä¹‰<span class="term">åº¦é‡ç•¸å˜</span>ï¼ˆmetric distortionï¼‰ï¼š</p>
      $$\text{dis}(\eta) = \sup_{u,v \in \Omega} |d_h(\eta(u), \eta(v)) - d_g(u, v)|$$
      <p>GDL è“å›¾è¦æ±‚å‡½æ•° $f$ å¯¹åŸŸå˜å½¢ç¨³å®šï¼š</p>
      $$\|f(x, \Omega) - f(x \circ \eta^{-1}, \tilde{\Omega})\| \leq C \|x\| \cdot \text{dis}(\eta)$$
    </div>

    <h3 id="manifold-fourier">æµå½¢ä¸Šçš„å‚…é‡Œå¶åˆ†æä¸è°±å·ç§¯</h3>

    <p><span class="term">æ•£åº¦</span>ï¼ˆdivergenceï¼‰$\nabla^* : \mathcal{X}(\Omega, T\Omega) \to \mathcal{X}(\Omega, \mathbb{R})$ æ˜¯æ¢¯åº¦çš„ä¼´éšç®—å­ã€‚<span class="term">æ‹‰æ™®æ‹‰æ–¯-è´å°”ç‰¹æ‹‰ç±³ç®—å­</span>ï¼ˆLaplace-Beltramiï¼‰æ˜¯å®ƒä»¬çš„å¤åˆï¼š</p>

    <div class="math-block">
      $$\Delta = \nabla^* \nabla$$
      <div class="math-explain">
        æ‹‰æ™®æ‹‰æ–¯ç®—å­è¡¡é‡"å‡½æ•°åœ¨æŸç‚¹çš„å€¼ä¸å‘¨å›´æ— ç©·å°çƒå¹³å‡å€¼çš„å·®å¼‚"â€”â€”æ˜¯çƒ­æ‰©æ•£ã€æ³¢åŠ¨æ–¹ç¨‹ç­‰çš„æ ¸å¿ƒã€‚<br>
        <strong>å…³é”®æ€§è´¨</strong>ï¼š$\Delta$ æ˜¯<strong>å†…è•´çš„</strong>ï¼ˆç­‰è·ä¸å˜ï¼‰ã€<strong>è‡ªä¼´éšçš„</strong>ï¼ˆ$\langle \Delta x, y \rangle = \langle x, \Delta y \rangle$ï¼‰ã€<strong>å„å‘åŒæ€§çš„</strong>ï¼ˆæ— æ–¹å‘åå¥½ï¼‰ã€‚
      </div>
    </div>

    <p>åœ¨ç´§è‡´æµå½¢ä¸Šï¼Œ$\Delta$ æœ‰å¯æ•°çš„ç‰¹å¾åˆ†è§£ï¼š</p>
    <div class="math-block">
      $$\Delta \phi_k = \lambda_k \phi_k, \quad 0 = \lambda_0 \leq \lambda_1 \leq \cdots$$
      <div class="math-explain">
        ç‰¹å¾å‡½æ•° $\{\phi_k\}$ æ„æˆæ­£äº¤åŸºï¼Œ$\lambda_k$ å¯¹åº”"é¢‘ç‡"ã€‚è¿™å°±æ˜¯æµå½¢ä¸Šçš„<strong>å¹¿ä¹‰å‚…é‡Œå¶åŸº</strong>ï¼<br>
        Dirichlet èƒ½é‡æœ€å°åŒ–è§†è§’ï¼š$\phi_{k+1}$ æ˜¯åœ¨ä¸å‰ $k$ ä¸ªç‰¹å¾å‡½æ•°æ­£äº¤çš„çº¦æŸä¸‹ï¼Œæœ€å…‰æ»‘çš„å‡½æ•°ã€‚
      </div>
    </div>

    <p><span class="term">è°±å·ç§¯</span>ï¼ˆspectral convolutionï¼‰å®šä¹‰ä¸ºå‚…é‡Œå¶åŸŸçš„é€å…ƒç´ ä¹˜ç§¯ï¼š</p>
    <div class="math-block">
      $$(x \star \theta)(u) = \sum_{k \geq 0} (\hat{x}_k \cdot \hat{\theta}_k) \, \phi_k(u)$$
      <div class="math-explain">
        è¿™æ˜¯å°†æ¬§å‡ é‡Œå¾—å·ç§¯å®šç†"åè¿‡æ¥"ç”¨ï¼šä»¥é¢‘åŸŸä¹˜ç§¯<strong>å®šä¹‰</strong>å·ç§¯ã€‚æ„é€ æ˜¯å†…è•´çš„ â†’ ç­‰è·ä¸å˜ âœ“ã€‚ä½†å› ä¸ºæ‹‰æ™®æ‹‰æ–¯æ˜¯å„å‘åŒæ€§çš„ â†’ å·ç§¯ä¹Ÿæ˜¯å„å‘åŒæ€§çš„ï¼ˆæ²¡æœ‰æ–¹å‘æ€§ï¼‰ã€‚
      </div>
    </div>

    <div class="figure">
      <img src="../assets/ch4_p58_img0.png" alt="Spectral filter instability">
      <figcaption>å›¾ 12ï¼šè°±æ»¤æ³¢å™¨å¯¹åŸŸæ‰°åŠ¨çš„ä¸ç¨³å®šæ€§ã€‚å·¦ï¼šç½‘æ ¼ $\Omega$ ä¸Šçš„ä¿¡å· $x$ã€‚ä¸­ï¼šåœ¨ $\Omega$ çš„æ‹‰æ™®æ‹‰æ–¯ç‰¹å¾åŸºä¸Šåšè°±æ»¤æ³¢ã€‚å³ï¼šåœ¨è¿‘ç­‰è·æ‰°åŠ¨åŸŸ $\tilde{\Omega}$ ä¸ŠåšåŒæ ·çš„è°±æ»¤æ³¢â€”â€”ç»“æœå¤§ä¸ç›¸åŒï¼é«˜é¢‘ç‰¹å¾å‡½æ•°å¯¹å¾®å°æ‰°åŠ¨æå…¶æ•æ„Ÿã€‚</figcaption>
    </div>

    <p><strong>ç©ºé—´å·ç§¯</strong>ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆï¼Œåœ¨åˆ‡ç©ºé—´ä¸­ç”¨æŒ‡æ•°æ˜ å°„å±€éƒ¨å®šä¹‰ï¼š</p>
    <div class="math-block">
      $$(x \star \theta)(u) = \int_{T_u\Omega} x(\exp_u Y) \, \theta_u(Y) \, dY$$
      <div class="math-explain">
        æ»¤æ³¢å™¨ $\theta_u$ å®šä¹‰åœ¨åˆ‡ç©ºé—´ä¸Šï¼Œé€šè¿‡æŒ‡æ•°æ˜ å°„"è´´åˆ°"æµå½¢ä¸Šã€‚ä½†ç”±äºæµå½¢ä¸æ˜¯é½æ€§ç©ºé—´ï¼Œ<strong>æ²¡æœ‰</strong>å…¨å±€å…±äº«çš„æ»¤æ³¢å™¨â€”â€”å¿…é¡»å¼•å…¥<strong>è§„èŒƒ</strong>ï¼ˆgaugeï¼Œè§ Â§4.5ï¼‰ã€‚
      </div>
    </div>

    <!-- ä»£ç ï¼šçƒé¢æµ‹åœ°çº¿ -->
    <h3 id="code-geodesic">ğŸ’» ä»£ç ï¼šçƒé¢ä¸Šçš„æµ‹åœ°çº¿è®¡ç®—</h3>

    <div class="code-container">
      <div class="code-header">
        <span>Python â€” çƒé¢æµ‹åœ°çº¿ã€æŒ‡æ•°æ˜ å°„ã€æ‹‰æ™®æ‹‰æ–¯ç‰¹å¾åŸº</span>
        <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      </div>
      <pre><code>import numpy as np

# === çƒé¢ S^2 ä¸Šçš„æµ‹åœ°çº¿ ===
def geodesic_distance_sphere(u, v):
    """çƒé¢ä¸Šä¸¤ç‚¹çš„æµ‹åœ°è·ç¦» = arccos(u Â· v)"""
    dot = np.clip(u @ v, -1.0, 1.0)
    return np.arccos(dot)

# ä¸¤ä¸ªå•ä½å‘é‡
u = np.array([0, 0, 1.0])   # åŒ—æ
v = np.array([1, 0, 0.0])   # "èµ¤é“ä¸Šçš„ç‚¹"
d = geodesic_distance_sphere(u, v)
print(f"åŒ—æåˆ°èµ¤é“ç‚¹çš„æµ‹åœ°è·ç¦»: {d:.4f} = Ï€/2 = {np.pi/2:.4f}")

# === æŒ‡æ•°æ˜ å°„ ===
def exp_map_sphere(u, x):
    """
    çƒé¢ä¸Šçš„æŒ‡æ•°æ˜ å°„
    u: åŸºç‚¹ï¼ˆå•ä½å‘é‡ï¼‰
    x: åˆ‡å‘é‡ï¼ˆå‚ç›´äº uï¼‰
    è¿”å›: æ²¿ x æ–¹å‘èµ° ||x|| è·ç¦»ååˆ°è¾¾çš„ç‚¹
    """
    norm_x = np.linalg.norm(x)
    if norm_x < 1e-10:
        return u.copy()
    return np.cos(norm_x) * u + np.sin(norm_x) / norm_x * x

# ä»åŒ—æå‡ºå‘ï¼Œæ²¿ x æ–¹å‘èµ° Ï€/2
tangent_vec = np.array([np.pi/2, 0, 0.0])  # åˆ‡å‘é‡ï¼ˆå‚ç›´äº z è½´ï¼‰
# æ³¨æ„ï¼šåˆ‡å‘é‡éœ€è¦åœ¨åˆ‡ç©ºé—´å†…ï¼ˆå‚ç›´äº uï¼‰
assert abs(tangent_vec @ u) < 1e-10, "åˆ‡å‘é‡å¿…é¡»å‚ç›´äºåŸºç‚¹ï¼"

arrival = exp_map_sphere(u, tangent_vec)
print(f"\næŒ‡æ•°æ˜ å°„: exp_u(x) = {np.round(arrival, 4)}")
print(f"åˆ°è¾¾çš„ç‚¹èŒƒæ•°: {np.linalg.norm(arrival):.6f}")  # åº”è¯¥ â‰ˆ 1

# === å¯¹æ•°æ˜ å°„ï¼ˆæŒ‡æ•°æ˜ å°„çš„é€†ï¼‰===
def log_map_sphere(u, v):
    """çƒé¢ä¸Šçš„å¯¹æ•°æ˜ å°„ï¼šä» u åˆ° v çš„åˆ‡å‘é‡"""
    dot = np.clip(u @ v, -1.0, 1.0)
    d = np.arccos(dot)
    if d < 1e-10:
        return np.zeros_like(u)
    proj = v - dot * u  # æŠ•å½±åˆ°åˆ‡ç©ºé—´
    proj = proj / np.linalg.norm(proj) * d
    return proj

x_recovered = log_map_sphere(u, arrival)
print(f"å¯¹æ•°æ˜ å°„æ¢å¤åˆ‡å‘é‡: {np.round(x_recovered, 4)}")
print(f"ä¸åŸåˆ‡å‘é‡ä¸€è‡´: {np.allclose(tangent_vec, x_recovered, atol=1e-6)}")

# === å¹³è¡Œç§»åŠ¨ ===
def parallel_transport_sphere(u, v, X):
    """
    æ²¿å¤§åœ†å¼§å°†åˆ‡å‘é‡ X âˆˆ T_u S^2 å¹³è¡Œç§»åŠ¨åˆ° T_v S^2
    """
    # æµ‹åœ°çº¿æ–¹å‘
    log_uv = log_map_sphere(u, v)
    d = np.linalg.norm(log_uv)
    if d < 1e-10:
        return X.copy()
    
    n = log_uv / d  # å•ä½æ–¹å‘
    # Rodrigues å…¬å¼çš„å˜ä½“
    # å¹³è¡Œç§»åŠ¨ = ä¿æŒä¸æµ‹åœ°çº¿æ–¹å‘çš„å¤¹è§’å’Œé•¿åº¦ä¸å˜
    X_transported = X - (np.dot(X, n + v) / (1 + np.dot(u, v))) * (u + v)
    return X_transported

# å°†åŒ—æçš„åˆ‡å‘é‡å¹³è¡Œç§»åŠ¨åˆ°èµ¤é“
X_at_north = np.array([1.0, 0, 0])  # åŒ—æåˆ‡å¹³é¢å†…çš„å‘é‡
v_equator = np.array([1, 0, 0.0])
X_at_equator = parallel_transport_sphere(u, v_equator, X_at_north)
print(f"\nå¹³è¡Œç§»åŠ¨: {X_at_north} â†’ {np.round(X_at_equator, 4)}")
print(f"é•¿åº¦ä¿æŒ: {np.linalg.norm(X_at_north):.4f} â†’ {np.linalg.norm(X_at_equator):.4f}")

# === éªŒè¯è·¯å¾„ä¾èµ–æ€§ ===
# æ²¿ä¸åŒè·¯å¾„ç§»åŠ¨åˆ°åŒä¸€ç‚¹ï¼šè¿™æ˜¯æ›²ç‡çš„ä½“ç°ï¼
print("\n=== è·¯å¾„ä¾èµ–æ€§ï¼ˆæ›²ç‡æ•ˆåº”ï¼‰ ===")
# è·¯å¾„ 1: åŒ—æ â†’ (1,0,0) ç›´æ¥
X1 = parallel_transport_sphere(u, v_equator, np.array([0, 1.0, 0]))
# è·¯å¾„ 2: åŒ—æ â†’ (0,1,0) â†’ (1,0,0) 
mid = np.array([0, 1.0, 0])
X_mid = parallel_transport_sphere(u, mid, np.array([0, 1.0, 0]))
X2 = parallel_transport_sphere(mid, v_equator, X_mid)
print(f"è·¯å¾„1ç»“æœ: {np.round(X1, 4)}")
print(f"è·¯å¾„2ç»“æœ: {np.round(X2, 4)}")
print(f"ç»“æœä¸åŒ â†’ å¹³è¡Œç§»åŠ¨æ˜¯è·¯å¾„ä¾èµ–çš„ï¼")
</code></pre>
    </div>

    <div class="callout callout-exercise">
      <h4>ğŸ“ ç»ƒä¹  4.4</h4>
      <ol>
        <li><strong>è®¡ç®—</strong>ï¼šåœ¨çƒé¢ $S^2$ ä¸Šï¼ŒåŒ—æ $(0,0,1)$ åˆ°å—æ $(0,0,-1)$ çš„æµ‹åœ°è·ç¦»æ˜¯å¤šå°‘ï¼Ÿæœ‰å¤šå°‘æ¡ä¸åŒçš„æµ‹åœ°çº¿ï¼Ÿ</li>
        <li><strong>è¯æ˜</strong>ï¼šåœ¨ $S^2$ ä¸Šæ²¿çº¬çº¿ï¼ˆéå¤§åœ†å¼§ï¼‰ä» A åˆ° B çš„è·¯å¾„ä¸æ˜¯æµ‹åœ°çº¿ã€‚</li>
        <li><strong>ç¼–ç¨‹</strong>ï¼šç”¨ä¸Šé¢çš„ä»£ç ï¼Œåœ¨çƒé¢ä¸Šåšä¸€ä¸ª"å¹³è¡Œç§»åŠ¨ä¸‰è§’å½¢"å®éªŒï¼šå°†å‘é‡æ²¿ä¸‰è§’å½¢ $A \to B \to C \to A$ ç§»åŠ¨ä¸€åœˆï¼ŒéªŒè¯èµ·å§‹å‘é‡ä¸ç»ˆæ­¢å‘é‡ä¹‹é—´çš„è§’åº¦ç­‰äºä¸‰è§’å½¢çš„é¢ç§¯ï¼ˆé«˜æ–¯-åšå†…å®šç†çš„ç‰¹ä¾‹ï¼‰ã€‚</li>
        <li><strong>æ€è€ƒ</strong>ï¼šä¸ºä»€ä¹ˆè°±å·ç§¯åœ¨ä¸åŒæµå½¢ä¸Šä¸èƒ½æ³›åŒ–ï¼Ÿæç¤ºï¼šè€ƒè™‘ç‰¹å¾åŸºçš„ä¾èµ–æ€§ã€‚</li>
      </ol>
    </div>


    <!-- ============================================================ -->
    <!-- SECTION 4.5: GAUGES AND BUNDLES -->
    <!-- ============================================================ -->
    <h2 id="sec4-5">4.5 è§„èŒƒå’Œçº¤ç»´ä¸› (Gauges and Bundles)</h2>

    <div class="bilingual">
      <div class="zh">
        <p>åœ¨æµå½¢ä¸Šå®šä¹‰å·ç§¯æ—¶ï¼Œæˆ‘ä»¬é‡åˆ°äº†ä¸€ä¸ªæ ¹æœ¬æ€§é—®é¢˜ï¼šå¿…é¡»é€‰æ‹©å±€éƒ¨åæ ‡æ¡†æ¶ï¼ˆbasisï¼‰æ¥è¡¨ç¤ºåˆ‡å‘é‡ï¼Œä½†è¿™ä¸ªé€‰æ‹©æ˜¯<strong>ä»»æ„çš„</strong>ã€‚<span class="term">è§„èŒƒç†è®º</span>ï¼ˆgauge theoryï¼‰æ­£æ˜¯å¤„ç†è¿™ç§ä»»æ„æ€§çš„æ•°å­¦æ¡†æ¶â€”â€”å®ƒæ¥è‡ªç‰©ç†å­¦ï¼ˆæ¨-Mills ç†è®ºï¼‰ï¼Œä½†åœ¨å‡ ä½•æ·±åº¦å­¦ä¹ ä¸­åŒæ ·å…³é”®ã€‚</p>
      </div>
      <div class="en">
        Gauge theory deals with the arbitrariness in the choice of local reference frames. It originates from physics (Yang-Mills theory) but is equally crucial in Geometric Deep Learning.
      </div>
    </div>

    <h3 id="bundle-intuition">çº¤ç»´ä¸›çš„ç›´è§‰</h3>

    <div class="callout callout-info">
      <h4>ğŸ’¡ çº¤ç»´ä¸› = åœ¨æ¯ä¸ªç‚¹é™„ç€ä¸€ä¸ªå‘é‡ç©ºé—´</h4>
      <p>æƒ³è±¡ä¸€æ ¹æ¯›æ¯›è™«ï¼ˆbase space $\Omega$ï¼‰ï¼Œåœ¨èº«ä½“çš„æ¯ä¸€èŠ‚ï¼ˆæ¯ä¸ªç‚¹ $u$ï¼‰éƒ½é•¿ç€ä¸€åœˆæ¯›ï¼ˆfiber $V_u$ï¼‰ã€‚</p>
      <ul>
        <li><strong>åˆ‡ä¸›</strong> $T\Omega$ï¼šæ¯ä¸ªç‚¹é™„ç€åˆ‡ç©ºé—´ $T_u\Omega$ï¼ˆæ¯›çš„æ–¹å‘ = æµå½¢ä¸Šçš„æ–¹å‘ï¼‰</li>
        <li><strong>ä¸€èˆ¬å‘é‡ä¸›</strong>ï¼šå¯ä»¥é™„ç€ä»»æ„å‘é‡ç©ºé—´ï¼ˆå¦‚ RGB é¢œè‰²ç©ºé—´ã€ç‰¹å¾é€šé“ç©ºé—´ï¼‰</li>
      </ul>
      <p>å±€éƒ¨çœ‹ï¼Œä¸› â‰ˆ $\Omega \times V$ï¼ˆç›´ç§¯ï¼‰ã€‚å…¨å±€å¯èƒ½"æ‰­æ›²"â€”â€”å°±åƒè«æ¯”ä¹Œæ–¯ç¯ä¸æ˜¯ $S^1 \times \mathbb{R}$ çš„ç›´ç§¯ã€‚</p>
    </div>

    <div class="blueprint">
      <h4>çº¤ç»´ä¸›çš„éæ­£å¼å®šä¹‰</h4>
      <p>å‘é‡ä¸›ç”±ä»¥ä¸‹ç»„æˆï¼š</p>
      <ul>
        <li><strong>åº•ç©ºé—´</strong>ï¼ˆbase spaceï¼‰$\Omega$ï¼šæµå½¢</li>
        <li><strong>çº¤ç»´</strong>ï¼ˆfiberï¼‰$V$ï¼šé™„ç€åœ¨æ¯ä¸ªç‚¹çš„å‘é‡ç©ºé—´ï¼ˆç»´åº¦ $d$ï¼‰</li>
        <li>åœ¨æ¯ä¸ªç‚¹ $u \in \Omega$ï¼Œçº¤ç»´ä¸º $V_u$ï¼ˆå¯¹åˆ‡ä¸›ï¼Œ$V_u = T_u\Omega$ï¼‰</li>
        <li>å±€éƒ¨çœ‹åƒ $\Omega \times V$ï¼Œå…¨å±€å¯èƒ½æœ‰"æ‰­æ›²"</li>
      </ul>
      <p><strong>æˆªé¢</strong>ï¼ˆsectionï¼‰= å‘é‡åœº $X : \Omega \to T\Omega$ï¼Œåœ¨æ¯ä¸ªç‚¹é€‰å–ä¸€ä¸ªçº¤ç»´ä¸­çš„å‘é‡ã€‚</p>
    </div>

    <h3 id="gauge-transform">è§„èŒƒå˜æ¢ (Gauge Transformation)</h3>

    <p><span class="term">è§„èŒƒ</span>ï¼ˆgaugeï¼‰= æ¯ä¸ªç‚¹ä¸Šçº¤ç»´çš„åŸºï¼ˆframeï¼‰$\omega_u : \mathbb{R}^s \to T_u\Omega$ã€‚å‘é‡åœº $X$ åœ¨è§„èŒƒ $\omega$ ä¸‹è¡¨ç¤ºä¸ºå‡½æ•° $\mathbf{x} : \Omega \to \mathbb{R}^s$ã€‚</p>

    <div class="math-block">
      $$X(u) = \omega_u(\mathbf{x}(u))$$
      <div class="math-explain">
        æŠ½è±¡å‘é‡ $X(u)$ é€šè¿‡è§„èŒƒ $\omega_u$ è¢«è¡¨ç¤ºä¸ºåæ ‡ $\mathbf{x}(u)$ã€‚<strong>æ”¹å˜è§„èŒƒ</strong>éœ€è¦åŒæ—¶æ”¹å˜åæ ‡è¡¨ç¤ºã€‚
      </div>
    </div>

    <p><span class="term">è§„èŒƒå˜æ¢</span>ï¼š$g : \Omega \to G$ï¼Œåœ¨æ¯ä¸ªç‚¹ç‹¬ç«‹æ”¹å˜åŸºåº•ã€‚æ–°è§„èŒƒ $\omega'_u = \omega_u \circ g_u$ï¼Œæ–°åæ ‡ $\mathbf{x}'(u) = g_u^{-1} \mathbf{x}(u)$ã€‚</p>

    <div class="math-block">
      $$X(u) = \omega'_u(\mathbf{x}'(u)) = \omega_u(g_u \, g_u^{-1} \, \mathbf{x}(u)) = \omega_u(\mathbf{x}(u)) = X(u) \quad \checkmark$$
      <div class="math-explain">
        åº•å±‚çš„å‡ ä½•å¯¹è±¡ï¼ˆå‘é‡åœº $X$ï¼‰ä¸å˜â€”â€”å˜çš„åªæ˜¯å®ƒçš„åæ ‡è¡¨ç¤ºï¼è¿™å°±æ˜¯è§„èŒƒå˜æ¢çš„æœ¬è´¨ã€‚
      </div>
    </div>

    <div class="callout callout-info">
      <h4>ğŸ’¡ RGB é¢œè‰²çš„è§„èŒƒç±»æ¯”</h4>
      <p>RGB å›¾åƒï¼šä½ç½® $u \in \mathbb{Z}^2$ï¼ˆ2D ç½‘æ ¼ï¼‰ï¼Œé¢œè‰² $\mathbf{x}(u) \in \mathbb{R}^3$ã€‚æ ‡å‡†è§„èŒƒ = (R, G, B) é¡ºåºã€‚</p>
      <p>å¦‚æœåœ¨æ¯ä¸ªåƒç´ <strong>ç‹¬ç«‹</strong>æ‰“ä¹±é¢œè‰²é€šé“é¡ºåºï¼ˆè§„èŒƒå˜æ¢ $g(u) \in \Sigma_3$ï¼‰ï¼Œå›¾ç‰‡çš„"å«ä¹‰"ä¸å˜â€”â€”åªæ˜¯æ•°å­—è¡¨ç¤ºå˜äº†ã€‚</p>
      <p>ä¸€ä¸ªå¥½çš„å›¾åƒåˆ†ç±»ç½‘ç»œåº”è¯¥åœ¨è¿™ç§å˜æ¢ä¸‹ç»™å‡ºç›¸åŒçš„åˆ†ç±»ç»“æœâ€”â€”è¿™å°±æ˜¯<strong>è§„èŒƒç­‰å˜æ€§</strong>ï¼</p>
    </div>

    <div class="figure">
      <img src="../assets/ch4_p60_img0.png" alt="Gauge equivariance">
      <figcaption>è§„èŒƒå˜æ¢æ”¹å˜äº†å‘é‡åœºçš„åæ ‡è¡¨ç¤ºï¼Œä½†ä¸æ”¹å˜åº•å±‚çš„å‡ ä½•å¯¹è±¡ã€‚å·¦ï¼šåŸå§‹è§„èŒƒä¸‹çš„å‘é‡åœºã€‚å³ï¼šè§„èŒƒå˜æ¢åçš„å‘é‡åœºåæ ‡è¡¨ç¤ºå˜äº†ï¼Œä½†å‡ ä½•å‘é‡ç›¸åŒã€‚</figcaption>
    </div>

    <h3 id="structure-group">ç»“æ„ç¾¤ (Structure Group)</h3>

    <div class="blueprint">
      <h4>ç»“æ„ç¾¤</h4>
      <p>é™åˆ¶è§„èŒƒå˜æ¢å¿…é¡»ä¿æŒæŸç§æ€§è´¨ï¼ˆå¦‚æ­£äº¤æ€§ã€å–å‘ï¼‰ï¼Œå¯¹åº”ä¸åŒçš„<span class="term">ç»“æ„ç¾¤</span>ï¼š</p>
      <table>
        <tr><th>ç»“æ„ç¾¤</th><th>ä¿æŒæ€§è´¨</th><th>å«ä¹‰</th></tr>
        <tr><td>$\text{GL}(s)$</td><td>å¯é€†æ€§</td><td>ä»»æ„åŸºå˜æ¢</td></tr>
        <tr><td>$\text{O}(s)$</td><td>æ­£äº¤æ€§</td><td>ä¿æŒè§’åº¦å’Œé•¿åº¦ï¼ˆå«åå°„ï¼‰</td></tr>
        <tr><td>$\text{SO}(s)$</td><td>æ­£äº¤ + å–å‘</td><td>çº¯æ—‹è½¬</td></tr>
        <tr><td>$\Sigma_d$</td><td>é€šé“æ’åˆ—</td><td>é¢œè‰²é€šé“äº¤æ¢</td></tr>
      </table>
      <p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šå¯¹äºåˆ‡ä¸›ï¼Œå¦‚æœè€ƒè™‘æ­£äº¤æ¡†æ¶ï¼Œç»“æ„ç¾¤æ˜¯ $\text{SO}(s)$ã€‚ç»™å®šä»»æ„ä¸¤ä¸ªæ­£äº¤æ¡†æ¶ï¼Œæ°å¥½å­˜åœ¨<strong>å”¯ä¸€çš„</strong>æ—‹è½¬å°†ä¸€ä¸ªæ˜ åˆ°å¦ä¸€ä¸ªã€‚</p>
    </div>

    <h3 id="gauge-equivariance">è§„èŒƒç­‰å˜æ€§ (Gauge Equivariance)</h3>

    <p>å°†è§„èŒƒå˜æ¢è§†ä¸ºå¯¹ç§°æ€§æ„å‘³ç€ï¼šä»»ä½•ä¸¤ä¸ªé€šè¿‡è§„èŒƒå˜æ¢ç›¸è”ç³»çš„è§„èŒƒè¢«è§†ä¸º<strong>ç­‰ä»·</strong>ã€‚</p>

    <div class="math-block">
      $$f \circ \rho_{\text{in}}(g) = \rho_{\text{out}}(g) \circ f$$
      <div class="math-explain">
        <span class="term">è§„èŒƒç­‰å˜</span>çš„æ˜ å°„ $f$ï¼šæ”¹å˜è¾“å…¥è§„èŒƒ â†’ è¾“å‡ºä»¥å¯¹åº”çš„è¡¨ç¤ºå˜æ¢ã€‚<br>
        <strong>å…³é”®ç»“æœ</strong>ï¼šè§„èŒƒç­‰å˜æ˜ å°„çš„åæ ‡è¡¨è¾¾å¼<strong>ä¸è§„èŒƒé€‰æ‹©æ— å…³</strong>â€”â€”å°±åƒå›¾ä¸Šçš„ç­‰å˜å‡½æ•°ä¸èŠ‚ç‚¹æ’åˆ—æ— å…³ã€‚
      </div>
    </div>

    <div class="callout callout-math">
      <h4>ğŸ”® è§„èŒƒç­‰å˜ vs å…¨å±€ç­‰å˜</h4>
      <p>å¯¹æ¯”ä¸¤ç§å¯¹ç§°æ€§ï¼š</p>
      <table>
        <tr><th>ç±»å‹</th><th>ä½œç”¨æ–¹å¼</th><th>ä¾‹å­</th></tr>
        <tr><td>å…¨å±€å¯¹ç§°ï¼ˆå¦‚ç½®æ¢ã€æ—‹è½¬ï¼‰</td><td>å¯¹<strong>æ•´ä¸ªåŸŸ</strong>ç»Ÿä¸€å˜æ¢</td><td>å¹³ç§»æ‰€æœ‰åƒç´ ã€æ—‹è½¬æ•´ä¸ªåˆ†å­</td></tr>
        <tr><td>è§„èŒƒå¯¹ç§°</td><td>åœ¨<strong>æ¯ä¸ªç‚¹ç‹¬ç«‹</strong>å˜æ¢å‚è€ƒæ¡†æ¶</td><td>åœ¨æ¯ä¸ªç‚¹ç‹¬ç«‹æ—‹è½¬åˆ‡ç©ºé—´çš„åŸº</td></tr>
      </table>
      <p>è§„èŒƒç­‰å˜æ€§çº¦æŸæ›´å¼ºï¼šä¸ä»…è¦å¤„ç†å…¨å±€å˜æ¢ï¼Œè¿˜è¦å¤„ç†é€ç‚¹ç‹¬ç«‹çš„å±€éƒ¨å˜æ¢ã€‚</p>
    </div>

    <h3 id="connection">è”ç»œä¸å¹³è¡Œç§»åŠ¨åœ¨è§„èŒƒä¸­çš„è§’è‰²</h3>

    <h4>æ ‡é‡åœº â†’ æ ‡é‡åœºçš„æ˜ å°„</h4>
    <p>æ ‡é‡åœ¨è§„èŒƒå˜æ¢ä¸‹ä¸å˜ï¼ˆ$\rho(g) = 1$ï¼‰ï¼Œæ‰€ä»¥<strong>ä»»ä½•</strong>çº¿æ€§æ˜ å°„ $f : \mathcal{X}(\Omega, \mathbb{R}) \to \mathcal{X}(\Omega, \mathbb{R})$ éƒ½è‡ªåŠ¨æ˜¯è§„èŒƒç­‰å˜çš„ï¼š</p>
    <div class="math-block">
      $$(x \star \theta)(u) = \int_\Omega \theta(u, v) \, x(v) \, dv$$
      <div class="math-explain">
        æ»¤æ³¢å™¨ $\theta(u, v)$ æ˜¯ä½ç½®ä¾èµ–çš„â€”â€”<strong>æ²¡æœ‰ç©ºé—´æƒé‡å…±äº«</strong>ã€‚è§„èŒƒå¯¹ç§°æ€§æœ¬èº«ä¸æä¾›æƒé‡å…±äº«ï¼éœ€è¦é¢å¤–çš„ç»“æ„ï¼ˆå¦‚ç­‰è·ä¸å˜æ€§ï¼‰ã€‚
      </div>
    </div>

    <h4>å‘é‡åœº â†’ å‘é‡åœºçš„æ˜ å°„ï¼ˆéœ€è¦è”ç»œï¼ï¼‰</h4>
    <p>çŸ©é˜µå€¼æ ¸ $\Theta(u, v) \in \mathbb{R}^{s \times s}$ å¿…é¡»è¿æ¥ä¸åŒç‚¹çš„åˆ‡ç©ºé—´ã€‚ç›´æ¥è¦æ±‚åœ¨æ¯å¯¹ $(u, v)$ çš„è§„èŒƒå˜æ¢ä¸‹ç­‰å˜å¤ªå¼ºäº†ï¼ˆæ ¸ä¼šè¢«è¿«ä¸ºé›¶ï¼ï¼‰ã€‚</p>

    <p>è§£å†³æ–¹æ¡ˆï¼šå…ˆç”¨<span class="term">è”ç»œ</span>ï¼ˆconnection = å¹³è¡Œç§»åŠ¨ï¼‰å°†å‘é‡è¿åˆ°åŒä¸€åˆ‡ç©ºé—´ï¼Œå†æ–½åŠ ç­‰å˜çº¦æŸï¼š</p>

    <div class="math-block">
      $$(\mathbf{x} \star \Theta)(u) = \int_\Omega \Theta(u, v) \, \rho(g_{v \to u}) \, \mathbf{x}(v) \, dv$$
      <div class="math-explain">
        $g_{v \to u} \in G$ æ˜¯æ²¿æµ‹åœ°çº¿ä» $v$ åˆ° $u$ çš„å¹³è¡Œç§»åŠ¨ï¼ˆ$\text{SO}(s)$ å…ƒç´ ï¼‰ã€‚$\rho(g_{v \to u})$ æ˜¯æ—‹è½¬çŸ©é˜µã€‚<br>
        å¦‚æœæ»¤æ³¢å™¨ä¸ç»“æ„ç¾¤è¡¨ç¤ºäº¤æ¢ï¼š$\Theta(u,v)\rho(g_u) = \rho(g_u)\Theta(u,v)$ï¼Œåˆ™æ•´ä½“æ˜¯è§„èŒƒç­‰å˜çš„ã€‚
      </div>
    </div>

    <div class="callout callout-robot">
      <h4>ğŸ¤– PhysRobot å…³è”ï¼šè§„èŒƒç­‰å˜æ€§åœ¨ç‰©ç†ä¸­</h4>
      <p>åœ¨ç‰©ç†ä»¿çœŸä¸­ï¼Œè¡¨é¢ä¸Šçš„åŠ›å’Œæ³•å‘é‡æ˜¯<strong>åˆ‡å‘é‡åœº</strong>â€”â€”å®ƒä»¬çš„æ•°å€¼è¡¨ç¤ºä¾èµ–äºåæ ‡ç³»çš„é€‰æ‹©ã€‚</p>
      <ul>
        <li>FEMï¼ˆæœ‰é™å…ƒæ–¹æ³•ï¼‰ä¸­ï¼Œæ¯ä¸ªä¸‰è§’å½¢æœ‰è‡ªå·±çš„å±€éƒ¨åæ ‡ç³»â€”â€”è¿™å°±æ˜¯"è§„èŒƒ"</li>
        <li>è®¡ç®—åº”åŠ›æ—¶éœ€è¦åœ¨ä¸åŒä¸‰è§’å½¢é—´"æ¬è¿"å¼ é‡â€”â€”è¿™å°±æ˜¯"è”ç»œ"</li>
        <li>è§„èŒƒç­‰å˜çš„ç½‘ç»œå¯ä»¥ä¿è¯ç»“æœä¸ä¾èµ–äº mesh çš„å‚æ•°åŒ–æ–¹å¼</li>
      </ul>
    </div>

    <div class="callout callout-warn">
      <h4>âš ï¸ ä¸ºä»€ä¹ˆå…‰æ»‘å…¨å±€è§„èŒƒå¯èƒ½ä¸å­˜åœ¨ï¼Ÿ</h4>
      <p><strong>PoincarÃ©-Hopf å®šç†</strong>ï¼ˆ"æ¯›çƒå®šç†"ï¼‰ï¼š$S^2$ ä¸Šä¸å­˜åœ¨å¤„å¤„éé›¶çš„å…‰æ»‘åˆ‡å‘é‡åœºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ <strong>ä¸èƒ½</strong>ç»™çƒé¢æ¢³ä¸€ä¸ªæ²¡æœ‰"æ—‹"çš„å‘å‹ï¼</p>
      <p>æ•°å­¦ä¸Šï¼š$S^2$ æ˜¯<strong>ä¸å¯å¹³è¡ŒåŒ–</strong>ï¼ˆnon-parallelisableï¼‰çš„æµå½¢ã€‚è¿™æ„å‘³ç€åœ¨ $S^2$ ä¸Šæ— æ³•å®šä¹‰å…¨å±€å…‰æ»‘çš„è§„èŒƒâ€”â€”å¿…é¡»æ¥å—å±€éƒ¨è§„èŒƒå’Œè§„èŒƒå˜æ¢ã€‚</p>
      <p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè§„èŒƒç†è®ºä¸ä»…æ˜¯"å¥½çš„æ•°å­¦"ï¼Œè€Œæ˜¯<strong>å¿…é¡»çš„</strong>â€”â€”åœ¨æŸäº›æµå½¢ä¸Šï¼Œæ²¡æœ‰æ·å¾„å¯ä»¥ç»•è¿‡å®ƒã€‚</p>
    </div>

    <div class="callout callout-exercise">
      <h4>ğŸ“ ç»ƒä¹  4.5</h4>
      <ol>
        <li><strong>ç›´è§‰</strong>ï¼šè§£é‡Šä¸ºä»€ä¹ˆ RGB å›¾åƒçš„ $1 \times 1$ å·ç§¯ï¼ˆé€åƒç´ çº¿æ€§å˜æ¢ $\mathbb{R}^3 \to \mathbb{R}^C$ï¼‰åœ¨é€šé“ç½®æ¢ä¸‹æ˜¯è§„èŒƒç­‰å˜çš„ã€‚</li>
        <li><strong>è¯æ˜</strong>ï¼šå¦‚æœ $f$ æ˜¯è§„èŒƒç­‰å˜çš„ï¼ˆ$f \circ \rho_{\text{in}}(g) = \rho_{\text{out}}(g) \circ f$ï¼‰ï¼Œé‚£ä¹ˆ $f' = \rho_{\text{out}}^{-1}(g) \circ f \circ \rho_{\text{in}}(g) = f$â€”â€”å³è§„èŒƒå˜æ¢ä¸æ”¹å˜ç­‰å˜æ˜ å°„æœ¬èº«ã€‚</li>
        <li><strong>æ€è€ƒ</strong>ï¼šåœ¨ç½‘æ ¼ï¼ˆmeshï¼‰ä¸Šï¼ŒèŠ‚ç‚¹çš„ 1-hop é‚»å±…å¯ä»¥æŒ‰é¡ºæ—¶é’ˆæ’åºã€‚è¿™ç§"å¾ªç¯æ’åº"çš„æ­§ä¹‰æ€§å¯¹åº”ä»€ä¹ˆè§„èŒƒç¾¤ï¼Ÿï¼ˆæç¤ºï¼š$\text{SO}(2)$ çš„ç¦»æ•£ç‰ˆæœ¬ï¼‰</li>
        <li><strong>æ¯”è¾ƒ</strong>ï¼šå…¨å±€å¯¹ç§°æ€§ï¼ˆÂ§4.3ï¼‰å’Œè§„èŒƒå¯¹ç§°æ€§ï¼ˆÂ§4.5ï¼‰çš„çº¦æŸå“ªä¸ªæ›´å¼ºï¼Ÿå¯¹ç½‘ç»œè®¾è®¡æœ‰ä»€ä¹ˆä¸åŒå½±å“ï¼Ÿ</li>
      </ol>
    </div>


    <!-- ============================================================ -->
    <!-- SECTION 4.6: GEOMETRIC GRAPHS AND MESHES -->
    <!-- ============================================================ -->
    <h2 id="sec4-6">4.6 å‡ ä½•å›¾å’Œç½‘æ ¼ (Geometric Graphs and Meshes)</h2>

    <div class="bilingual">
      <div class="zh">
        <p>ç½‘æ ¼ï¼ˆmeshï¼‰æ˜¯å›¾å’Œæµå½¢çš„äº¤æ±‡ç‚¹ï¼šå®ƒåƒå›¾ä¸€æ ·æ˜¯ç¦»æ•£çš„ï¼Œä½†æœ‰æ¥è‡ªæµå½¢çš„é¢å¤–ç»“æ„ã€‚åœ¨æˆ‘ä»¬çš„"5G"ä¸­ï¼Œç½‘æ ¼ä¸æ˜¯ç‹¬ç«‹çš„ä¸€ç±»ï¼Œè€Œæ˜¯<strong>æ¡¥æ¢</strong>â€”â€”è¿æ¥ç¦»æ•£çš„å›¾æ–¹æ³•å’Œè¿ç»­çš„æµå½¢ç†è®ºã€‚</p>
      </div>
      <div class="en">
        Meshes fall somewhere between graphs and manifolds: they are similar to graphs but have additional structure that allows treating them as continuous objects. They bridge discrete graph methods and continuous manifold theory.
      </div>
    </div>

    <h3 id="mesh-def">ä¸‰è§’ç½‘æ ¼</h3>

    <div class="blueprint">
      <h4>å®šä¹‰ï¼šä¸‰è§’ç½‘æ ¼ (Triangular Mesh)</h4>
      <p>ä¸‰è§’ç½‘æ ¼ $\mathcal{T} = (\mathcal{V}, \mathcal{E}, \mathcal{F})$ ç”±ä»¥ä¸‹ç»„æˆï¼š</p>
      <ul>
        <li><strong>èŠ‚ç‚¹</strong> $\mathcal{V}$ï¼šåµŒå…¥åœ¨ $\mathbb{R}^3$ ä¸­ï¼Œåæ ‡ä¸º $\mathbf{x}_1, \ldots, \mathbf{x}_n$</li>
        <li><strong>è¾¹</strong> $\mathcal{E}$ï¼šèŠ‚ç‚¹é—´çš„è¿æ¥</li>
        <li><strong>é¢</strong> $\mathcal{F} = \{(u, v, q)\}$ï¼šä¸‰è§’é¢ç‰‡ï¼ˆèŠ‚ç‚¹çš„æœ‰åºä¸‰å…ƒç»„ï¼Œå®šä¹‰é¢çš„æœå‘ï¼‰</li>
      </ul>
      <p><strong>æµå½¢ç½‘æ ¼</strong>ï¼ˆmanifold meshï¼‰çš„æ¡ä»¶ï¼šæ¯æ¡è¾¹æ°å¥½è¢«ä¸¤ä¸ªä¸‰è§’å½¢å…±äº«ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„é‚»æ¥ä¸‰è§’å½¢å½¢æˆå•ç¯ã€‚</p>
    </div>

    <div class="callout callout-info">
      <h4>ğŸ’¡ ç½‘æ ¼çš„åº¦é‡</h4>
      <p>è¾¹é•¿ $\ell_{uv} = \|\mathbf{x}_u - \mathbf{x}_v\|$ ä»åµŒå…¥ç©ºé—´ç»§æ‰¿ï¼Œè‡ªåŠ¨æ»¡è¶³ä¸‰è§’ä¸ç­‰å¼ã€‚åªä¾èµ– $\ell$ çš„æ€§è´¨æ˜¯<strong>å†…è•´çš„</strong>ï¼Œä¿æŒ $\ell$ ä¸å˜çš„å˜å½¢æ˜¯<strong>ç­‰è·å˜æ¢</strong>ã€‚</p>
    </div>

    <h3 id="cotangent-laplacian">ä½™åˆ‡æ‹‰æ™®æ‹‰æ–¯ (Cotangent Laplacian)</h3>

    <p>ç½‘æ ¼ä¸Šçš„æ‹‰æ™®æ‹‰æ–¯æ˜¯è¿ç»­æ‹‰æ™®æ‹‰æ–¯-è´å°”ç‰¹æ‹‰ç±³ç®—å­çš„ç¦»æ•£åŒ–ï¼š</p>

    <div class="math-block">
      $$(\Delta \mathbf{X})_u = \sum_{v \in \mathcal{N}_u} w_{uv} (\mathbf{x}_u - \mathbf{x}_v)$$
      <div class="math-explain">
        çŸ©é˜µå½¢å¼ï¼š$\Delta = \mathbf{D} - \mathbf{W}$ï¼Œå…¶ä¸­ $\mathbf{W}$ æ˜¯åŠ æƒé‚»æ¥çŸ©é˜µã€‚æ³¨æ„è¿™å’Œ Â§4.1 çš„ç»„åˆæ‹‰æ™®æ‹‰æ–¯å½¢å¼ç›¸åŒâ€”â€”åŒºåˆ«åœ¨äº<strong>æƒé‡çš„é€‰å–</strong>ï¼
      </div>
    </div>

    <p><span class="term">ä½™åˆ‡æƒé‡</span>ï¼ˆcotangent weightsï¼‰åˆ©ç”¨ä¸‰è§’å½¢çš„è§’åº¦ä¿¡æ¯ï¼š</p>

    <div class="math-block">
      $$w_{uv} = \frac{\cot \angle uqv + \cot \angle upv}{2 a_u}$$
      <div class="math-explain">
        $\angle uqv$ å’Œ $\angle upv$ æ˜¯å…±äº«è¾¹ $(u,v)$ å¯¹é¢çš„ä¸¤ä¸ªè§’ï¼›$a_u$ æ˜¯èŠ‚ç‚¹ $u$ å‘¨å›´çš„å±€éƒ¨é¢ç§¯å…ƒç´ ã€‚<br>
        <strong>å…³é”®æ€§è´¨</strong>ï¼šä½™åˆ‡æ‹‰æ™®æ‹‰æ–¯æ˜¯<strong>å†…è•´çš„</strong>â€”â€”å¯ä»¥å®Œå…¨ç”¨è¾¹é•¿ $\ell$ è¡¨ç¤ºï¼ˆé€šè¿‡ Heron å…¬å¼ï¼‰â†’ ç­‰è·ä¸å˜ï¼
      </div>
    </div>

    <div class="figure">
      <img src="../assets/ch4_p65_img0.png" alt="Cotangent Laplacian and mesh neighborhoods">
      <figcaption>å·¦ï¼šä½™åˆ‡æƒé‡çš„å‡ ä½•å«ä¹‰â€”â€”ä¸¤ä¸ªå¯¹è§’çš„ä½™åˆ‡å€¼ã€‚å³ï¼šä¸åŒåˆ†è¾¨ç‡ç½‘æ ¼ä¸Šçš„ 2-hop é‚»åŸŸâ€”â€”å¤šé¡¹å¼æ»¤æ³¢å™¨çš„æ”¯æ’‘ä¾èµ–åˆ†è¾¨ç‡ï¼</figcaption>
    </div>

    <div class="callout callout-math">
      <h4>ğŸ”® ä½™åˆ‡æƒé‡çš„è¾¹é•¿è¡¨è¾¾å¼</h4>
      $$w_{uv} = \frac{-\ell_{uv}^2 + \ell_{vq}^2 + \ell_{uq}^2}{8 a_{uvq}} + \frac{-\ell_{uv}^2 + \ell_{vp}^2 + \ell_{up}^2}{8 a_{uvp}}$$
      <p>ä¸‰è§’å½¢é¢ç§¯ç”± Heron å…¬å¼è®¡ç®—ï¼š$a_{uvq} = \sqrt{s(s-\ell_{uv})(s-\ell_{vq})(s-\ell_{uq})}$ï¼Œ$s = \frac{1}{2}(\ell_{uv} + \ell_{uq} + \ell_{vq})$ã€‚</p>
      <p>å…¨éƒ¨ç”¨è¾¹é•¿ $\ell$ è¡¨è¾¾ â†’ <strong>ç­‰è·ä¸å˜</strong> âœ“</p>
    </div>

    <h4>å¤šé¡¹å¼æ»¤æ³¢å™¨ vs æœ‰ç†æ»¤æ³¢å™¨</h4>

    <p><strong>å¤šé¡¹å¼æ»¤æ³¢å™¨</strong>ï¼š$\hat{p}(\Delta)\mathbf{X} = \sum_{k=0}^r \alpha_k \Delta^k \mathbf{X}$</p>
    <ul>
      <li>åªéœ€åå¤ä¹˜ä»¥ç¨€ç–çŸ©é˜µ $\Delta$ï¼Œå¤æ‚åº¦ $O(|\mathcal{E}|dr)$</li>
      <li>$r$ é˜¶å¤šé¡¹å¼ = $r$-hop å±€éƒ¨æ»¤æ³¢å™¨</li>
      <li><strong>é—®é¢˜</strong>ï¼šæ”¯æ’‘ä¾èµ–ç½‘æ ¼åˆ†è¾¨ç‡ï¼ˆç»†ç½‘æ ¼éœ€è¦æ›´å¤§çš„ $r$ï¼‰</li>
    </ul>

    <p><strong>æœ‰ç†æ»¤æ³¢å™¨</strong>ï¼ˆå¦‚ Cayley å¤šé¡¹å¼ï¼‰ï¼šåˆ†è¾¨ç‡æ— å…³</p>
    <div class="math-block">
      $$\hat{p}(\lambda) = \text{Re}\left(\sum_{l=0}^r \alpha_l \left(\frac{\lambda - i}{\lambda + i}\right)^l\right)$$
      <div class="math-explain">
        Cayley å˜æ¢ $\frac{\lambda - i}{\lambda + i}$ å°†å®è½´æ˜ å°„åˆ°å¤å¹³é¢çš„å•ä½åœ†ã€‚ä¼˜ç‚¹ï¼šæ”¯æ’‘ä¸å±€é™äºå›ºå®šçš„ hop æ•°ï¼ŒæŒ‡æ•°è¡°å‡ï¼›ç¼ºç‚¹ï¼šéœ€è¦çŸ©é˜µæ±‚é€†ã€‚
      </div>
    </div>

    <h3 id="spectral-mesh">è°±åˆ†æä¸ç½‘æ ¼ä¸Šçš„å·ç§¯</h3>

    <p>æ‹‰æ™®æ‹‰æ–¯çš„ç‰¹å¾åˆ†è§£ $\Delta = \boldsymbol{\Phi} \boldsymbol{\Lambda} \boldsymbol{\Phi}^\top$ æä¾›äº†éæ¬§å‡ é‡Œå¾—å‚…é‡Œå¶åŸºï¼š</p>

    <div class="math-block">
      $$\mathbf{X} \star \boldsymbol{\theta} = \boldsymbol{\Phi} \, \text{diag}(\hat{\boldsymbol{\theta}}) \, \boldsymbol{\Phi}^\top \mathbf{X}$$
      <div class="math-explain">
        è°±å·ç§¯ = å‚…é‡Œå¶å˜æ¢ â†’ é¢‘åŸŸä¹˜æ³• â†’ é€†å‚…é‡Œå¶å˜æ¢ã€‚è¿™å¯¹å›¾å’Œç½‘æ ¼éƒ½é€‚ç”¨ã€‚
      </div>
    </div>

    <div class="callout callout-warn">
      <h4>âš ï¸ è°±æ–¹æ³•çš„å±€é™</h4>
      <ul>
        <li><strong>ç‰¹å¾åŸºä¸ç¨³å®š</strong>ï¼šé«˜é¢‘ç‰¹å¾å‡½æ•°å¯¹å¾®å°æ‰°åŠ¨æå…¶æ•æ„Ÿï¼ˆè§å›¾ 12ï¼‰</li>
        <li><strong>æ— æ³•è·¨åŸŸæ³›åŒ–</strong>ï¼šä¸åŒå›¾/ç½‘æ ¼æœ‰ä¸åŒçš„ç‰¹å¾åŸºï¼Œå‚…é‡Œå¶ç³»æ•°ä¸å¯æ¯”è¾ƒ</li>
        <li><strong>å„å‘åŒæ€§</strong>ï¼šæ‹‰æ™®æ‹‰æ–¯æ˜¯å„å‘åŒæ€§çš„ â†’ æ»¤æ³¢å™¨æ— æ–¹å‘åå¥½</li>
      </ul>
      <p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨å¤šé¡¹å¼/æœ‰ç†ä¼ é€’å‡½æ•° $\hat{p}(\Delta)$ è€Œéç›´æ¥çš„ç‰¹å¾åˆ†è§£ â†’ æ›´ç¨³å®šï¼Œä¸”é¿å… $O(n^3)$ çš„ç‰¹å¾åˆ†è§£ã€‚</p>
    </div>

    <h3 id="functional-maps">å‡½æ•°æ˜ å°„ (Functional Maps)</h3>

    <p>ä¸¤ä¸ªç½‘æ ¼å¯èƒ½è¡¨ç¤ºåŒä¸€ç‰©ä½“ä½†æœ‰<strong>ä¸åŒçš„è¿æ¥ç»“æ„å’ŒèŠ‚ç‚¹æ•°</strong>ã€‚ä¼ ç»Ÿçš„"ç‚¹åˆ°ç‚¹"å¯¹åº”ä¸é€‚ç”¨â€”â€”<span class="term">å‡½æ•°æ˜ å°„</span>å°†å¯¹åº”ä»ç‚¹æ¨å¹¿åˆ°å‡½æ•°ï¼š</p>

    <div class="math-block">
      $$\mathbf{x}' = \mathbf{C} \mathbf{x}, \quad \mathbf{C} \in \mathbb{R}^{n' \times n}$$
      <div class="math-explain">
        å‡½æ•°æ˜ å°„ $\mathbf{C}$ å»ºç«‹ä¸¤ä¸ªç½‘æ ¼ä¸Šçš„ä¿¡å·ä¹‹é—´çš„å¯¹åº”ã€‚<br>
        ç®—å­è¡¨ç¤ºçš„å…³ç³»ï¼š$\mathbf{Q}' = \mathbf{C}\mathbf{Q}\mathbf{C}^\top$ï¼Œå³"æ˜ å°„åˆ°ç¬¬ä¸€ä¸ªç½‘æ ¼ â†’ åº”ç”¨ç®—å­ â†’ æ˜ å°„å›ç¬¬äºŒä¸ªç½‘æ ¼"ã€‚<br>
        å¯¹äºé¢ç§¯ä¿æŒçš„æ˜ å°„ï¼š$\mathbf{C} \in O(n)$ï¼ˆæ­£äº¤çŸ©é˜µï¼‰ã€‚
      </div>
    </div>

    <div class="figure">
      <img src="../assets/ch4_p67_img0.png" alt="Functional maps">
      <figcaption>å›¾ 13ï¼šç‚¹æ˜ å°„ï¼ˆå·¦ï¼‰vs å‡½æ•°æ˜ å°„ï¼ˆå³ï¼‰ã€‚å‡½æ•°æ˜ å°„ç”¨å‡½æ•°ä¹‹é—´çš„å¯¹åº”ä»£æ›¿ç‚¹ä¹‹é—´çš„å¯¹åº”ï¼Œæ›´åŠ çµæ´»å’Œç¨³å®šã€‚</figcaption>
    </div>

    <p><strong>é‡ç½‘æ ¼ä¸å˜æ€§</strong>ï¼ˆremeshing invarianceï¼‰ï¼š</p>
    <div class="math-block">
      $$f(\mathbf{Q}) = f(\mathbf{C}\mathbf{Q}\mathbf{C}^\top), \quad \forall \mathbf{C} \in O(n)$$
      <div class="math-explain">
        æ¯”ç½®æ¢ä¸å˜æ€§æ›´ä¸€èˆ¬ï¼šç½®æ¢çŸ©é˜µ $\mathbf{P}$ æ˜¯æ­£äº¤çŸ©é˜µçš„ç‰¹ä¾‹ï¼ˆ$\mathbf{P}^\top\mathbf{P} = \mathbf{I}$ï¼‰ã€‚<br>
        <strong>Wang et al. (2019)</strong> çš„å…³é”®ç»“æœï¼šé‡ç½‘æ ¼ä¸å˜çš„å‡½æ•°åªä¾èµ–ç®—å­çš„<strong>è°±</strong>ï¼ˆç‰¹å¾å€¼ï¼‰ï¼Œå³ $f(\mathbf{Q}) = f(\boldsymbol{\Lambda})$ã€‚
      </div>
    </div>

    <!-- ä»£ç ï¼šå‡ ä½•å›¾ -->
    <h3 id="code-mesh">ğŸ’» ä»£ç ï¼šå‡ ä½•å›¾ä¸ç½‘æ ¼æ‹‰æ™®æ‹‰æ–¯</h3>

    <div class="code-container">
      <div class="code-header">
        <span>Python â€” æ„å»ºå‡ ä½•å›¾ä¸ä½™åˆ‡æ‹‰æ™®æ‹‰æ–¯</span>
        <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      </div>
      <pre><code>import numpy as np
from scipy.sparse import csr_matrix, diags
from scipy.sparse.linalg import eigsh

# === æ„å»ºç®€å•çš„ä¸‰è§’ç½‘æ ¼ï¼ˆæ­£äºŒåé¢ä½“ï¼‰===
# ç”¨ Ï† = (1+âˆš5)/2 é»„é‡‘æ¯”ä¾‹æ„é€ 
phi = (1 + np.sqrt(5)) / 2
vertices = np.array([
    [-1, phi, 0], [1, phi, 0], [-1, -phi, 0], [1, -phi, 0],
    [0, -1, phi], [0, 1, phi], [0, -1, -phi], [0, 1, -phi],
    [phi, 0, -1], [phi, 0, 1], [-phi, 0, -1], [-phi, 0, 1],
], dtype=float)
# å½’ä¸€åŒ–åˆ°å•ä½çƒé¢
vertices /= np.linalg.norm(vertices, axis=1, keepdims=True)

# é¢ï¼ˆä¸‰è§’å½¢ç´¢å¼•ï¼‰
faces = np.array([
    [0,11,5], [0,5,1], [0,1,7], [0,7,10], [0,10,11],
    [1,5,9], [5,11,4], [11,10,2], [10,7,6], [7,1,8],
    [3,9,4], [3,4,2], [3,2,6], [3,6,8], [3,8,9],
    [4,9,5], [2,4,11], [6,2,10], [8,6,7], [9,8,1],
])
n = len(vertices)
print(f"æ­£äºŒåé¢ä½“: {n} ä¸ªé¡¶ç‚¹, {len(faces)} ä¸ªé¢")

# === ç»„åˆæ‹‰æ™®æ‹‰æ–¯ï¼ˆç®€å•ç‰ˆï¼šæƒé‡ = 1ï¼‰===
# æå–è¾¹
edges = set()
for f in faces:
    for i in range(3):
        u, v = f[i], f[(i+1) % 3]
        edges.add((min(u,v), max(u,v)))

# é‚»æ¥çŸ©é˜µ
rows, cols, vals = [], [], []
for u, v in edges:
    rows.extend([u, v]); cols.extend([v, u]); vals.extend([1.0, 1.0])
A = csr_matrix((vals, (rows, cols)), shape=(n, n))
D = diags(np.array(A.sum(axis=1)).flatten())
L_comb = D - A

# === ä½™åˆ‡æ‹‰æ™®æ‹‰æ–¯ ===
def cotangent_laplacian(vertices, faces):
    """è®¡ç®—ä½™åˆ‡æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ"""
    n = len(vertices)
    rows, cols, vals = [], [], []
    areas = np.zeros(n)
    
    for f in faces:
        # ä¸‰è§’å½¢çš„ä¸‰ä¸ªé¡¶ç‚¹
        v0, v1, v2 = vertices[f[0]], vertices[f[1]], vertices[f[2]]
        
        # è¾¹å‘é‡
        e01 = v1 - v0; e12 = v2 - v1; e20 = v0 - v2
        
        # ä¸‰è§’å½¢é¢ç§¯ï¼ˆå‰ç§¯çš„ä¸€åŠï¼‰
        area = 0.5 * np.linalg.norm(np.cross(e01, -e20))
        
        # ä½™åˆ‡å€¼
        cot0 = np.dot(-e20, e01) / (2 * area + 1e-10)  # âˆ v0
        cot1 = np.dot(-e01, e12) / (2 * area + 1e-10)  # âˆ v1
        cot2 = np.dot(-e12, e20) / (2 * area + 1e-10)  # âˆ v2
        
        # è´¡çŒ®
        for (i, j, cot) in [(f[1], f[2], cot0), 
                             (f[0], f[2], cot1), 
                             (f[0], f[1], cot2)]:
            rows.extend([i, j]); cols.extend([j, i])
            vals.extend([cot/2, cot/2])
        
        # é¢ç§¯åˆ†é…ï¼ˆ1/3 ç»™æ¯ä¸ªé¡¶ç‚¹ï¼‰
        for idx in f:
            areas[idx] += area / 3
    
    W = csr_matrix((vals, (rows, cols)), shape=(n, n))
    D_w = diags(np.array(W.sum(axis=1)).flatten())
    L_cot = D_w - W
    
    # å½’ä¸€åŒ–ï¼ˆé™¤ä»¥å±€éƒ¨é¢ç§¯ï¼‰
    A_inv = diags(1.0 / (areas + 1e-10))
    L_normalized = A_inv @ L_cot
    
    return L_cot, areas

L_cot, areas = cotangent_laplacian(vertices, faces)

# === è°±åˆ†æ ===
# è®¡ç®—å‰ 6 ä¸ªç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡
eigenvalues, eigenvectors = eigsh(L_cot.toarray(), k=6, which='SM')
print(f"\nå‰ 6 ä¸ªç‰¹å¾å€¼: {np.round(eigenvalues, 4)}")
print(f"ç¬¬ä¸€ä¸ªç‰¹å¾å€¼ â‰ˆ 0: {eigenvalues[0]:.6f}")
print(f"ç¬¬ä¸€ä¸ªç‰¹å¾å‘é‡ â‰ˆ å¸¸æ•°: std = {eigenvectors[:,0].std():.6f}")

# === è°±æ»¤æ³¢ ===
# ä½é€šæ»¤æ³¢ï¼šä¿ç•™å‰ k ä¸ªç‰¹å¾åˆ†é‡
k = 4
signal = np.random.randn(n)
signal_hat = eigenvectors.T @ signal   # å‚…é‡Œå¶å˜æ¢
signal_filtered = eigenvectors[:, :k] @ signal_hat[:k]  # æˆªæ–­é€†å˜æ¢
print(f"\nåŸå§‹ä¿¡å·èƒ½é‡: {np.linalg.norm(signal):.4f}")
print(f"æ»¤æ³¢åèƒ½é‡: {np.linalg.norm(signal_filtered):.4f}")
print(f"ï¼ˆä½é€šæ»¤æ³¢ä¿ç•™äº†å…‰æ»‘åˆ†é‡ï¼‰")

# === å¤šé¡¹å¼æ»¤æ³¢å™¨ï¼ˆä¸éœ€è¦ç‰¹å¾åˆ†è§£ï¼ï¼‰===
# p(Î”) = Î±0 I + Î±1 Î” + Î±2 Î”Â²
alpha = [1.0, -0.5, 0.1]
L_dense = L_cot.toarray()
result = alpha[0] * signal + alpha[1] * L_dense @ signal + alpha[2] * L_dense @ L_dense @ signal
print(f"\nå¤šé¡¹å¼æ»¤æ³¢ï¼ˆåº¦=2ï¼‰å®Œæˆï¼Œæ— éœ€ç‰¹å¾åˆ†è§£")
print(f"2é˜¶å¤šé¡¹å¼ = 2-hop å±€éƒ¨æ»¤æ³¢å™¨")
</code></pre>
    </div>

    <div class="code-container">
      <div class="code-header">
        <span>Python â€” å‡ ä½•å›¾ï¼ˆç²’å­ç³»ç»Ÿï¼‰çš„æ‹‰æ™®æ‹‰æ–¯</span>
        <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      </div>
      <pre><code>import numpy as np
from scipy.spatial import cKDTree
from scipy.sparse import csr_matrix, diags

# === ç²’å­ç³»ç»Ÿä½œä¸ºå‡ ä½•å›¾ ===
np.random.seed(42)
n_particles = 200
positions = np.random.randn(n_particles, 3) * 2.0

# åŸºäºè·ç¦»é˜ˆå€¼å»ºå›¾ï¼ˆè¿™å°±æ˜¯ GNS çš„åšæ³•ï¼ï¼‰
radius = 1.5
tree = cKDTree(positions)
pairs = tree.query_pairs(r=radius)
print(f"ç²’å­æ•°: {n_particles}")
print(f"åŠå¾„ {radius} å†…çš„è¾¹æ•°: {len(pairs)}")
print(f"å¹³å‡åº¦: {2*len(pairs)/n_particles:.1f}")

# === æ„å»ºåŠ æƒé‚»æ¥çŸ©é˜µ ===
# æƒé‡ä¸è·ç¦»æˆåæ¯”ï¼ˆå¸¸ç”¨äºå‡ ä½•å›¾ï¼‰
rows, cols, vals = [], [], []
for i, j in pairs:
    dist = np.linalg.norm(positions[i] - positions[j])
    w = np.exp(-dist)  # é«˜æ–¯æ ¸æƒé‡
    rows.extend([i, j]); cols.extend([j, i]); vals.extend([w, w])

W = csr_matrix((vals, (rows, cols)), shape=(n_particles, n_particles))
D = diags(np.array(W.sum(axis=1)).flatten())
L = D - W  # å‡ ä½•å›¾æ‹‰æ™®æ‹‰æ–¯

# === ç­‰è·ä¸å˜æ€§æµ‹è¯• ===
# æ—‹è½¬æ‰€æœ‰ç²’å­ï¼ˆåˆšä½“å˜æ¢ï¼‰
from scipy.spatial.transform import Rotation
R = Rotation.from_euler('xyz', [30, 45, 60], degrees=True).as_matrix()
positions_rotated = (R @ positions.T).T

# é‡æ–°å»ºå›¾
tree_rot = cKDTree(positions_rotated)
pairs_rot = tree_rot.query_pairs(r=radius)

# ç›¸åŒçš„è¿æ¥ï¼
print(f"\næ—‹è½¬åçš„è¾¹æ•°: {len(pairs_rot)}")
print(f"è¾¹é›†ç›¸åŒ: {pairs == pairs_rot}")  # Trueï¼

# æƒé‡ä¹Ÿç›¸åŒï¼ˆå› ä¸ºè·ç¦»ä¸å˜ï¼‰
rows_r, cols_r, vals_r = [], [], []
for i, j in pairs_rot:
    dist = np.linalg.norm(positions_rotated[i] - positions_rotated[j])
    w = np.exp(-dist)
    rows_r.extend([i, j]); cols_r.extend([j, i]); vals_r.extend([w, w])

W_rot = csr_matrix((vals_r, (rows_r, cols_r)), shape=(n_particles, n_particles))
L_rot = diags(np.array(W_rot.sum(axis=1)).flatten()) - W_rot

print(f"æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µåœ¨æ—‹è½¬ä¸‹ä¸å˜: {np.allclose(L.toarray(), L_rot.toarray())}")
print("â†’ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåŸºäºè·ç¦»çš„å‡ ä½•å›¾å¤©ç„¶å…·æœ‰ SE(3) ä¸å˜æ€§ï¼")
</code></pre>
    </div>

    <div class="callout callout-robot" id="robot-mesh">
      <h4>ğŸ¤– PhysRobot å…³è”ï¼šç‰©ç†ç³»ç»Ÿå°±æ˜¯å‡ ä½•å›¾ï¼</h4>
      <p>GNS çš„æ ¸å¿ƒæ´å¯Ÿï¼šç‰©ç†ç³»ç»Ÿå¯ä»¥ç»Ÿä¸€è¡¨ç¤ºä¸º<strong>å‡ ä½•å›¾</strong>ï¼š</p>
      <table>
        <tr><th>ç‰©ç†ç³»ç»Ÿ</th><th>èŠ‚ç‚¹</th><th>è¾¹</th><th>ç‰¹æ®Šç»“æ„</th></tr>
        <tr><td>æµä½“ï¼ˆSPHï¼‰</td><td>ç²’å­</td><td>$r$-è¿‘é‚»</td><td>åŠ¨æ€å›¾ï¼ˆæ¯æ­¥é‡å»ºï¼‰</td></tr>
        <tr><td>æŸ”ä½“ï¼ˆFEMï¼‰</td><td>ç½‘æ ¼é¡¶ç‚¹</td><td>ç½‘æ ¼è¾¹</td><td>ä¸‰è§’/å››é¢ä½“é¢</td></tr>
        <tr><td>åˆšä½“</td><td>ç¢°æ’ç‚¹</td><td>æ¥è§¦å…³ç³»</td><td>SE(3) çº¦æŸ</td></tr>
        <tr><td>å¸ƒæ–™</td><td>ç½‘æ ¼èŠ‚ç‚¹</td><td>æ‹‰ä¼¸/å¼¯æ›²è¾¹</td><td>æµå½¢ç»“æ„</td></tr>
      </table>
      <p>åœ¨ GNS çš„ Encode-Process-Decode æ¡†æ¶ä¸­ï¼š</p>
      <ul>
        <li><strong>Encode</strong>ï¼šå°†ç²’å­ä½ç½®/é€Ÿåº¦ç¼–ç ä¸ºèŠ‚ç‚¹ç‰¹å¾ï¼Œç›¸å¯¹ä½ç½®/è·ç¦»ç¼–ç ä¸ºè¾¹ç‰¹å¾</li>
        <li><strong>Process</strong>ï¼šå¤šè½®æ¶ˆæ¯ä¼ é€’ï¼ˆÂ§4.1 çš„å±€éƒ¨ç­‰å˜å‡½æ•° $\phi$ï¼‰</li>
        <li><strong>Decode</strong>ï¼šé¢„æµ‹åŠ é€Ÿåº¦ï¼ˆ=ä¸‹ä¸€æ­¥æ›´æ–°ï¼‰</li>
      </ul>
      <p>ä½¿ç”¨<strong>ç›¸å¯¹ä½ç½®</strong>å’Œ<strong>è·ç¦»</strong>ä½œä¸ºè¾¹ç‰¹å¾ï¼Œè‡ªåŠ¨ä¿è¯äº† $\text{SE}(3)$ ä¸å˜æ€§â€”â€”è¿™å°±æ˜¯ Â§4.3 ç¾¤å¯¹ç§°æ€§åœ¨å®è·µä¸­çš„ä½“ç°ï¼</p>
    </div>

    <div class="callout callout-exercise">
      <h4>ğŸ“ ç»ƒä¹  4.6</h4>
      <ol>
        <li><strong>è®¡ç®—</strong>ï¼šå¯¹ä¸€ä¸ªæ­£ä¸‰è§’å½¢ç½‘æ ¼ï¼ˆ3 ä¸ªé¡¶ç‚¹ï¼‰ï¼Œå†™å‡ºç»„åˆæ‹‰æ™®æ‹‰æ–¯å’Œä½™åˆ‡æ‹‰æ™®æ‹‰æ–¯ï¼Œæ¯”è¾ƒå®ƒä»¬çš„ç‰¹å¾å€¼ã€‚</li>
        <li><strong>ç¼–ç¨‹</strong>ï¼šåŠ è½½ä¸€ä¸ª 3D ç½‘æ ¼ï¼ˆå¦‚ Stanford Bunnyï¼‰ï¼Œè®¡ç®—ä½™åˆ‡æ‹‰æ™®æ‹‰æ–¯çš„å‰ 20 ä¸ªç‰¹å¾å‡½æ•°ï¼Œå¯è§†åŒ–åœ¨ç½‘æ ¼ä¸Šã€‚</li>
        <li><strong>å®éªŒ</strong>ï¼šå¯¹ä¸Šé¢çš„ç²’å­ç³»ç»Ÿä»£ç ï¼Œæ”¹å˜è·ç¦»é˜ˆå€¼ $r$ï¼Œè§‚å¯Ÿå›¾çš„è¿é€šæ€§å’Œæ‹‰æ™®æ‹‰æ–¯è°±çš„å˜åŒ–ã€‚</li>
        <li><strong>æ€è€ƒ</strong>ï¼šä¸ºä»€ä¹ˆ GNS çš„å›¾æ¯ä¸ªæ—¶é—´æ­¥éƒ½è¦é‡å»ºï¼Ÿå¦‚æœç”¨å›ºå®šçš„å›¾ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</li>
      </ol>
    </div>


    <!-- ============================================================ -->
    <!-- COMPREHENSIVE EXERCISES -->
    <!-- ============================================================ -->
    <h2 id="exercises-all">ğŸ“ ç»¼åˆç»ƒä¹ </h2>

    <div class="callout callout-exercise">
      <h4>Exercise Aï¼š5G å¯¹ç…§åˆ†æ</h4>
      <p>å¡«å†™ä¸‹è¡¨ï¼Œæ¯”è¾ƒäº”ç§å‡ ä½•åŸŸçš„å…³é”®å±æ€§ï¼š</p>
      <table>
        <tr><th>å±æ€§</th><th>Graph</th><th>Grid</th><th>Group/é½æ€§ç©ºé—´</th><th>Manifold</th><th>Gauge/Bundle</th></tr>
        <tr><td>å¯¹ç§°ç¾¤</td><td>$\Sigma_n$</td><td>?</td><td>?</td><td>?</td><td>?</td></tr>
        <tr><td>æƒé‡å…±äº«</td><td>?</td><td>?</td><td>?</td><td>?</td><td>?</td></tr>
        <tr><td>å·ç§¯ç±»å‹</td><td>?</td><td>?</td><td>?</td><td>?</td><td>?</td></tr>
        <tr><td>å‚…é‡Œå¶åŸº</td><td>?</td><td>?</td><td>?</td><td>?</td><td>?</td></tr>
        <tr><td>æ»¤æ³¢å™¨æ–¹å‘æ€§</td><td>?</td><td>?</td><td>?</td><td>?</td><td>?</td></tr>
      </table>
    </div>

    <div class="callout callout-exercise">
      <h4>Exercise Bï¼šä»é›†åˆåˆ°ç½‘æ ¼çš„è¿ç»­ä½“</h4>
      <p>é›†åˆ â†’ å›¾ â†’ ç½‘æ ¼ â†’ æµå½¢ æ˜¯ä¸€æ¡ä»ç®€å•åˆ°å¤æ‚çš„è·¯å¾„ã€‚å¯¹äºæ¯ä¸€æ­¥çš„"å‡çº§"ï¼Œè¯´æ˜ï¼š</p>
      <ol>
        <li>å¢åŠ äº†ä»€ä¹ˆç»“æ„ï¼Ÿ</li>
        <li>è·å¾—äº†ä»€ä¹ˆæ–°çš„è®¡ç®—èƒ½åŠ›ï¼Ÿ</li>
        <li>å¼•å…¥äº†ä»€ä¹ˆæ–°çš„å¯¹ç§°æ€§çº¦æŸï¼Ÿ</li>
      </ol>
    </div>

    <div class="callout callout-exercise">
      <h4>Exercise Cï¼šPhysRobot è®¾è®¡æŒ‘æˆ˜</h4>
      <p>ä½ éœ€è¦è®¾è®¡ä¸€ä¸ª GNN æ¥ä»¿çœŸä»¥ä¸‹ç‰©ç†åœºæ™¯ã€‚å¯¹æ¯ä¸ªåœºæ™¯ï¼ŒæŒ‡å‡ºåº”è¯¥ä½¿ç”¨å“ªç§å‡ ä½•åŸŸè¡¨ç¤ºï¼Œå“ªç§å¯¹ç§°æ€§çº¦æŸï¼Œä»¥åŠå¦‚ä½•ç¼–ç è¾“å…¥ï¼š</p>
      <ol>
        <li>æ°´æ¯ä¸­çš„æ°´ï¼ˆSPH æµä½“ï¼‰</li>
        <li>å¼¹æ€§çƒè½åœ¨åœ°é¢ä¸Šï¼ˆFEM æŸ”ä½“ï¼‰</li>
        <li>ä¸€ç¾¤æ˜Ÿæ˜Ÿçš„å¼•åŠ›äº¤äº’ï¼ˆN-body é—®é¢˜ï¼‰</li>
        <li>è›‹ç™½è´¨åˆ†å­çš„è¡¨é¢ï¼ˆåˆ†å­è¡¨é¢ï¼‰</li>
      </ol>
    </div>


    <!-- ============================================================ -->
    <!-- SUMMARY -->
    <!-- ============================================================ -->
    <h2 id="summary">ğŸ“Š ç« èŠ‚æ€»ç»“</h2>

    <div class="callout callout-success">
      <h4>âœ… æ ¸å¿ƒè¦ç‚¹</h4>
      <ol>
        <li><strong>5G æ˜¯ä¸€å¼ åœ°å›¾</strong>ï¼šGraphs, Grids, Groups, Geodesics, Gauges æ˜¯äº”ç§å…³é”®çš„å‡ ä½•åŸŸï¼Œæ¯ç§åŸŸæœ‰ä¸åŒçš„å¯¹ç§°ç¾¤å’Œä¸å˜æ€§ç»“æ„</li>
        <li><strong>å¯¹ç§°æ€§å†³å®šæ¶æ„</strong>ï¼šCNN = å¹³ç§»å¯¹ç§°ï¼ŒGNN = ç½®æ¢å¯¹ç§°ï¼ŒSpherical CNN = æ—‹è½¬å¯¹ç§°â€”â€”æ¶æ„ä»å¯¹ç§°æ€§ä¸­æ¶Œç°</li>
        <li><strong>å·ç§¯çš„ç»Ÿä¸€è§†è§’</strong>ï¼šæ‰€æœ‰å·ç§¯éƒ½æ˜¯"æ¨¡å¼åŒ¹é…"â€”â€”åœ¨åŸŸä¸Šæ»‘åŠ¨æ»¤æ³¢å™¨å¹¶è®¡ç®—å†…ç§¯ã€‚ä¸åŒä¹‹å¤„åœ¨äºæ»¤æ³¢å™¨å¦‚ä½•"æ»‘åŠ¨"ï¼ˆç¾¤ä½œç”¨ï¼‰</li>
        <li><strong>è°±ä¸ç©ºé—´å¯¹å¶</strong>ï¼šå‚…é‡Œå¶å˜æ¢å¯¹è§’åŒ–å¯¹ç§°ç®—å­ï¼Œå·ç§¯ = é¢‘åŸŸä¹˜æ³•ã€‚è¿™å¯¹æ‰€æœ‰åŸŸéƒ½æˆç«‹ï¼Œä½†å¯¹ç§°ç¾¤ä¸åŒæ—¶ï¼Œå‚…é‡Œå¶åŸºä¹Ÿä¸åŒ</li>
        <li><strong>å±€éƒ¨ vs å…¨å±€</strong>ï¼šé½æ€§ç©ºé—´æœ‰å…¨å±€å¯¹ç§°æ€§ï¼ˆå¯ä»¥å…±äº«æ»¤æ³¢å™¨ï¼‰ï¼Œä¸€èˆ¬æµå½¢åªæœ‰å±€éƒ¨ç»“æ„ï¼ˆéœ€è¦è§„èŒƒç†è®ºï¼‰</li>
        <li><strong>è§„èŒƒæ˜¯å¿…é¡»çš„</strong>ï¼šåœ¨ä¸å¯å¹³è¡ŒåŒ–çš„æµå½¢ä¸Šï¼ˆå¦‚çƒé¢ï¼‰ï¼Œæ— æ³•é¿å…è§„èŒƒç†è®ºâ€”â€”å®ƒä¸æ˜¯å¥¢ä¾ˆå“ï¼Œè€Œæ˜¯å¿…éœ€å“</li>
        <li><strong>ç‰©ç†ç³»ç»Ÿæ˜¯å‡ ä½•å›¾</strong>ï¼šGNS å°†ç²’å­ç³»ç»Ÿç¼–ç ä¸ºå‡ ä½•å›¾ï¼Œåˆ©ç”¨ç›¸å¯¹ä½ç½®å’Œè·ç¦»ä¿è¯ SE(3) ä¸å˜æ€§</li>
      </ol>
    </div>

    <div class="callout callout-info">
      <h4>ğŸ“– ä»åŸŸåˆ°æ¶æ„çš„è·¯çº¿å›¾</h4>
      <p>æœ¬ç« æè¿°äº†"åœ¨å“ªé‡Œ"ï¼ˆå‡ ä½•åŸŸï¼‰å’Œ"ä»€ä¹ˆå¯¹ç§°æ€§"ï¼ˆå¯¹ç§°ç¾¤ï¼‰ã€‚ä¸‹ä¸€ç« ï¼ˆChapter 5ï¼‰å°†è®¨è®º"æ€ä¹ˆåš"â€”â€”åœ¨æ¯ç§åŸŸä¸Šå¦‚ä½•å…·ä½“å®ç° GDL è“å›¾çš„æ„å»ºå—ï¼ˆçº¿æ€§ç­‰å˜å±‚ã€éçº¿æ€§ã€æ± åŒ–ï¼‰ã€‚</p>
      <table>
        <tr><th>æœ¬ç« ï¼ˆCh.4ï¼‰</th><th>â†’</th><th>ä¸‹ä¸€ç« ï¼ˆCh.5ï¼‰</th></tr>
        <tr><td>å›¾ + ç½®æ¢å¯¹ç§°</td><td>â†’</td><td>GNN æ¶ˆæ¯ä¼ é€’å±‚</td></tr>
        <tr><td>ç½‘æ ¼ + å¹³ç§»å¯¹ç§°</td><td>â†’</td><td>CNN å·ç§¯å±‚</td></tr>
        <tr><td>ç¾¤ + ç¾¤å¯¹ç§°</td><td>â†’</td><td>çƒé¢ CNNã€ç¾¤ç­‰å˜ CNN</td></tr>
        <tr><td>æµå½¢ + ç­‰è·å¯¹ç§°</td><td>â†’</td><td>å†…è•´ CNNã€Mesh CNN</td></tr>
        <tr><td>çº¤ç»´ä¸› + è§„èŒƒå¯¹ç§°</td><td>â†’</td><td>è§„èŒƒç­‰å˜ CNN</td></tr>
      </table>
    </div>

    <h2 id="references">ğŸ“š å…³é”®å‚è€ƒæ–‡çŒ®</h2>
    <ul>
      <li><strong>Bronstein et al., 2021</strong> â€” "Geometric Deep Learning: Grids, Groups, Graphs, Geodesics, and Gauges" (åŸæ–‡)</li>
      <li><strong>Bruna et al., 2013</strong> â€” é¦–ä¸ªåŸºäºå›¾è°±çš„ GNNï¼ˆè°±åŸŸå·ç§¯ï¼‰</li>
      <li><strong>Defferrard et al., 2016</strong> â€” ChebNetï¼ˆå¤šé¡¹å¼è°±æ»¤æ³¢å™¨ï¼‰</li>
      <li><strong>Kipf & Welling, 2017</strong> â€” GCNï¼ˆç®€åŒ–è°±æ–¹æ³•ï¼‰</li>
      <li><strong>Cohen & Welling, 2016</strong> â€” ç¾¤ç­‰å˜ CNNï¼ˆ$p4$, $p4m$ ç¾¤ï¼‰</li>
      <li><strong>Cohen et al., 2018</strong> â€” çƒé¢ CNNï¼ˆSO(3) ç­‰å˜ï¼‰</li>
      <li><strong>Boscaini et al., 2016</strong> â€” æµå½¢ä¸Šçš„å„å‘å¼‚æ€§ CNN</li>
      <li><strong>de Haan et al., 2021</strong> â€” è§„èŒƒç­‰å˜ç½‘æ ¼ CNN</li>
      <li><strong>Ovsjanikov et al., 2012</strong> â€” å‡½æ•°æ˜ å°„</li>
      <li><strong>Levie et al., 2018</strong> â€” CayleyNetï¼ˆæœ‰ç†è°±æ»¤æ³¢å™¨ï¼‰</li>
      <li><strong>Sanchez-Gonzalez et al., 2020</strong> â€” GNSï¼ˆå›¾ç½‘ç»œä»¿çœŸå™¨ï¼‰</li>
    </ul>

  </main>

  <!-- ============================================================ -->
  <!-- JavaScript -->
  <!-- ============================================================ -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
  <script>
    // === Theme Toggle ===
    function toggleTheme() {
      const html = document.documentElement;
      const current = html.getAttribute('data-theme');
      const next = current === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
      document.querySelector('.theme-toggle').textContent = next === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
    }
    // Restore theme
    (function() {
      const saved = localStorage.getItem('theme');
      if (saved === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
      }
    })();

    // === Sidebar Toggle ===
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('open');
    }

    // === Progress Bar ===
    window.addEventListener('scroll', function() {
      const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const scrolled = (winScroll / height) * 100;
      document.getElementById('progressBar').style.width = scrolled + '%';
    });

    // === Copy Code ===
    function copyCode(btn) {
      const pre = btn.closest('.code-container').querySelector('pre');
      const code = pre.textContent;
      navigator.clipboard.writeText(code).then(() => {
        btn.textContent = 'âœ… å·²å¤åˆ¶';
        setTimeout(() => btn.textContent = 'ğŸ“‹ å¤åˆ¶', 2000);
      });
    }

    // === Active Sidebar Link ===
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
          const id = entry.target.id;
          const link = document.querySelector(`.sidebar a[href="#${id}"]`);
          if (link) link.classList.add('active');
        }
      });
    }, { rootMargin: '-20% 0px -70% 0px' });

    document.querySelectorAll('h2[id], h3[id]').forEach(el => observer.observe(el));

    // === Close sidebar on link click (mobile) ===
    document.querySelectorAll('.sidebar a').forEach(a => {
      a.addEventListener('click', () => {
        if (window.innerWidth <= 768) {
          document.getElementById('sidebar').classList.remove('open');
        }
      });
    });
  </script>
</body>
</html>
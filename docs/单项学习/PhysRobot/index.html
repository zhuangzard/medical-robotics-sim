<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PhysRobot æ·±åº¦æ•™ç¨‹ â€” ç‰©ç†å®ˆæ’ GNN + å¼ºåŒ–å­¦ä¹ </title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
<style>
:root {
  --bg: #ffffff;
  --bg-secondary: #f7f8fa;
  --text: #1a1a2e;
  --text-secondary: #555;
  --accent: #4361ee;
  --accent-light: #e8edff;
  --border: #e0e0e0;
  --sidebar-bg: #f0f2f5;
  --sidebar-active: #4361ee;
  --code-bg: #f6f8fa;
  --code-text: #24292e;
  --def-bg: #e8f4fd;
  --def-border: #2196F3;
  --thm-bg: #e8f5e9;
  --thm-border: #4CAF50;
  --ex-bg: #fff8e1;
  --ex-border: #FF9800;
  --warn-bg: #ffebee;
  --warn-border: #f44336;
  --insight-bg: #f3e5f5;
  --insight-border: #9C27B0;
  --shadow: 0 2px 8px rgba(0,0,0,0.08);
  --radius: 8px;
  --sidebar-w: 280px;
  --font-cn: "PingFang SC","Hiragino Sans GB","Microsoft YaHei","Noto Sans CJK SC",sans-serif;
  --font-mono: "SF Mono","Fira Code","JetBrains Mono",Consolas,monospace;
}
[data-theme="dark"] {
  --bg: #0d1117; --bg-secondary: #161b22; --text: #c9d1d9; --text-secondary: #8b949e;
  --accent: #58a6ff; --accent-light: #1c2d41; --border: #30363d; --sidebar-bg: #161b22;
  --sidebar-active: #58a6ff; --code-bg: #161b22; --code-text: #c9d1d9;
  --def-bg: #0d2137; --def-border: #58a6ff; --thm-bg: #0d2818; --thm-border: #3fb950;
  --ex-bg: #2a1f00; --ex-border: #d29922; --warn-bg: #2d0f0f; --warn-border: #f85149;
  --insight-bg: #1a0d1f; --insight-border: #a855f7;
  --shadow: 0 2px 8px rgba(0,0,0,0.3);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth;scroll-padding-top:80px}
body{font-family:var(--font-cn);background:var(--bg);color:var(--text);line-height:1.8;font-size:16px;transition:background .3s,color .3s}
.sidebar{position:fixed;top:0;left:0;width:var(--sidebar-w);height:100vh;background:var(--sidebar-bg);border-right:1px solid var(--border);overflow-y:auto;z-index:100;padding:20px 0;transition:transform .3s ease,background .3s}
.sidebar-header{padding:10px 20px 20px;border-bottom:1px solid var(--border);margin-bottom:10px}
.sidebar-header h2{font-size:18px;color:var(--accent);margin-bottom:4px}
.sidebar-header p{font-size:12px;color:var(--text-secondary)}
.sidebar nav a{display:block;padding:6px 20px;color:var(--text-secondary);text-decoration:none;font-size:13px;border-left:3px solid transparent;transition:all .2s}
.sidebar nav a:hover{color:var(--accent);background:var(--accent-light)}
.sidebar nav a.active{color:var(--sidebar-active);border-left-color:var(--sidebar-active);background:var(--accent-light);font-weight:600}
.sidebar nav .ch-title{font-weight:700;color:var(--text);padding:12px 20px 4px;font-size:13px;text-transform:uppercase;letter-spacing:.5px}
.main-content{margin-left:var(--sidebar-w);padding:40px 60px 80px;max-width:900px}
.top-bar{position:fixed;top:0;left:var(--sidebar-w);right:0;height:50px;background:var(--bg);border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:flex-end;padding:0 20px;z-index:99;gap:10px}
.top-bar button{background:none;border:1px solid var(--border);border-radius:6px;padding:4px 12px;cursor:pointer;color:var(--text);font-size:13px;transition:all .2s}
.top-bar button:hover{background:var(--accent-light);border-color:var(--accent)}
h1{font-size:2em;margin:60px 0 20px;padding-bottom:10px;border-bottom:2px solid var(--accent);color:var(--accent)}
h2{font-size:1.5em;margin:40px 0 15px;padding-bottom:6px;border-bottom:1px solid var(--border);color:var(--text)}
h3{font-size:1.2em;margin:30px 0 10px;color:var(--text)}
h4{font-size:1.05em;margin:20px 0 8px;color:var(--text-secondary)}
p{margin:10px 0}
a{color:var(--accent);text-decoration:none}
a:hover{text-decoration:underline}
ul,ol{margin:10px 0 10px 24px}
li{margin:4px 0}
table{width:100%;border-collapse:collapse;margin:15px 0;font-size:.95em}
th,td{border:1px solid var(--border);padding:8px 12px;text-align:left}
th{background:var(--bg-secondary);font-weight:600}
tr:nth-child(even){background:var(--bg-secondary)}
code{font-family:var(--font-mono);background:var(--code-bg);color:var(--code-text);padding:2px 6px;border-radius:4px;font-size:.9em}
pre{background:var(--code-bg);border:1px solid var(--border);border-radius:var(--radius);padding:16px 20px;overflow-x:auto;margin:15px 0;line-height:1.5;position:relative}
pre code{background:none;padding:0;font-size:.85em}
pre .copy-btn{position:absolute;top:8px;right:8px;background:var(--bg);border:1px solid var(--border);border-radius:4px;padding:2px 8px;cursor:pointer;font-size:12px;opacity:0;transition:opacity .2s}
pre:hover .copy-btn{opacity:1}
.box{border-left:4px solid;padding:16px 20px;margin:20px 0;border-radius:0 var(--radius) var(--radius) 0}
.box-title{font-weight:700;margin-bottom:6px;display:flex;align-items:center;gap:6px}
.def{background:var(--def-bg);border-color:var(--def-border)}
.thm{background:var(--thm-bg);border-color:var(--thm-border)}
.ex{background:var(--ex-bg);border-color:var(--ex-border)}
.warn{background:var(--warn-bg);border-color:var(--warn-border)}
.insight{background:var(--insight-bg);border-color:var(--insight-border)}
.arch-diagram{background:var(--code-bg);border:1px solid var(--border);border-radius:var(--radius);padding:20px;margin:20px 0;font-family:var(--font-mono);font-size:.82em;line-height:1.4;white-space:pre;overflow-x:auto}
.formula-card{background:var(--bg-secondary);border:1px solid var(--border);border-radius:var(--radius);padding:16px;margin:15px 0;text-align:center}
.formula-card .label{font-size:.85em;color:var(--text-secondary);margin-top:6px}
.progress-bar{position:fixed;top:0;left:0;width:0;height:3px;background:linear-gradient(90deg,var(--accent),#9b59b6);z-index:200;transition:width .1s}
.menu-toggle{display:none;position:fixed;top:10px;left:10px;z-index:200;background:var(--accent);color:#fff;border:none;border-radius:6px;padding:8px 12px;font-size:18px;cursor:pointer}
@media(max-width:900px){
  .sidebar{transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .main-content{margin-left:0;padding:20px}
  .top-bar{left:0}
  .menu-toggle{display:block}
}
.katex-display{margin:12px 0;overflow-x:auto;overflow-y:hidden}
</style>
</head>
<body>

<div class="progress-bar" id="progressBar"></div>
<button class="menu-toggle" id="menuToggle">â˜°</button>

<aside class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <h2>âš›ï¸ PhysRobot</h2>
    <p>ç‰©ç†å®ˆæ’GNN + å¼ºåŒ–å­¦ä¹ </p>
  </div>
  <nav>
    <div class="ch-title">ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºç¡€</div>
    <a href="#ch1">ç¬¬1ç«  é—®é¢˜å®šä¹‰</a>
    <a href="#ch1-1">1.1 ä¼ ç»ŸRLçš„ä½æ•ˆ</a>
    <a href="#ch1-2">1.2 ç‰©ç†å…ˆéªŒçŸ¥è¯†</a>
    <a href="#ch1-3">1.3 PhysRobotæ ¸å¿ƒåˆ›æ–°</a>
    <a href="#ch2">ç¬¬2ç«  ç†è®ºåŸºç¡€</a>
    <a href="#ch2-1">2.1 åŠ›å­¦æ¡†æ¶æ¼”è¿›</a>
    <a href="#ch2-2">2.2 å®ˆæ’å®šå¾‹</a>
    <a href="#ch2-3">2.3 è¾›ç»“æ„ä¸è¾›ç§¯åˆ†å™¨</a>
    <a href="#ch2-4">2.4 å¯¹æœºå™¨å­¦ä¹ çš„æ„ä¹‰</a>
    <div class="ch-title">ç¬¬äºŒéƒ¨åˆ†ï¼šæ¶æ„</div>
    <a href="#ch3">ç¬¬3ç«  å®Œæ•´æ¶æ„</a>
    <a href="#ch3-1">3.1 æ¶æ„æ€»è§ˆ</a>
    <a href="#ch3-2">3.2 è¾“å…¥è¾“å‡ºç»´åº¦</a>
    <a href="#ch3-3">3.3 ä¿¡æ¯æµåŠ¨è·¯å¾„</a>
    <a href="#ch3-4">3.4 æ¢¯åº¦ä¼ æ’­</a>
    <a href="#ch4">ç¬¬4ç«  EdgeFrameæ·±å…¥</a>
    <a href="#ch4-1">4.1 ä¸ºä»€ä¹ˆéœ€è¦è¾¹å¸§</a>
    <a href="#ch4-2">4.2 æ•°å­¦æ¨å¯¼</a>
    <a href="#ch4-3">4.3 SE(3)ç­‰å˜æ€§</a>
    <a href="#ch4-4">4.4 ä»£ç è§£æ</a>
    <a href="#ch5">ç¬¬5ç«  DynamicalGNNæ·±å…¥</a>
    <a href="#ch5-1">5.1 æ¶ˆæ¯ä¼ é€’æ¨å¯¼</a>
    <a href="#ch5-2">5.2 å®ˆæ’å¾‹ç¼–ç </a>
    <a href="#ch5-3">5.3 ä»£ç è§£æ</a>
    <a href="#ch6">ç¬¬6ç«  è¾›ç§¯åˆ†å™¨</a>
    <a href="#ch6-1">6.1 ä¸ºä»€ä¹ˆä¸ç”¨Euler</a>
    <a href="#ch6-2">6.2 Leapfrogæ–¹æ³•</a>
    <a href="#ch6-3">6.3 åœ¨RLä¸­çš„ä½œç”¨</a>
    <div class="ch-title">ç¬¬ä¸‰éƒ¨åˆ†ï¼šè®­ç»ƒ</div>
    <a href="#ch7">ç¬¬7ç«  ä¸PPOæ•´åˆ</a>
    <a href="#ch7-1">7.1 BaseFeaturesExtractor</a>
    <a href="#ch7-2">7.2 ç‰©ç†ç‰¹å¾é€å…¥PPO</a>
    <a href="#ch7-3">7.3 è®­ç»ƒä»£ç è§£æ</a>
    <a href="#ch8">ç¬¬8ç«  å®éªŒè®¾è®¡</a>
    <a href="#ch8-1">8.1 å…¬å¹³å¯¹æ¯”è¦æ±‚</a>
    <a href="#ch8-2">8.2 Ablationè®¾è®¡</a>
    <div class="ch-title">ç¬¬å››éƒ¨åˆ†ï¼šåˆ†æ</div>
    <a href="#ch9">ç¬¬9ç«  ç›¸å…³å·¥ä½œå¯¹æ¯”</a>
    <a href="#ch9-1">9.1 vs HNN/LNN</a>
    <a href="#ch9-2">9.2 vs GNS/EGNN</a>
    <a href="#ch9-3">9.3 vs Model-based RL</a>
    <a href="#ch10">ç¬¬10ç«  è®ºæ–‡å†™ä½œå»ºè®®</a>
    <a href="#appendix">é™„å½•</a>
    <a href="#appendix-algo">A. ç®—æ³•ä¼ªä»£ç </a>
    <a href="#appendix-symbols">B. æ•°å­¦ç¬¦å·è¡¨</a>
    <a href="#appendix-formulas">C. å…³é”®å…¬å¼é€ŸæŸ¥</a>
  </nav>
</aside>

<div class="top-bar">
  <button onclick="toggleTheme()">ğŸŒ“ ä¸»é¢˜</button>
  <button onclick="window.scrollTo({top:0,behavior:'smooth'})">â†‘ é¡¶éƒ¨</button>
</div>

<main class="main-content">

<!-- ========== ç¬¬1ç«  ========== -->
<h1 id="ch1">ç¬¬ä¸€ç« ï¼šé—®é¢˜å®šä¹‰</h1>

<h2 id="ch1-1">1.1 ä¸ºä»€ä¹ˆä¼ ç»Ÿ RL åœ¨ç‰©ç†ä»»åŠ¡ä¸Šæ•ˆç‡ä½ï¼Ÿ</h2>

<p>å¼ºåŒ–å­¦ä¹ ï¼ˆRLï¼‰åœ¨ Atari æ¸¸æˆã€å›´æ£‹ç­‰çº¯ä¿¡æ¯ç¯å¢ƒä¸­å–å¾—äº†å·¨å¤§æˆåŠŸï¼Œä½†åœ¨éœ€è¦ç‰©ç†äº¤äº’çš„æœºå™¨äººæ“ä½œä»»åŠ¡ä¸­ï¼ŒRL é¢ä¸´æ ¹æœ¬æ€§æŒ‘æˆ˜ï¼š</p>

<div class="box warn">
<div class="box-title">âš ï¸ æ ¸å¿ƒé—®é¢˜</div>
<p><strong>ä¼ ç»Ÿ RL ä»é›¶å­¦ä¹ ç‰©ç†è§„å¾‹</strong>â€”â€”å®ƒå¿…é¡»é€šè¿‡è¯•é”™å‘ç°"æ¨é‡ç‰©éœ€è¦æ›´å¤§åŠ›"ã€"åŠ¨é‡ä¼šä¼ é€’"ç­‰äººç±»å‡­ç›´è§‰å°±çŸ¥é“çš„äº‹å®ã€‚è¿™å¯¼è‡´ï¼š</p>
<ul>
<li><strong>æ ·æœ¬æ•ˆç‡æä½</strong>ï¼šéœ€è¦ 10âµ~10â¶ æ¬¡äº¤äº’æ‰èƒ½å­¦ä¼šç®€å•çš„æ¨ç®±å­ä»»åŠ¡</li>
<li><strong>OOD æ³›åŒ–å·®</strong>ï¼šæ¢ä¸€ä¸ªè´¨é‡ä¸åŒçš„ç®±å­ï¼Œç­–ç•¥å°±å¤±æ•ˆ</li>
<li><strong>å®‰å…¨æ€§å·®</strong>ï¼šæ— æ³•ä¿è¯åŠ›/èƒ½é‡çº¦æŸï¼Œåœ¨åŒ»ç–—ç­‰åœºæ™¯ä¸­ä¸å¯æ¥å—</li>
</ul>
</div>

<p>æ ¹æœ¬åŸå› åœ¨äº RL çš„ MLP ç­–ç•¥ç½‘ç»œæ˜¯ä¸€ä¸ª<strong>é€šç”¨å‡½æ•°é€¼è¿‘å™¨</strong>â€”â€”å®ƒæ²¡æœ‰ä»»ä½•ç‰©ç†å½’çº³åç½®ï¼ˆinductive biasï¼‰ã€‚ç»™å®šç›¸åŒçš„è§‚æµ‹ï¼ŒMLP æ— æ³•åŒºåˆ†"è´¨é‡å¯¼è‡´çš„åŠ é€Ÿåº¦å˜åŒ–"å’Œ"æ‘©æ“¦å¯¼è‡´çš„å‡é€Ÿ"ï¼Œå› ä¸ºå®ƒä¸ç†è§£ \(F = ma\)ã€‚</p>

<div class="box def">
<div class="box-title">ğŸ“– å…³é”®æ¦‚å¿µï¼šå½’çº³åç½®ï¼ˆInductive Biasï¼‰</div>
<p>å½’çº³åç½®æ˜¯æŒ‡æ¨¡å‹æ¶æ„ä¸­å†…ç½®çš„å…ˆéªŒå‡è®¾ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>CNN</strong> çš„å¹³ç§»ä¸å˜æ€§ â†’ é€‚åˆå›¾åƒ</li>
<li><strong>RNN</strong> çš„åºåˆ—ç»“æ„ â†’ é€‚åˆæ—¶åºæ•°æ®</li>
<li><strong>GNN</strong> çš„å›¾ç»“æ„ â†’ é€‚åˆå…³ç³»æ¨ç†</li>
<li><strong>PhysRobot</strong> çš„ç‰©ç†å®ˆæ’ â†’ é€‚åˆç‰©ç†äº¤äº’ä»»åŠ¡</li>
</ul>
</div>

<h2 id="ch1-2">1.2 ç‰©ç†å…ˆéªŒçŸ¥è¯†æœ‰å“ªäº›ï¼Ÿå¦‚ä½•åˆ©ç”¨ï¼Ÿ</h2>

<p>åœ¨ç‰›é¡¿åŠ›å­¦æ¡†æ¶ä¸‹ï¼Œç‰©ç†äº¤äº’éµå¾ªä¸€ç»„ç²¾ç¡®çš„å®šå¾‹ï¼š</p>

<table>
<tr><th>å…ˆéªŒçŸ¥è¯†</th><th>æ•°å­¦è¡¨è¾¾</th><th>å¯¹ RL çš„ä»·å€¼</th></tr>
<tr><td>ç‰›é¡¿ç¬¬äºŒå®šå¾‹</td><td>\(F = ma\)</td><td>çŸ¥é“åŠ›â†’åŠ é€Ÿåº¦çš„å› æœå…³ç³»</td></tr>
<tr><td>ç‰›é¡¿ç¬¬ä¸‰å®šå¾‹</td><td>\(F_{ij} = -F_{ji}\)</td><td>åŠ›çš„åå¯¹ç§°æ€§ â†’ åŠ¨é‡å®ˆæ’</td></tr>
<tr><td>åŠ¨é‡å®ˆæ’</td><td>\(\sum m_i v_i = \text{const}\)</td><td>é¢„æµ‹ç¢°æ’åè¿åŠ¨</td></tr>
<tr><td>èƒ½é‡å®ˆæ’</td><td>\(E_k + E_p = \text{const}\)</td><td>çº¦æŸå¯è¾¾çŠ¶æ€ç©ºé—´</td></tr>
<tr><td>å‡ ä½•å¯¹ç§°æ€§</td><td>SE(3) ç­‰å˜æ€§</td><td>æ—‹è½¬/å¹³ç§»ä¸å˜çš„ç‰©ç†è§„å¾‹</td></tr>
</table>

<p>PhysRobot çš„æ ¸å¿ƒæ€è·¯æ˜¯ï¼š<strong>å°†è¿™äº›å…ˆéªŒç›´æ¥ç¼–ç åˆ°ç¥ç»ç½‘ç»œæ¶æ„ä¸­</strong>ï¼Œè€Œéè®© RL ä»é›¶å­¦ä¹ ã€‚</p>

<h2 id="ch1-3">1.3 PhysRobot çš„æ ¸å¿ƒå‡è®¾å’Œåˆ›æ–°ç‚¹</h2>

<div class="box thm">
<div class="box-title">ğŸ¯ PhysRobot æ ¸å¿ƒå‡è®¾</div>
<ol>
<li><strong>å‡è®¾ 1</strong>ï¼šæœºå™¨äººæ“ä½œä»»åŠ¡ä¸­çš„ç‰©ç†äº¤äº’å¯ä»¥ç”¨å›¾ç¥ç»ç½‘ç»œå»ºæ¨¡ï¼ˆèŠ‚ç‚¹ = ç‰©ä½“ï¼Œè¾¹ = æ¥è§¦/äº¤äº’ï¼‰</li>
<li><strong>å‡è®¾ 2</strong>ï¼šåœ¨ GNN ä¸­å¼ºåˆ¶æ‰§è¡Œç‰›é¡¿ç¬¬ä¸‰å®šå¾‹ï¼ˆ\(F_{ij} = -F_{ji}\)ï¼‰ï¼Œå¯ä»¥ä½œä¸ºæœ‰æ•ˆçš„å½’çº³åç½®</li>
<li><strong>å‡è®¾ 3</strong>ï¼šç‰©ç†æ„ŸçŸ¥çš„ç‰¹å¾è¡¨ç¤ºæ¯”åŸå§‹è§‚æµ‹æ›´é€‚åˆ RL ç­–ç•¥å­¦ä¹ </li>
</ol>
</div>

<div class="box insight">
<div class="box-title">ğŸ’¡ æ ¸å¿ƒåˆ›æ–°</div>
<p>PhysRobot = <strong>Dynami-CAL ç‰©ç† GNN</strong>ï¼ˆæå–ç‰©ç†ä¸€è‡´çš„ç‰¹å¾ï¼‰+ <strong>PPO ç­–ç•¥</strong>ï¼ˆå­¦ä¹ æ§åˆ¶ç­–ç•¥ï¼‰</p>
<p>è¿™æ˜¯é¦–æ¬¡å°†<strong>ç¡¬çº¦æŸåŠ¨é‡å®ˆæ’ GNN</strong> ç”¨ä½œ RL çš„ç‰¹å¾æå–å™¨ï¼Œç”¨äº<strong>æ¥è§¦ä¸°å¯Œçš„éä¿å®ˆæœºå™¨äººæ“ä½œä»»åŠ¡</strong>ã€‚</p>
</div>

<!-- ========== ç¬¬2ç«  ========== -->
<h1 id="ch2">ç¬¬äºŒç« ï¼šç†è®ºåŸºç¡€</h1>

<h2 id="ch2-1">2.1 ä»ç‰›é¡¿åŠ›å­¦åˆ°å“ˆå¯†é¡¿åŠ›å­¦</h2>

<p>ç†è§£ PhysRobot éœ€è¦ä¸‰ä¸ªå±‚æ¬¡çš„åŠ›å­¦æ¡†æ¶ï¼š</p>

<h3>2.1.1 ç‰›é¡¿åŠ›å­¦</h3>

<p>æœ€ç›´è§‚çš„ç‰©ç†æ¡†æ¶ï¼Œç›´æ¥æè¿°åŠ›ä¸è¿åŠ¨çš„å…³ç³»ï¼š</p>

<div class="formula-card">
\[\vec{F} = m\vec{a} = m\frac{d^2\vec{x}}{dt^2}\]
<div class="label">ç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼šåŠ› = è´¨é‡ Ã— åŠ é€Ÿåº¦</div>
</div>

<p>PhysRobot çš„ DynamicalGNN ç›´æ¥å·¥ä½œåœ¨ç‰›é¡¿åŠ›å­¦æ¡†æ¶ä¸­â€”â€”å®ƒé¢„æµ‹çš„æ˜¯åŠ é€Ÿåº¦ \(\vec{a}\)ï¼Œè€Œéèƒ½é‡æˆ–æ‹‰æ ¼æœ—æ—¥é‡ã€‚</p>

<h3>2.1.2 æ‹‰æ ¼æœ—æ—¥åŠ›å­¦</h3>

<p>å¼•å…¥å¹¿ä¹‰åæ ‡ \(q\) å’Œæ‹‰æ ¼æœ—æ—¥é‡ \(L = T - V\)ï¼ˆåŠ¨èƒ½å‡åŠ¿èƒ½ï¼‰ï¼š</p>

<div class="formula-card">
\[\frac{d}{dt}\frac{\partial L}{\partial \dot{q}_i} - \frac{\partial L}{\partial q_i} = 0\]
<div class="label">Euler-Lagrange æ–¹ç¨‹</div>
</div>

<p>Lagrangian Neural Networks (LNN) ä½¿ç”¨ç¥ç»ç½‘ç»œå‚æ•°åŒ– \(L(q, \dot{q})\)ï¼Œè‡ªåŠ¨å¾—åˆ°è¿åŠ¨æ–¹ç¨‹ã€‚</p>

<h3>2.1.3 å“ˆå¯†é¡¿åŠ›å­¦</h3>

<p>å¼•å…¥å¹¿ä¹‰åŠ¨é‡ \(p = \partial L / \partial \dot{q}\) å’Œå“ˆå¯†é¡¿é‡ \(H = T + V\)ï¼ˆæ€»èƒ½é‡ï¼‰ï¼š</p>

<div class="formula-card">
\[\dot{q} = \frac{\partial H}{\partial p}, \quad \dot{p} = -\frac{\partial H}{\partial q}\]
<div class="label">å“ˆå¯†é¡¿æ­£åˆ™æ–¹ç¨‹ï¼šä¿æŒè¾›ç»“æ„</div>
</div>

<p>Hamiltonian Neural Networks (HNN) å‚æ•°åŒ– \(H(q, p)\)ï¼Œè‡ªåŠ¨ä¿è¯èƒ½é‡å®ˆæ’ã€‚</p>

<div class="box ex">
<div class="box-title">ğŸ” PhysRobot ä¸ºä»€ä¹ˆé€‰æ‹©ç‰›é¡¿æ¡†æ¶ï¼Ÿ</div>
<ol>
<li><strong>æ¥è§¦å‹å¥½</strong>ï¼šHNN/LNN å‡è®¾ä¿å®ˆç³»ç»Ÿï¼ˆæ— æ‘©æ“¦ã€æ— ç¢°æ’æŸè€—ï¼‰ï¼Œä¸é€‚åˆæ¥è§¦ä¸°å¯Œçš„æœºå™¨äººæ“ä½œ</li>
<li><strong>GNN å…¼å®¹</strong>ï¼šç‰›é¡¿åŠ›å­¦çš„"åŠ› = äº¤äº’"æ¡†æ¶å¤©ç„¶å¯¹åº” GNN çš„"æ¶ˆæ¯ = è¾¹"</li>
<li><strong>ç›´æ¥å¯ç”¨</strong>ï¼šé¢„æµ‹çš„åŠ é€Ÿåº¦å¯ç›´æ¥é€šè¿‡ç§¯åˆ†å™¨å¾—åˆ°ä¸‹ä¸€çŠ¶æ€</li>
</ol>
</div>

<h2 id="ch2-2">2.2 å®ˆæ’å®šå¾‹</h2>

<h3>2.2.1 åŠ¨é‡å®ˆæ’</h3>

<div class="box thm">
<div class="box-title">ğŸ“ å®šç† 2.1ï¼ˆåŠ¨é‡å®ˆæ’ï¼‰</div>
<p>è‹¥ç³»ç»Ÿä¸­æ‰€æœ‰å†…åŠ›æ»¡è¶³ç‰›é¡¿ç¬¬ä¸‰å®šå¾‹ \(\vec{F}_{ij} = -\vec{F}_{ji}\)ï¼Œåˆ™ç³»ç»Ÿæ€»åŠ¨é‡å®ˆæ’ï¼š</p>
\[\vec{P} = \sum_{i=1}^N m_i \vec{v}_i = \text{å¸¸æ•°}\]
<p><strong>è¯æ˜</strong>ï¼š</p>
\[\frac{d\vec{P}}{dt} = \sum_i m_i \vec{a}_i = \sum_i \sum_{j\neq i} \vec{F}_{ij} = \sum_{i<j}(\vec{F}_{ij} + \vec{F}_{ji}) = \sum_{i<j} \vec{0} = \vec{0} \quad\square\]
</div>

<p>è¿™æ˜¯ PhysRobot çš„<strong>æ ¸å¿ƒç‰©ç†çº¦æŸ</strong>ï¼šé€šè¿‡åœ¨ GNN ä¸­å¼ºåˆ¶ \(\vec{F}_{ij} = -\vec{F}_{ji}\)ï¼Œæˆ‘ä»¬<strong>åœ¨æ¶æ„å±‚é¢ä¿è¯</strong>åŠ¨é‡å®ˆæ’ã€‚</p>

<h3>2.2.2 èƒ½é‡å®ˆæ’</h3>

<div class="formula-card">
\[E = \frac{1}{2}\sum_i m_i |\vec{v}_i|^2 + V(\{\vec{x}_i\}) = \text{å¸¸æ•°ï¼ˆä¿å®ˆç³»ç»Ÿï¼‰}\]
<div class="label">åŠ¨èƒ½ + åŠ¿èƒ½ = æ€»èƒ½é‡ï¼ˆä»…å¯¹ä¿å®ˆåŠ›æˆç«‹ï¼‰</div>
</div>

<p>æ³¨æ„ï¼šPhysRobot <strong>ä¸å¼ºåˆ¶</strong>èƒ½é‡å®ˆæ’ï¼Œå› ä¸ºæœºå™¨äººæ“ä½œæ¶‰åŠæ‘©æ“¦ã€ç¢°æ’ç­‰è€—æ•£è¿‡ç¨‹ã€‚è¿™æ˜¯ä¸ HNN çš„å…³é”®åŒºåˆ«ã€‚</p>

<h3>2.2.3 è§’åŠ¨é‡å®ˆæ’</h3>

<div class="formula-card">
\[\vec{L} = \sum_i \vec{r}_i \times m_i\vec{v}_i = \text{å¸¸æ•°ï¼ˆä¸­å¿ƒåŠ›æ¡ä»¶ä¸‹ï¼‰}\]
<div class="label">éœ€è¦é¢å¤–æ¡ä»¶ï¼š\(\vec{F}_{ij} \parallel \vec{r}_{ij}\)ï¼ˆåŠ›æ²¿è¿çº¿æ–¹å‘ï¼‰</div>
</div>

<h2 id="ch2-3">2.3 è¾›ç»“æ„ä¸è¾›ç§¯åˆ†å™¨</h2>

<p>å“ˆå¯†é¡¿ç³»ç»Ÿçš„ç›¸ç©ºé—´ \((q, p)\) å…·æœ‰è¾›ç»“æ„â€”â€”é¢ç§¯ï¼ˆæ›´ç²¾ç¡®åœ°è¯´ï¼Œè¾›å½¢å¼ï¼‰åœ¨æ—¶é—´æ¼”åŒ–ä¸‹ä¸å˜ã€‚</p>

<div class="box def">
<div class="box-title">ğŸ“– è¾›ç§¯åˆ†å™¨ vs æ™®é€šç§¯åˆ†å™¨</div>
<table>
<tr><th>æ–¹æ³•</th><th>é˜¶æ•°</th><th>èƒ½é‡æ¼‚ç§»</th><th>é•¿æœŸç¨³å®šæ€§</th></tr>
<tr><td>æ˜¾å¼ Euler</td><td>1</td><td>\(O(n \cdot \Delta t^2)\)ï¼ˆçº¿æ€§å¢é•¿ï¼‰</td><td>âŒ å‘æ•£</td></tr>
<tr><td>RK4</td><td>4</td><td>\(O(n \cdot \Delta t^5)\)ï¼ˆç¼“æ…¢å¢é•¿ï¼‰</td><td>âš ï¸ ç¼“æ…¢å‘æ•£</td></tr>
<tr><td><strong>StÃ¶rmer-Verlet</strong></td><td>2</td><td>\(O(\Delta t^2)\)ï¼ˆ<strong>æœ‰ç•Œ</strong>ï¼‰</td><td>âœ… ç¨³å®š</td></tr>
</table>
</div>

<p>StÃ¶rmer-Verletï¼ˆä¹Ÿç§° Leapfrogï¼‰ç§¯åˆ†å™¨ï¼š</p>

<div class="formula-card">
\[\begin{aligned}
\vec{v}_{n+1/2} &= \vec{v}_n + \frac{\Delta t}{2}\vec{a}_n \\
\vec{x}_{n+1} &= \vec{x}_n + \Delta t \cdot \vec{v}_{n+1/2} \\
\vec{a}_{n+1} &= f(\vec{x}_{n+1}) \\
\vec{v}_{n+1} &= \vec{v}_{n+1/2} + \frac{\Delta t}{2}\vec{a}_{n+1}
\end{aligned}\]
<div class="label">StÃ¶rmer-Verlet æ–¹æ³•ï¼šåŠæ­¥æ›´æ–°é€Ÿåº¦ â†’ å…¨æ­¥æ›´æ–°ä½ç½® â†’ åŠæ­¥æ›´æ–°é€Ÿåº¦</div>
</div>

<h2 id="ch2-4">2.4 ä¸ºä»€ä¹ˆè¿™äº›å¯¹æœºå™¨å­¦ä¹ æœ‰ç”¨ï¼Ÿ</h2>

<div class="box insight">
<div class="box-title">ğŸ’¡ ç‰©ç† â†’ ML çš„æ¡¥æ¢</div>
<ol>
<li><strong>åŠ¨é‡å®ˆæ’ â†’ åå¯¹ç§°æ¶ˆæ¯ä¼ é€’</strong>ï¼šGNN çš„æ¶ˆæ¯å‡½æ•°æ»¡è¶³ \(m_{ij} = -m_{ji}\) å°±èƒ½ä¿è¯åŠ¨é‡å®ˆæ’</li>
<li><strong>èƒ½é‡å®ˆæ’ â†’ è¾›ç§¯åˆ†/å“ˆå¯†é¡¿ç»“æ„</strong>ï¼šä½¿ç”¨è¾›ç§¯åˆ†å™¨æˆ–å‚æ•°åŒ– \(H(q,p)\) å¯ä¿æŒèƒ½é‡</li>
<li><strong>å¯¹ç§°æ€§ â†’ ç­‰å˜ç½‘ç»œ</strong>ï¼šSE(3) å¯¹ç§°æ€§å¯¹åº”ç­‰å˜ GNNï¼ˆæ—‹è½¬è¾“å…¥â†’æ—‹è½¬è¾“å‡ºï¼‰</li>
<li><strong>å®ˆæ’å¾‹ â†’ æ ·æœ¬æ•ˆç‡</strong>ï¼šç‰©ç†çº¦æŸå¤§å¹…ç¼©å°å‡è®¾ç©ºé—´ï¼Œå‡å°‘æ‰€éœ€è®­ç»ƒæ•°æ®</li>
</ol>
</div>

<!-- ========== ç¬¬3ç«  ========== -->
<h1 id="ch3">ç¬¬ä¸‰ç« ï¼šPhysRobot å®Œæ•´æ¶æ„</h1>

<h2 id="ch3-1">3.1 æ¶æ„æ€»è§ˆ</h2>

<div class="arch-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PhysRobot å®Œæ•´æ¶æ„                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Observation (16-dim)                                            â”‚
â”‚  [joint_pos(2), joint_vel(2), ee_pos(3),                        â”‚
â”‚   box_pos(3), box_vel(3), goal_pos(3)]                          â”‚
â”‚       â”‚                                                          â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚       â”‚                   â”‚                      â”‚               â”‚
â”‚       â–¼                   â–¼                      â–¼               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Policy  â”‚    â”‚ Graph          â”‚    â”‚ Goal Info        â”‚      â”‚
â”‚  â”‚ Stream  â”‚    â”‚ Construction   â”‚    â”‚ (goal_pos)       â”‚      â”‚
â”‚  â”‚ (MLP)   â”‚    â”‚ obsâ†’(pos,vel,  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â”‚         â”‚    â”‚  edge_index)   â”‚                               â”‚
â”‚  â”‚ 16â†’128  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚  â”‚ â†’128    â”‚            â”‚                                        â”‚
â”‚  â”‚ â†’128    â”‚            â–¼                                        â”‚
â”‚  â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚         â”‚    â”‚  EdgeFrame     â”‚                               â”‚
â”‚  â”‚         â”‚    â”‚  pos,vel â†’     â”‚                               â”‚
â”‚  â”‚         â”‚    â”‚  edge_feat(E,8)â”‚                               â”‚
â”‚  â”‚         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚  â”‚         â”‚            â”‚                                        â”‚
â”‚  â”‚         â”‚            â–¼                                        â”‚
â”‚  â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚  â”‚         â”‚    â”‚ DynamiCAL GNN  â”‚                               â”‚
â”‚  â”‚         â”‚    â”‚ Ã—3 MP layers   â”‚                               â”‚
â”‚  â”‚         â”‚    â”‚ node_feat â†’    â”‚                               â”‚
â”‚  â”‚         â”‚    â”‚ acceleration   â”‚                               â”‚
â”‚  â”‚         â”‚    â”‚ (N, 3)         â”‚                               â”‚
â”‚  â”‚         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚  â”‚         â”‚            â”‚                                        â”‚
â”‚  â”‚         â”‚            â”‚ box_acc (1, 3)                         â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚                                        â”‚
â”‚       â”‚                 â”‚                                        â”‚
â”‚       â–¼                 â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚  â”‚     Fusion Module          â”‚                                  â”‚
â”‚  â”‚  cat(policy_feat, box_acc) â”‚                                  â”‚
â”‚  â”‚  (128 + 3) â†’ 128           â”‚                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚               â”‚                                                  â”‚
â”‚               â–¼                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚  â”‚    PPO Actor-Critic        â”‚                                  â”‚
â”‚  â”‚  Actor: 128 â†’ 2 (torques)  â”‚                                  â”‚
â”‚  â”‚  Critic: 128 â†’ 1 (value)   â”‚                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div>

<h2 id="ch3-2">3.2 æ¯ä¸ªæ¨¡å—çš„è¾“å…¥è¾“å‡ºç»´åº¦</h2>

<table>
<tr><th>æ¨¡å—</th><th>è¾“å…¥</th><th>è¾“å‡º</th><th>å‚æ•°é‡</th></tr>
<tr><td>è§‚æµ‹è§£æ</td><td>obs: (B, 16)</td><td>ee_pos(3), box_pos(3), box_vel(3), ...</td><td>0</td></tr>
<tr><td>å›¾æ„å»º</td><td>ee_pos, box_pos, box_vel</td><td>positions(2,3), edge_index(2,2)</td><td>0</td></tr>
<tr><td>EdgeFrame</td><td>positions(2,3), velocities(2,3), edges(2,2)</td><td>edge_features(2,8)</td><td>0ï¼ˆçº¯å‡ ä½•è®¡ç®—ï¼‰</td></tr>
<tr><td>è¾¹å¸§ç¼–ç </td><td>edge_features(2,8)</td><td>edge_hidden(2,64)</td><td>~5K</td></tr>
<tr><td>èŠ‚ç‚¹ç¼–ç </td><td>node_states(2,6)</td><td>node_hidden(2,128)</td><td>~17K</td></tr>
<tr><td>æ¶ˆæ¯ä¼ é€’ Ã—3</td><td>node(2,128) + edge(2,64)</td><td>node_updated(2,128)</td><td>~100K/å±‚</td></tr>
<tr><td>åŠ é€Ÿåº¦è§£ç </td><td>node(2,128)</td><td>accelerations(2,3)</td><td>~25K</td></tr>
<tr><td>ç­–ç•¥æµ MLP</td><td>obs(B,16)</td><td>policy_feat(B,128)</td><td>~33K</td></tr>
<tr><td>èåˆæ¨¡å—</td><td>(B, 128+3)</td><td>(B, 128)</td><td>~17K</td></tr>
<tr><td>PPO Actor</td><td>(B, 128)</td><td>(B, 2)</td><td>SB3 é»˜è®¤</td></tr>
<tr><td>PPO Critic</td><td>(B, 128)</td><td>(B, 1)</td><td>SB3 é»˜è®¤</td></tr>
</table>

<p><strong>æ€»å‚æ•°é‡</strong>ï¼š~500Kï¼ˆä¸å« PPO å¤´éƒ¨ï¼‰ï¼Œè¿œå°äº RT-2 çš„ 55B å‚æ•°ã€‚</p>

<h2 id="ch3-3">3.3 ä¿¡æ¯æµåŠ¨è·¯å¾„</h2>

<p>æ•°æ®åœ¨ PhysRobot ä¸­æµç»ä¸¤æ¡å¹¶è¡Œè·¯å¾„ï¼š</p>

<div class="box def">
<div class="box-title">ğŸ“– åŒæµæ¶æ„</div>
<p><strong>ç­–ç•¥æµï¼ˆPolicy Streamï¼‰</strong>ï¼š</p>
<pre><code>obs(16) â†’ MLP(16â†’128â†’128â†’128) â†’ policy_features(128)</code></pre>
<p>åŠŸèƒ½ï¼šå­¦ä¹ "åšä»€ä¹ˆ"â€”â€”ä»»åŠ¡ç›®æ ‡ã€éšœç¢å›é¿ç­‰é«˜å±‚è¯­ä¹‰</p>

<p><strong>ç‰©ç†æµï¼ˆPhysics Streamï¼‰</strong>ï¼š</p>
<pre><code>obs â†’ graph(2 nodes, 2 edges)
  â†’ EdgeFrame â†’ edge_features(2,8)
  â†’ NodeEncoder â†’ node_features(2,128)
  â†’ MessagePassing Ã—3 â†’ updated_features(2,128)
  â†’ Decoder â†’ accelerations(2,3)
  â†’ æå– box_acc(1,3)</code></pre>
<p>åŠŸèƒ½ï¼šå­¦ä¹ "ä»€ä¹ˆæ˜¯ç‰©ç†å¯èƒ½çš„"â€”â€”åŠ¨é‡å®ˆæ’çš„åŠ¨åŠ›å­¦é¢„æµ‹</p>

<p><strong>èåˆ</strong>ï¼š</p>
<pre><code>cat(policy_features, box_acc) â†’ MLP(131â†’128) â†’ PPO</code></pre>
</div>

<h2 id="ch3-4">3.4 æ¢¯åº¦å¦‚ä½•é€šè¿‡æ•´ä¸ªç³»ç»Ÿä¼ æ’­</h2>

<p>PPO çš„æŸå¤±å‡½æ•°ï¼ˆç­–ç•¥æŸå¤± + ä»·å€¼æŸå¤± + ç†µæ­£åˆ™åŒ–ï¼‰çš„æ¢¯åº¦é€šè¿‡ä»¥ä¸‹è·¯å¾„åå‘ä¼ æ’­ï¼š</p>

<pre><code>PPO Loss
  â†“ âˆ‚L/âˆ‚Î¸_PPO
Fusion Module
  â†“ åˆ†è£‚ä¸ºä¸¤æ¡è·¯å¾„
  â”œâ”€â”€ âˆ‚L/âˆ‚Î¸_policy (ç­–ç•¥æµæ¢¯åº¦)
  â”‚     â†’ æ›´æ–° policy_stream MLP
  â””â”€â”€ âˆ‚L/âˆ‚Î¸_physics (ç‰©ç†æµæ¢¯åº¦)
        â†’ Decoder â†’ MessagePassing â†’ NodeEncoder â†’ EdgeFrame(encoder)
        â†’ æ›´æ–°æ‰€æœ‰ç‰©ç†æ ¸å¿ƒå‚æ•°</code></pre>

<div class="box warn">
<div class="box-title">âš ï¸ æ½œåœ¨é—®é¢˜ï¼šæ¢¯åº¦å†²çª</div>
<p>ç­–ç•¥æµå’Œç‰©ç†æµçš„æ¢¯åº¦å¯èƒ½å†²çªï¼šç­–ç•¥æµæƒ³è¦æœ€å¤§åŒ–ä»»åŠ¡å¥–åŠ±ï¼Œç‰©ç†æµæƒ³è¦å‡†ç¡®é¢„æµ‹åŠ¨åŠ›å­¦ã€‚å½“ä¸¤ä¸ªç›®æ ‡çŸ›ç›¾æ—¶ï¼ˆå¦‚ç­–ç•¥æƒ³åšç‰©ç†ä¸Šä¸å¯èƒ½çš„åŠ¨ä½œï¼‰ï¼Œæ¢¯åº¦æ›´æ–°æ–¹å‘ä¼šäº’ç›¸æŠµæ¶ˆã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>stop_gradient</code> åœ¨ç‰©ç†æµä¸Šï¼Œè®©ç‰©ç†æ ¸å¿ƒåªé€šè¿‡è¾…åŠ©æŸå¤±æ›´æ–°</li>
<li>ä½¿ç”¨ gradient surgery (PCGrad) å¤„ç†å†²çªæ¢¯åº¦</li>
<li>ä¸¤é˜¶æ®µè®­ç»ƒï¼šå…ˆé¢„è®­ç»ƒç‰©ç†æ ¸å¿ƒï¼Œå†è”åˆè®­ç»ƒ</li>
</ul>
</div>

<!-- ========== ç¬¬4ç«  ========== -->
<h1 id="ch4">ç¬¬å››ç« ï¼šEdgeFrame æ·±å…¥</h1>

<h2 id="ch4-1">4.1 ä¸ºä»€ä¹ˆéœ€è¦è¾¹å¸§ï¼Ÿ</h2>

<p>åœ¨æ™®é€š GNN ä¸­ï¼Œæ¶ˆæ¯å‡½æ•°æ˜¯ï¼š</p>
\[m_{ij} = \text{MLP}(h_i, h_j, \vec{r}_{ij})\]

<p>é—®é¢˜ï¼šè¿™ä¸ª MLP æ²¡æœ‰ä»»ä½•ç»“æ„çº¦æŸï¼Œå®ƒçš„è¾“å‡ºå¯ä»¥æ˜¯ä»»æ„å€¼ï¼Œæ— æ³•ä¿è¯ \(m_{ij} = -m_{ji}\)ã€‚</p>

<div class="box thm">
<div class="box-title">ğŸ“ EdgeFrame çš„æ ¸å¿ƒæ€æƒ³</div>
<p>åœ¨æ¯æ¡è¾¹ \((i,j)\) ä¸Šæ„å»ºä¸€ä¸ª<strong>å±€éƒ¨æ­£äº¤åæ ‡ç³»</strong> \(\{\vec{e}_1, \vec{e}_2, \vec{e}_3\}\)ï¼Œæ»¡è¶³ï¼š</p>
\[\vec{e}_k^{(ji)} = -\vec{e}_k^{(ij)} \quad (k=1,2) \qquad \text{ï¼ˆåå¯¹ç§°ï¼‰}\]
<p>ç„¶åå°†åŠ›åˆ†è§£ä¸ºï¼š</p>
\[\vec{F}_{ij} = f_1 \vec{e}_1^{(ij)} + f_2 \vec{e}_2^{(ij)} + f_3 \vec{e}_3^{(ij)}\]
<p>ç”±äº \(\vec{e}_k\) åå¯¹ç§°ï¼Œåªè¦æ ‡é‡ç³»æ•° \(f_k\) å¯¹ç§°ï¼ˆå³ \(f_k^{(ij)} = f_k^{(ji)}\)ï¼‰ï¼Œå°±è‡ªåŠ¨ä¿è¯ \(\vec{F}_{ij} = -\vec{F}_{ji}\)ã€‚</p>
</div>

<h2 id="ch4-2">4.2 æ•°å­¦æ¨å¯¼</h2>

<h3>4.2.1 æ„å»º \(\vec{e}_1\)ï¼šæ²¿è¾¹æ–¹å‘</h3>

\[\vec{r}_{ij} = \vec{x}_j - \vec{x}_i, \quad \vec{e}_1^{(ij)} = \frac{\vec{r}_{ij}}{||\vec{r}_{ij}||}\]

<p>åå¯¹ç§°æ€§éªŒè¯ï¼š</p>
\[\vec{e}_1^{(ji)} = \frac{\vec{r}_{ji}}{||\vec{r}_{ji}||} = \frac{-\vec{r}_{ij}}{||\vec{r}_{ij}||} = -\vec{e}_1^{(ij)} \quad âœ“\]

<h3>4.2.2 æ„å»º \(\vec{e}_2\)ï¼šGram-Schmidt æ­£äº¤åŒ–</h3>

<p>Dynami-CAL åŸè®ºæ–‡ä½¿ç”¨ç›¸å¯¹é€Ÿåº¦æ„å»º \(\vec{e}_2\)ï¼š</p>

\[\vec{v}_{ij} = \vec{v}_j - \vec{v}_i\]
\[\vec{v}_{ij}^{\perp} = \vec{v}_{ij} - (\vec{v}_{ij} \cdot \vec{e}_1)\vec{e}_1 \quad \text{ï¼ˆå»æ‰å¹³è¡Œåˆ†é‡ï¼‰}\]
\[\vec{e}_2^{(ij)} = \frac{\vec{v}_{ij}^{\perp}}{||\vec{v}_{ij}^{\perp}||}\]

<p>åå¯¹ç§°æ€§éªŒè¯ï¼š\(\vec{v}_{ji} = -\vec{v}_{ij}\)ï¼Œæ‰€ä»¥ \(\vec{e}_2^{(ji)} = -\vec{e}_2^{(ij)}\) âœ“</p>

<h3>4.2.3 æ„å»º \(\vec{e}_3\)ï¼šå‰ç§¯</h3>

\[\vec{e}_3^{(ij)} = \vec{e}_1^{(ij)} \times \vec{e}_2^{(ij)}\]

<p><strong>æ³¨æ„</strong>ï¼š\(\vec{e}_3\) æ˜¯<strong>å¯¹ç§°çš„</strong>ï¼ˆä¸æ˜¯åå¯¹ç§°çš„ï¼‰ï¼Œå› ä¸ºä¸¤ä¸ªåå¯¹ç§°å‘é‡çš„å‰ç§¯æ˜¯å¯¹ç§°çš„ï¼š</p>
\[\vec{e}_3^{(ji)} = (-\vec{e}_1^{(ij)}) \times (-\vec{e}_2^{(ij)}) = \vec{e}_1^{(ij)} \times \vec{e}_2^{(ij)} = \vec{e}_3^{(ij)}\]

<p>å› æ­¤ \(f_3\) éœ€è¦ç‰¹æ®Šå¤„ç†æ‰èƒ½ä¿è¯æ•´ä½“åŠ›çš„åå¯¹ç§°æ€§ã€‚</p>

<h2 id="ch4-3">4.3 ä¸ SE(3) ç­‰å˜æ€§çš„å…³ç³»</h2>

<div class="box insight">
<div class="box-title">ğŸ’¡ ç­‰å˜æ€§ vs å®ˆæ’æ€§</div>
<p>è¿™æ˜¯ä¸¤ä¸ªç›¸å…³ä½†ä¸åŒçš„æ¦‚å¿µï¼š</p>
<ul>
<li><strong>SE(3) ç­‰å˜æ€§</strong>ï¼ˆEGNN çš„ç‰¹æ€§ï¼‰ï¼šå¦‚æœæ—‹è½¬æ‰€æœ‰è¾“å…¥ï¼Œè¾“å‡ºä¹Ÿç›¸åº”æ—‹è½¬ã€‚æ•°å­¦ä¸Šï¼š\(f(Rx) = Rf(x)\)</li>
<li><strong>åŠ¨é‡å®ˆæ’</strong>ï¼ˆPhysRobot çš„ç‰¹æ€§ï¼‰ï¼šæ‰€æœ‰å†…åŠ›ä¹‹å’Œä¸ºé›¶ã€‚æ•°å­¦ä¸Šï¼š\(\sum_i F_i = 0\)</li>
</ul>
<p><strong>å…³é”®åŒºåˆ«</strong>ï¼šç­‰å˜æ€§ä¿è¯ç‰©ç†è§„å¾‹åœ¨ä¸åŒå‚è€ƒç³»ä¸‹ä¸€è‡´ï¼Œå®ˆæ’æ€§ä¿è¯ç‰©ç†é‡åœ¨æ—¶é—´æ¼”åŒ–ä¸­ä¸å˜ã€‚<strong>ä¸¤è€…äº’ç›¸ç‹¬ç«‹</strong>â€”â€”ä¸€ä¸ªç­‰å˜ä½†ä¸å®ˆæ’çš„ GNN ä¼šäº§ç”ŸåŠ¨é‡æ¼‚ç§»ï¼Œä¸€ä¸ªå®ˆæ’ä½†ä¸ç­‰å˜çš„ GNN åœ¨æ—‹è½¬åè¡Œä¸ºä¸ä¸€è‡´ã€‚</p>
<p>PhysRobot é€šè¿‡ EdgeFrame çš„ç›¸å¯¹åæ ‡åŒæ—¶è·å¾—äº†<strong>å¹³ç§»ä¸å˜æ€§</strong>å’Œ<strong>åŠ¨é‡å®ˆæ’</strong>ï¼Œä½†ä¸¥æ ¼çš„ SO(3) ç­‰å˜æ€§éœ€è¦ Scalarization-Vectorization ç®¡é“ï¼ˆè§ç¬¬ 5 ç« è®¨è®ºï¼‰ã€‚</p>
</div>

<h2 id="ch4-4">4.4 ä»£ç é€è¡Œè§£æ</h2>

<p>ä»¥ä¸‹æ˜¯ <code>physics_core/edge_frame.py</code> çš„æ ¸å¿ƒä»£ç è§£æï¼š</p>

<pre><code class="python">class EdgeFrame(nn.Module):
    def __init__(self, hidden_dim: int = 64):
        super().__init__()
        self.hidden_dim = hidden_dim
        
        # è¾¹ç‰¹å¾ç¼–ç å™¨
        # è¾“å…¥: [dx, dy, dz, ||r||, dvx, dvy, dvz, ||v||] = 8ç»´
        self.edge_encoder = nn.Sequential(
            nn.Linear(8, hidden_dim),     # 8 â†’ 64
            nn.LayerNorm(hidden_dim),     # ç¨³å®šè®­ç»ƒ
            nn.ReLU(),                    # éçº¿æ€§
            nn.Linear(hidden_dim, hidden_dim),  # 64 â†’ 64
            nn.LayerNorm(hidden_dim),
            nn.ReLU(),
        )
    
    def forward(self, positions, velocities, edge_index):
        src_idx, tgt_idx = edge_index[0], edge_index[1]
        
        # r_ij = x_j - x_i : åå¯¹ç§°ï¼ˆäº¤æ¢i,jåå–åï¼‰
        r_ij = positions[tgt_idx] - positions[src_idx]  # (E, 3)
        r_norm = torch.norm(r_ij, dim=1, keepdim=True)  # (E, 1)
        
        # v_rel = v_j - v_i : åå¯¹ç§°
        v_rel = velocities[tgt_idx] - velocities[src_idx]  # (E, 3)
        v_norm = torch.norm(v_rel, dim=1, keepdim=True)    # (E, 1)
        
        # æ‹¼æ¥åŸå§‹ç‰¹å¾: (E, 8)
        # [r_ij(3), ||r||(1), v_rel(3), ||v||(1)]
        edge_features = torch.cat([r_ij, r_norm, v_rel, v_norm], dim=1)
        
        # âš ï¸ ç»è¿‡ MLP åï¼Œåå¯¹ç§°æ€§ä¸å†ä¿è¯
        # è¿™æ˜¯å½“å‰å®ç°çš„ä¸€ä¸ªå±€é™
        edge_hidden = self.edge_encoder(edge_features)
        return edge_hidden</code></pre>

<div class="box warn">
<div class="box-title">âš ï¸ å®ç° vs ç†è®ºçš„å·®è·</div>
<p>å½“å‰ <code>edge_frame.py</code> ä¸­çš„ <code>edge_encoder</code> MLP ä¼šç ´ååå¯¹ç§°æ€§ã€‚åŸå§‹çš„ \(\vec{r}_{ij} = -\vec{r}_{ji}\)ï¼Œä½†ç»è¿‡ ReLU ç­‰éçº¿æ€§å‡½æ•°åï¼Œ\(\text{MLP}(\vec{r}_{ij}) \neq -\text{MLP}(\vec{r}_{ji})\)ã€‚</p>
<p>Dynami-CAL åŸè®ºæ–‡çš„åšæ³•æ˜¯ï¼šå…ˆæŠ•å½±åˆ°æ ‡é‡ï¼ˆScalarizationï¼‰ï¼ŒMLP å¤„ç†æ ‡é‡ï¼Œå†é‡å»ºå‘é‡ï¼ˆVectorizationï¼‰ã€‚æ ‡é‡å¤„ç†ä¸å½±å“å‘é‡çš„æ–¹å‘æ€§è´¨ã€‚</p>
<p>åœ¨ <code>baselines/physics_informed.py</code> ä¸­çš„ <code>DynamiCALGraphNet</code> é€šè¿‡ç›´æ¥åœ¨è¾¹å¸§ä¸Šåˆ†è§£åŠ›æ¥æ›´å¥½åœ°ä¿æŒåå¯¹ç§°æ€§ã€‚</p>
</div>

<!-- ========== ç¬¬5ç«  ========== -->
<h1 id="ch5">ç¬¬äº”ç« ï¼šDynamicalGNN æ·±å…¥</h1>

<h2 id="ch5-1">5.1 PhysicsMessagePassing å®Œæ•´æ¨å¯¼</h2>

<p>GNN çš„æ¶ˆæ¯ä¼ é€’èŒƒå¼åŒ…å«ä¸‰ä¸ªæ­¥éª¤ï¼š</p>

<div class="formula-card">
\[\text{1. Message: } \vec{m}_{ij} = \phi(\vec{h}_i, \vec{h}_j, \vec{e}_{ij})\]
\[\text{2. Aggregate: } \vec{M}_i = \bigoplus_{j \in \mathcal{N}(i)} \vec{m}_{ij}\]
\[\text{3. Update: } \vec{h}_i' = \psi(\vec{h}_i, \vec{M}_i)\]
<div class="label">æ¶ˆæ¯ä¼ é€’çš„ä¸‰ä¸ªé˜¶æ®µï¼šè®¡ç®—æ¶ˆæ¯ â†’ èšåˆ â†’ æ›´æ–°</div>
</div>

<h3>5.1.1 æ¶ˆæ¯å‡½æ•° \(\phi\) çš„è®¾è®¡</h3>

<p>åœ¨ <code>PhysicsMessagePassing</code> ä¸­ï¼š</p>

<pre><code class="python">def message(self, x_i, x_j, edge_attr):
    # x_i: ç›®æ ‡èŠ‚ç‚¹ç‰¹å¾ (E, hidden_dim)
    # x_j: æºèŠ‚ç‚¹ç‰¹å¾ (E, hidden_dim)
    # edge_attr: è¾¹ç‰¹å¾ (E, edge_dim)
    msg_input = torch.cat([edge_attr, x_i, x_j], dim=-1)
    messages = self.message_net(msg_input)  # MLP: 320â†’128â†’128
    return messages</code></pre>

<p>æ¶ˆæ¯çš„è¾“å…¥ç»´åº¦ = <code>edge_dim(64) + 2 Ã— hidden_dim(128) = 320</code>ã€‚</p>

<h3>5.1.2 èšåˆæ–¹å¼</h3>

<p>ä½¿ç”¨ <strong>sum èšåˆ</strong>ï¼ˆ<code>aggr='add'</code>ï¼‰ï¼Œè€Œé mean æˆ– maxã€‚åŸå› ï¼š</p>
<ul>
<li>Sum èšåˆå¯¹åº”åŠ›çš„å åŠ åŸç†ï¼ˆ\(\vec{F}_{total} = \sum \vec{F}_{ij}\)ï¼‰</li>
<li>Mean èšåˆä¼šä¸¢å¤±"æœ‰å¤šå°‘ä¸ªé‚»å±…åœ¨æ–½åŠ›"çš„ä¿¡æ¯</li>
<li>Max èšåˆåªä¿ç•™æœ€å¼ºçš„äº¤äº’ï¼Œç‰©ç†ä¸Šä¸åˆç†</li>
</ul>

<h3>5.1.3 æ›´æ–°å‡½æ•° \(\psi\) çš„è®¾è®¡</h3>

<pre><code class="python">def update(self, aggr_out, x):
    # aggr_out: èšåˆåçš„æ¶ˆæ¯ (N, hidden_dim)
    # x: åŸå§‹èŠ‚ç‚¹ç‰¹å¾ (N, hidden_dim)
    update_input = torch.cat([x, aggr_out], dim=-1)  # (N, 256)
    x_new = self.update_net(update_input) + x  # æ®‹å·®è¿æ¥
    return x_new</code></pre>

<p><strong>æ®‹å·®è¿æ¥</strong>æ˜¯å…³é”®ï¼šå®ƒå…è®¸èŠ‚ç‚¹åœ¨æ›´æ–°åä¿ç•™åŸå§‹ä¿¡æ¯ï¼Œé˜²æ­¢æ¶ˆæ¯ä¼ é€’è¿‡åº¦å¹³æ»‘ã€‚</p>

<h2 id="ch5-2">5.2 å®ˆæ’å¾‹å¦‚ä½•ç¼–ç </h2>

<p>å®ˆæ’å¾‹åœ¨ä¸¤ä¸ªå±‚é¢ç¼–ç ï¼š</p>

<h3>5.2.1 æ¶æ„å±‚é¢ï¼ˆHard Constraintï¼‰</h3>

<p>åœ¨ <code>baselines/physics_informed.py</code> çš„ <code>DynamiCALGraphNet</code> ä¸­ï¼š</p>

<pre><code class="python"># åŠ›åˆ†è§£åˆ°è¾¹å¸§ä¸Š
force = (
    f_scalar * e1 +          # æ²¿è¾¹æ–¹å‘çš„åŠ›
    f_vector[:, 0:1] * e2 +  # å‚ç›´æ–¹å‘ 1
    f_vector[:, 1:2] * e3    # å‚ç›´æ–¹å‘ 2
)

# èšåˆåŠ›ï¼ˆsum aggregationï¼‰
# ç”±äº e1_ij = -e1_ji, e2_ij = -e2_ji:
# F_ij + F_ji = f*(e1_ij + e1_ji) + ... = 0
# å› æ­¤ âˆ‘F = 0ï¼ˆåŠ¨é‡å®ˆæ’ï¼‰</code></pre>

<h3>5.2.2 æŸå¤±å‡½æ•°å±‚é¢ï¼ˆSoft Constraintï¼Œè¾…åŠ©ï¼‰</h3>

<p>å¯ä»¥æ·»åŠ å®ˆæ’å¾‹è¿åæƒ©ç½šä½œä¸ºè¾…åŠ©æŸå¤±ï¼š</p>

<pre><code class="python"># åŠ¨é‡å®ˆæ’æƒ©ç½š
total_force = predicted_forces.sum(dim=0)  # åº”ä¸º [0,0,0]
momentum_loss = torch.norm(total_force)

# æ€»æŸå¤±
loss = rl_loss + lambda_momentum * momentum_loss</code></pre>

<h3>5.2.3 Decoder è®¾è®¡</h3>

<p>ä»èŠ‚ç‚¹éšè—çŠ¶æ€è§£ç åŠ é€Ÿåº¦ï¼š</p>

<pre><code class="python">self.decoder = nn.Sequential(
    nn.Linear(hidden_dim, hidden_dim),     # 128 â†’ 128
    nn.LayerNorm(hidden_dim),
    nn.ReLU(),
    nn.Linear(hidden_dim, hidden_dim // 2), # 128 â†’ 64
    nn.ReLU(),
    nn.Linear(hidden_dim // 2, output_dim), # 64 â†’ 3 (åŠ é€Ÿåº¦)
)</code></pre>

<p>æ³¨æ„ï¼šDecoder è¾“å‡ºçš„æ˜¯<strong>æ¯ä¸ªèŠ‚ç‚¹çš„åŠ é€Ÿåº¦</strong>ï¼Œè€Œéæˆå¯¹çš„åŠ›ã€‚è¿™æ„å‘³ç€åŠ¨é‡å®ˆæ’éœ€è¦åœ¨æ¶ˆæ¯ä¼ é€’é˜¶æ®µä¿è¯ï¼Œè€Œéåœ¨è§£ç é˜¶æ®µã€‚</p>

<h2 id="ch5-3">5.3 å¤šå±‚æ¶ˆæ¯ä¼ é€’çš„ç‰©ç†å«ä¹‰</h2>

<p>PhysRobot ä½¿ç”¨ 3 å±‚æ¶ˆæ¯ä¼ é€’ã€‚æ¯å±‚çš„ç‰©ç†å«ä¹‰ï¼š</p>

<table>
<tr><th>å±‚æ•°</th><th>æ„Ÿå—é‡</th><th>ç‰©ç†å«ä¹‰</th></tr>
<tr><td>ç¬¬ 1 å±‚</td><td>ç›´æ¥é‚»å±…</td><td>å­¦ä¹ ç›´æ¥æ¥è§¦åŠ›ï¼ˆç¢°æ’ã€æ‘©æ“¦ï¼‰</td></tr>
<tr><td>ç¬¬ 2 å±‚</td><td>2-hop é‚»å±…</td><td>å­¦ä¹ é—´æ¥åŠ›ä¼ é€’ï¼ˆAæ¨Bï¼ŒBæ¨Cï¼‰</td></tr>
<tr><td>ç¬¬ 3 å±‚</td><td>3-hop é‚»å±…</td><td>å­¦ä¹ å…¨å±€çº¦æŸï¼ˆå¤šä½“åè°ƒï¼‰</td></tr>
</table>

<p>å¯¹äºå½“å‰ 2 èŠ‚ç‚¹çš„å›¾ï¼Œ3 å±‚æ¶ˆæ¯ä¼ é€’æ˜¯å†—ä½™çš„ï¼ˆ1 å±‚å°±è¶³å¤Ÿè¦†ç›–æ‰€æœ‰èŠ‚ç‚¹ï¼‰ã€‚ä½†è®¾è®¡ 3 å±‚æ˜¯ä¸ºäº†<strong>å¯æ‰©å±•æ€§</strong>â€”â€”åœ¨å¤šç‰©ä½“åœºæ™¯ä¸­ï¼Œ3 å±‚å…è®¸ä¿¡æ¯ä¼ æ’­åˆ° 3-hop é‚»å±…ã€‚</p>

<!-- ========== ç¬¬6ç«  ========== -->
<h1 id="ch6">ç¬¬å…­ç« ï¼šè¾›ç§¯åˆ†å™¨</h1>

<h2 id="ch6-1">6.1 ä¸ºä»€ä¹ˆä¸ç”¨ Eulerï¼Ÿ</h2>

<p>æ˜¾å¼ Euler ç§¯åˆ† \(x_{n+1} = x_n + v_n \Delta t, \; v_{n+1} = v_n + a_n \Delta t\) æœ‰ä¸€ä¸ªè‡´å‘½é—®é¢˜ï¼š</p>

<div class="box warn">
<div class="box-title">âš ï¸ Euler ç§¯åˆ†çš„èƒ½é‡çˆ†ç‚¸</div>
<p>å¯¹äºç®€è°æŒ¯å­ \(a = -kx\)ï¼ŒEuler ç§¯åˆ†çš„èƒ½é‡åœ¨æ¯ä¸€æ­¥éƒ½<strong>å•è°ƒå¢åŠ </strong>ï¼š</p>
\[E_{n+1} = E_n + \frac{1}{2}k^2 x_n^2 \Delta t^2 > E_n\]
<p>ç»è¿‡ \(N\) æ­¥åï¼Œæ€»èƒ½é‡å¢é•¿ä¸º \(O(N\Delta t^2)\)â€”â€”<strong>çº¿æ€§å‘æ•£</strong>ã€‚</p>
<p>å¯¹äºé•¿æ—¶é—´ä»¿çœŸï¼ˆå¦‚ 1000 æ­¥ RL rolloutï¼‰ï¼Œè¿™æ„å‘³ç€ç‰©ç†é¢„æµ‹å®Œå…¨ä¸å¯ä¿¡ã€‚</p>
</div>

<h2 id="ch6-2">6.2 StÃ¶rmer-Verlet (Leapfrog) æ–¹æ³•</h2>

<p>è¾›ç§¯åˆ†å™¨çš„æ ¸å¿ƒæ€æƒ³ï¼šé€šè¿‡ç‰¹æ®Šçš„æ›´æ–°é¡ºåºï¼Œä¿æŒç›¸ç©ºé—´çš„è¾›ç»“æ„ã€‚</p>

<pre><code class="python">class SymplecticIntegrator:
    def __init__(self, dt: float = 0.01):
        self.dt = dt
    
    def step(self, positions, velocities, acceleration_fn):
        # 1. è®¡ç®—å½“å‰åŠ é€Ÿåº¦
        accel_n = acceleration_fn(positions, velocities)
        
        # 2. åŠæ­¥é€Ÿåº¦æ›´æ–°
        v_half = velocities + 0.5 * self.dt * accel_n
        
        # 3. å…¨æ­¥ä½ç½®æ›´æ–°ï¼ˆä½¿ç”¨åŠæ­¥é€Ÿåº¦ï¼‰
        x_new = positions + self.dt * v_half
        
        # 4. è®¡ç®—æ–°ä½ç½®çš„åŠ é€Ÿåº¦
        accel_n1 = acceleration_fn(x_new, v_half)
        
        # 5. åŠæ­¥é€Ÿåº¦æ›´æ–°
        v_new = v_half + 0.5 * self.dt * accel_n1
        
        return x_new, v_new</code></pre>

<p>å…³é”®æ€§è´¨ï¼š</p>
<ul>
<li><strong>æ—¶é—´å¯é€†</strong>ï¼šä» \((x_{n+1}, v_{n+1})\) å¯ä»¥ç²¾ç¡®å›åˆ° \((x_n, v_n)\)</li>
<li><strong>è¾›ä¿æŒ</strong>ï¼šç›¸ç©ºé—´é¢ç§¯ä¸å˜</li>
<li><strong>èƒ½é‡æœ‰ç•Œ</strong>ï¼šèƒ½é‡åå·® \(O(\Delta t^2)\)ï¼Œä¸éšæ—¶é—´å¢é•¿</li>
</ul>

<h2 id="ch6-3">6.3 åœ¨ RL ä¸­çš„ä½œç”¨</h2>

<div class="box ex">
<div class="box-title">ğŸ” è¾›ç§¯åˆ†å™¨åœ¨ PhysRobot ä¸­çš„ç°çŠ¶</div>
<p><strong>å®é™…æƒ…å†µ</strong>ï¼š<code>physics_core/integrators.py</code> å®ç°äº† SymplecticIntegrator å’Œ RK4Integratorï¼Œä½†åœ¨ <code>PhysRobotAgent</code> ä¸­<strong>å¹¶æœªä½¿ç”¨</strong>ã€‚</p>
<p>å½“å‰ç‰©ç†æ ¸å¿ƒåªåšå•æ­¥åŠ é€Ÿåº¦é¢„æµ‹ï¼Œé¢„æµ‹ç»“æœç›´æ¥ä½œä¸º PPO çš„ç‰¹å¾ï¼Œæ²¡æœ‰é€šè¿‡ç§¯åˆ†å™¨è¿›è¡Œå¤šæ­¥ rolloutã€‚</p>
<p><strong>å»ºè®®çš„ä½¿ç”¨æ–¹å¼</strong>ï¼š</p>
<ol>
<li><strong>çŸ­æ—¶ rollout ç‰¹å¾</strong>ï¼šç”¨è¾›ç§¯åˆ†å™¨åš 5-10 æ­¥å‰å‘é¢„æµ‹ï¼Œå°†é¢„æµ‹è½¨è¿¹ä½œä¸ºé¢å¤–ç‰¹å¾é€å…¥ PPO</li>
<li><strong>Model-based è§„åˆ’</strong>ï¼šç”¨ç‰©ç†æ ¸å¿ƒ + è¾›ç§¯åˆ†å™¨åš MPCï¼ˆæ¨¡å‹é¢„æµ‹æ§åˆ¶ï¼‰</li>
<li><strong>è®­ç»ƒè¾…åŠ©æŸå¤±</strong>ï¼šç”¨è¾›ç§¯åˆ†å™¨ rollout ä¸ç¯å¢ƒçœŸå®è½¨è¿¹å¯¹æ¯”ï¼Œè®­ç»ƒç‰©ç†æ ¸å¿ƒçš„åŠ¨åŠ›å­¦é¢„æµ‹èƒ½åŠ›</li>
</ol>
</div>

<!-- ========== ç¬¬7ç«  ========== -->
<h1 id="ch7">ç¬¬ä¸ƒç« ï¼šä¸ PPO çš„æ•´åˆ</h1>

<h2 id="ch7-1">7.1 BaseFeaturesExtractor æ¥å£</h2>

<p>Stable-Baselines3 çš„ PPO å…è®¸è‡ªå®šä¹‰ç‰¹å¾æå–å™¨ã€‚PhysRobot é€šè¿‡ç»§æ‰¿ <code>BaseFeaturesExtractor</code> å°†ç‰©ç† GNN åµŒå…¥ PPOï¼š</p>

<pre><code class="python">from stable_baselines3.common.torch_layers import BaseFeaturesExtractor

class PhysRobotFeaturesExtractor(BaseFeaturesExtractor):
    def __init__(self, observation_space, features_dim=128):
        # features_dim å¿…é¡»ä¸çˆ¶ç±»å£°æ˜ä¸€è‡´
        super().__init__(observation_space, features_dim)
        
        # ç‰©ç†æ ¸å¿ƒï¼ˆDynami-CALï¼‰
        self.physics_core = PhysicsCore(
            node_feature_dim=6,      # pos(3) + vel(3)
            hidden_dim=128,
            n_message_passing=3
        )
        
        # ç­–ç•¥æµï¼ˆæ ‡å‡† MLPï¼‰
        self.policy_stream = nn.Sequential(
            nn.Linear(observation_space.shape[0], 128),  # 16 â†’ 128
            nn.ReLU(),
            nn.Linear(128, 128),
            nn.ReLU(),
            nn.Linear(128, features_dim)  # â†’ 128
        )
        
        # èåˆï¼šç‰©ç†ç‰¹å¾(3) + ç­–ç•¥ç‰¹å¾(128) â†’ 128
        self.fusion = nn.Sequential(
            nn.Linear(features_dim + 3, features_dim),
            nn.ReLU()
        )</code></pre>

<p><code>BaseFeaturesExtractor</code> çš„çº¦å®šï¼š</p>
<ul>
<li><code>__init__</code> ä¸­çš„ <code>features_dim</code> å£°æ˜è¾“å‡ºç»´åº¦</li>
<li><code>forward()</code> å¿…é¡»è¿”å› shape <code>(batch_size, features_dim)</code> çš„å¼ é‡</li>
<li>PPO çš„ Actor å’Œ Critic å…±äº«è¿™ä¸ªç‰¹å¾æå–å™¨ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰</li>
</ul>

<h2 id="ch7-2">7.2 å¦‚ä½•å°†ç‰©ç†ç‰¹å¾é€å…¥ PPO</h2>

<pre><code class="python">def forward(self, observations):
    # 1. ç­–ç•¥æµ
    policy_features = self.policy_stream(observations)  # (B, 128)
    
    # 2. ç‰©ç†æµï¼šobs â†’ graph â†’ GNN â†’ acceleration
    graph = self._obs_to_graph(observations)
    physics_pred = self.physics_core(graph)  # (2*B, 3)
    box_physics = physics_pred[1::2]  # å– box èŠ‚ç‚¹ â†’ (B, 3)
    
    # 3. èåˆ
    combined = torch.cat([policy_features, box_physics], dim=-1)  # (B, 131)
    features = self.fusion(combined)  # (B, 128)
    
    return features  # é€å…¥ PPO Actor-Critic</code></pre>

<p><code>_obs_to_graph</code> çš„å…³é”®å®ç°ï¼š</p>

<pre><code class="python">def _obs_to_graph(self, obs):
    batch_size = obs.shape[0]
    graphs = []
    for i in range(batch_size):
        o = obs[i]
        ee_pos = o[4:7]      # æœ«ç«¯æ‰§è¡Œå™¨ä½ç½®
        box_pos = o[7:10]     # ç®±å­ä½ç½®
        box_vel = o[10:13]    # ç®±å­é€Ÿåº¦
        ee_vel = torch.zeros(3, device=obs.device)  # è¿‘ä¼¼ï¼ˆâš ï¸ä¸ç²¾ç¡®ï¼‰
        
        positions = torch.stack([ee_pos, box_pos])  # (2, 3)
        node_features = torch.stack([
            torch.cat([ee_vel, ee_pos]),   # (6,)
            torch.cat([box_vel, box_pos])  # (6,)
        ])  # (2, 6)
        
        edge_index = torch.tensor(
            [[0, 1], [1, 0]], dtype=torch.long, device=obs.device
        ).t()  # åŒå‘è¾¹
        
        graph = Data(x=node_features, pos=positions, edge_index=edge_index)
        graphs.append(graph)
    
    return Batch.from_data_list(graphs)</code></pre>

<div class="box warn">
<div class="box-title">âš ï¸ æ³¨æ„ï¼šee_vel çš„è¿‘ä¼¼</div>
<p>å½“å‰å®ç°ä¸­ï¼Œæœ«ç«¯æ‰§è¡Œå™¨çš„é€Ÿåº¦è¢«è®¾ä¸ºé›¶å‘é‡ <code>torch.zeros(3)</code>ï¼Œè¿™æ˜¯å› ä¸ºè§‚æµ‹ç©ºé—´ (16-dim) åªåŒ…å«å…³èŠ‚é€Ÿåº¦ <code>joint_vel(2)</code>ï¼Œæ²¡æœ‰æœ«ç«¯æ‰§è¡Œå™¨çš„ç¬›å¡å°”é€Ÿåº¦ã€‚</p>
<p><strong>æ”¹è¿›æ–¹æ¡ˆ</strong>ï¼šé€šè¿‡é›…å¯æ¯”çŸ©é˜µä»å…³èŠ‚é€Ÿåº¦è®¡ç®—æœ«ç«¯é€Ÿåº¦ \(\dot{x}_{ee} = J(q)\dot{q}\)ï¼Œæˆ–è€…ç›´æ¥åœ¨ç¯å¢ƒä¸­æ·»åŠ  ee_vel åˆ°è§‚æµ‹ã€‚</p>
</div>

<h2 id="ch7-3">7.3 å®Œæ•´è®­ç»ƒä»£ç è§£æ</h2>

<pre><code class="python">class PhysRobotAgent:
    def __init__(self, env, learning_rate=3e-4, verbose=1):
        # æ ¸å¿ƒï¼šå°† PhysRobotFeaturesExtractor ä¼ å…¥ PPO
        policy_kwargs = dict(
            features_extractor_class=PhysRobotFeaturesExtractor,
            features_extractor_kwargs=dict(features_dim=128),
        )
        
        self.model = PPO(
            "MlpPolicy",         # PPO çš„ Actor-Critic å¤´éƒ¨ä»æ˜¯ MLP
            env,
            learning_rate=learning_rate,
            n_steps=2048,         # æ¯æ¬¡æ›´æ–°æ”¶é›†çš„æ­¥æ•°
            batch_size=64,        # å°æ‰¹é‡å¤§å°
            n_epochs=10,          # æ¯æ‰¹æ•°æ®çš„æ¢¯åº¦æ›´æ–°æ¬¡æ•°
            gamma=0.99,           # æŠ˜æ‰£å› å­
            policy_kwargs=policy_kwargs,  # ğŸ”‘ è‡ªå®šä¹‰ç‰¹å¾æå–å™¨
            verbose=verbose,
            tensorboard_log="./logs/physrobot/"
        )</code></pre>

<p>è®­ç»ƒæµç¨‹ï¼š</p>
<ol>
<li>ç¯å¢ƒç”Ÿæˆ <code>n_steps=2048</code> æ­¥çš„ trajectory</li>
<li>æ‰€æœ‰è§‚æµ‹é€šè¿‡ <code>PhysRobotFeaturesExtractor.forward()</code> æå–ç‰¹å¾</li>
<li>PPO ç”¨è¿™äº›ç‰¹å¾è®¡ç®— advantageã€æ›´æ–° Actor-Critic</li>
<li>æ¢¯åº¦åŒæ—¶æ›´æ–°ç‰©ç†æ ¸å¿ƒå’Œç­–ç•¥æµçš„å‚æ•°</li>
</ol>

<!-- ========== ç¬¬8ç«  ========== -->
<h1 id="ch8">ç¬¬å…«ç« ï¼šå®éªŒè®¾è®¡</h1>

<h2 id="ch8-1">8.1 å…¬å¹³å¯¹æ¯”çš„è¦æ±‚</h2>

<div class="box thm">
<div class="box-title">ğŸ“ å®éªŒå…¬å¹³æ€§åŸåˆ™</div>
<ol>
<li><strong>ç›¸åŒè¶…å‚æ•°</strong>ï¼šæ‰€æœ‰æ–¹æ³•ä½¿ç”¨ç›¸åŒçš„ PPO è¶…å‚æ•°ï¼ˆlr, batch_size, n_epochs...ï¼‰</li>
<li><strong>ç›¸åŒå‚æ•°é¢„ç®—</strong>ï¼šç‰¹å¾æå–å™¨å‚æ•°é‡åº”ç›¸å½“ï¼ˆæˆ–æ³¨æ˜å·®å¼‚ï¼‰</li>
<li><strong>ç›¸åŒç¯å¢ƒå’Œç§å­</strong>ï¼šä½¿ç”¨ç›¸åŒçš„éšæœºç§å­å’Œç¯å¢ƒé…ç½®</li>
<li><strong>å¤š seed è¿è¡Œ</strong>ï¼šè‡³å°‘ 5 ä¸ªä¸åŒç§å­ï¼ŒæŠ¥å‘Š mean Â± std</li>
<li><strong>ç»Ÿè®¡æ£€éªŒ</strong>ï¼šä½¿ç”¨ Welch's t-test æˆ– bootstrap CI ç¡®è®¤æ˜¾è‘—æ€§</li>
</ol>
</div>

<h3>ä¸‰ä¸ªåŸºçº¿çš„å¯¹æ¯”</h3>

<table>
<tr><th>æ–¹æ³•</th><th>ç‰¹å¾æå–å™¨</th><th>ç‰©ç†çº¦æŸ</th><th>å‚æ•°é‡ï¼ˆç‰¹å¾éƒ¨åˆ†ï¼‰</th></tr>
<tr><td>Pure PPO</td><td>MLP (2å±‚)</td><td>æ— </td><td>~33K</td></tr>
<tr><td>GNS + PPO</td><td>GNS (3å±‚ GNN)</td><td>æ— ï¼ˆæ•°æ®é©±åŠ¨ï¼‰</td><td>~400K</td></tr>
<tr><td><strong>PhysRobot</strong></td><td>DynamiCAL + MLP</td><td>åŠ¨é‡å®ˆæ’ï¼ˆç¡¬çº¦æŸï¼‰</td><td>~500K</td></tr>
</table>

<h2 id="ch8-2">8.2 Ablation Study è®¾è®¡</h2>

<table>
<tr><th>ç¼–å·</th><th>å˜ä½“</th><th>ä¿®æ”¹å†…å®¹</th><th>æ£€éªŒå‡è®¾</th></tr>
<tr><td>A1</td><td>Full PhysRobot</td><td>å®Œæ•´æ¨¡å‹</td><td>â€”</td></tr>
<tr><td>A2</td><td>No EdgeFrame</td><td>ç”¨æ ‡å‡† MLP æ›¿ä»£è¾¹å¸§</td><td>è¾¹å¸§çš„å¿…è¦æ€§</td></tr>
<tr><td>A3</td><td>No GNN</td><td>ç”¨ MLP æ›¿ä»£ GNN</td><td>å›¾ç»“æ„çš„å¿…è¦æ€§</td></tr>
<tr><td>A4</td><td>No Physics Stream</td><td>ç§»é™¤ç‰©ç†æµ</td><td>ç‰©ç†ç‰¹å¾çš„å¿…è¦æ€§</td></tr>
<tr><td>A5</td><td>Soft Constraint</td><td>ç”¨ loss penalty æ›¿ä»£ç¡¬çº¦æŸ</td><td>ç¡¬çº¦æŸ vs è½¯çº¦æŸ</td></tr>
<tr><td>A6</td><td>1-layer MP</td><td>1 å±‚æ¶ˆæ¯ä¼ é€’</td><td>æ¶ˆæ¯ä¼ é€’å±‚æ•°çš„å½±å“</td></tr>
<tr><td>A7</td><td>No Residual</td><td>ç§»é™¤æ®‹å·®è¿æ¥</td><td>æ®‹å·®è¿æ¥çš„å¿…è¦æ€§</td></tr>
</table>

<h3>è¯„ä»·æŒ‡æ ‡</h3>

<ol>
<li><strong>æ ·æœ¬æ•ˆç‡</strong>ï¼šè¾¾åˆ° 70% æˆåŠŸç‡æ‰€éœ€çš„ timesteps</li>
<li><strong>æœ€ç»ˆæˆåŠŸç‡</strong>ï¼šè®­ç»ƒç»“æŸæ—¶çš„æˆåŠŸç‡</li>
<li><strong>OOD æ³›åŒ–</strong>ï¼šåœ¨ mass âˆˆ {0.2, 0.5, 2.0, 5.0} ä¸Šçš„æˆåŠŸç‡</li>
<li><strong>åŠ¨é‡è¯¯å·®</strong>ï¼š\(||\sum \vec{F}_{predicted}|| / \max(||\vec{F}_{ij}||)\)</li>
<li><strong>è®­ç»ƒæ—¶é—´</strong>ï¼šwall-clock time per 1000 timesteps</li>
</ol>

<!-- ========== ç¬¬9ç«  ========== -->
<h1 id="ch9">ç¬¬ä¹ç« ï¼šä¸ç›¸å…³å·¥ä½œå¯¹æ¯”</h1>

<h2 id="ch9-1">9.1 vs Hamiltonian Neural Networks (HNN)</h2>

<table>
<tr><th>ç»´åº¦</th><th>HNN</th><th>PhysRobot</th></tr>
<tr><td>å®ˆæ’é‡</td><td>èƒ½é‡ï¼ˆ\(H = \text{const}\)ï¼‰</td><td>åŠ¨é‡ï¼ˆ\(\sum m_iv_i = \text{const}\)ï¼‰</td></tr>
<tr><td>æ¡†æ¶</td><td>å“ˆå¯†é¡¿åŠ›å­¦ \(\dot{q} = \partial H/\partial p\)</td><td>ç‰›é¡¿åŠ›å­¦ \(F = ma\)</td></tr>
<tr><td>å‡è®¾</td><td>ä¿å®ˆç³»ç»Ÿï¼ˆæ— è€—æ•£ï¼‰</td><td>å…è®¸è€—æ•£</td></tr>
<tr><td>æ¥è§¦å¤„ç†</td><td>âŒ ä¸é€‚åˆï¼ˆæ¥è§¦æ˜¯éä¿å®ˆçš„ï¼‰</td><td>âœ… GNN å­¦ä¹ æ¥è§¦åŠ›</td></tr>
<tr><td>å¤šä½“æ‰©å±•</td><td>âŒ éœ€è¦æ‰‹åŠ¨å®šä¹‰ \(H(q_1,...,q_N,p_1,...,p_N)\)</td><td>âœ… GNN å¤©ç„¶å¤„ç†å˜åŒ–æ‹“æ‰‘</td></tr>
<tr><td>ä¸ RL é›†æˆ</td><td>âŒ å›°éš¾ï¼ˆéœ€è¦è¾›ç­–ç•¥æ¢¯åº¦ï¼‰</td><td>âœ… ç®€å•ï¼ˆç‰¹å¾æå–å™¨æ¥å£ï¼‰</td></tr>
<tr><td>é€‚ç”¨åœºæ™¯</td><td>åˆ†å­åŠ¨åŠ›å­¦ã€å¤©ä½“åŠ›å­¦</td><td>æœºå™¨äººæ“ä½œã€æ¥è§¦ä¸°å¯Œä»»åŠ¡</td></tr>
</table>

<h2 id="ch9-2">9.2 vs GNS å’Œ EGNN</h2>

<table>
<tr><th>ç»´åº¦</th><th>GNS (DeepMind)</th><th>EGNN</th><th>PhysRobot</th></tr>
<tr><td>åŠ¨é‡å®ˆæ’</td><td>âŒï¼ˆ10-50% è¯¯å·®ï¼‰</td><td>âŒï¼ˆ5-10% è¯¯å·®ï¼‰</td><td>âœ…ï¼ˆ&lt;0.1% è¯¯å·®ï¼‰</td></tr>
<tr><td>æ—‹è½¬ç­‰å˜</td><td>âŒ</td><td>âœ… E(n) ç­‰å˜</td><td>éƒ¨åˆ†ï¼ˆå¹³ç§»ä¸å˜ï¼‰</td></tr>
<tr><td>é•¿æ—¶ç¨³å®šæ€§</td><td>âŒ èƒ½é‡å‘æ•£</td><td>âš ï¸ ç¼“æ…¢å‘æ•£</td><td>âœ… ç¨³å®šï¼ˆåŠ¨é‡å®ˆæ’ï¼‰</td></tr>
<tr><td>OOD æ³›åŒ–</td><td>âŒ å·®</td><td>âš ï¸ ä¸­ç­‰</td><td>âœ… å¥½</td></tr>
<tr><td>è®­ç»ƒæ•°æ®éœ€æ±‚</td><td>500+ è½¨è¿¹</td><td>~100 è½¨è¿¹</td><td>~5 è½¨è¿¹ï¼ˆç‰©ç†ä»¿çœŸé¢„è®­ç»ƒï¼‰</td></tr>
</table>

<h2 id="ch9-3">9.3 vs Model-based RL</h2>

<table>
<tr><th>ç»´åº¦</th><th>MBPO/Dreamer</th><th>PhysRobot</th></tr>
<tr><td>ä¸–ç•Œæ¨¡å‹</td><td>å®Œæ•´çš„ \(s' = f(s, a)\)</td><td>åªå­¦ç‰©ç†ç‰¹å¾</td></tr>
<tr><td>è§„åˆ’èƒ½åŠ›</td><td>âœ… å¯ä»¥åš MPC</td><td>âŒ ä¸ç›´æ¥åšè§„åˆ’</td></tr>
<tr><td>ç‰©ç†çº¦æŸ</td><td>âŒ æ— ï¼ˆé»‘ç›’æ¨¡å‹ï¼‰</td><td>âœ… åŠ¨é‡å®ˆæ’</td></tr>
<tr><td>å¤æ‚åº¦</td><td>é«˜ï¼ˆéœ€è¦å­¦ä¹ å®Œæ•´åŠ¨åŠ›å­¦ï¼‰</td><td>ä½ï¼ˆåªéœ€å­¦ä¹ ç‰¹å¾ï¼‰</td></tr>
<tr><td>äº’è¡¥æ€§</td><td colspan="2">å¯ä»¥ç»“åˆï¼šPhysRobot åšç‰©ç†ç‰¹å¾ï¼ŒDreamer åšä¸–ç•Œæ¨¡å‹</td></tr>
</table>

<div class="box insight">
<div class="box-title">ğŸ’¡ PhysRobot çš„ç‹¬ç‰¹å®šä½</div>
<p>PhysRobot ä¸æ˜¯ HNNã€LNNã€GNS æˆ– Model-based RL çš„ç«äº‰å¯¹æ‰‹ï¼Œè€Œæ˜¯ä¸€ä¸ª<strong>äº’è¡¥çš„ç‰¹å¾æå–æ¨¡å—</strong>ã€‚å®ƒçš„ç‹¬ç‰¹è´¡çŒ®åœ¨äºï¼š</p>
<ol>
<li>åœ¨<strong>éä¿å®ˆçš„æ¥è§¦ä¸°å¯Œ</strong>ä»»åŠ¡ä¸­æä¾›ç‰©ç†å½’çº³åç½®</li>
<li>é€šè¿‡<strong>ç¡¬çº¦æŸ</strong>ï¼ˆè€ŒéæŸå¤±å‡½æ•°ï¼‰ä¿è¯åŠ¨é‡å®ˆæ’</li>
<li>ä»¥<strong>ç‰¹å¾æå–å™¨</strong>çš„å½¢å¼ä¸æ ‡å‡† RL ç®¡é“æ— ç¼é›†æˆ</li>
</ol>
</div>

<!-- ========== ç¬¬10ç«  ========== -->
<h1 id="ch10">ç¬¬åç« ï¼šè®ºæ–‡å†™ä½œå»ºè®®</h1>

<h2>10.1 Introduction çš„æ•…äº‹çº¿</h2>

<p>æ¨èçš„å™äº‹ç»“æ„ï¼š</p>

<ol>
<li><strong>å¼€åœº</strong>ï¼ˆ1æ®µï¼‰ï¼šæœºå™¨äººæ“ä½œéœ€è¦ç†è§£ç‰©ç†â†’å½“å‰æ–¹æ³•ä¸ç†è§£â†’é—®é¢˜</li>
<li><strong>ç°æœ‰æ–¹æ³•çš„ä¸è¶³</strong>ï¼ˆ2æ®µï¼‰ï¼š
    <ul>
    <li>Pure RLï¼šæ ·æœ¬æ•ˆç‡ä½ï¼ŒOOD å·®</li>
    <li>Physics-informed RL (PINNs)ï¼šè½¯çº¦æŸï¼Œä¼˜åŒ–å›°éš¾</li>
    <li>HNN/LNNï¼šä¿å®ˆç³»ç»Ÿå‡è®¾ï¼Œä¸é€‚åˆæ¥è§¦</li>
    </ul>
</li>
<li><strong>æˆ‘ä»¬çš„æ–¹æ³•</strong>ï¼ˆ1æ®µï¼‰ï¼šç¡¬çº¦æŸåŠ¨é‡å®ˆæ’ GNN + RL = PhysRobot</li>
<li><strong>è´¡çŒ®åˆ—è¡¨</strong>ï¼ˆbullet pointsï¼‰ï¼š
    <ul>
    <li>æ¶æ„åˆ›æ–°ï¼šé¦–ä¸ªå°† momentum-conserving GNN ç”¨äº RL ç‰¹å¾æå–</li>
    <li>ç†è®ºä¿è¯ï¼šTheorem 1 è¯æ˜åŠ¨é‡å®ˆæ’</li>
    <li>å®éªŒéªŒè¯ï¼šXx æ ·æœ¬æ•ˆç‡ + Yx OOD æ³›åŒ–</li>
    </ul>
</li>
</ol>

<h2>10.2 éœ€è¦çš„å›¾è¡¨</h2>

<table>
<tr><th>å›¾/è¡¨</th><th>å†…å®¹</th><th>ç›®çš„</th></tr>
<tr><td>Fig 1</td><td>æ¶æ„æ€»è§ˆå›¾</td><td>ä¸€å›¾ç†è§£æ–¹æ³•</td></tr>
<tr><td>Fig 2</td><td>EdgeFrame ç¤ºæ„å›¾</td><td>è§£é‡Šæ ¸å¿ƒåˆ›æ–°</td></tr>
<tr><td>Fig 3</td><td>å­¦ä¹ æ›²çº¿ï¼ˆreward vs timestepsï¼‰</td><td>æ ·æœ¬æ•ˆç‡å¯¹æ¯”</td></tr>
<tr><td>Fig 4</td><td>OOD æ³›åŒ–æŸ±çŠ¶å›¾</td><td>ä¸åŒè´¨é‡ä¸‹çš„æˆåŠŸç‡</td></tr>
<tr><td>Fig 5</td><td>åŠ¨é‡è¯¯å·®æ—¶é—´åºåˆ—</td><td>å®ˆæ’æ€§éªŒè¯</td></tr>
<tr><td>Fig 6</td><td>Ablation ç»“æœè¡¨</td><td>å„æ¨¡å—è´¡çŒ®</td></tr>
<tr><td>Tab 1</td><td>æ‰€æœ‰æ–¹æ³•çš„å®Œæ•´å¯¹æ¯”</td><td>ä¸»è¦ç»“æœ</td></tr>
<tr><td>Tab 2</td><td>è®¡ç®—å¼€é”€å¯¹æ¯”</td><td>å®ç”¨æ€§è¯„ä¼°</td></tr>
</table>

<h2>10.3 å¯èƒ½çš„ Reviewer é—®é¢˜</h2>

<div class="box ex">
<div class="box-title">ğŸ” é¢„æœŸé—®é¢˜ä¸å‡†å¤‡</div>

<p><strong>Q1ï¼šPushBox å¤ªç®€å•äº†</strong></p>
<p>A: PushBox æ˜¯ proof-of-conceptã€‚(a) OOD æ³›åŒ–å®éªŒå±•ç¤ºäº†ç‰©ç†å…ˆéªŒçš„ä»·å€¼ (b) æä¾› multi-object æ‰©å±•å®éªŒ (c) æ¶æ„è®¾è®¡é¢å‘å¤æ‚åœºæ™¯</p>

<p><strong>Q2ï¼šå’Œç›´æ¥åŠ  physics loss æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong></p>
<p>A: Ablation A5 ç›´æ¥å¯¹æ¯”äº†ç¡¬çº¦æŸ vs è½¯çº¦æŸã€‚ç¡¬çº¦æŸåœ¨ä»»ä½•å‚æ•°å€¼ä¸‹éƒ½æ»¡è¶³å®ˆæ’å¾‹ï¼Œè½¯çº¦æŸä¼šåœ¨ä¼˜åŒ–å‹åŠ›ä¸‹è¢«ç‰ºç‰²ã€‚</p>

<p><strong>Q3ï¼šä¸ºä»€ä¹ˆä¸ç”¨ HNN/LNNï¼Ÿ</strong></p>
<p>A: HNN/LNN å‡è®¾ä¿å®ˆç³»ç»Ÿï¼Œä¸é€‚åˆæœ‰æ‘©æ“¦å’Œç¢°æ’æŸè€—çš„æœºå™¨äººæ“ä½œã€‚PhysRobot åªå‡è®¾åŠ¨é‡å®ˆæ’ï¼ˆæ›´å¼±çš„å‡è®¾ï¼‰ï¼Œé€‚ç”¨èŒƒå›´æ›´å¹¿ã€‚</p>

<p><strong>Q4ï¼šGNN åªæœ‰ 2 ä¸ªèŠ‚ç‚¹ï¼Œæœ‰æ„ä¹‰å—ï¼Ÿ</strong></p>
<p>A: 2 èŠ‚ç‚¹æ˜¯æœ€ç®€æƒ…å†µï¼Œç”¨äºéªŒè¯æ ¸å¿ƒæœºåˆ¶ã€‚multi-object å®éªŒ (5-10 èŠ‚ç‚¹) å±•ç¤ºäº†å¯æ‰©å±•æ€§ã€‚</p>

<p><strong>Q5ï¼šè®¡ç®—å¼€é”€ï¼Ÿ</strong></p>
<p>A: GNN æ¨ç†å¢åŠ çº¦ ~5msï¼ˆæ‰¹é‡å¤„ç†ï¼‰ã€‚ç›¸æ¯” PPO çš„ç­–ç•¥æ›´æ–°ï¼ˆ~50ms/batchï¼‰ï¼Œå¼€é”€å¯æ¥å—ã€‚</p>
</div>

<h2>10.4 æ‰©å±•å®éªŒå»ºè®®</h2>

<ol>
<li><strong>Multi-object åœºæ™¯</strong>ï¼š3-5 ä¸ªä¸åŒè´¨é‡çš„ç‰©ä½“ï¼Œå±•ç¤º GNN å¤„ç†å˜åŒ–æ‹“æ‰‘çš„èƒ½åŠ›</li>
<li><strong>æ‘©æ“¦ OOD</strong>ï¼šè®­ç»ƒ Î¼=0.5ï¼Œæµ‹è¯• Î¼âˆˆ{0.1, 0.3, 0.7, 1.0}</li>
<li><strong>ä¸åŒä»»åŠ¡</strong>ï¼šStackã€Sortã€Tool-use ç­‰æ›´å¤æ‚çš„æ“ä½œ</li>
<li><strong>Sim-to-sim è¿ç§»</strong>ï¼šåœ¨ MuJoCo è®­ç»ƒï¼Œåœ¨ Isaac Gym æµ‹è¯•</li>
<li><strong>Real robot</strong>ï¼ˆå¦‚æœå¯èƒ½ï¼‰ï¼šåœ¨çœŸå®æœºæ¢°è‡‚ä¸ŠéªŒè¯</li>
</ol>

<!-- ========== é™„å½• ========== -->
<h1 id="appendix">é™„å½•</h1>

<h2 id="appendix-algo">A. å®Œæ•´ç®—æ³•ä¼ªä»£ç </h2>

<pre><code class="python">ç®—æ³•: PhysRobot è®­ç»ƒ

è¾“å…¥: ç¯å¢ƒ E, æ€»æ­¥æ•° T, PPO è¶…å‚æ•°
è¾“å‡º: è®­ç»ƒå¥½çš„ç­–ç•¥ Ï€

åˆå§‹åŒ–:
  physics_core = PhysicsCore(hidden_dim=128, n_mp=3)
  policy_stream = MLP(16 â†’ 128 â†’ 128)
  fusion = MLP(131 â†’ 128)
  ppo = PPO(features_extractor=PhysRobotExtractor)

For t = 1 to T:
  // æ”¶é›†æ•°æ®
  For step = 1 to n_steps:
    obs = E.observe()                    // (16,)
    
    // ç‰©ç†æµ
    graph = obs_to_graph(obs)            // 2 nodes, 2 edges
    edge_feat = EdgeFrame(graph.pos, graph.vel)  // (2, 64)
    node_feat = NodeEncoder(graph.x)     // (2, 128)
    For l = 1 to 3:
      node_feat = MessagePassing_l(node_feat, edge_feat)
    acc_pred = Decoder(node_feat)        // (2, 3)
    box_acc = acc_pred[1]                // (3,)
    
    // ç­–ç•¥æµ
    policy_feat = policy_stream(obs)     // (128,)
    
    // èåˆ
    features = fusion(cat(policy_feat, box_acc))  // (128,)
    
    // PPO åŠ¨ä½œé€‰æ‹©
    action = ppo.sample_action(features) // (2,)
    obs', reward, done = E.step(action)
    buffer.store(obs, action, reward, done)
  
  // PPO æ›´æ–°ï¼ˆæ¢¯åº¦åŒæ—¶æµå‘ç‰©ç†æµå’Œç­–ç•¥æµï¼‰
  For epoch = 1 to n_epochs:
    batch = buffer.sample(batch_size)
    loss = ppo_loss(batch)  // clip_loss + vf_loss + entropy
    loss.backward()          // æ¢¯åº¦æµå‘æ‰€æœ‰æ¨¡å—
    optimizer.step()

Return Ï€</code></pre>

<h2 id="appendix-symbols">B. æ•°å­¦ç¬¦å·è¡¨</h2>

<table>
<tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>ç»´åº¦</th></tr>
<tr><td>\(\vec{x}_i\)</td><td>èŠ‚ç‚¹ \(i\) çš„ä½ç½®</td><td>\(\mathbb{R}^3\)</td></tr>
<tr><td>\(\vec{v}_i\)</td><td>èŠ‚ç‚¹ \(i\) çš„é€Ÿåº¦</td><td>\(\mathbb{R}^3\)</td></tr>
<tr><td>\(\vec{a}_i\)</td><td>èŠ‚ç‚¹ \(i\) çš„åŠ é€Ÿåº¦</td><td>\(\mathbb{R}^3\)</td></tr>
<tr><td>\(m_i\)</td><td>èŠ‚ç‚¹ \(i\) çš„è´¨é‡</td><td>\(\mathbb{R}\)</td></tr>
<tr><td>\(\vec{r}_{ij}\)</td><td>ç›¸å¯¹ä½ç§» \(\vec{x}_j - \vec{x}_i\)</td><td>\(\mathbb{R}^3\)</td></tr>
<tr><td>\(\vec{F}_{ij}\)</td><td>èŠ‚ç‚¹ \(j\) å¯¹ \(i\) çš„åŠ›</td><td>\(\mathbb{R}^3\)</td></tr>
<tr><td>\(\vec{e}_k^{(ij)}\)</td><td>è¾¹å¸§åŸºå‘é‡ (\(k=1,2,3\))</td><td>\(\mathbb{R}^3\), å•ä½å‘é‡</td></tr>
<tr><td>\(f_k\)</td><td>åŠ›çš„æ ‡é‡åˆ†é‡</td><td>\(\mathbb{R}\)</td></tr>
<tr><td>\(\vec{h}_i\)</td><td>èŠ‚ç‚¹ \(i\) çš„éšè—çŠ¶æ€</td><td>\(\mathbb{R}^{128}\)</td></tr>
<tr><td>\(\vec{e}_{ij}\)</td><td>è¾¹ \((i,j)\) çš„ç‰¹å¾</td><td>\(\mathbb{R}^{64}\)</td></tr>
<tr><td>\(\vec{m}_{ij}\)</td><td>ä» \(j\) åˆ° \(i\) çš„æ¶ˆæ¯</td><td>\(\mathbb{R}^{128}\)</td></tr>
<tr><td>\(H(q,p)\)</td><td>å“ˆå¯†é¡¿é‡ï¼ˆæ€»èƒ½é‡ï¼‰</td><td>\(\mathbb{R}\)</td></tr>
<tr><td>\(L(q,\dot{q})\)</td><td>æ‹‰æ ¼æœ—æ—¥é‡ (\(T-V\))</td><td>\(\mathbb{R}\)</td></tr>
<tr><td>\(\vec{P}\)</td><td>ç³»ç»Ÿæ€»åŠ¨é‡</td><td>\(\mathbb{R}^3\)</td></tr>
<tr><td>\(\vec{L}\)</td><td>ç³»ç»Ÿæ€»è§’åŠ¨é‡</td><td>\(\mathbb{R}^3\)</td></tr>
<tr><td>\(\Delta t\)</td><td>ç§¯åˆ†æ­¥é•¿</td><td>\(\mathbb{R}\)</td></tr>
</table>

<h2 id="appendix-formulas">C. å…³é”®å…¬å¼é€ŸæŸ¥</h2>

<div class="formula-card">
<strong>1. ç‰›é¡¿ç¬¬ä¸‰å®šå¾‹ï¼ˆPhysRobot æ ¸å¿ƒçº¦æŸï¼‰</strong>
\[\vec{F}_{ij} = -\vec{F}_{ji}\]
</div>

<div class="formula-card">
<strong>2. åŠ¨é‡å®ˆæ’ï¼ˆç”±åå¯¹ç§°æ€§ä¿è¯ï¼‰</strong>
\[\frac{d}{dt}\sum_i m_i\vec{v}_i = \sum_{i<j}(\vec{F}_{ij} + \vec{F}_{ji}) = \vec{0}\]
</div>

<div class="formula-card">
<strong>3. EdgeFrame åŠ›åˆ†è§£</strong>
\[\vec{F}_{ij} = f_1 \vec{e}_1^{(ij)} + f_2 \vec{e}_2^{(ij)} + f_3 \vec{e}_3^{(ij)}\]
</div>

<div class="formula-card">
<strong>4. è¾›ç§¯åˆ†å™¨ï¼ˆStÃ¶rmer-Verletï¼‰</strong>
\[\vec{v}_{n+1/2} = \vec{v}_n + \tfrac{\Delta t}{2}\vec{a}_n, \quad
\vec{x}_{n+1} = \vec{x}_n + \Delta t\,\vec{v}_{n+1/2}, \quad
\vec{v}_{n+1} = \vec{v}_{n+1/2} + \tfrac{\Delta t}{2}\vec{a}_{n+1}\]
</div>

<div class="formula-card">
<strong>5. GNN æ¶ˆæ¯ä¼ é€’</strong>
\[\vec{h}_i' = \psi\!\left(\vec{h}_i,\;\sum_{j\in\mathcal{N}(i)}\phi(\vec{h}_i, \vec{h}_j, \vec{e}_{ij})\right)\]
</div>

<div class="formula-card">
<strong>6. PPO ç›®æ ‡å‡½æ•°</strong>
\[L^{CLIP}(\theta) = \hat{\mathbb{E}}\!\left[\min\!\left(\frac{\pi_\theta(a|s)}{\pi_{\theta_{\text{old}}}(a|s)}\hat{A},\;\text{clip}\!\left(\frac{\pi_\theta}{\pi_{\theta_{\text{old}}}}, 1\!-\!\epsilon, 1\!+\!\epsilon\right)\hat{A}\right)\right]\]
</div>

<div class="formula-card">
<strong>7. èƒ½é‡å®ˆæ’æ£€æŸ¥</strong>
\[E = \frac{1}{2}\sum_i m_i||\vec{v}_i||^2 + V(\{\vec{x}_i\}), \quad \frac{\Delta E}{E_0} < \text{tolerance}\]
</div>

<br>
<hr>
<p style="text-align:center;color:var(--text-secondary);font-size:.9em">
  PhysRobot æ·±åº¦æ•™ç¨‹ Â· 2026-02-06 Â· ç‰©ç†å®ˆæ’GNN + å¼ºåŒ–å­¦ä¹ <br>
  ç›®æ ‡ä¼šè®®ï¼šICRA 2027 / CoRL 2026
</p>

</main>

<script>
// Theme toggle
function toggleTheme(){
  const b = document.body;
  b.setAttribute('data-theme', b.getAttribute('data-theme')==='dark'?'':'dark');
  localStorage.setItem('theme', b.getAttribute('data-theme'));
}
(function(){const t=localStorage.getItem('theme');if(t)document.body.setAttribute('data-theme',t)})();

// Menu toggle
document.getElementById('menuToggle').onclick = function(){
  document.getElementById('sidebar').classList.toggle('open');
};

// Progress bar
window.addEventListener('scroll', function(){
  const h = document.documentElement;
  const pct = (h.scrollTop / (h.scrollHeight - h.clientHeight)) * 100;
  document.getElementById('progressBar').style.width = pct + '%';
});

// Active nav
const navLinks = document.querySelectorAll('.sidebar nav a[href^="#"]');
const observer = new IntersectionObserver(entries => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      navLinks.forEach(l => l.classList.remove('active'));
      const link = document.querySelector('.sidebar nav a[href="#' + e.target.id + '"]');
      if (link) link.classList.add('active');
    }
  });
}, {rootMargin: '-20% 0px -60% 0px'});
document.querySelectorAll('h1[id], h2[id]').forEach(s => observer.observe(s));

// KaTeX render
document.addEventListener('DOMContentLoaded', function(){
  if(typeof renderMathInElement !== 'undefined'){
    renderMathInElement(document.body, {
      delimiters: [
        {left: '$$', right: '$$', display: true},
        {left: '\\[', right: '\\]', display: true},
        {left: '$', right: '$', display: false},
        {left: '\\(', right: '\\)', display: false}
      ],
      throwOnError: false
    });
  }
});
</script>
</body>
</html>

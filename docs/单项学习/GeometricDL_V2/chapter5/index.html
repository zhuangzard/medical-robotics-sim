<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chapter 5: Geometric Deep Learning Models | GDL å­¦ä¹ æŒ‡å—</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Serif+SC:wght@400;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}],throwOnError:false})"></script>
  <style>
/* ================================================================
   Geometric Deep Learning Study Guide - Chapter 5 Inline Styles
   ================================================================ */
:root {
  --bg: #ffffff;
  --bg-secondary: #f8f9fa;
  --bg-code: #f1f3f5;
  --text: #212529;
  --text-secondary: #495057;
  --text-muted: #868e96;
  --border: #dee2e6;
  --accent: #4263eb;
  --accent-light: #dbe4ff;
  --accent-dark: #3b5bdb;
  --success: #37b24d;
  --warning: #f59f00;
  --danger: #f03e3e;
  --sidebar-width: 300px;
  --header-height: 60px;
  --shadow: 0 1px 3px rgba(0,0,0,0.08);
  --shadow-lg: 0 4px 12px rgba(0,0,0,0.1);
  --radius: 8px;
  --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  --font-serif: 'Noto Serif SC', 'Georgia', serif;
}

[data-theme="dark"] {
  --bg: #1a1b1e; --bg-secondary: #25262b; --bg-code: #2c2e33;
  --text: #c1c2c5; --text-secondary: #909296; --text-muted: #5c5f66;
  --border: #373a40; --accent: #5c7cfa; --accent-light: #1c2541; --accent-dark: #748ffc;
  --shadow: 0 1px 3px rgba(0,0,0,0.3); --shadow-lg: 0 4px 12px rgba(0,0,0,0.4);
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html { font-size: 16px; scroll-behavior: smooth; scroll-padding-top: calc(var(--header-height) + 20px); }
body { font-family: var(--font-sans); background: var(--bg); color: var(--text); line-height: 1.7; transition: background 0.3s, color 0.3s; }

/* Header */
.header { position: fixed; top: 0; left: 0; right: 0; height: var(--header-height); background: var(--bg-secondary); border-bottom: 1px solid var(--border); display: flex; align-items: center; padding: 0 24px; z-index: 1000; box-shadow: var(--shadow); }
.header-title { font-size: 1.1rem; font-weight: 700; color: var(--accent); flex: 1; }
.header-title a { color: var(--accent); text-decoration: none; }
.header-nav { display: flex; gap: 12px; align-items: center; }
.header-nav a { color: var(--text-secondary); text-decoration: none; font-size: 0.85rem; padding: 4px 10px; border-radius: 4px; transition: all 0.2s; }
.header-nav a:hover { background: var(--accent-light); color: var(--accent); }
.theme-toggle { background: var(--bg-code); border: 1px solid var(--border); border-radius: 20px; padding: 6px 12px; cursor: pointer; font-size: 1rem; color: var(--text); transition: all 0.2s; }
.theme-toggle:hover { background: var(--accent-light); }

/* Progress bar */
.progress-bar { position: fixed; top: var(--header-height); left: 0; width: 0%; height: 3px; background: linear-gradient(90deg, var(--accent), #e64980, var(--accent-dark)); z-index: 1001; transition: width 0.1s; }

/* Sidebar */
.sidebar { position: fixed; top: var(--header-height); left: 0; width: var(--sidebar-width); height: calc(100vh - var(--header-height)); background: var(--bg-secondary); border-right: 1px solid var(--border); overflow-y: auto; padding: 20px 0; z-index: 900; transition: transform 0.3s; }
.sidebar-toggle { display: none; position: fixed; top: calc(var(--header-height) + 10px); left: 10px; z-index: 950; background: var(--accent); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 1.2rem; cursor: pointer; box-shadow: var(--shadow-lg); }
.sidebar h3 { padding: 8px 20px; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; color: var(--text-muted); margin-top: 12px; }
.sidebar a { display: block; padding: 5px 20px 5px 24px; color: var(--text-secondary); text-decoration: none; font-size: 0.82rem; border-left: 3px solid transparent; transition: all 0.2s; }
.sidebar a:hover { background: var(--accent-light); color: var(--accent); border-left-color: var(--accent); }
.sidebar a.active { background: var(--accent-light); color: var(--accent); border-left-color: var(--accent); font-weight: 600; }
.sidebar a.sub { padding-left: 40px; font-size: 0.78rem; }
.sidebar a.sub-sub { padding-left: 56px; font-size: 0.76rem; }
.sidebar .star { color: #f59f00; }

/* Main */
.main { margin-left: var(--sidebar-width); margin-top: var(--header-height); padding: 40px 60px; max-width: 960px; }
h1 { font-size: 2.2rem; font-weight: 800; margin-bottom: 16px; line-height: 1.3; }
h2 { font-size: 1.6rem; font-weight: 700; margin-top: 56px; margin-bottom: 16px; padding-bottom: 8px; border-bottom: 2px solid var(--accent); }
h3 { font-size: 1.3rem; font-weight: 600; margin-top: 40px; margin-bottom: 12px; }
h4 { font-size: 1.1rem; font-weight: 600; margin-top: 28px; margin-bottom: 8px; color: var(--text-secondary); }
p { margin-bottom: 16px; }
ul, ol { padding-left: 24px; margin-bottom: 16px; }
li { margin-bottom: 6px; }
a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }

/* Bilingual */
.bilingual { margin: 20px 0; border-left: 4px solid var(--accent); padding: 16px 20px; background: var(--bg-secondary); border-radius: 0 var(--radius) var(--radius) 0; }
.bilingual .zh { font-size: 1rem; line-height: 1.8; margin-bottom: 10px; }
.bilingual .en { font-size: 0.86rem; color: var(--text-muted); font-style: italic; line-height: 1.6; border-top: 1px solid var(--border); padding-top: 8px; }
.term { color: var(--accent); font-weight: 600; }

/* Math blocks */
.math-block { margin: 24px 0; padding: 20px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: var(--radius); overflow-x: auto; }
.math-explain { margin-top: 12px; padding: 12px 16px; background: var(--accent-light); border-radius: var(--radius); font-size: 0.92rem; color: var(--text-secondary); }
.math-explain::before { content: "ğŸ’¡ "; }

/* Symbol table */
.symbol-table { margin: 16px 0; }
.symbol-table table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
.symbol-table th { background: var(--accent); color: white; padding: 8px 12px; text-align: left; }
.symbol-table td { padding: 8px 12px; border: 1px solid var(--border); }
.symbol-table tr:nth-child(even) { background: var(--bg-secondary); }

/* Figures */
.figure { margin: 24px 0; text-align: center; }
.figure img { max-width: 100%; height: auto; border-radius: var(--radius); box-shadow: var(--shadow); }
.figure figcaption { margin-top: 10px; font-size: 0.88rem; color: var(--text-secondary); font-style: italic; }

/* Callout boxes */
.callout { margin: 24px 0; padding: 16px 20px; border-radius: var(--radius); border-left: 4px solid; }
.callout h4 { margin-top: 0; margin-bottom: 8px; font-size: 0.95rem; color: var(--text); }
.callout-info { background: #e7f5ff; border-left-color: #339af0; }
[data-theme="dark"] .callout-info { background: #1c3a5e; border-left-color: #339af0; }
.callout-project { background: #ebfbee; border-left-color: var(--success); }
[data-theme="dark"] .callout-project { background: #1e3a23; border-left-color: var(--success); }
.callout-warning { background: #fff9db; border-left-color: var(--warning); }
[data-theme="dark"] .callout-warning { background: #3a3520; border-left-color: var(--warning); }
.callout-key { background: #fff0f6; border-left-color: #e64980; }
[data-theme="dark"] .callout-key { background: #3a1c2e; border-left-color: #e64980; }
.callout-danger { background: #ffe3e3; border-left-color: var(--danger); }
[data-theme="dark"] .callout-danger { background: #3a1c1c; border-left-color: var(--danger); }
.callout-project h4::before { content: "ğŸ¤– "; }
.callout-info h4::before { content: "â„¹ï¸ "; }
.callout-warning h4::before { content: "âš ï¸ "; }
.callout-key h4::before { content: "ğŸ”‘ "; }
.callout-danger h4::before { content: "ğŸ”¥ "; }

/* Code blocks */
.code-container { position: relative; margin: 16px 0; }
.code-container .copy-btn { position: absolute; top: 8px; right: 8px; background: var(--accent); color: white; border: none; border-radius: 4px; padding: 4px 10px; font-size: 0.75rem; cursor: pointer; opacity: 0; transition: opacity 0.2s; z-index: 10; }
.code-container:hover .copy-btn { opacity: 1; }
.code-container .copy-btn:active { background: var(--accent-dark); }
.code-label { display: inline-block; background: var(--accent); color: white; padding: 2px 10px; font-size: 0.75rem; border-radius: var(--radius) var(--radius) 0 0; font-weight: 600; }
pre { margin: 0 0 16px 0; padding: 16px; background: var(--bg-code); border: 1px solid var(--border); border-radius: var(--radius); overflow-x: auto; font-family: var(--font-mono); font-size: 0.85rem; line-height: 1.55; }
code { font-family: var(--font-mono); font-size: 0.88em; background: var(--bg-code); padding: 2px 6px; border-radius: 3px; }
pre code { background: none; padding: 0; font-size: inherit; }

/* Blueprint / Framework box */
.blueprint { margin: 24px 0; padding: 20px; background: linear-gradient(135deg, var(--accent-light), var(--bg-secondary)); border: 2px solid var(--accent); border-radius: var(--radius); }
.blueprint h4 { color: var(--accent); margin-top: 0; }

/* Tables */
table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 0.9rem; }
th, td { padding: 10px 14px; border: 1px solid var(--border); text-align: left; }
th { background: var(--bg-secondary); font-weight: 600; }

/* Comparison table */
.comparison-table { overflow-x: auto; margin: 24px 0; }
.comparison-table table { min-width: 600px; }
.comparison-table th { background: var(--accent); color: white; }
.comparison-table td:first-child { font-weight: 600; color: var(--accent); }

/* Algorithm */
.algorithm { margin: 24px 0; border: 2px solid var(--accent); border-radius: var(--radius); overflow: hidden; }
.algorithm-title { background: var(--accent); color: white; padding: 8px 16px; font-weight: 600; font-size: 0.95rem; }
.algorithm-body { padding: 16px; background: var(--bg-secondary); font-family: var(--font-mono); font-size: 0.85rem; line-height: 1.8; white-space: pre-wrap; }

/* Exercises */
.exercises { margin: 32px 0; padding: 20px; background: var(--bg-secondary); border: 2px solid var(--warning); border-radius: var(--radius); }
.exercises h3 { margin-top: 0; color: var(--warning); }
.exercises h3::before { content: "âœï¸ "; }
.exercises ol { padding-left: 24px; }
.exercises li { margin-bottom: 12px; line-height: 1.6; }

/* Step-by-step derivation */
.derivation { margin: 20px 0; padding: 16px 20px; background: var(--bg-secondary); border-left: 4px solid #e64980; border-radius: 0 var(--radius) var(--radius) 0; }
.derivation h4 { color: #e64980; margin-top: 0; }
.derivation h4::before { content: "ğŸ“ "; }
.step { margin: 8px 0; padding: 8px 12px; background: var(--bg); border-radius: var(--radius); border: 1px solid var(--border); }
.step-num { display: inline-block; background: var(--accent); color: white; width: 24px; height: 24px; border-radius: 50%; text-align: center; font-size: 0.75rem; line-height: 24px; margin-right: 8px; font-weight: 700; }

/* Navigation */
.chapter-nav { display: flex; justify-content: space-between; margin-top: 60px; padding: 20px 0; border-top: 1px solid var(--border); }
.chapter-nav a { display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: var(--radius); font-weight: 500; transition: all 0.2s; }
.chapter-nav a:hover { background: var(--accent-light); border-color: var(--accent); text-decoration: none; }

/* Reading time badge */
.badge { display: inline-block; background: var(--accent); color: white; padding: 2px 10px; border-radius: 12px; font-size: 0.78rem; font-weight: 600; margin-right: 6px; }
.badge-green { background: var(--success); }
.badge-orange { background: var(--warning); }
.badge-red { background: var(--danger); }

/* Responsive */
@media (max-width: 1024px) {
  .sidebar { transform: translateX(-100%); }
  .sidebar.open { transform: translateX(0); }
  .sidebar-toggle { display: block; }
  .main { margin-left: 0; padding: 30px 24px; }
}
@media (max-width: 640px) {
  .main { padding: 20px 16px; }
  h1 { font-size: 1.6rem; }
  h2 { font-size: 1.3rem; }
  .header-nav a { display: none; }
  .header-nav .theme-toggle { display: inline-block; }
}
@media print {
  .sidebar, .header, .sidebar-toggle, .theme-toggle, .progress-bar { display: none; }
  .main { margin: 0; padding: 20px; max-width: 100%; }
}

/* Tooltip */
.tooltip { position: relative; border-bottom: 1px dotted var(--accent); cursor: help; }
.tooltip:hover::after { content: attr(data-tip); position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); background: var(--bg-code); border: 1px solid var(--border); padding: 8px 12px; border-radius: var(--radius); font-size: 0.82rem; white-space: nowrap; z-index: 100; box-shadow: var(--shadow-lg); }

/* Tab system for code comparison */
.tab-container { margin: 20px 0; border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
.tab-buttons { display: flex; background: var(--bg-secondary); border-bottom: 1px solid var(--border); }
.tab-btn { flex: 1; padding: 10px; border: none; background: none; cursor: pointer; font-weight: 500; color: var(--text-secondary); font-size: 0.88rem; transition: all 0.2s; border-bottom: 2px solid transparent; }
.tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); background: var(--bg); }
.tab-content { display: none; padding: 0; }
.tab-content.active { display: block; }
.tab-content pre { margin: 0; border: none; border-radius: 0; }

/* Flow diagram */
.flow { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; margin: 16px 0; padding: 16px; background: var(--bg-secondary); border-radius: var(--radius); }
.flow-box { padding: 8px 16px; background: var(--accent-light); border: 2px solid var(--accent); border-radius: var(--radius); font-weight: 600; font-size: 0.9rem; text-align: center; }
.flow-arrow { font-size: 1.3rem; color: var(--accent); font-weight: 700; }
  </style>
<!-- Enrichment CSS - to be injected into each chapter's <head> -->
<style>
/* ========== Enrichment Blocks ========== */
.enrichment-block {
  margin: 2.5rem 0;
  padding: 2rem;
  background: linear-gradient(135deg, #f0f7ff 0%, #e8f4fd 100%);
  border-left: 4px solid #3b82f6;
  border-radius: 0 12px 12px 0;
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
}
[data-theme="dark"] .enrichment-block {
  background: linear-gradient(135deg, #1a2332 0%, #1e293b 100%);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.enrichment-block h4 {
  margin-top: 0;
  font-size: 1.2rem;
  color: #1e40af;
}
[data-theme="dark"] .enrichment-block h4 {
  color: #93c5fd;
}

.enrichment-qa { margin-bottom: 1.5rem; }

.qa-pair {
  margin: 1.2rem 0;
  padding: 1.2rem;
  background: rgba(255,255,255,0.7);
  border-radius: 10px;
  transition: transform 0.2s;
}
.qa-pair:hover { transform: translateX(4px); }
[data-theme="dark"] .qa-pair {
  background: rgba(0,0,0,0.25);
}

.question {
  font-weight: 700;
  color: #2563eb;
  margin-bottom: 0.75rem;
  font-size: 1.05rem;
  line-height: 1.6;
}
[data-theme="dark"] .question { color: #60a5fa; }

.answer {
  line-height: 1.9;
  color: #374151;
  font-size: 1rem;
}
[data-theme="dark"] .answer { color: #d1d5db; }
.answer p { margin: 0.5rem 0; }

.enrichment-intuition {
  margin: 1.2rem 0;
  padding: 1.2rem;
  background: rgba(251,191,36,0.1);
  border-radius: 10px;
  border-left: 3px solid #f59e0b;
  line-height: 1.8;
}
[data-theme="dark"] .enrichment-intuition {
  background: rgba(251,191,36,0.05);
}

.enrichment-application {
  margin: 1.2rem 0;
  padding: 1.2rem;
  background: rgba(16,185,129,0.1);
  border-radius: 10px;
  border-left: 3px solid #10b981;
  line-height: 1.8;
}
[data-theme="dark"] .enrichment-application {
  background: rgba(16,185,129,0.05);
}

.enrichment-summary {
  margin: 1.2rem 0;
  padding: 1.2rem;
  background: rgba(139,92,246,0.1);
  border-radius: 10px;
  border-left: 3px solid #8b5cf6;
  line-height: 1.8;
}
[data-theme="dark"] .enrichment-summary {
  background: rgba(139,92,246,0.05);
}
</style>

</head>
<body>
  <div class="progress-bar" id="progressBar"></div>

  <header class="header">
    <div class="header-title"><a href="../index.html">ğŸ“ GDL å­¦ä¹ æŒ‡å—</a></div>
    <div class="header-nav">
      <a href="../chapter4/index.html">â† Ch.4 å‡ ä½•åŸŸ</a>
      <a href="../index.html">ç›®å½•</a>
      <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
    </div>
  </header>

  <button class="sidebar-toggle" onclick="toggleSidebar()">â˜°</button>

  <nav class="sidebar" id="sidebar">
    <h3>Chapter 5</h3>
    <a href="#overview">æ¦‚è¿°</a>
    <a href="#sec5-1">5.1 å·ç§¯ç¥ç»ç½‘ç»œ CNN</a>
    <a href="#cnn-group-theory" class="sub">ç¾¤è®ºè§£é‡Š</a>
    <a href="#cnn-convolution-theorem" class="sub">å·ç§¯å®šç†</a>
    <a href="#cnn-pooling" class="sub">æ± åŒ–ä¸ä¸å˜æ€§</a>
    <a href="#cnn-resnet" class="sub">æ®‹å·®ç½‘ç»œ</a>
    <a href="#cnn-code" class="sub">ä»£ç å®ç°</a>
    <a href="#sec5-2">5.2 ç¾¤ç­‰å˜ CNN</a>
    <a href="#gcnn-definition" class="sub">G-CNN å®šä¹‰</a>
    <a href="#gcnn-group-conv" class="sub">ç¾¤å·ç§¯</a>
    <a href="#gcnn-code" class="sub">ä»£ç å®ç°</a>
    <a href="#sec5-3">5.3 å›¾ç¥ç»ç½‘ç»œ GNN <span class="star">â­â­â­</span></a>
    <a href="#gnn-overview" class="sub">æ€»è§ˆ</a>
    <a href="#gnn-mpnn" class="sub">æ¶ˆæ¯ä¼ é€’æ¡†æ¶</a>
    <a href="#gnn-three-flavors" class="sub">ä¸‰ç§é£æ ¼</a>
    <a href="#gnn-gcn" class="sub">GCN å®Œæ•´æ¨å¯¼</a>
    <a href="#gnn-gat" class="sub">GAT æ³¨æ„åŠ›æœºåˆ¶</a>
    <a href="#gnn-graphsage" class="sub">GraphSAGE</a>
    <a href="#gnn-gin" class="sub">GIN è¡¨è¾¾åŠ›</a>
    <a href="#gnn-comparison" class="sub">GNN å¯¹æ¯”è¡¨</a>
    <a href="#gnn-code" class="sub">å®Œæ•´ä»£ç </a>
    <a href="#gnn-physrobot" class="sub">ğŸ¤– PhysRobot å…³è”</a>
    <a href="#sec5-4">5.4 DeepSets / Transformer</a>
    <a href="#deepsets" class="sub">Deep Sets</a>
    <a href="#transformer" class="sub">Transformer</a>
    <a href="#latent-graph" class="sub">éšå¼å›¾æ¨æ–­</a>
    <a href="#sec5-5">5.5 ç­‰å˜æ¶ˆæ¯ä¼ é€’ <span class="star">â­â­</span></a>
    <a href="#egnn" class="sub">E(n)-ç­‰å˜ GNN</a>
    <a href="#tfn" class="sub">Tensor Field Network</a>
    <a href="#empnn-physrobot" class="sub">ğŸ¤– EdgeFrame å…³è”</a>
    <a href="#empnn-code" class="sub">ä»£ç å®ç°</a>
    <a href="#sec5-6">5.6 å†…è•´ç½‘æ ¼ CNN</a>
    <a href="#geodesic-cnn" class="sub">æµ‹åœ°çº¿ CNN</a>
    <a href="#monet" class="sub">MoNet</a>
    <a href="#gauge-cnn" class="sub">è§„èŒƒç­‰å˜ CNN</a>
    <a href="#sec5-7">5.7 å¾ªç¯ç¥ç»ç½‘ç»œ RNN</a>
    <a href="#rnn-equivariance" class="sub">æ—¶é—´ç­‰å˜æ€§</a>
    <a href="#rnn-vanishing" class="sub">æ¢¯åº¦æ¶ˆå¤±</a>
    <a href="#sec5-8">5.8 LSTM</a>
    <a href="#lstm-gates" class="sub">é—¨æ§æœºåˆ¶</a>
    <a href="#lstm-time-warp" class="sub">æ—¶é—´æ‰­æ›²ä¸å˜æ€§</a>
    <a href="#exercises">ç»ƒä¹ é¢˜</a>
    <h3>å¯¼èˆª</h3>
    <a href="../index.html">ğŸ“š æ€»ç›®å½•</a>
    <a href="../chapter4/index.html">â† Ch.4 å‡ ä½•åŸŸ</a>
  </nav>

  <main class="main">

    <!-- ====================== CHAPTER TITLE ====================== -->
    <h1>Chapter 5: Geometric Deep Learning Models<br>
      <span style="font-size:0.55em;color:var(--text-secondary)">å‡ ä½•æ·±åº¦å­¦ä¹ æ¨¡å‹ â€” ä» CNN åˆ° GNN å†åˆ°ç­‰å˜ç½‘ç»œ</span>
    </h1>

    <p>
      <span class="badge badge-red">â­ æœ€é‡è¦ç« èŠ‚</span>
      <span class="badge badge-orange">é¢„è®¡é˜…è¯»ï¼š6+ å°æ—¶</span>
      <span class="badge badge-green">ä»£ç å¯è¿è¡Œ</span>
    </p>

    <!-- ====================== OVERVIEW ====================== -->
    <div class="callout callout-info" id="overview">
      <h4>æœ¬ç« æ¦‚è¿°</h4>
      <p>æœ¬ç« æ˜¯å…¨ä¹¦çš„<strong>æ ¸å¿ƒé«˜æ½®</strong>ã€‚åœ¨å‰å››ç« å»ºç«‹äº†å‡ ä½•å…ˆéªŒï¼ˆå¯¹ç§°æ€§ã€ä¸å˜æ€§ã€ç­‰å˜æ€§ï¼‰å’Œå‡ ä½•åŸŸï¼ˆ5 Gsï¼‰ä¹‹åï¼Œæœ¬ç« å±•ç¤ºè¿™äº›ç†è®ºåŸåˆ™å¦‚ä½•<strong>å…·è±¡åŒ–ä¸ºå®é™…çš„æ·±åº¦å­¦ä¹ æ¶æ„</strong>ã€‚æ¯ä¸€ç§æµè¡Œçš„æ·±åº¦å­¦ä¹ æ¨¡å‹â€”â€”CNNã€GNNã€Transformerã€LSTMâ€”â€”éƒ½æ˜¯å‡ ä½•æ·±åº¦å­¦ä¹ è“å›¾åœ¨ç‰¹å®šåŸŸå’Œå¯¹ç§°ç¾¤ä¸Šçš„<strong>å®ä¾‹åŒ–</strong>ã€‚</p>
      <table>
        <thead><tr><th>æ¶æ„</th><th>åŸŸ Î©</th><th>å¯¹ç§°ç¾¤ G</th><th>ç­‰å˜æ“ä½œ</th><th>å¯¹åº”èŠ‚</th></tr></thead>
        <tbody>
          <tr><td>CNN</td><td>ç½‘æ ¼ $\mathbb{Z}^d$</td><td>å¹³ç§»ç¾¤ $(\mathbb{Z}^d, +)$</td><td>å·ç§¯</td><td>Â§5.1</td></tr>
          <tr><td>G-CNN</td><td>é½æ¬¡ç©ºé—´ $\Omega$</td><td>ä¸€èˆ¬ç¾¤ $G$</td><td>ç¾¤å·ç§¯</td><td>Â§5.2</td></tr>
          <tr><td>GNN</td><td>å›¾ $(V, E)$</td><td>ç½®æ¢ç¾¤ $\Sigma_n$</td><td>æ¶ˆæ¯ä¼ é€’</td><td>Â§5.3</td></tr>
          <tr><td>Transformer</td><td>é›†åˆ / å®Œå…¨å›¾</td><td>ç½®æ¢ç¾¤ $\Sigma_n$</td><td>è‡ªæ³¨æ„åŠ›</td><td>Â§5.4</td></tr>
          <tr><td>EMPNN</td><td>å‡ ä½•å›¾</td><td>$E(3) \times \Sigma_n$</td><td>ç­‰å˜æ¶ˆæ¯ä¼ é€’</td><td>Â§5.5</td></tr>
          <tr><td>Mesh CNN</td><td>æµå½¢/ç½‘æ ¼</td><td>ç­‰è·ç¾¤ + è§„èŒƒç¾¤</td><td>æµ‹åœ°çº¿å·ç§¯</td><td>Â§5.6</td></tr>
          <tr><td>RNN/LSTM</td><td>æ—¶é—´ç½‘æ ¼ $\mathbb{Z}$</td><td>æ—¶é—´å¹³ç§» + æ—¶é—´æ‰­æ›²</td><td>å¾ªç¯æ›´æ–°</td><td>Â§5.7-8</td></tr>
        </tbody>
      </table>
    </div>

    <div class="callout callout-project">
      <h4>ä¸ PhysRobot é¡¹ç›®çš„å…³è”</h4>
      <p>æœ¬ç« æ˜¯æˆ‘ä»¬ <strong>PhysRobot åŒ»ç–—æœºå™¨äººä»¿çœŸ</strong>é¡¹ç›®çš„ç†è®ºåŸºçŸ³ã€‚æˆ‘ä»¬çš„æ ¸å¿ƒæ¨¡å—ç›´æ¥å¯¹åº”æœ¬ç« å†…å®¹ï¼š</p>
      <ul>
        <li><code>DynamicalGNN</code> = Â§5.3 æ¶ˆæ¯ä¼ é€’ GNN çš„ç‰©ç†ç‰¹åŒ–ç‰ˆ</li>
        <li><code>EdgeFrame</code> = Â§5.5 ç­‰å˜æ¶ˆæ¯ä¼ é€’ç½‘ç»œ (EMPNN) çš„ E(3) ç­‰å˜å®ç°</li>
        <li>ç²’å­ç³»ç»Ÿä»¿çœŸ = GNN åœ¨åŠ¨åŠ›å­¦ç³»ç»Ÿä¸Šçš„åº”ç”¨</li>
      </ul>
    </div>

    <!-- ====================== 5.1 CNN ====================== -->

<!-- === GLOSSARY START === -->
<!-- ç¬¬5ç« ï¼šGNN æ ¸å¿ƒæœ¯è¯­è¯å…¸ -->

<div class="enrichment-block" style="border-left-color: #ec4899;">
  <h4>ğŸ“– ç¬¬5ç« æ ¸å¿ƒæ¦‚å¿µè¯¦è§£</h4>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">æ¶ˆæ¯ä¼ é€’ (Message Passing) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šèŠ‚ç‚¹é€šè¿‡è¾¹å‘é‚»å±…"å‘é€æ¶ˆæ¯"ï¼Œé‚»å±…æ”¶é›†è¿™äº›æ¶ˆæ¯åæ›´æ–°è‡ªå·±çš„ç‰¹å¾â€”â€”è¿™æ˜¯ GNN æœ€åŸºç¡€çš„è®¡ç®—èŒƒå¼ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>æ¶ˆæ¯ä¼ é€’åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p>
    <ol>
      <li><strong>æ¶ˆæ¯è®¡ç®—</strong>ï¼šèŠ‚ç‚¹ \( v \) æ ¹æ®è‡ªå·±çš„ç‰¹å¾ \( x_v \) å’Œé‚»å±… \( u \) çš„ç‰¹å¾ \( x_u \) è®¡ç®—è¦å‘é€çš„æ¶ˆæ¯ï¼š
        <p style="text-align: center;">$$ m_{uv} = \psi(x_u, x_v) $$</p>
      </li>
      <li><strong>æ¶ˆæ¯èšåˆ</strong>ï¼šèŠ‚ç‚¹ \( u \) æ”¶é›†æ‰€æœ‰é‚»å±…å‘æ¥çš„æ¶ˆæ¯ï¼š
        <p style="text-align: center;">$$ \tilde{m}_u = \bigoplus_{v \in \mathcal{N}_u} m_{uv} $$</p>
      </li>
      <li><strong>ç‰¹å¾æ›´æ–°</strong>ï¼šèŠ‚ç‚¹ \( u \) æ ¹æ®èšåˆåçš„æ¶ˆæ¯æ›´æ–°è‡ªå·±çš„ç‰¹å¾ï¼š
        <p style="text-align: center;">$$ h_u = \phi(x_u, \tilde{m}_u) $$</p>
      </li>
    </ol>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>æ¶ˆæ¯ä¼ é€’æ˜¯ GNN å®ç°<strong>ç½®æ¢ç­‰å˜æ€§</strong>çš„æ ¸å¿ƒæœºåˆ¶ã€‚ç”±äºæ¶ˆæ¯åœ¨é‚»å±…é—´ä¼ é€’ï¼Œæ— è®ºèŠ‚ç‚¹çš„ç¼–å·å¦‚ä½•æ’åˆ—ï¼Œæœ€ç»ˆçš„èšåˆç»“æœéƒ½æ˜¯ç›¸åŒçš„ï¼ˆå› ä¸ºèšåˆå‡½æ•°æ˜¯ç½®æ¢ä¸å˜çš„ï¼‰ã€‚è¿™ä½¿å¾— GNN èƒ½å¤Ÿ"çœ‹åˆ°"å›¾çš„æ‹“æ‰‘ç»“æ„ï¼Œè€Œä¸ä¾èµ–äºèŠ‚ç‚¹çš„å…·ä½“æ ‡å·ã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šæƒ³è±¡ä¸€ä¸ªæ‘åº„ï¼Œæ¯ä¸ªäººï¼ˆèŠ‚ç‚¹ï¼‰æŠŠè‡ªå·±çš„æ¶ˆæ¯å‘Šè¯‰é‚»å±…ï¼Œé‚»å±…ä»¬æ±‡æ€»æ‰€æœ‰å¬åˆ°çš„æ¶ˆæ¯åï¼Œæ›´æ–°è‡ªå·±çš„æƒ³æ³•â€”â€”è¿™å°±æ˜¯æ¶ˆæ¯ä¼ é€’çš„æœ¬è´¨ã€‚</p>
  </div>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">èšåˆ (Aggregation) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šèšåˆå‡½æ•°æŠŠå¤šä¸ªé‚»å±…çš„æ¶ˆæ¯"åˆå¹¶"æˆä¸€ä¸ªå‘é‡ï¼Œæ˜¯ GNN ä¸­å®ç°ç½®æ¢ä¸å˜æ€§çš„å…³é”®æ“ä½œã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>èšåˆå‡½æ•° \( \bigoplus \) å¿…é¡»æ»¡è¶³<strong>ç½®æ¢ä¸å˜æ€§</strong>ï¼šæ— è®ºé‚»å±…çš„é¡ºåºå¦‚ä½•æ’åˆ—ï¼Œèšåˆç»“æœéƒ½ç›¸åŒã€‚å¸¸ç”¨çš„èšåˆå‡½æ•°æœ‰ä¸‰ç§ï¼š</p>
    
    <div style="background: #f9fafb; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
      <p><strong>1. SUMï¼ˆæ±‚å’Œï¼‰</strong></p>
      <p style="text-align: center;">$$ \tilde{m}_u = \sum_{v \in \mathcal{N}_u} m_{uv} $$</p>
      <ul>
        <li><strong>ä¼˜ç‚¹</strong>ï¼šä¿ç•™äº†é‚»å±…æ•°é‡ä¿¡æ¯ï¼ˆåº¦æ•æ„Ÿï¼‰</li>
        <li><strong>ç¼ºç‚¹</strong>ï¼šé«˜åº¦èŠ‚ç‚¹çš„ç‰¹å¾å€¼ä¼šå¾ˆå¤§ï¼Œå¯èƒ½å¯¼è‡´æ•°å€¼ä¸ç¨³å®š</li>
        <li><strong>é€‚ç”¨</strong>ï¼šéœ€è¦åŒºåˆ†èŠ‚ç‚¹åº¦çš„åœºæ™¯ï¼ˆå¦‚ç¤¾äº¤ç½‘ç»œä¸­çš„"ç½‘çº¢"èŠ‚ç‚¹ï¼‰</li>
      </ul>
      
      <p style="margin-top: 1rem;"><strong>2. MEANï¼ˆå¹³å‡ï¼‰</strong></p>
      <p style="text-align: center;">$$ \tilde{m}_u = \frac{1}{|\mathcal{N}_u|} \sum_{v \in \mathcal{N}_u} m_{uv} $$</p>
      <ul>
        <li><strong>ä¼˜ç‚¹</strong>ï¼šæ•°å€¼ç¨³å®šï¼Œä¸å—èŠ‚ç‚¹åº¦å½±å“</li>
        <li><strong>ç¼ºç‚¹</strong>ï¼šä¸¢å¤±äº†é‚»å±…æ•°é‡ä¿¡æ¯ï¼ˆåº¦ä¸æ•æ„Ÿï¼‰</li>
        <li><strong>é€‚ç”¨</strong>ï¼šèŠ‚ç‚¹åº¦å·®å¼‚ä¸é‡è¦çš„åœºæ™¯ï¼ˆå¦‚åˆ†å­å›¾ä¸­çš„åŸå­ï¼‰</li>
      </ul>
      
      <p style="margin-top: 1rem;"><strong>3. MAXï¼ˆæœ€å¤§å€¼ï¼‰</strong></p>
      <p style="text-align: center;">$$ \tilde{m}_u = \max_{v \in \mathcal{N}_u} m_{uv} \quad \text{(element-wise)} $$</p>
      <ul>
        <li><strong>ä¼˜ç‚¹</strong>ï¼šå…³æ³¨"æœ€æ˜¾è‘—"çš„é‚»å±…ç‰¹å¾ï¼Œé€‚åˆè¯†åˆ«å±€éƒ¨æ¨¡å¼</li>
        <li><strong>ç¼ºç‚¹</strong>ï¼šä¸¢å¤±å¤§éƒ¨åˆ†é‚»å±…ä¿¡æ¯ï¼ˆåªä¿ç•™æå€¼ï¼‰</li>
        <li><strong>é€‚ç”¨</strong>ï¼šéœ€è¦æ£€æµ‹"å…³é”®ç‰¹å¾"çš„åœºæ™¯ï¼ˆå¦‚ç‚¹äº‘ä¸­çš„å½¢çŠ¶å°–ç«¯ï¼‰</li>
      </ul>
    </div>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>èšåˆå‡½æ•°æ˜¯ GNN çš„"å¯¹ç§°æ€§å®ˆé—¨å‘˜"â€”â€”å®ƒç¡®ä¿äº†æ— è®ºé‚»å±…å¦‚ä½•æ’åˆ—ï¼ŒGNN çš„è¾“å‡ºéƒ½ä¿æŒç½®æ¢ç­‰å˜æ€§ã€‚é€‰æ‹©åˆé€‚çš„èšåˆå‡½æ•°ç›¸å½“äºé€‰æ‹©<strong>ä»€ä¹ˆæ ·çš„ç»Ÿè®¡é‡</strong>æ¥æ€»ç»“é‚»å±…ä¿¡æ¯ï¼šSUM å…³æ³¨"æ€»é‡"ï¼ŒMEAN å…³æ³¨"å¹³å‡æ°´å¹³"ï¼ŒMAX å…³æ³¨"æç«¯æƒ…å†µ"ã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šç­çº§ç»Ÿè®¡æˆç»©æ—¶ï¼Œæ±‚å’Œå¾—åˆ°"æ€»åˆ†"ï¼Œå¹³å‡å¾—åˆ°"ç­çº§æ°´å¹³"ï¼Œæœ€å¤§å€¼å¾—åˆ°"æœ€é«˜åˆ†"â€”â€”ä¸åŒçš„èšåˆæ–¹å¼æå–ä¸åŒçš„ä¿¡æ¯ã€‚</p>
  </div>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">å¤šå¤´æ³¨æ„åŠ› (Multi-head Attention) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šåŒæ—¶ä½¿ç”¨å¤šä¸ªç‹¬ç«‹çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œè®©æ¨¡å‹ä»ä¸åŒ"è§†è§’"å…³æ³¨é‚»å±…ç‰¹å¾ï¼Œå°±åƒåŒæ—¶ç”¨å¤šä¸ªç›¸æœºæ‹æ‘„åŒä¸€åœºæ™¯ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>åœ¨ Graph Attention Networkï¼ˆGATï¼‰ä¸­ï¼Œæ³¨æ„åŠ›æœºåˆ¶è®¡ç®—èŠ‚ç‚¹ \( u \) å¯¹é‚»å±… \( v \) çš„é‡è¦æ€§ï¼š</p>
    <p style="text-align: center;">$$ \alpha_{uv} = \frac{\exp(a(x_u, x_v))}{\sum_{w \in \mathcal{N}_u} \exp(a(x_u, x_w))} $$</p>
    <p>ç„¶ååŠ æƒèšåˆï¼š</p>
    <p style="text-align: center;">$$ h_u = \sigma\left( \sum_{v \in \mathcal{N}_u} \alpha_{uv} W x_v \right) $$</p>
    
    <p><strong>å¤šå¤´æ³¨æ„åŠ›</strong>çš„åšæ³•æ˜¯å¹¶è¡Œè¿è¡Œ \( K \) ä¸ªç‹¬ç«‹çš„æ³¨æ„åŠ›å¤´ï¼š</p>
    <p style="text-align: center;">$$ h_u = \bigoplus_{k=1}^K \sigma\left( \sum_{v \in \mathcal{N}_u} \alpha_{uv}^k W^k x_v \right) $$</p>
    <p>å…¶ä¸­ \( \bigoplus \) é€šå¸¸æ˜¯æ‹¼æ¥ï¼ˆconcatenationï¼‰æˆ–å¹³å‡ã€‚</p>
    
    <p><strong>ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ</strong></p>
    <ul>
      <li><strong>å¤šæ ·æ€§</strong>ï¼šæ¯ä¸ªå¤´å­¦ä¹ ä¸åŒçš„"å…³æ³¨æ¨¡å¼"ï¼ˆå¦‚ç»“æ„ç‰¹å¾ vs. è¯­ä¹‰ç‰¹å¾ï¼‰</li>
      <li><strong>ç¨³å®šæ€§</strong>ï¼šç±»ä¼¼é›†æˆå­¦ä¹ ï¼Œé™ä½å•ä¸€æ³¨æ„åŠ›æœºåˆ¶çš„åå·®</li>
      <li><strong>è¡¨è¾¾åŠ›</strong>ï¼šå¢åŠ æ¨¡å‹å®¹é‡ï¼Œèƒ½æ•æ‰æ›´å¤æ‚çš„èŠ‚ç‚¹é—´å…³ç³»</li>
    </ul>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>å¤šå¤´æ³¨æ„åŠ›æ˜¯<strong>éšå¼æ¨æ–­å›¾ç»“æ„</strong>çš„å¼ºå¤§å·¥å…·ã€‚åœ¨ Transformer ä¸­ï¼Œå®Œå…¨å›¾ä¸Šçš„å¤šå¤´æ³¨æ„åŠ›å…è®¸æ¨¡å‹å­¦ä¹ å“ªäº›èŠ‚ç‚¹åº”è¯¥ç›¸äº’å…³æ³¨ï¼ˆå³"è½¯é‚»æ¥çŸ©é˜µ"ï¼‰ã€‚åœ¨ GAT ä¸­ï¼Œå®ƒç»†åŒ–äº†å›¾çš„è¾¹æƒé‡ï¼Œä½¿æ¨¡å‹èƒ½åŠ¨æ€è°ƒæ•´ä¿¡æ¯ä¼ é€’çš„å¼ºåº¦ã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šé¢è¯•æ—¶ï¼Œä¸åŒé¢è¯•å®˜ä»ä¸åŒè§’åº¦è¯„ä¼°å€™é€‰äººï¼ˆæŠ€æœ¯èƒ½åŠ›ã€æ²Ÿé€šèƒ½åŠ›ã€æ–‡åŒ–å¥‘åˆåº¦ï¼‰ï¼Œæœ€åç»¼åˆæ‰€æœ‰è¯„ä»·â€”â€”è¿™å°±æ˜¯å¤šå¤´æ³¨æ„åŠ›çš„æ€æƒ³ã€‚</p>
  </div>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">è¿‡å¹³æ»‘ (Over-smoothing) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šGNN å±‚æ•°è¿‡å¤šæ—¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„ç‰¹å¾ä¼šå˜å¾—è¶Šæ¥è¶Šç›¸ä¼¼ï¼ˆè¶‹äºå¹³æ»‘ï¼‰ï¼Œå¯¼è‡´æ¨¡å‹å¤±å»åŒºåˆ†ä¸åŒèŠ‚ç‚¹çš„èƒ½åŠ›ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>æ¯ç»è¿‡ä¸€å±‚ GNNï¼ŒèŠ‚ç‚¹çš„ç‰¹å¾ä¼šä¸é‚»å±…çš„ç‰¹å¾"æ··åˆ"ï¼š</p>
    <p style="text-align: center;">$$ h_u^{(l+1)} = \sigma\left( W^{(l)} \left[ h_u^{(l)} \| \text{AGG}(\{h_v^{(l)} : v \in \mathcal{N}_u\}) \right] \right) $$</p>
    <p>ç»è¿‡ \( L \) å±‚åï¼ŒèŠ‚ç‚¹ \( u \) çš„ç‰¹å¾èšåˆäº† \( L \)-hop é‚»åŸŸå†…æ‰€æœ‰èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚åœ¨è¿é€šå›¾ä¸­ï¼Œéšç€ \( L \to \infty \)ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„æ„Ÿå—é‡ä¼šæ‰©å±•åˆ°æ•´ä¸ªå›¾ï¼Œå¯¼è‡´ï¼š</p>
    <p style="text-align: center;">$$ h_u^{(\infty)} \approx h_v^{(\infty)} \quad \forall u, v $$</p>
    <p>å³æ‰€æœ‰èŠ‚ç‚¹çš„ç‰¹å¾æ”¶æ•›åˆ°åŒä¸€ä¸ªå‘é‡ï¼ˆå›¾çš„"å…¨å±€å¹³å‡"ï¼‰ï¼</p>
    
    <p><strong>ç†è®ºè§£é‡Š</strong>ï¼š</p>
    <p>GNN çš„æ¶ˆæ¯ä¼ é€’å¯ä»¥çœ‹ä½œå›¾æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µçš„ä½é€šæ»¤æ³¢å™¨ï¼Œå®ƒä¼šä¸æ–­"å¹³æ»‘"èŠ‚ç‚¹ç‰¹å¾ï¼ŒæŠ‘åˆ¶é«˜é¢‘ä¿¡å·ï¼ˆèŠ‚ç‚¹é—´çš„å·®å¼‚ï¼‰ã€‚</p>
    
    <p><strong>å±å®³</strong>ï¼š</p>
    <ul>
      <li>èŠ‚ç‚¹åˆ†ç±»ä»»åŠ¡ï¼šæ— æ³•åŒºåˆ†ä¸åŒç±»åˆ«çš„èŠ‚ç‚¹</li>
      <li>é“¾æ¥é¢„æµ‹ä»»åŠ¡ï¼šæ‰€æœ‰èŠ‚ç‚¹å¯¹çš„ç›¸ä¼¼åº¦éƒ½è¶‹äºç›¸åŒ</li>
      <li>å›¾åˆ†ç±»ä»»åŠ¡ï¼šä¸åŒå›¾çš„è¡¨ç¤ºè¶‹äºç›¸åŒ</li>
    </ul>
    
    <p><strong>ç¼“è§£æ–¹æ³•</strong>ï¼š</p>
    <ul>
      <li><strong>æµ…å±‚ç½‘ç»œ</strong>ï¼šé™åˆ¶ GNN å±‚æ•°ï¼ˆé€šå¸¸ 2-4 å±‚ï¼‰</li>
      <li><strong>æ®‹å·®è¿æ¥</strong>ï¼š\( h_u^{(l+1)} = h_u^{(l+1)} + h_u^{(l)} \)</li>
      <li><strong>è·³è·ƒè¿æ¥</strong>ï¼šæ‹¼æ¥æ‰€æœ‰å±‚çš„ç‰¹å¾ \( h_u = [h_u^{(1)} \| h_u^{(2)} \| \ldots \| h_u^{(L)}] \)</li>
      <li><strong>Dropout</strong>ï¼šåœ¨æ¶ˆæ¯ä¼ é€’ä¸­éšæœºä¸¢å¼ƒéƒ¨åˆ†é‚»å±…</li>
    </ul>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>è¿‡å¹³æ»‘æ˜¯ GNN çš„<strong>æ·±åº¦å›°å¢ƒ</strong>â€”â€”è™½ç„¶æ›´æ·±çš„ç½‘ç»œç†è®ºä¸Šèƒ½èšåˆæ›´è¿œçš„ä¿¡æ¯ï¼Œä½†å®é™…ä¸Šä¼šå¯¼è‡´ä¿¡æ¯è¿‡åº¦æ··åˆã€‚è¿™åæ˜ äº†å›¾ç»“æ„å­¦ä¹ çš„æœ¬è´¨æŒ‘æˆ˜ï¼šå¦‚ä½•å¹³è¡¡<strong>å±€éƒ¨æ€§</strong>ï¼ˆä¿ç•™èŠ‚ç‚¹ä¸ªæ€§ï¼‰å’Œ<strong>å…¨å±€æ€§</strong>ï¼ˆæ•è·é•¿ç¨‹ä¾èµ–ï¼‰ã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šåœ¨ç”µè¯ä¼ è¯æ¸¸æˆä¸­ï¼Œä¼ é€’çš„äººè¶Šå¤šï¼ˆå±‚æ•°è¶Šæ·±ï¼‰ï¼Œæœ€ç»ˆçš„æ¶ˆæ¯è¶Šæ¨¡ç³Šï¼Œæ¯ä¸ªäººçš„ç†è§£è¶‹äºç›¸åŒâ€”â€”è¿™å°±æ˜¯è¿‡å¹³æ»‘ã€‚</p>
  </div>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">è¿‡å‹ç¼© (Over-squashing) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šGNN è¯•å›¾æŠŠå¤§é‡è¿œè·ç¦»é‚»å±…çš„ä¿¡æ¯"å‹ç¼©"åˆ°å›ºå®šç»´åº¦çš„èŠ‚ç‚¹è¡¨ç¤ºä¸­,å¯¼è‡´ä¿¡æ¯ç“¶é¢ˆï¼Œé•¿ç¨‹ä¾èµ–éš¾ä»¥å»ºæ¨¡ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>è€ƒè™‘ä¸€ä¸ªèŠ‚ç‚¹ \( u \)ï¼Œå®ƒçš„ \( k \)-hop é‚»åŸŸåŒ…å« \( N_k \) ä¸ªèŠ‚ç‚¹ã€‚å½“ \( k \) å¢å¤§æ—¶ï¼Œ\( N_k \) å¯èƒ½å‘ˆæŒ‡æ•°å¢é•¿ï¼ˆå¦‚åœ¨åº¦ä¸º \( d \) çš„æ ‘ä¸Šï¼Œ\( N_k \sim d^k \)ï¼‰ã€‚ä½† GNN çš„èŠ‚ç‚¹è¡¨ç¤ºç»´åº¦ \( h_u \in \mathbb{R}^m \) æ˜¯å›ºå®šçš„ï¼</p>
    
    <p><strong>ä¿¡æ¯ç“¶é¢ˆ</strong>ï¼š</p>
    <p>è¦æŠŠ \( N_k \) ä¸ªé‚»å±…çš„ä¿¡æ¯ï¼ˆæ€»å…± \( N_k \cdot m \) ç»´ï¼‰å‹ç¼©åˆ° \( m \) ç»´ï¼Œå¿…ç„¶ä¼šä¸¢å¤±å¤§é‡ä¿¡æ¯ã€‚è¿™ç§"ä¿¡æ¯å‹ç¼©"å¯¼è‡´ï¼š</p>
    <ul>
      <li>è¿œè·ç¦»èŠ‚ç‚¹çš„å½±å“è¢«"ç¨€é‡Š"</li>
      <li>é•¿ç¨‹ä¾èµ–éš¾ä»¥ä¼ é€’</li>
      <li>å›¾çš„å…¨å±€ç»“æ„éš¾ä»¥æ•æ‰</li>
    </ul>
    
    <p><strong>ä¸è¿‡å¹³æ»‘çš„åŒºåˆ«</strong>ï¼š</p>
    <table style="width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 0.95em;">
      <thead>
        <tr style="background: rgba(236,72,153,0.1);">
          <th style="padding: 0.5rem; border: 1px solid #f9a8d4;"></th>
          <th style="padding: 0.5rem; border: 1px solid #f9a8d4;">è¿‡å¹³æ»‘</th>
          <th style="padding: 0.5rem; border: 1px solid #f9a8d4;">è¿‡å‹ç¼©</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="padding: 0.5rem; border: 1px solid #fce7f3;"><strong>é—®é¢˜æœ¬è´¨</strong></td>
          <td style="padding: 0.5rem; border: 1px solid #fce7f3;">ä¿¡æ¯è¿‡åº¦æ··åˆ</td>
          <td style="padding: 0.5rem; border: 1px solid #fce7f3;">ä¿¡æ¯ä¼ é€’ç“¶é¢ˆ</td>
        </tr>
        <tr>
          <td style="padding: 0.5rem; border: 1px solid #fce7f3;"><strong>è¡¨ç°</strong></td>
          <td style="padding: 0.5rem; border: 1px solid #fce7f3;">èŠ‚ç‚¹è¡¨ç¤ºè¶‹äºç›¸åŒ</td>
          <td style="padding: 0.5rem; border: 1px solid #fce7f3;">è¿œç¨‹ä¿¡æ¯ä¸¢å¤±</td>
        </tr>
        <tr>
          <td style="padding: 0.5rem; border: 1px solid #fce7f3;"><strong>å½±å“</strong></td>
          <td style="padding: 0.5rem; border: 1px solid #fce7f3;">æµ…å±‚ä¹Ÿä¼šå‡ºç°</td>
          <td style="padding: 0.5rem; border: 1px solid #fce7f3;">æ·±å±‚æ›´ä¸¥é‡</td>
        </tr>
      </tbody>
    </table>
    
    <p><strong>ç¼“è§£æ–¹æ³•</strong>ï¼š</p>
    <ul>
      <li><strong>å¢åŠ ç‰¹å¾ç»´åº¦</strong>ï¼šæé«˜ \( m \)ï¼Œä½†è®¡ç®—æˆæœ¬å¢åŠ </li>
      <li><strong>æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šé€‰æ‹©æ€§åœ°å…³æ³¨é‡è¦é‚»å±…ï¼Œå‡å°‘å†—ä½™ä¿¡æ¯</li>
      <li><strong>å›¾é‡è¿</strong>ï¼šæ·»åŠ é•¿ç¨‹è¾¹ï¼ˆå¦‚è™šæ‹ŸèŠ‚ç‚¹ï¼‰ï¼Œç¼©çŸ­ä¿¡æ¯ä¼ é€’è·¯å¾„</li>
      <li><strong>Transformer æ¶æ„</strong>ï¼šç”¨å…¨è¿æ¥ï¼ˆå®Œå…¨å›¾ï¼‰æ›¿ä»£ç¨€ç–å›¾ï¼Œç›´æ¥å»ºæ¨¡é•¿ç¨‹ä¾èµ–</li>
    </ul>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>è¿‡å‹ç¼©æ­ç¤ºäº† GNN çš„<strong>è¡¨è¾¾åŠ›ç“¶é¢ˆ</strong>â€”â€”å›ºå®šç»´åº¦çš„å‘é‡è¡¨ç¤ºæ— æ³•å……åˆ†ç¼–ç å¤§è§„æ¨¡å›¾çš„ä¿¡æ¯ã€‚è¿™æ¿€å‘äº†å¯¹<strong>è‡ªé€‚åº”æ¶æ„</strong>ï¼ˆå¦‚å±‚æ¬¡åŒ– GNNã€å›¾ Transformerï¼‰çš„ç ”ç©¶ï¼Œè¯•å›¾çªç ´è¿™ä¸€é™åˆ¶ã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šç”¨ä¸€é¡µ PPT æ€»ç»“ä¸€æœ¬ä¹¦â€”â€”ä¹¦è¶Šåšï¼ˆé‚»åŸŸè¶Šå¤§ï¼‰ï¼Œä¿¡æ¯ä¸¢å¤±è¶Šä¸¥é‡ï¼›åªæœ‰åŠ å¤§ PPT é¡µæ•°ï¼ˆå¢åŠ ç»´åº¦ï¼‰æˆ–æ”¹ç”¨è§†é¢‘ï¼ˆæ¢æ¶æ„ï¼‰æ‰èƒ½è§£å†³ã€‚</p>
  </div>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">è¡¨è¾¾åŠ› (Expressiveness) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šè¡¨è¾¾åŠ›è¡¡é‡ GNN èƒ½åŒºåˆ†å¤šå°‘ç§ä¸åŒçš„å›¾ç»“æ„â€”â€”è¡¨è¾¾åŠ›è¶Šå¼ºï¼Œæ¨¡å‹èƒ½"çœ‹å‡º"çš„å›¾ç»“æ„å·®å¼‚è¶Šç»†å¾®ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>å½¢å¼åŒ–å®šä¹‰ï¼šå¦‚æœå­˜åœ¨ä¸¤ä¸ªéåŒæ„çš„å›¾ \( G_1, G_2 \)ï¼Œä½† GNN å¯¹å®ƒä»¬äº§ç”Ÿç›¸åŒçš„è¡¨ç¤ºï¼š</p>
    <p style="text-align: center;">$$ f_{\text{GNN}}(G_1) = f_{\text{GNN}}(G_2) $$</p>
    <p>åˆ™ç§° GNN æ— æ³•åŒºåˆ† \( G_1 \) å’Œ \( G_2 \)ã€‚<strong>è¡¨è¾¾åŠ›</strong>æŒ‡çš„æ˜¯ GNN èƒ½åŒºåˆ†çš„å›¾çš„"ç­‰ä»·ç±»"æ•°é‡ã€‚</p>
    
    <p><strong>ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</strong></p>
    <ul>
      <li><strong>å›¾åˆ†ç±»</strong>ï¼šä¸åŒç±»åˆ«çš„å›¾å¿…é¡»èƒ½è¢«åŒºåˆ†</li>
      <li><strong>å›¾ç”Ÿæˆ</strong>ï¼šéœ€è¦ç”Ÿæˆå¤šæ ·åŒ–çš„å›¾ç»“æ„</li>
      <li><strong>åˆ†å­æ€§è´¨é¢„æµ‹</strong>ï¼šåŒåˆ†å¼‚æ„ä½“ï¼ˆæ‹“æ‰‘ç»“æ„ä¸åŒä½†åˆ†å­å¼ç›¸åŒï¼‰éœ€è¦è¢«åŒºåˆ†</li>
    </ul>
    
    <p><strong>å½±å“è¡¨è¾¾åŠ›çš„å› ç´ </strong>ï¼š</p>
    <ol>
      <li><strong>èšåˆå‡½æ•°</strong>ï¼š
        <ul>
          <li>SUM/MEANï¼šè¡¨è¾¾åŠ›è¾ƒå¼ºï¼ˆåœ¨æŸäº›æ¡ä»¶ä¸‹èƒ½è¾¾åˆ° WL æµ‹è¯•çš„è¡¨è¾¾åŠ›ï¼‰</li>
          <li>MAXï¼šè¡¨è¾¾åŠ›è¾ƒå¼±ï¼ˆæ— æ³•åŒºåˆ†å¤šé‡é›†çš„å·®å¼‚ï¼‰</li>
        </ul>
      </li>
      <li><strong>æ¶ˆæ¯å‡½æ•°</strong>ï¼š
        <ul>
          <li>ç®€å•çº¿æ€§å˜æ¢ï¼šè¡¨è¾¾åŠ›æœ‰é™</li>
          <li>MLPï¼ˆå¤šå±‚æ„ŸçŸ¥æœºï¼‰ï¼šè¡¨è¾¾åŠ›æ›´å¼º</li>
        </ul>
      </li>
      <li><strong>ç½‘ç»œæ·±åº¦</strong>ï¼š
        <ul>
          <li>æ›´æ·±çš„ç½‘ç»œèƒ½æ•æ‰æ›´è¿œçš„æ‹“æ‰‘ä¿¡æ¯</li>
          <li>ä½†å—è¿‡å¹³æ»‘å’Œè¿‡å‹ç¼©é™åˆ¶</li>
        </ul>
      </li>
    </ol>
    
    <p><strong>ç†è®ºåŸºå‡†ï¼šWL æµ‹è¯•</strong>ï¼ˆè§ä¸‹ä¸€æ¡ï¼‰</p>
    <p>æ ‡å‡† GNNï¼ˆå¦‚ GCNã€GraphSAGEï¼‰çš„è¡¨è¾¾åŠ›<strong>æœ€å¤šç­‰åŒäº 1-WL æµ‹è¯•</strong>ã€‚æ›´é«˜è¡¨è¾¾åŠ›çš„æ¶æ„åŒ…æ‹¬ï¼š</p>
    <ul>
      <li><strong>GIN (Graph Isomorphism Network)</strong>ï¼šç†è®ºä¸Šè¾¾åˆ° 1-WL çš„ä¸Šç•Œ</li>
      <li><strong>é«˜é˜¶ GNN</strong>ï¼šåŸºäº \( k \)-WL æµ‹è¯•ï¼ˆ\( k > 1 \)ï¼‰</li>
      <li><strong>å­å›¾ GNN</strong>ï¼šé€šè¿‡æšä¸¾å­å›¾æ¨¡å¼å¢å¼ºè¡¨è¾¾åŠ›</li>
    </ul>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>è¡¨è¾¾åŠ›æ˜¯ GNN çš„<strong>ç†è®ºä¸Šç•Œ</strong>â€”â€”å®ƒå‘Šè¯‰æˆ‘ä»¬æ¨¡å‹"èƒ½åšä»€ä¹ˆ"å’Œ"ä¸èƒ½åšä»€ä¹ˆ"ã€‚Geometric Deep Learning å¼ºè°ƒé€šè¿‡<strong>å¯¹ç§°æ€§çº¦æŸ</strong>ï¼ˆå¦‚ç½®æ¢ç­‰å˜æ€§ï¼‰æ¥è®¾è®¡æ¶æ„ï¼Œè€Œè¡¨è¾¾åŠ›åˆ†æç¡®ä¿è¿™äº›çº¦æŸä¸ä¼šè¿‡åº¦é™åˆ¶æ¨¡å‹èƒ½åŠ›ã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šäººè„¸è¯†åˆ«ç³»ç»Ÿçš„"è¡¨è¾¾åŠ›"æ˜¯èƒ½åŒºåˆ†å¤šå°‘å¼ ä¸åŒçš„è„¸â€”â€”ç³»ç»Ÿè¶Šå¼ºï¼ŒåŒèƒèƒä¹Ÿèƒ½åˆ†è¾¨ï¼›ç³»ç»Ÿè¶Šå¼±ï¼Œåªèƒ½åˆ†è¾¨æ€§åˆ«å’Œå¹´é¾„æ®µã€‚</p>
  </div>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">WL æµ‹è¯• (Weisfeiler-Leman Test) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šWL æµ‹è¯•æ˜¯ä¸€ä¸ªç»å…¸çš„å›¾åŒæ„æµ‹è¯•ç®—æ³•ï¼Œå®ƒé€šè¿‡è¿­ä»£åœ°ç»™èŠ‚ç‚¹"æŸ“è‰²"æ¥åˆ¤æ–­ä¸¤ä¸ªå›¾æ˜¯å¦åŒæ„â€”â€”GNN çš„è¡¨è¾¾åŠ›ä¸Šç•Œå°±æ˜¯ WL æµ‹è¯•çš„è¡¨è¾¾åŠ›ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p><strong>1-WL æµ‹è¯•</strong>ï¼ˆä¹Ÿç§° Color Refinementï¼‰çš„æ­¥éª¤ï¼š</p>
    <ol>
      <li><strong>åˆå§‹åŒ–</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹æ ¹æ®è‡ªèº«ç‰¹å¾ï¼ˆå¦‚åº¦æ•°ï¼‰è·å¾—ä¸€ä¸ªåˆå§‹"é¢œè‰²" \( c_v^{(0)} \)</li>
      <li><strong>è¿­ä»£æŸ“è‰²</strong>ï¼šåœ¨ç¬¬ \( t \) è½®ï¼ŒèŠ‚ç‚¹ \( v \) çš„æ–°é¢œè‰²åŸºäºï¼š
        <ul>
          <li>è‡ªå·±çš„æ—§é¢œè‰² \( c_v^{(t-1)} \)</li>
          <li>é‚»å±…é¢œè‰²çš„<strong>å¤šé‡é›†</strong> \( \{c_u^{(t-1)} : u \in \mathcal{N}_v\} \)</li>
        </ul>
        <p style="text-align: center;">$$ c_v^{(t)} = \text{HASH}\left( c_v^{(t-1)}, \{\!\{ c_u^{(t-1)} : u \in \mathcal{N}_v \}\!\} \right) $$</p>
      </li>
      <li><strong>åˆ¤å®š</strong>ï¼šé‡å¤ç›´åˆ°é¢œè‰²åˆ†å¸ƒç¨³å®šã€‚å¦‚æœä¸¤ä¸ªå›¾çš„é¢œè‰²åˆ†å¸ƒç›¸åŒï¼Œåˆ™"å¯èƒ½åŒæ„"ï¼›å¦åˆ™"å¿…ç„¶ä¸åŒæ„"</li>
    </ol>
    
    <p><strong>ä¸ GNN çš„è”ç³»</strong>ï¼ˆXu et al., 2019ï¼‰ï¼š</p>
    <p>æ ‡å‡† GNN çš„æ¶ˆæ¯ä¼ é€’ï¼š</p>
    <p style="text-align: center;">$$ h_v^{(t)} = \sigma\left( W \left[ h_v^{(t-1)} \| \text{AGG}(\{h_u^{(t-1)} : u \in \mathcal{N}_v\}) \right] \right) $$</p>
    <p>ä¸ 1-WL çš„é¢œè‰²æ›´æ–°<strong>é«˜åº¦ç›¸ä¼¼</strong>ï¼å…³é”®å·®å¼‚ï¼š</p>
    <ul>
      <li><strong>WL</strong>ï¼šä½¿ç”¨<strong>å•å°„</strong>çš„ HASH å‡½æ•°ï¼ˆä¿è¯ä¸åŒå¤šé‡é›†å¾—åˆ°ä¸åŒé¢œè‰²ï¼‰</li>
      <li><strong>GNN</strong>ï¼šä½¿ç”¨å¯å­¦ä¹ çš„å‡½æ•°ï¼ˆå¦‚ MLPï¼‰ï¼Œ<strong>ä¸ä¸€å®šå•å°„</strong></li>
    </ul>
    
    <p><strong>ç†è®ºç»“æœ</strong>ï¼š</p>
    <div style="background: #f9fafb; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
      <p><strong>å®šç†ï¼ˆXu et al., 2019ï¼‰</strong>ï¼šå¦‚æœ GNN çš„èšåˆå’Œæ›´æ–°å‡½æ•°éƒ½æ˜¯<strong>å•å°„</strong>çš„ï¼Œåˆ™å…¶è¡¨è¾¾åŠ›ç­‰åŒäº 1-WL æµ‹è¯•ã€‚</p>
      <p style="margin-top: 0.5rem;"><strong>æ¨è®º</strong>ï¼šæ ‡å‡† GNNï¼ˆå¦‚ GCNã€GATï¼‰çš„è¡¨è¾¾åŠ›<strong>ä¸è¶…è¿‡</strong> 1-WL æµ‹è¯•ã€‚</p>
    </div>
    
    <p><strong>1-WL çš„å±€é™æ€§</strong>ï¼š</p>
    <p>å­˜åœ¨éåŒæ„çš„å›¾ï¼Œ1-WL æ— æ³•åŒºåˆ†ã€‚ç»å…¸ä¾‹å­ï¼š</p>
    <div style="background: #f9fafb; padding: 1rem; border-radius: 8px; margin: 1rem 0; font-family: monospace; text-align: center;">
      å›¾1: æ­£å…­è¾¹å½¢<br>
      å›¾2: ä¸¤ä¸ªç‹¬ç«‹çš„ä¸‰è§’å½¢<br>
      ï¼ˆä¸¤è€…çš„èŠ‚ç‚¹åº¦æ•°åˆ†å¸ƒç›¸åŒï¼Œ1-WL æ— æ³•åŒºåˆ†ï¼‰
    </div>
    
    <p><strong>è¶…è¶Š 1-WLï¼šé«˜é˜¶ GNN</strong>ï¼š</p>
    <ul>
      <li><strong>\( k \)-WL æµ‹è¯•</strong>ï¼šåŒæ—¶è€ƒè™‘ \( k \) ä¸ªèŠ‚ç‚¹çš„å…ƒç»„</li>
      <li><strong>\( k \)-é˜¶ GNN</strong>ï¼šåœ¨ \( k \)-å…ƒç»„çš„è¶…å›¾ä¸Šåšæ¶ˆæ¯ä¼ é€’</li>
      <li>ä»£ä»·ï¼šè®¡ç®—å¤æ‚åº¦ä» \( O(|V|) \) å¢é•¿åˆ° \( O(|V|^k) \)</li>
    </ul>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>WL æµ‹è¯•æä¾›äº† GNN è¡¨è¾¾åŠ›çš„<strong>ç†è®ºåŸºå‡†</strong>ã€‚å®ƒæ­ç¤ºäº†æ¶ˆæ¯ä¼ é€’æ¶æ„çš„æœ¬è´¨å±€é™ï¼šåªèƒ½"çœ‹åˆ°"å±€éƒ¨æ‹“æ‰‘æ¨¡å¼ã€‚è¿™æ¨åŠ¨äº†å¯¹<strong>æ›´å¼ºæ¶æ„</strong>ï¼ˆé«˜é˜¶ GNNã€å­å›¾æ–¹æ³•ã€Transformerï¼‰çš„æ¢ç´¢ï¼Œä»¥åŠå¯¹<strong>ä»»åŠ¡é€‚é…æ€§</strong>çš„æ€è€ƒï¼ˆæ˜¯å¦æ‰€æœ‰ä»»åŠ¡éƒ½éœ€è¦å®Œå…¨åŒºåˆ†å›¾åŒæ„ï¼Ÿï¼‰ã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šWL æµ‹è¯•åƒ"å±‚å±‚ç­›ç½‘"â€”â€”ç¬¬ä¸€å±‚ç­›æ‰æ˜æ˜¾ä¸åŒçš„å›¾ï¼Œç¬¬äºŒå±‚ç­›æ‰æ›´ç»†å¾®çš„å·®å¼‚â€¦â€¦æ ‡å‡† GNN åªèƒ½ç”¨"ç¬¬ä¸€å±‚ç­›ç½‘"ï¼Œé«˜é˜¶ GNN ç”¨"å¤šå±‚ç­›ç½‘"ã€‚</p>
  </div>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">ç­‰å˜æ¶ˆæ¯ä¼ é€’ (Equivariant Message Passing) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šåœ¨ä¿æŒç½®æ¢ç­‰å˜æ€§çš„åŒæ—¶ï¼Œè¿˜ä¿æŒå¯¹<strong>å‡ ä½•å˜æ¢</strong>ï¼ˆå¦‚æ—‹è½¬ã€å¹³ç§»ï¼‰çš„ç­‰å˜æ€§â€”â€”è®© GNN èƒ½æ­£ç¡®å¤„ç† 3D åˆ†å­ã€ç‚¹äº‘ç­‰å¸¦ç©ºé—´åæ ‡çš„å›¾æ•°æ®ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>æ ‡å‡† GNN åªå¤„ç†"æŠ½è±¡å›¾"ï¼ˆèŠ‚ç‚¹ç‰¹å¾ \( x_v \in \mathbb{R}^d \)ï¼Œæ²¡æœ‰å‡ ä½•å«ä¹‰ï¼‰ã€‚ä½†åœ¨å¾ˆå¤šåº”ç”¨ä¸­ï¼ŒèŠ‚ç‚¹ç‰¹å¾åŒ…å«<strong>ç©ºé—´åæ ‡</strong>ï¼š</p>
    <ul>
      <li><strong>åˆ†å­å›¾</strong>ï¼šåŸå­ä½ç½® \( \mathbf{r}_v \in \mathbb{R}^3 \)</li>
      <li><strong>ç‚¹äº‘</strong>ï¼šç‚¹çš„ 3D åæ ‡</li>
      <li><strong>è›‹ç™½è´¨ç»“æ„</strong>ï¼šæ°¨åŸºé…¸æ®‹åŸºçš„ç©ºé—´ä½ç½®</li>
    </ul>
    
    <p><strong>å‡ ä½•ç­‰å˜æ€§è¦æ±‚</strong>ï¼š</p>
    <p>å¦‚æœè¾“å…¥åæ ‡ç»è¿‡æ¬§å‡ é‡Œå¾—å˜æ¢ \( g \in E(3) \)ï¼ˆæ—‹è½¬ \( R \) + å¹³ç§» \( \mathbf{t} \)ï¼‰ï¼š</p>
    <p style="text-align: center;">$$ \mathbf{r}_v \mapsto R \mathbf{r}_v + \mathbf{t} $$</p>
    <p>åˆ™è¾“å‡ºåæ ‡ä¹Ÿåº”è¯¥ç›¸åº”å˜æ¢ï¼š</p>
    <p style="text-align: center;">$$ \mathbf{r}'_v \mapsto R \mathbf{r}'_v + \mathbf{t} $$</p>
    <p>è€Œæ ‡é‡ç‰¹å¾ \( f_v \) ä¿æŒä¸å˜ï¼ˆ<strong>ä¸å˜æ€§</strong>ï¼‰ã€‚</p>
    
    <p><strong>å®ç°æ–¹å¼ï¼ˆEGNNï¼ŒSatorras et al., 2021ï¼‰</strong>ï¼š</p>
    <div style="background: #f9fafb; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
      <p><strong>æ ‡é‡ç‰¹å¾æ›´æ–°</strong>ï¼ˆä¸å˜é‡ï¼‰ï¼š</p>
      <p style="text-align: center;">$$ f'_u = \phi\left( f_u, \bigoplus_{v \in \mathcal{N}_u} \psi_f(f_u, f_v, \|\mathbf{r}_u - \mathbf{r}_v\|^2) \right) $$</p>
      <p style="font-size: 0.9em; color: #6b7280;">â†³ åªä¾èµ–<strong>è·ç¦»</strong>ï¼ˆæ—‹è½¬/å¹³ç§»ä¸å˜é‡ï¼‰</p>
      
      <p style="margin-top: 1rem;"><strong>åæ ‡æ›´æ–°</strong>ï¼ˆç­‰å˜é‡ï¼‰ï¼š</p>
      <p style="text-align: center;">$$ \mathbf{r}'_u = \mathbf{r}_u + \sum_{v \neq u} (\mathbf{r}_u - \mathbf{r}_v) \cdot \psi_c(f_u, f_v, \|\mathbf{r}_u - \mathbf{r}_v\|^2) $$</p>
      <p style="font-size: 0.9em; color: #6b7280;">â†³ æ²¿ç›¸å¯¹ä½ç½®æ–¹å‘åŠ æƒç§»åŠ¨</p>
    </div>
    
    <p><strong>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ</strong></p>
    <ul>
      <li><strong>è·ç¦»ä¸å˜</strong>ï¼š\( \|\mathbf{r}_u - \mathbf{r}_v\| \) åœ¨æ—‹è½¬å’Œå¹³ç§»ä¸‹ä¸å˜</li>
      <li><strong>ç›¸å¯¹ä½ç½®ç­‰å˜</strong>ï¼š\( \mathbf{r}_u - \mathbf{r}_v \) åœ¨æ—‹è½¬ä¸‹ç­‰å˜ï¼ˆ\( R(\mathbf{r}_u - \mathbf{r}_v) = R\mathbf{r}_u - R\mathbf{r}_v \)ï¼‰ï¼Œå¹³ç§»ä¸‹ä¸å˜</li>
      <li><strong>çº¿æ€§ç»„åˆä¿æŒç­‰å˜æ€§</strong>ï¼š\( \sum \alpha_v (\mathbf{r}_u - \mathbf{r}_v) \) ä»ç„¶ç­‰å˜</li>
    </ul>
    
    <p><strong>æ›´å¼ºçš„æ¡†æ¶ï¼šä¸å¯çº¦è¡¨ç¤º</strong>ï¼ˆè§ä¸‹ä¸€æ¡ï¼‰</p>
    <p>EGNN åªå¤„ç†æ ‡é‡ï¼ˆ0é˜¶ï¼‰å’Œå‘é‡ï¼ˆ1é˜¶ï¼‰ç‰¹å¾ã€‚æ›´ä¸€èˆ¬çš„æ¡†æ¶ï¼ˆå¦‚ SE(3)-Transformerï¼‰å…è®¸å¤„ç†<strong>ä»»æ„é˜¶å¼ é‡</strong>ï¼ˆå¦‚é€Ÿåº¦ã€åŠ›çŸ©ã€åº”åŠ›å¼ é‡ï¼‰ï¼Œé€šè¿‡çƒè°å‡½æ•°å’Œ Clebsch-Gordan ç³»æ•°å®ç°ã€‚</p>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>ç­‰å˜æ¶ˆæ¯ä¼ é€’æ˜¯ Geometric Deep Learning æ¡†æ¶åœ¨<strong>æ¬§å‡ é‡Œå¾—ç¾¤</strong>ä¸Šçš„å®ä¾‹åŒ–ã€‚å®ƒå±•ç¤ºäº†å¦‚ä½•å°†<strong>å¤šä¸ªå¯¹ç§°æ€§</strong>ï¼ˆç½®æ¢ + æ¬§å‡ é‡Œå¾—ï¼‰ç»“åˆåˆ°åŒä¸€æ¶æ„ä¸­ï¼Œè¿™æ˜¯ GDL çš„æ ¸å¿ƒæ€æƒ³ï¼š"<strong>å¯¹ç§°æ€§å åŠ </strong>"ã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šè®¾è®¡ä¸€ä¸ª"è¯†åˆ«æ¤…å­"çš„ç®—æ³•â€”â€”æ— è®ºæ¤…å­å¦‚ä½•æ‘†æ”¾ï¼ˆæ—‹è½¬ã€å¹³ç§»ï¼‰ï¼Œç®—æ³•éƒ½èƒ½è¯†åˆ«ã€‚ç­‰å˜æ¶ˆæ¯ä¼ é€’ç¡®ä¿ï¼šå¦‚æœè¾“å…¥çš„æ¤…å­æ—‹è½¬äº†90åº¦ï¼Œè¾“å‡ºçš„"æ¤…å­æ–¹å‘"ä¹Ÿç›¸åº”æ—‹è½¬90åº¦ã€‚</p>
  </div>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">ä¸å¯çº¦è¡¨ç¤º (Irreducible Representation) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šä¸å¯çº¦è¡¨ç¤ºæ˜¯ç¾¤ä½œç”¨çš„"åŸå­å•å…ƒ"â€”â€”ä»»ä½•å¤æ‚çš„å‡ ä½•å¯¹è±¡ï¼ˆå¦‚å¼ é‡ï¼‰éƒ½å¯ä»¥åˆ†è§£ä¸ºä¸å¯çº¦è¡¨ç¤ºçš„ç›´å’Œï¼Œå°±åƒä»»ä½•æ•°éƒ½å¯ä»¥åˆ†è§£ä¸ºè´¨å› æ•°ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>åœ¨ç¾¤è®ºä¸­ï¼Œ<strong>è¡¨ç¤º</strong>ï¼ˆrepresentationï¼‰æ˜¯æŠŠç¾¤å…ƒç´  \( g \) æ˜ å°„åˆ°çº¿æ€§å˜æ¢ï¼ˆçŸ©é˜µï¼‰ \( \rho(g) \) çš„æ–¹å¼ã€‚å¯¹äºæ—‹è½¬ç¾¤ \( SO(3) \)ï¼š</p>
    <ul>
      <li><strong>æ ‡é‡</strong>ï¼ˆå¦‚æ¸©åº¦ï¼‰ï¼š0é˜¶ï¼Œæ—‹è½¬ä¸‹ä¸å˜ â†’ \( \rho(g) = 1 \)</li>
      <li><strong>å‘é‡</strong>ï¼ˆå¦‚é€Ÿåº¦ï¼‰ï¼š1é˜¶ï¼Œæ—‹è½¬ä¸‹ç­‰å˜ â†’ \( \rho(g) = R \in \mathbb{R}^{3 \times 3} \)</li>
      <li><strong>å¼ é‡</strong>ï¼ˆå¦‚åº”åŠ›å¼ é‡ï¼‰ï¼š2é˜¶åŠä»¥ä¸Š â†’ \( \rho(g) \) æ˜¯æ›´é«˜ç»´çš„çŸ©é˜µ</li>
    </ul>
    
    <p><strong>ä¸å¯çº¦è¡¨ç¤ºçš„å®šä¹‰</strong>ï¼š</p>
    <p>è¡¨ç¤º \( \rho \) æ˜¯<strong>ä¸å¯çº¦çš„</strong>ï¼Œå¦‚æœå®ƒä¸èƒ½è¢«è¿›ä¸€æ­¥åˆ†è§£ä¸ºæ›´å°çš„ç‹¬ç«‹å­è¡¨ç¤ºã€‚å¯¹äº \( SO(3) \)ï¼Œä¸å¯çº¦è¡¨ç¤ºç”±<strong>é˜¶æ•°</strong> \( \ell = 0, 1, 2, \ldots \) æ ‡è®°ï¼š</p>
    <ul>
      <li>\( \ell = 0 \)ï¼šæ ‡é‡ï¼ˆ1 ç»´ï¼‰</li>
      <li>\( \ell = 1 \)ï¼šå‘é‡ï¼ˆ3 ç»´ï¼‰</li>
      <li>\( \ell = 2 \)ï¼šå¯¹ç§°æ— è¿¹å¼ é‡ï¼ˆ5 ç»´ï¼‰</li>
      <li>ä¸€èˆ¬åœ°ï¼Œ\( \ell \) é˜¶è¡¨ç¤ºæ˜¯ \( 2\ell + 1 \) ç»´</li>
    </ul>
    
    <p><strong>çƒè°å‡½æ•°çš„è§’è‰²</strong>ï¼ˆè§ä¸‹ä¸€æ¡ï¼‰ï¼š</p>
    <p>\( \ell \) é˜¶çƒè°å‡½æ•° \( Y_{\ell}^m(\theta, \phi) \)ï¼ˆ\( m = -\ell, \ldots, \ell \)ï¼‰æ„æˆäº† \( \ell \) é˜¶ä¸å¯çº¦è¡¨ç¤ºçš„<strong>æ ‡å‡†åŸº</strong>ã€‚</p>
    
    <p><strong>åœ¨ç­‰å˜ GNN ä¸­çš„åº”ç”¨</strong>ï¼š</p>
    <p>ç­‰å˜ GNNï¼ˆå¦‚ SE(3)-Transformerï¼‰æŠŠèŠ‚ç‚¹ç‰¹å¾åˆ†è§£ä¸ºä¸å¯çº¦è¡¨ç¤ºçš„ç›´å’Œï¼š</p>
    <p style="text-align: center;">$$ \mathbf{f}_v = \mathbf{f}_v^{(0)} \oplus \mathbf{f}_v^{(1)} \oplus \mathbf{f}_v^{(2)} \oplus \ldots $$</p>
    <p>å…¶ä¸­ \( \mathbf{f}_v^{(\ell)} \in \mathbb{R}^{2\ell+1} \) æ˜¯ \( \ell \) é˜¶ç‰¹å¾ã€‚æ¶ˆæ¯ä¼ é€’æ—¶ï¼Œä¸åŒé˜¶çš„ç‰¹å¾é€šè¿‡<strong>Clebsch-Gordan ç³»æ•°</strong>ç»„åˆï¼š</p>
    <p style="text-align: center;">$$ \mathbf{f}_u^{(\ell_3)} \leftarrow \sum_{\ell_1, \ell_2} C_{\ell_1, \ell_2}^{\ell_3} \left( \mathbf{f}_u^{(\ell_1)} \otimes \mathbf{f}_v^{(\ell_2)} \right) $$</p>
    
    <p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
    <ul>
      <li><strong>ç†è®ºä¿è¯</strong>ï¼šè¡¨ç¤ºè®ºç¡®ä¿ç­‰å˜æ€§ä¸¥æ ¼æˆç«‹</li>
      <li><strong>ä¸°å¯Œè¡¨è¾¾</strong>ï¼šå¯ä»¥å¤„ç†ä»»æ„å¤æ‚çš„å‡ ä½•å¯¹è±¡ï¼ˆä¸é™äºæ ‡é‡å’Œå‘é‡ï¼‰</li>
      <li><strong>æ¨¡å—åŒ–</strong>ï¼šä¸åŒé˜¶çš„ç‰¹å¾ç‹¬ç«‹å¤„ç†ï¼Œæ˜“äºæ‰©å±•</li>
    </ul>
    
    <p><strong>ä»£ä»·</strong>ï¼š</p>
    <ul>
      <li>è®¡ç®—å¤æ‚åº¦é«˜ï¼ˆéœ€è¦è®¡ç®— Clebsch-Gordan ç³»æ•°å’Œ Wigner D-çŸ©é˜µï¼‰</li>
      <li>éœ€è¦æ·±å…¥çš„ç¾¤è®ºçŸ¥è¯†</li>
    </ul>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>ä¸å¯çº¦è¡¨ç¤ºæ˜¯ Geometric Deep Learning çš„<strong>æ•°å­¦åŸºçŸ³</strong>ã€‚å®ƒæä¾›äº†ä¸€å¥—<strong>å®Œå¤‡çš„è¯­è¨€</strong>æ¥æè¿°æ‰€æœ‰å¯èƒ½çš„å‡ ä½•ç­‰å˜æ“ä½œï¼Œå°±åƒå‚…é‡Œå¶å˜æ¢æä¾›äº†æè¿°æ‰€æœ‰å¹³ç§»ç­‰å˜æ“ä½œçš„å®Œå¤‡åŸºã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šå…‰å¯ä»¥åˆ†è§£ä¸ºçº¢ã€ç»¿ã€è“ä¸‰åŸè‰²ï¼ˆç±»æ¯”ä¸å¯çº¦è¡¨ç¤ºï¼‰ï¼Œä»»ä½•é¢œè‰²éƒ½æ˜¯ä¸‰åŸè‰²çš„ç»„åˆï¼ˆç±»æ¯”å¯çº¦è¡¨ç¤ºï¼‰ã€‚çƒè°å‡½æ•°å°±æ˜¯"å‡ ä½•ä¸–ç•Œçš„ä¸‰åŸè‰²"ã€‚</p>
  </div>
  
  <div class="concept-card" style="margin: 1.5rem 0; padding: 1.2rem; background: rgba(236,72,153,0.06); border-radius: 10px; border: 1px solid rgba(236,72,153,0.2);">
    <h5 style="margin-top: 0; color: #db2777;">çƒè°å‡½æ•° (Spherical Harmonics) ğŸ”‘</h5>
    <p><strong>ä¸€å¥è¯</strong>ï¼šçƒè°å‡½æ•°æ˜¯å®šä¹‰åœ¨çƒé¢ä¸Šçš„"å‚…é‡Œå¶åŸºå‡½æ•°"â€”â€”å®ƒä»¬å¯¹æ—‹è½¬ç­‰å˜ï¼Œæ˜¯æ„å»º 3D ç­‰å˜ç¥ç»ç½‘ç»œçš„æ ¸å¿ƒæ•°å­¦å·¥å…·ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>çƒè°å‡½æ•° \( Y_{\ell}^m(\theta, \phi) \) æ˜¯çƒé¢ \( S^2 \) ä¸Šçš„æ­£äº¤å‡½æ•°æ—ï¼Œç”±ä¸¤ä¸ªå‚æ•°å®šä¹‰ï¼š</p>
    <ul>
      <li><strong>\( \ell \in \{0, 1, 2, \ldots\} \)</strong>ï¼šé˜¶æ•°ï¼ˆdegreeï¼‰ï¼Œæ§åˆ¶"é¢‘ç‡"</li>
      <li><strong>\( m \in \{-\ell, \ldots, \ell\} \)</strong>ï¼šåºæ•°ï¼ˆorderï¼‰ï¼Œå…± \( 2\ell + 1 \) ä¸ª</li>
    </ul>
    
    <p><strong>ç›´è§‚ç†è§£</strong>ï¼š</p>
    <div style="background: #f9fafb; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
      <p><strong>\( \ell = 0 \)</strong>ï¼šå¸¸æ•°ï¼ˆçƒé¢ä¸Šå‡åŒ€åˆ†å¸ƒï¼‰</p>
      <p><strong>\( \ell = 1 \)</strong>ï¼šçº¿æ€§å‡½æ•°ï¼ˆç±»ä¼¼ \( x, y, z \) åæ ‡ï¼‰</p>
      <p><strong>\( \ell = 2 \)</strong>ï¼šäºŒæ¬¡å‡½æ•°ï¼ˆç±»ä¼¼ \( xy, xz, x^2 - y^2 \) ç­‰ï¼‰</p>
      <p>\( \ell \) è¶Šå¤§ï¼Œçƒé¢ä¸Šçš„"æ³¢çº¹"è¶Šå¯†é›†ï¼ˆé«˜é¢‘æˆåˆ†ï¼‰ã€‚</p>
    </div>
    
    <p><strong>å…³é”®æ€§è´¨</strong>ï¼š</p>
    <ol>
      <li><strong>æ­£äº¤å®Œå¤‡</strong>ï¼šä»»ä½•çƒé¢å‡½æ•°éƒ½å¯ä»¥è¡¨ç¤ºä¸ºçƒè°å‡½æ•°çš„çº¿æ€§ç»„åˆï¼ˆç±»æ¯”å‚…é‡Œå¶çº§æ•°ï¼‰</li>
      <li><strong>æ—‹è½¬ç­‰å˜</strong>ï¼šæ—‹è½¬çƒé¢å‡½æ•° \( f \) åï¼Œå…¶çƒè°ç³»æ•°æŒ‰ Wigner D-çŸ©é˜µå˜æ¢ï¼š
        <p style="text-align: center;">$$ [f(R^{-1} \cdot)]_{\ell}^m = \sum_{m'} D_{\ell}^{mm'}(R) \cdot [f]_{\ell}^{m'} $$</p>
      </li>
      <li><strong>å·ç§¯å®šç†</strong>ï¼šçƒé¢å·ç§¯åœ¨çƒè°åŸŸæ˜¯é€é¢‘ç‡ç›¸ä¹˜ï¼ˆç±»æ¯”æ¬§å‡ é‡Œå¾—ç©ºé—´çš„å·ç§¯å®šç†ï¼‰</li>
    </ol>
    
    <p><strong>åœ¨ 3D ç­‰å˜ GNN ä¸­çš„åº”ç”¨</strong>ï¼š</p>
    <ul>
      <li><strong>ç‰¹å¾è¡¨ç¤º</strong>ï¼šèŠ‚ç‚¹ \( v \) çš„ \( \ell \) é˜¶ç‰¹å¾ \( \mathbf{f}_v^{(\ell)} \) ç”¨ \( 2\ell+1 \) ä¸ªçƒè°ç³»æ•°è¡¨ç¤º</li>
      <li><strong>æ¶ˆæ¯è®¡ç®—</strong>ï¼šç›¸å¯¹ä½ç½® \( \mathbf{r}_{uv} = \mathbf{r}_v - \mathbf{r}_u \) ç”¨çƒè°å‡½æ•°ç¼–ç ï¼š
        <p style="text-align: center;">$$ Y_{\ell}^m(\mathbf{r}_{uv}) = Y_{\ell}^m(\theta_{uv}, \phi_{uv}) $$</p>
      </li>
      <li><strong>ç­‰å˜æ»¤æ³¢</strong>ï¼šåˆ©ç”¨çƒè°å‡½æ•°çš„æ—‹è½¬ç­‰å˜æ€§ï¼Œè®¾è®¡ç­‰å˜çš„å·ç§¯æ ¸</li>
    </ul>
    
    <p><strong>å®é™…åº”ç”¨</strong>ï¼š</p>
    <ul>
      <li><strong>åˆ†å­å»ºæ¨¡</strong>ï¼šSchNetã€DimeNet ç”¨çƒè°å‡½æ•°ç¼–ç åŸå­é—´çš„è§’åº¦ä¿¡æ¯</li>
      <li><strong>è›‹ç™½è´¨ç»“æ„é¢„æµ‹</strong>ï¼šAlphaFold çš„æ—©æœŸç‰ˆæœ¬ä½¿ç”¨çƒè°ç‰¹å¾</li>
      <li><strong>ç‚¹äº‘å¤„ç†</strong>ï¼šSpherical CNNs åœ¨çƒé¢ä¸Šåšå·ç§¯</li>
    </ul>
    
    <p><strong>è®¡ç®—æŒ‘æˆ˜</strong>ï¼š</p>
    <ul>
      <li>é«˜é˜¶çƒè°å‡½æ•°è®¡ç®—æ˜‚è´µï¼ˆéœ€è¦ç‰¹æ®Šä¼˜åŒ–ï¼‰</li>
      <li>Clebsch-Gordan ç³»æ•°é¢„è®¡ç®—å’Œå­˜å‚¨å ç”¨å†…å­˜</li>
      <li>éœ€è¦ FFT-like ç®—æ³•ï¼ˆå¦‚ SO(3) FFTï¼‰åŠ é€Ÿ</li>
    </ul>
    
    <p><strong>åœ¨ GDL ä¸­çš„è§’è‰²</strong>ï¼š</p>
    <p>çƒè°å‡½æ•°æ˜¯ Geometric Deep Learning åœ¨<strong>çƒé¢</strong>å’Œ <strong>SO(3) ç¾¤</strong>ä¸Šçš„"å‚…é‡Œå¶åŸº"ã€‚å®ƒä»¬æä¾›äº†ä¸€ç§<strong>æ ‡å‡†åŒ–</strong>çš„æ–¹å¼æ¥è¡¨ç¤ºå’Œæ“ä½œæ—‹è½¬ç­‰å˜ç‰¹å¾ï¼Œå°±åƒå‚…é‡Œå¶å˜æ¢ä¸ºå¹³ç§»ç­‰å˜æä¾›äº†æ ‡å‡†åŒ–è¡¨ç¤ºã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šéŸ³ä¹å¯ä»¥åˆ†è§£ä¸ºä¸åŒé¢‘ç‡çš„æ­£å¼¦æ³¢ï¼ˆå‚…é‡Œå¶åˆ†è§£ï¼‰ï¼Œçƒé¢ä¸Šçš„"å›¾æ¡ˆ"å¯ä»¥åˆ†è§£ä¸ºä¸åŒé˜¶çš„çƒè°å‡½æ•°ã€‚ä½é˜¶çƒè°å‡½æ•°æ˜¯"ä½éŸ³"ï¼ˆå¹³æ»‘å˜åŒ–ï¼‰ï¼Œé«˜é˜¶çƒè°å‡½æ•°æ˜¯"é«˜éŸ³"ï¼ˆå¿«é€Ÿå˜åŒ–ï¼‰ã€‚</p>
  </div>
  
</div>
<!-- === GLOSSARY END === -->

    <h2 id="sec5-1">5.1 å·ç§¯ç¥ç»ç½‘ç»œ (CNN)<br><span style="font-size:0.65em;color:var(--text-secondary)">Convolutional Neural Networks</span></h2>

    <div class="bilingual">
      <div class="zh">
        <p>å·ç§¯ç¥ç»ç½‘ç»œæ˜¯å‡ ä½•æ·±åº¦å­¦ä¹ è“å›¾æœ€æ—©ä¹Ÿæœ€è‘—åçš„å®ä¾‹ã€‚åœ¨ Â§4.2 ä¸­æˆ‘ä»¬å·²ç»å®Œæ•´åˆ»ç”»äº†<span class="term">çº¿æ€§</span>ä¸”<span class="term">å±€éƒ¨</span>çš„<span class="term">å¹³ç§»ç­‰å˜</span>ç®—å­â€”â€”å®ƒä»¬å°±æ˜¯ä¸å±€éƒ¨åŒ–æ»¤æ³¢å™¨çš„<strong>å·ç§¯</strong> $C(\theta)\mathbf{x} = \mathbf{x} \star \theta$ã€‚</p>
      </div>
      <div class="en">
        CNNs are perhaps the earliest and most well-known example of deep learning architectures following the GDL blueprint. Linear, local, translation-equivariant operators are exactly convolutions with a localized filter.
      </div>
    </div>

<!-- === ENRICHMENT: sec5-1 === -->
<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šå·ç§¯ = å¹³ç§»ç­‰å˜æ˜¯ä»€ä¹ˆæ„æ€?</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šä»€ä¹ˆå«"å¹³ç§»ç­‰å˜"ï¼Ÿæˆ‘åªçŸ¥é“å·ç§¯å°±æ˜¯ä¸ªæ»‘åŠ¨çª—å£...ä¸ºä»€ä¹ˆè¯´ $T_t[\mathbf{x}] \star \theta = T_t[\mathbf{x} \star \theta]$ å°±è¯æ˜äº†ç­‰å˜æ€§ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>"ç­‰å˜"çš„ç”Ÿæ´»ç±»æ¯”</strong>ï¼šæƒ³è±¡ä½ åœ¨æ‹ä¸€å¼ å…¨å®¶ç¦ï¼Œç„¶åæ‰€æœ‰äººåŒæ—¶å‘å³ç§»åŠ¨ 3 æ­¥ï¼Œå†æ‹ä¸€å¼ ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°æ˜¯"å¹³ç§»ç­‰å˜"çš„ï¼Œé‚£ä¹ˆï¼š</p>
        <ul>
          <li><strong>å…ˆç§»åŠ¨äººå†è¯†åˆ«</strong> = <strong>å…ˆè¯†åˆ«å†ç§»åŠ¨ç»“æœ</strong></li>
          <li>æ¯”å¦‚"æ‰¾å‡ºæ‰€æœ‰äººçš„è„¸"è¿™ä¸ªæ“ä½œå°±æ˜¯ç­‰å˜çš„ï¼šäººç§»åŠ¨äº†ï¼Œè¯†åˆ«å‡ºçš„è„¸ä¹Ÿè·Ÿç€ç§»åŠ¨</li>
        </ul>
        
        <p><strong>æ•°å­¦ç¬¦å·è§£è¯»</strong>ï¼š</p>
        <ul>
          <li>$T_t[\mathbf{x}]$ â†’ å°†å›¾åƒ $\mathbf{x}$ å¹³ç§» $t$ ä¸ªåƒç´ ï¼ˆæ¯”å¦‚å‘å³ç§» 5 ä¸ªåƒç´ ï¼‰</li>
          <li>$\star$ â†’ å·ç§¯æ“ä½œï¼ˆæ»‘åŠ¨çª—å£ï¼‰</li>
          <li>$\theta$ â†’ å·ç§¯æ ¸ï¼ˆæ¯”å¦‚ 3Ã—3 çš„è¾¹ç¼˜æ£€æµ‹å™¨ï¼‰</li>
          <li>$T_t[\mathbf{x}] \star \theta$ â†’ å…ˆå¹³ç§»å›¾åƒï¼Œå†åšå·ç§¯</li>
          <li>$T_t[\mathbf{x} \star \theta]$ â†’ å…ˆåšå·ç§¯ï¼Œå†å¹³ç§»ç»“æœ</li>
        </ul>
        
        <p><strong>ä¸ºä»€ä¹ˆå·ç§¯æ»¡è¶³è¿™ä¸ªæ€§è´¨ï¼Ÿ</strong></p>
        <p>å·ç§¯çš„å®šä¹‰æ˜¯ $(\mathbf{x} \star \theta)(u) = \sum_v \mathbf{x}(v) \cdot \theta(u-v)$ï¼Œæ³¨æ„å…³é”®ï¼šæ»¤æ³¢å™¨çš„ä½ç½®æ˜¯<strong>ç›¸å¯¹äºè¾“å‡ºä½ç½® $u$</strong> çš„ã€‚å½“ä½ å¹³ç§»è¾“å…¥ $\mathbf{x}$ï¼Œæ¯ä¸ªåƒç´ çš„"é‚»å±…å…³ç³»"ä¿æŒä¸å˜ï¼Œæ‰€ä»¥å·ç§¯ç»“æœä¹Ÿä¼šç­‰é‡å¹³ç§»ã€‚</p>
        
        <p><strong>åä¾‹</strong>ï¼šå…¨è¿æ¥å±‚ $y = Wx$ ä¸æ˜¯ç­‰å˜çš„ï¼Œå› ä¸ºæ¯ä¸ªè¾“å‡ºç¥ç»å…ƒè¿æ¥åˆ°<strong>æ‰€æœ‰</strong>è¾“å…¥çš„å›ºå®šä½ç½®ï¼Œå¹³ç§»è¾“å…¥ä¼šå½»åº•æ‰“ä¹±è¿™ç§å…³ç³»ã€‚</p>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šå¾ªç¯çŸ©é˜µ $C(\theta)$ æ˜¯ä»€ä¹ˆï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šæ–‡ç« è¯´"å¹³ç§»ç­‰å˜ç®—å­ = å¾ªç¯çŸ©é˜µ"ï¼Œä»€ä¹ˆæ˜¯å¾ªç¯çŸ©é˜µï¼Ÿè·Ÿå·ç§¯æœ‰å•¥å…³ç³»ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>å¾ªç¯çŸ©é˜µ</strong>æ˜¯ä¸€ç§ç‰¹æ®ŠçŸ©é˜µï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸Šä¸€è¡Œ<strong>å¾ªç¯å³ç§»</strong>ä¸€ä½å¾—åˆ°çš„ã€‚æ¯”å¦‚å¯¹äº 1D ä¿¡å· $\theta = [a, b, c]$ï¼š</p>
        
        $$C(\theta) = \begin{bmatrix} a & c & b \\ b & a & c \\ c & b & a \end{bmatrix}$$
        
        <p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼šå½“ä½ è®¡ç®— $C(\theta) \mathbf{x}$ï¼ˆçŸ©é˜µä¹˜æ³•ï¼‰ï¼Œå¾—åˆ°çš„ç»“æœæ°å¥½ç­‰äº $\mathbf{x} \star \theta$ï¼ˆå·ç§¯ï¼‰ï¼</p>
        
        <p><strong>ä¸ºä»€ä¹ˆï¼Ÿ</strong>é€ä¸ªçœ‹ç¬¬ $i$ è¡Œï¼š</p>
        <ul>
          <li>ç¬¬1è¡Œï¼š$[a, c, b]$ â†’ $y_1 = a \cdot x_1 + c \cdot x_2 + b \cdot x_3$</li>
          <li>ç¬¬2è¡Œï¼š$[b, a, c]$ â†’ $y_2 = b \cdot x_1 + a \cdot x_2 + c \cdot x_3$</li>
          <li>è¿™æ­£æ˜¯å·ç§¯çš„å®šä¹‰ï¼šæ¯ä¸ªè¾“å‡º $y_i$ æ˜¯æ»¤æ³¢å™¨åœ¨ä½ç½® $i$ ä¸è¾“å…¥çš„åŠ æƒå’Œ</li>
        </ul>
        
        <p><strong>å¾ªç¯çŸ©é˜µçš„å¯¹è§’åŒ–</strong>ï¼šä»»ä½•å¾ªç¯çŸ©é˜µéƒ½å¯ä»¥å†™æˆ $C = F^{-1} \Lambda F$ï¼Œå…¶ä¸­ $F$ æ˜¯ç¦»æ•£ Fourier å˜æ¢çŸ©é˜µï¼Œ$\Lambda$ æ˜¯å¯¹è§’çŸ©é˜µã€‚è¿™å°±æ˜¯<strong>å·ç§¯å®šç†</strong>çš„æ¥æºï¼</p>
        
        <p><strong>2D æƒ…å†µ</strong>ï¼šå›¾åƒå·ç§¯å¯¹åº”äº <strong>Block-circulant circulant-block</strong> çŸ©é˜µï¼ˆæ›´å¤æ‚çš„å¾ªç¯ç»“æ„ï¼‰ï¼Œä½†åŸç†ç›¸åŒã€‚</p>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šå·ç§¯å®šç† â€” ä¸ºä»€ä¹ˆ FFT èƒ½åŠ é€Ÿï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼š$\mathcal{F}[\mathbf{x} \star \theta] = \mathcal{F}[\mathbf{x}] \odot \mathcal{F}[\theta]$ è¿™ä¸ªç­‰å¼å¾ˆç¥å¥‡ï¼ä¸ºä»€ä¹ˆé¢‘åŸŸçš„<strong>é€å…ƒç´ ä¹˜æ³•</strong>èƒ½ä»£æ›¿ç©ºåŸŸçš„<strong>å·ç§¯</strong>ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>ç”Ÿæ´»ç±»æ¯”</strong>ï¼šæƒ³è±¡ä½ åœ¨æ··éŸ³å®¤è°ƒéŸ³ã€‚ç©ºåŸŸå·ç§¯å°±åƒç”¨ä¸€ä¸ª"å›å£°æ»¤æ³¢å™¨"é€å¸§å¤„ç†éŸ³é¢‘ï¼ˆå¾ˆæ…¢ï¼‰ï¼›é¢‘åŸŸæ–¹æ³•æ˜¯å…ˆåš Fourier å˜æ¢ï¼ˆæŠŠéŸ³é¢‘åˆ†è§£æˆä½éŸ³ã€ä¸­éŸ³ã€é«˜éŸ³ï¼‰ï¼Œç„¶åç›´æ¥è°ƒæ•´æ¯ä¸ªé¢‘æ®µçš„éŸ³é‡ï¼ˆå¾ˆå¿«ï¼‰ï¼Œæœ€åå†åˆæˆå›æ¥ã€‚</p>
        
        <p><strong>æ•°å­¦ç›´è§‰</strong>ï¼š</p>
        <ul>
          <li>Fourier å˜æ¢å°†ä¿¡å·åˆ†è§£ä¸º<strong>æ­£å¼¦æ³¢çš„å åŠ </strong>ï¼š$\mathbf{x} = \sum_k \hat{x}_k e^{i \omega_k t}$</li>
          <li>å·ç§¯æ˜¯"æ»‘åŠ¨ç›¸å…³"ï¼Œä½†æ­£å¼¦æ³¢æœ‰ä¸ªç‰¹æ®Šæ€§è´¨ï¼š<strong>å·ç§¯æ­£å¼¦æ³¢ = ç¼©æ”¾æ­£å¼¦æ³¢</strong></li>
          <li>å…·ä½“åœ°ï¼š$e^{i \omega t} \star \theta \propto \hat{\theta}(\omega) \cdot e^{i \omega t}$ï¼ˆé¢‘ç‡ä¸å˜ï¼Œåªæ”¹å˜å¹…åº¦ï¼‰</li>
          <li>æ‰€ä»¥åœ¨é¢‘åŸŸï¼Œå·ç§¯å˜æˆäº†ç®€å•çš„<strong>é€é¢‘ç‡ç›¸ä¹˜</strong> $\hat{y}_k = \hat{x}_k \cdot \hat{\theta}_k$</li>
        </ul>
        
        <p><strong>å¤æ‚åº¦å¯¹æ¯”</strong>ï¼š</p>
        <ul>
          <li>ç©ºåŸŸå·ç§¯ï¼šå¯¹æ¯ä¸ªè¾“å‡ºåƒç´  $(i,j)$ï¼Œéœ€è¦è®¡ç®— $k \times k$ ä¸ªä¹˜æ³• â†’ æ€»å…± $O(n^2 k^2)$</li>
          <li>é¢‘åŸŸæ–¹æ³•ï¼šFFT å˜æ¢ $O(n^2 \log n)$ + é€å…ƒç´ ä¹˜æ³• $O(n^2)$ + é€† FFT $O(n^2 \log n)$ â†’ æ€»å…± $O(n^2 \log n)$</li>
          <li>å½“ $k$ å¾ˆå¤§æ—¶ï¼ˆå¦‚ $k=32$ï¼‰ï¼Œé¢‘åŸŸæ–¹æ³•å¿«<strong>å‡ ç™¾å€</strong>ï¼</li>
        </ul>
        
        <p><strong>æ¨å¯¼æ ¸å¿ƒæ­¥éª¤</strong>ï¼ˆ1Dï¼‰ï¼š</p>
        $$\begin{align*}
        \mathcal{F}[x \star \theta][k] &= \sum_m \left(\sum_n x[n] \theta[m-n]\right) e^{-i2\pi km/N} \\
        &= \sum_n x[n] \sum_m \theta[m-n] e^{-i2\pi km/N} \\
        &\stackrel{p=m-n}{=} \sum_n x[n] e^{-i2\pi kn/N} \sum_p \theta[p] e^{-i2\pi kp/N} \\
        &= \hat{x}[k] \cdot \hat{\theta}[k]
        \end{align*}$$
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šæ± åŒ–çš„ä½œç”¨ â€” ç­‰å˜ vs ä¸å˜</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šä¸ºä»€ä¹ˆéœ€è¦æ± åŒ–ï¼Ÿå®ƒæ˜¯"ç ´å"ç­‰å˜æ€§çš„æ“ä½œå—ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>æ± åŒ–çš„ä¸¤ä¸ªä½œç”¨</strong>ï¼š</p>
        <ol>
          <li><strong>è®¡ç®—æ•ˆç‡</strong>ï¼šé™ä½ç‰¹å¾å›¾åˆ†è¾¨ç‡ï¼ˆå¦‚ä» $224 \times 224$ é™åˆ° $112 \times 112$ï¼‰ï¼Œå‡å°‘åç»­å±‚çš„è®¡ç®—é‡</li>
          <li><strong>æ„å»ºä¸å˜æ€§</strong>ï¼šå›¾åƒåˆ†ç±»ä»»åŠ¡ä¸­ï¼ŒçŒ«çš„ä½ç½®ä¸åº”è¯¥å½±å“"è¿™æ˜¯ä¸€åªçŒ«"çš„åˆ¤æ–­</li>
        </ol>
        
        <p><strong>æ± åŒ–æ˜¯ç­‰å˜è¿˜æ˜¯ä¸å˜ï¼Ÿ</strong></p>
        <ul>
          <li><strong>å±€éƒ¨æ± åŒ–</strong>ï¼ˆå¦‚ $2 \times 2$ max poolingï¼‰ï¼šä»ç„¶æ˜¯<strong>ç­‰å˜</strong>çš„ï¼è¾“å…¥å¹³ç§» â†’ è¾“å‡ºä¹Ÿå¹³ç§»ï¼ˆåªæ˜¯åˆ†è¾¨ç‡æ›´ä½ï¼‰</li>
          <li><strong>å…¨å±€æ± åŒ–</strong>ï¼ˆglobal average poolingï¼‰ï¼šå®Œå…¨<strong>ä¸å˜</strong> â€” æ— è®ºå›¾åƒå¦‚ä½•å¹³ç§»ï¼Œè¾“å‡ºéƒ½æ˜¯æ‰€æœ‰ç‰¹å¾çš„å¹³å‡å€¼</li>
        </ul>
        
        <p><strong>ç”Ÿæ´»ç±»æ¯”</strong>ï¼š</p>
        <ul>
          <li><strong>å±€éƒ¨æ± åŒ–</strong> = ç”¨ä½åˆ†è¾¨ç‡ç›¸æœºæ‹ç…§ï¼šç‰©ä½“ä½ç½®å…³ç³»ä¿ç•™ï¼Œä½†ç»†èŠ‚æ¨¡ç³Š</li>
          <li><strong>å…¨å±€æ± åŒ–</strong> = è®¡ç®—ç…§ç‰‡çš„"å¹³å‡äº®åº¦"ï¼šå®Œå…¨å¿½ç•¥ä½ç½®ä¿¡æ¯</li>
        </ul>
        
        <p><strong>ä¸åŒæ± åŒ–ç­–ç•¥</strong>ï¼š</p>
        <ul>
          <li><strong>Max pooling</strong>ï¼š$y = \max\{x_1, x_2, x_3, x_4\}$ â€” ä¿ç•™æœ€å¼ºç‰¹å¾ï¼Œå¯¹å™ªå£°é²æ£’</li>
          <li><strong>Average pooling</strong>ï¼š$y = \frac{1}{4}(x_1 + x_2 + x_3 + x_4)$ â€” å¹³æ»‘ç‰¹å¾ï¼Œå‡å°‘è¿‡æ‹Ÿåˆ</li>
          <li><strong>å¯å­¦ä¹ æ± åŒ–</strong>ï¼š$y = \sum_i \alpha_i x_i$ï¼Œå…¶ä¸­ $\alpha_i$ å¯å­¦ä¹  â€” æœ€çµæ´»ä½†å¯èƒ½è¿‡æ‹Ÿåˆ</li>
        </ul>
        
        <p><strong>åœ¨ GDL æ¡†æ¶ä¸­</strong>ï¼šæ± åŒ–å¯ä»¥çœ‹ä½œ<strong>ç²—åŒ–ç®—å­</strong> $P: \mathcal{X}(\Omega) \to \mathcal{X}(\Omega')$ï¼Œå°†é«˜åˆ†è¾¨ç‡åŸŸ $\Omega$ æ˜ å°„åˆ°ä½åˆ†è¾¨ç‡åŸŸ $\Omega'$ã€‚å®ƒä»ç„¶æ˜¯<strong>çº¿æ€§ç­‰å˜</strong>çš„ï¼ˆåœ¨ç²—åŒ–æ„ä¹‰ä¸‹ï¼‰ã€‚</p>
      </div>
    </div>
  </div>

  <div class="enrichment-intuition">
    <h4>ğŸ¯ ç›´è§‰ç†è§£ï¼šCNN çš„ä¸‰ä¸ªå…³é”®æ€§è´¨</h4>
    <p><strong>1. å±€éƒ¨æ€§</strong>ï¼ˆLocalityï¼‰ï¼šæ¯ä¸ªå·ç§¯æ ¸åªçœ‹å°é‚»åŸŸï¼ˆå¦‚ $3 \times 3$ï¼‰ï¼Œå°±åƒä½ ç”¨æ”¾å¤§é•œé€å—æ£€æŸ¥å›¾åƒã€‚<strong>ç±»æ¯”</strong>ï¼šåŒ»ç”Ÿç”¨å¬è¯Šå™¨æ£€æŸ¥å¿ƒè„ï¼Œæ¯æ¬¡åªå¬å±€éƒ¨åŒºåŸŸï¼Œè€Œä¸æ˜¯åŒæ—¶å¬å…¨èº«ã€‚</p>
    
    <p><strong>2. æƒé‡å…±äº«</strong>ï¼ˆWeight Sharingï¼‰ï¼šåŒä¸€ä¸ªæ»¤æ³¢å™¨åœ¨æ•´å¼ å›¾ä¸Šæ»‘åŠ¨ï¼Œå‚æ•°å¤ç”¨ã€‚<strong>ç±»æ¯”</strong>ï¼šç”¨åŒä¸€æŠŠå°ºå­æµ‹é‡æ‰€æœ‰ç‰©ä½“çš„é•¿åº¦ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªç‰©ä½“å‡†å¤‡ä¸€æŠŠä¸“ç”¨å°ºå­ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ CNN æ¯”å…¨è¿æ¥å±‚å‚æ•°å°‘<strong>å‡ åƒå€</strong>ã€‚</p>
    
    <p><strong>3. å¹³ç§»ç­‰å˜æ€§</strong>ï¼ˆTranslation Equivarianceï¼‰ï¼šæ£€æµ‹åˆ°çš„ç‰¹å¾éšè¾“å…¥ä½ç½®ç§»åŠ¨è€Œç§»åŠ¨ã€‚<strong>ç±»æ¯”</strong>ï¼šæ— è®ºçŒ«åœ¨ç…§ç‰‡å·¦è¾¹è¿˜æ˜¯å³è¾¹ï¼Œå·ç§¯ç¥ç»ç½‘ç»œéƒ½èƒ½åœ¨å¯¹åº”ä½ç½®è¯†åˆ«å‡º"çŒ«è€³æœµ"ç‰¹å¾ã€‚</p>
    
    <p><strong>ä¸ºä»€ä¹ˆè¿™ä¸‰ä¸ªæ€§è´¨åœ¨è§†è§‰ä»»åŠ¡ä¸­æœ‰æ•ˆï¼Ÿ</strong></p>
    <ul>
      <li>å›¾åƒçš„<strong>è¾¹ç¼˜ã€çº¹ç†</strong>æ˜¯å±€éƒ¨çš„</li>
      <li>åŒæ ·çš„è§†è§‰æ¨¡å¼ï¼ˆå¦‚"åœ†å½¢"ï¼‰å¯ä»¥å‡ºç°åœ¨å›¾åƒä»»ä½•ä½ç½®</li>
      <li>é«˜å±‚ç‰¹å¾ï¼ˆå¦‚"çœ¼ç›"ï¼‰ç”±ä½å±‚ç‰¹å¾ï¼ˆå¦‚"è¾¹ç¼˜"ï¼‰ç»„åˆè€Œæˆ â†’ å±‚æ¬¡ç»“æ„</li>
    </ul>
  </div>

  <div class="enrichment-application">
    <h4>ğŸ¥ åŒ»ç–—æœºå™¨äººåº”ç”¨ï¼šCNN åœ¨åŒ»å­¦å½±åƒä¸­çš„ä½œç”¨</h4>
    <p><strong>åœºæ™¯</strong>ï¼šCT/MRI å›¾åƒçš„ç—…ç¶æ£€æµ‹</p>
    <ul>
      <li><strong>å¹³ç§»ç­‰å˜æ€§</strong>ï¼šè‚¿ç˜¤å¯èƒ½åœ¨è‚ºéƒ¨ä»»ä½•ä½ç½®ï¼ŒCNN ä¸éœ€è¦ä¸ºæ¯ä¸ªä½ç½®å•ç‹¬è®­ç»ƒ</li>
      <li><strong>å¤šå°ºåº¦å¤„ç†</strong>ï¼šç”¨ä¸åŒå¤§å°çš„å·ç§¯æ ¸ï¼ˆ$3 \times 3$, $5 \times 5$ï¼‰æˆ–æ± åŒ–å±‚æ•æ‰ä¸åŒå°ºåº¦çš„ç—…å˜ï¼ˆå°ç»“èŠ‚ vs å¤§è‚¿å—ï¼‰</li>
      <li><strong>3D å·ç§¯</strong>ï¼šåŒ»å­¦å›¾åƒæ˜¯ 3D ä½“ç´ ï¼ˆvoxelï¼‰ï¼Œç”¨ 3D CNNï¼ˆå¦‚ 3D U-Netï¼‰å¤„ç†æ•´ä¸ªä½“ç§¯æ•°æ®</li>
    </ul>
    
    <p><strong>PhysRobot é¡¹ç›®å…³è”</strong>ï¼š</p>
    <ul>
      <li>è™½ç„¶æˆ‘ä»¬çš„<strong>ç²’å­ç³»ç»Ÿ</strong>ä¸»è¦ç”¨ GNNï¼ˆå› ä¸ºç²’å­é—´æ˜¯éè§„åˆ™å›¾ç»“æ„ï¼‰ï¼Œä½†å¦‚æœè¦å¤„ç†<strong>ä½“ç´ åŒ–çš„è½¯ç»„ç»‡</strong>ï¼ˆå¦‚å™¨å®˜ç½‘æ ¼ï¼‰ï¼Œå¯ä»¥ç”¨ 3D CNN æå–å½¢çŠ¶ç‰¹å¾</li>
      <li>CNN çš„<strong>æ®‹å·®è¿æ¥</strong>æ€æƒ³ç›´æ¥åº”ç”¨äºæˆ‘ä»¬çš„ <code>DynamicalGNN</code>ï¼ˆ$x' = x + \Delta x$ï¼‰</li>
      <li><strong>å±‚æ¬¡åŒ–ç‰¹å¾å­¦ä¹ </strong>ï¼šä½å±‚æ•æ‰å±€éƒ¨æ¥è§¦åŠ›ï¼Œé«˜å±‚æ•æ‰å…¨å±€è¿åŠ¨æ¨¡å¼</li>
    </ul>
  </div>
</div>

<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šResNet æ®‹å·®è¿æ¥ = ODE ç¦»æ•£åŒ–ï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼š$\mathbf{h} = \mathbf{x} + \sigma(F(\mathbf{x}))$ ä¸ºä»€ä¹ˆèƒ½è®©ç½‘ç»œå˜å¾—å¾ˆæ·±ï¼Ÿä¸ºä»€ä¹ˆè¯´å®ƒæ˜¯"ODE çš„å‰å‘æ¬§æ‹‰ç¦»æ•£åŒ–"ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>é—®é¢˜èƒŒæ™¯</strong>ï¼šåœ¨ ResNet ä¹‹å‰ï¼ˆ2015å¹´å‰ï¼‰ï¼Œæ·±åº¦ç½‘ç»œå¾ˆéš¾è®­ç»ƒâ€”â€”å±‚æ•°è¶…è¿‡ 20 å±‚å°±å¼€å§‹<strong>é€€åŒ–</strong>ï¼ˆè®­ç»ƒè¯¯å·®åè€Œä¸Šå‡ï¼‰ã€‚ResNet é€šè¿‡"æ®‹å·®è¿æ¥"è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œè®­ç»ƒå‡ºäº† 152 å±‚ç”šè‡³ 1000+ å±‚çš„ç½‘ç»œã€‚</p>
        
        <p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šä¸è¦è®©ç½‘ç»œç›´æ¥å­¦ä¹ ç›®æ ‡å‡½æ•° $H(\mathbf{x})$ï¼Œè€Œæ˜¯å­¦ä¹ <strong>æ®‹å·®</strong> $F(\mathbf{x}) = H(\mathbf{x}) - \mathbf{x}$ï¼Œå³"è¾“å…¥åˆ°è¾“å‡ºçš„å˜åŒ–é‡"ã€‚</p>
        
        <p><strong>ä¸ºä»€ä¹ˆæœ‰æ•ˆï¼Ÿ</strong></p>
        <ol>
          <li><strong>æ›´å®¹æ˜“ä¼˜åŒ–</strong>ï¼šå¦‚æœç›®æ ‡å‡½æ•°æ¥è¿‘æ’ç­‰æ˜ å°„ï¼ˆ$H(\mathbf{x}) \approx \mathbf{x}$ï¼‰ï¼Œæ®‹å·®ç½‘ç»œåªéœ€è¦è®© $F(\mathbf{x}) \approx 0$ï¼Œè¿™æ¯”ç›´æ¥æ‹Ÿåˆ $H(\mathbf{x})$ ç®€å•å¾—å¤šã€‚</li>
          <li><strong>æ¢¯åº¦æµé€šç•…</strong>ï¼šåå‘ä¼ æ’­æ—¶ï¼Œæ¢¯åº¦å¯ä»¥é€šè¿‡"æ·å¾„"ï¼ˆskip connectionï¼‰ç›´æ¥ä¼ åˆ°å‰é¢çš„å±‚ï¼Œé¿å…æ¢¯åº¦æ¶ˆå¤±ï¼š
          $$\frac{\partial \mathbf{h}}{\partial \mathbf{x}} = I + \frac{\partial \sigma(F(\mathbf{x}))}{\partial \mathbf{x}}$$
          å³ä½¿ $F$ çš„æ¢¯åº¦å¾ˆå°ï¼Œ$I$ é¡¹ä¿è¯æ¢¯åº¦è‡³å°‘ä¸º 1ã€‚</li>
        </ol>
        
        <p><strong>ODE è§†è§’</strong>ï¼šå°†æ·±åº¦ç½‘ç»œçœ‹ä½œè¿ç»­åŠ¨åŠ›ç³»ç»Ÿ $\dot{\mathbf{x}}(t) = f(\mathbf{x}(t), \theta(t))$ï¼Œå…¶ä¸­ $t$ æ˜¯"æ·±åº¦"ï¼ˆå±‚æ•°ï¼‰ã€‚æ®‹å·®è¿æ¥æ­£æ˜¯è¿™ä¸ª ODE çš„<strong>å‰å‘æ¬§æ‹‰ç¦»æ•£åŒ–</strong>ï¼š</p>
        $$\mathbf{x}_{t+\Delta t} = \mathbf{x}_t + \Delta t \cdot f(\mathbf{x}_t) \quad \Leftrightarrow \quad \mathbf{h} = \mathbf{x} + \sigma(F(\mathbf{x}))$$
        
        <p>è¿™å¯å‘äº† <strong>Neural ODE</strong>ï¼ˆChen et al., 2018ï¼‰ï¼šç”¨ ODE æ±‚è§£å™¨ä»£æ›¿ç¦»æ•£å±‚å †å ï¼Œå¯ä»¥è®­ç»ƒ"è¿ç»­æ·±åº¦"çš„ç½‘ç»œï¼</p>
        
        <p><strong>æ•°å­¦ç»†èŠ‚</strong>ï¼šå¦‚æœè®¾ $\Delta t = 1$ï¼ˆæ¯å±‚çš„æ­¥é•¿ï¼‰ï¼ŒResNet çš„ä¸€å±‚å°±æ˜¯ï¼š
        $$\mathbf{x}_{l+1} = \mathbf{x}_l + f(\mathbf{x}_l, \theta_l)$$
        æ·±åº¦ $L$ çš„ç½‘ç»œè¾“å‡ºæ˜¯åˆå€¼é—®é¢˜çš„è§£ï¼š
        $$\mathbf{x}_L = \mathbf{x}_0 + \sum_{l=0}^{L-1} f(\mathbf{x}_l, \theta_l) \approx \mathbf{x}_0 + \int_0^L f(\mathbf{x}(t), \theta(t)) dt$$
        </p>
      </div>
    </div>
  </div>

  <div class="enrichment-intuition">
    <h4>ğŸ¯ ç›´è§‰ç±»æ¯”ï¼šResNet = é«˜é€Ÿå…¬è·¯</h4>
    <p>æƒ³è±¡ä¿¡æ¯æµæ˜¯æ±½è½¦ï¼Œç½‘ç»œå±‚æ˜¯æ”¶è´¹ç«™ï¼š</p>
    <ul>
      <li><strong>ä¼ ç»Ÿç½‘ç»œ</strong>ï¼šæ±½è½¦å¿…é¡»ç»è¿‡æ¯ä¸ªæ”¶è´¹ç«™ï¼ˆæ¯å±‚éƒ½å¼ºåˆ¶å˜æ¢ä¿¡æ¯ï¼‰ï¼Œå¦‚æœæ”¶è´¹ç«™å¤ªå¤šï¼Œæ±½è½¦ä¼šå› ä¸ºé¢‘ç¹åˆ¹è½¦å¯åŠ¨è€Œå˜æ…¢ï¼ˆæ¢¯åº¦æ¶ˆå¤±ï¼‰</li>
      <li><strong>ResNet</strong>ï¼šåœ¨æ”¶è´¹ç«™æ—è¾¹ä¿®äº†<strong>é«˜é€Ÿå…¬è·¯</strong>ï¼ˆskip connectionï¼‰ï¼Œæ±½è½¦å¯ä»¥é€‰æ‹©ï¼šç»è¿‡æ”¶è´¹ç«™ï¼ˆ$F(\mathbf{x})$ï¼‰æˆ–èµ°é«˜é€Ÿï¼ˆ$\mathbf{x}$ï¼‰ï¼Œæœ€ç»ˆæ˜¯ä¸¤æ¡è·¯çš„å åŠ ï¼ˆ$\mathbf{x} + F(\mathbf{x})$ï¼‰</li>
      <li>å¦‚æœæŸä¸ªæ”¶è´¹ç«™æ²¡ç”¨ï¼ˆ$F(\mathbf{x}) \approx 0$ï¼‰ï¼Œæ±½è½¦ç›´æ¥èµ°é«˜é€Ÿç»•è¿‡ï¼Œä¸å½±å“åç»­æ—…ç¨‹</li>
    </ul>
  </div>
</div>
<!-- === END ENRICHMENT: sec5-1 === -->


    <h3 id="cnn-group-theory">ç»å…¸ CNN çš„ç¾¤è®ºè§£é‡Šï¼šå¹³ç§»ç­‰å˜æ€§</h3>

    <p>CNN çš„æ ¸å¿ƒæ•°å­¦æ€§è´¨æ˜¯<strong>å¹³ç§»ç­‰å˜æ€§</strong>ï¼ˆTranslation Equivarianceï¼‰ã€‚è®©æˆ‘ä»¬ä»ç¾¤è®ºçš„è§†è§’ä¸¥æ ¼ç†è§£è¿™ä¸€ç‚¹ã€‚</p>

    <div class="blueprint">
      <h4>å¹³ç§»ç­‰å˜æ€§çš„ä¸¥æ ¼å®šä¹‰</h4>
      <p>è®¾ $\rho(t)$ æ˜¯å¹³ç§»ç¾¤ $(\mathbb{Z}^2, +)$ åœ¨ä¿¡å·ç©ºé—´ $\mathcal{X}(\Omega)$ ä¸Šçš„è¡¨ç¤ºã€‚å¦‚æœå¯¹æ‰€æœ‰å¹³ç§» $t$ éƒ½æœ‰ï¼š</p>
      $$F(\rho(t)\mathbf{x}) = \rho(t)F(\mathbf{x})$$
      <p>åˆ™ç§° $F$ æ˜¯<span class="term">å¹³ç§»ç­‰å˜</span>çš„ã€‚ç›´è§‰ä¸Šï¼šå…ˆå¹³ç§»å›¾åƒå†å·ç§¯ = å…ˆå·ç§¯å†å¹³ç§»ç»“æœã€‚</p>
    </div>

    <p>è€ƒè™‘æ ‡é‡å€¼ï¼ˆå•é€šé“/ç°åº¦ï¼‰ç¦»æ•£åŒ–å›¾åƒï¼Œå…¶ä¸­åŸŸæ˜¯ç½‘æ ¼ $\Omega = [H] \times [W]$ï¼Œ$\mathbf{u} = (u_1, u_2)$ï¼Œ$\mathbf{x} \in \mathcal{X}(\Omega, \mathbb{R})$ã€‚</p>

    <p>ä»»ä½•å…·æœ‰ç´§æ”¯æ’‘æ»¤æ³¢å™¨ï¼ˆå¤§å° $H^f \times W^f$ï¼‰çš„å·ç§¯éƒ½å¯ä»¥å†™æˆ<strong>ç”Ÿæˆå…ƒ</strong>çš„çº¿æ€§ç»„åˆ $\theta_{1,1}, \ldots, \theta_{H^f, W^f}$ï¼Œæ¯ä¸ªç”Ÿæˆå…ƒç”±å•ä½è„‰å†²ç»™å‡ºï¼š</p>

    <div class="math-block">
      $$\theta_{vw}(u_1, u_2) = \delta(u_1 - v, u_2 - w)$$
      <div class="math-explain">
        $\delta$ æ˜¯ Dirac deltaï¼ˆåœ¨ç¦»æ•£æƒ…å†µä¸‹æ˜¯ Kronecker deltaï¼‰ï¼Œ$\theta_{vw}$ æ˜¯åœ¨ä½ç½® $(v, w)$ å¤„å€¼ä¸º 1ã€å…¶ä½™å¤„å€¼ä¸º 0 çš„"è„‰å†²"æ»¤æ³¢å™¨ã€‚
      </div>
    </div>

    <p>å› æ­¤ï¼Œ<strong>ä»»ä½•å±€éƒ¨çº¿æ€§ç­‰å˜æ˜ å°„</strong>éƒ½å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>

    <div class="math-block">
      $$F(\mathbf{x}) = \sum_{v=1}^{H^f} \sum_{w=1}^{W^f} \alpha_{vw} C(\theta_{vw}) \mathbf{x} \tag{26}$$
      <div class="math-explain">
        è¿™é‡Œ $C(\theta_{vw})$ æ˜¯å¾ªç¯çŸ©é˜µï¼Œ$\alpha_{vw}$ æ˜¯å¯å­¦ä¹ çš„æ»¤æ³¢å™¨æƒé‡ã€‚æ³¨æ„ $\mathbf{x}$ å’Œ $\theta_{vw}$ è™½ç„¶é€šå¸¸æ˜¯ 2D çŸ©é˜µï¼Œä½†åœ¨æ­¤æ–¹ç¨‹ä¸­è¢«å±•å¹³æˆå‘é‡/çŸ©é˜µã€‚
      </div>
    </div>

    <p>åœ¨åæ ‡ä¸­å±•å¼€ï¼Œå¾—åˆ°ç†Ÿæ‚‰çš„ <strong>2D å·ç§¯</strong>ï¼š</p>

    <div class="math-block">
      $$F(\mathbf{x})_{uv} = \sum_{a=1}^{H^f} \sum_{b=1}^{W^f} \alpha_{ab} \, x_{u+a, v+b} \tag{27}$$
    </div>

    <div class="derivation">
      <h4>é€æ­¥æ¨å¯¼ï¼šä¸ºä»€ä¹ˆå·ç§¯ = å¹³ç§»ç­‰å˜</h4>
      <div class="step"><span class="step-num">1</span>è®¾å¹³ç§»ç®—å­ $T_t[\mathbf{x}](u) = \mathbf{x}(u - t)$ï¼Œå¯¹ä¿¡å·æ–½åŠ å¹³ç§» $t = (t_1, t_2)$ã€‚</div>
      <div class="step"><span class="step-num">2</span>å·ç§¯æ“ä½œï¼š$(T_t[\mathbf{x}] \star \theta)(u) = \sum_v (T_t[\mathbf{x}])(v) \cdot \theta(u-v) = \sum_v \mathbf{x}(v - t) \cdot \theta(u-v)$</div>
      <div class="step"><span class="step-num">3</span>ä»¤ $w = v - t$ï¼Œåˆ™ $v = w + t$ï¼š$= \sum_w \mathbf{x}(w) \cdot \theta(u - t - w) = (\mathbf{x} \star \theta)(u - t)$</div>
      <div class="step"><span class="step-num">4</span>å³ $T_t[\mathbf{x}] \star \theta = T_t[\mathbf{x} \star \theta]$ï¼Œå¹³ç§»å’Œå·ç§¯<strong>å¯äº¤æ¢</strong>ã€‚âœ… ç­‰å˜æ€§æˆç«‹ã€‚</div>
    </div>

    <p>å½“è¾“å…¥ä»å•é€šé“æ‰©å±•åˆ°<strong>å¤šé€šé“</strong>ï¼ˆå¦‚ RGBï¼‰ï¼Œå·ç§¯æ»¤æ³¢å™¨å˜æˆå¼ é‡ï¼š</p>

    <div class="math-block">
      $$F(\mathbf{x})_{uvj} = \sum_{a=1}^{H^f} \sum_{b=1}^{W^f} \sum_{c=1}^{M} \alpha_{jabc} \, x_{u+a, v+b, c}, \quad j \in [N] \tag{28}$$
      <div class="math-explain">
        $M$ æ˜¯è¾“å…¥é€šé“æ•°ï¼Œ$N$ æ˜¯è¾“å‡ºé€šé“æ•°ã€‚$\alpha_{jabc}$ æ˜¯ä¸€ä¸ª 4D å¼ é‡ï¼šç¬¬ $j$ ä¸ªè¾“å‡ºé€šé“ç”±æ‰€æœ‰ $M$ ä¸ªè¾“å…¥é€šé“å’Œ $H^f \times W^f$ ä¸ªç©ºé—´ä½ç½®çš„çº¿æ€§ç»„åˆå†³å®šã€‚
      </div>
    </div>

    <div class="symbol-table">
      <h4>Â§5.1 ç¬¦å·è¡¨</h4>
      <table>
        <thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>ç±»å‹</th></tr></thead>
        <tbody>
          <tr><td>$\Omega = [H] \times [W]$</td><td>2D å›¾åƒåŸŸï¼ˆç½‘æ ¼ï¼‰</td><td>é›†åˆ</td></tr>
          <tr><td>$\mathbf{x} \in \mathcal{X}(\Omega, \mathbb{R})$</td><td>åŸŸä¸Šçš„æ ‡é‡ä¿¡å·ï¼ˆç°åº¦å›¾ï¼‰</td><td>å‡½æ•°</td></tr>
          <tr><td>$C(\theta)$</td><td>å¾ªç¯çŸ©é˜µï¼Œå‚æ•°ä¸º $\theta$</td><td>çŸ©é˜µ</td></tr>
          <tr><td>$\alpha_{vw}$</td><td>å¯å­¦ä¹ çš„å·ç§¯æ ¸æƒé‡</td><td>æ ‡é‡</td></tr>
          <tr><td>$H^f, W^f$</td><td>æ»¤æ³¢å™¨çš„é«˜åº¦å’Œå®½åº¦</td><td>æ•´æ•°</td></tr>
          <tr><td>$T_t$</td><td>å¹³ç§»ç®—å­ï¼Œå¹³ç§»é‡ $t$</td><td>ç®—å­</td></tr>
          <tr><td>$\sigma$</td><td>éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ ReLUï¼‰</td><td>å‡½æ•°</td></tr>
          <tr><td>$P$</td><td>æ± åŒ–/ç²—åŒ–ç®—å­</td><td>ç®—å­</td></tr>
        </tbody>
      </table>
    </div>

    <h3 id="cnn-convolution-theorem">å·ç§¯å®šç†ï¼šç©ºåŸŸ vs é¢‘åŸŸ</h3>

    <p>å·ç§¯æœ‰ä¸€ä¸ªæå…¶ä¼˜ç¾çš„æ€§è´¨ï¼Œå°†<strong>ç©ºåŸŸçš„å·ç§¯</strong>ä¸<strong>é¢‘åŸŸçš„é€å…ƒç´ ä¹˜æ³•</strong>è”ç³»èµ·æ¥ã€‚è¿™å°±æ˜¯<span class="term">å·ç§¯å®šç†</span>ï¼ˆConvolution Theoremï¼‰ã€‚</p>

    <div class="math-block">
      $$\mathcal{F}[\mathbf{x} \star \theta] = \mathcal{F}[\mathbf{x}] \odot \mathcal{F}[\theta]$$
      <div class="math-explain">
        ç©ºåŸŸå·ç§¯ï¼ˆ$O(n^2)$ å¤æ‚åº¦ï¼‰ç­‰ä»·äºå…ˆåš Fourier å˜æ¢ï¼Œå†é€å…ƒç´ ç›¸ä¹˜ï¼Œå†åšé€† Fourier å˜æ¢ã€‚ä½¿ç”¨ FFT å¯ä»¥å°†å·ç§¯çš„å¤æ‚åº¦ä» $O(n^2)$ é™åˆ° $O(n \log n)$ã€‚$\odot$ è¡¨ç¤ºé€å…ƒç´ ä¹˜æ³•ï¼ˆHadamard ä¹˜ç§¯ï¼‰ã€‚
      </div>
    </div>

    <div class="derivation">
      <h4>å·ç§¯å®šç†çš„æ¨å¯¼ï¼ˆ1D æƒ…å½¢ï¼‰</h4>
      <div class="step"><span class="step-num">1</span>ç¦»æ•£ Fourier å˜æ¢å®šä¹‰ï¼š$\hat{x}[k] = \sum_{n=0}^{N-1} x[n] \, e^{-i 2\pi kn / N}$</div>
      <div class="step"><span class="step-num">2</span>å·ç§¯å®šä¹‰ï¼š$(x \star \theta)[m] = \sum_{n=0}^{N-1} x[n] \, \theta[m - n]$</div>
      <div class="step"><span class="step-num">3</span>å¯¹å·ç§¯ç»“æœåš DFTï¼š
        $\mathcal{F}[x \star \theta][k] = \sum_{m} \left(\sum_{n} x[n] \theta[m-n]\right) e^{-i2\pi km/N}$</div>
      <div class="step"><span class="step-num">4</span>äº¤æ¢æ±‚å’Œé¡ºåºï¼š$= \sum_n x[n] \sum_m \theta[m-n] e^{-i2\pi km/N}$</div>
      <div class="step"><span class="step-num">5</span>ä»¤ $p = m - n$ï¼š$= \sum_n x[n] e^{-i2\pi kn/N} \sum_p \theta[p] e^{-i2\pi kp/N} = \hat{x}[k] \cdot \hat{\theta}[k]$</div>
      <div class="step"><span class="step-num">6</span>å› æ­¤ $\mathcal{F}[x \star \theta] = \hat{x} \odot \hat{\theta}$ âœ…</div>
    </div>

    <h3 id="cnn-pooling">æ± åŒ–ä½œä¸ºä¸å˜æ€§æ˜ å°„</h3>

    <p>å·ç§¯æ˜¯<strong>ç­‰å˜</strong>çš„â€”â€”è¾“å‡ºéšè¾“å…¥å¹³ç§»è€Œå¹³ç§»ã€‚ä½†è®¸å¤šä»»åŠ¡éœ€è¦<strong>ä¸å˜æ€§</strong>ï¼ˆå¦‚å›¾åƒåˆ†ç±»ï¼šå¹³ç§»å›¾åƒä¸åº”æ”¹å˜åˆ†ç±»ç»“æœï¼‰ã€‚è¿™å°±æ˜¯<span class="term">æ± åŒ–</span>ï¼ˆPoolingï¼‰çš„è§’è‰²ã€‚</p>

    <p>CNN å±‚çš„å®Œæ•´å…¬å¼ï¼š</p>

    <div class="math-block">
      $$\mathbf{h} = P(\sigma(F(\mathbf{x}))) \tag{29}$$
      <div class="math-explain">
        ä¸‰æ­¥ç»„åˆï¼šç­‰å˜çº¿æ€§å±‚ $F$ï¼ˆå·ç§¯ï¼‰â†’ éçº¿æ€§ $\sigma$ï¼ˆå¦‚ ReLUï¼‰â†’ ç²—åŒ–/æ± åŒ– $P$ã€‚æ± åŒ–å°†é«˜åˆ†è¾¨ç‡ç½‘æ ¼ $\Omega$ æ˜ å°„åˆ°ä½åˆ†è¾¨ç‡ç½‘æ ¼ $\Omega'$ï¼Œç­‰æ•ˆäºå¢å¤§æ„Ÿå—é‡ã€‚å¸¸è§çš„æ± åŒ–ç­–ç•¥ï¼šä½é€šæŠ—æ··å æ»¤æ³¢ï¼ˆå±€éƒ¨å¹³å‡ï¼‰+ ç½‘æ ¼é™é‡‡æ ·ï¼Œæˆ–éçº¿æ€§æœ€å¤§æ± åŒ–ã€‚
      </div>
    </div>

    <div class="flow">
      <div class="flow-box">è¾“å…¥ $\mathbf{x}$</div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">å·ç§¯ $F$<br><small>ç­‰å˜</small></div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">æ¿€æ´» $\sigma$<br><small>é€å…ƒç´ </small></div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">æ± åŒ– $P$<br><small>ç²—åŒ–</small></div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">è¾“å‡º $\mathbf{h}$</div>
    </div>

    <p><strong>å…¨å±€æ± åŒ–</strong>ï¼ˆGlobal Poolingï¼‰å®ç°å®Œå…¨çš„å¹³ç§»ä¸å˜æ€§ï¼šå¯¹æ‰€æœ‰ç©ºé—´ä½ç½®æ±‚å¹³å‡/æœ€å¤§å€¼ï¼Œè¾“å‡ºä¸è¾“å…¥ä½ç½®æ— å…³ã€‚</p>

    <h3 id="cnn-resnet">æ·±åº¦ç½‘ç»œä¸æ®‹å·®è¿æ¥</h3>

    <p>He et al. (2016) çš„å…³é”®æ´å¯Ÿï¼šå°†æ¯ä¸€å±‚é‡æ–°å‚æ•°åŒ–ä¸ºå¯¹å‰ä¸€å±‚ç‰¹å¾çš„<strong>æ‰°åŠ¨</strong>ï¼Œè€Œéé€šç”¨çš„éçº¿æ€§å˜æ¢ï¼š</p>

    <div class="math-block">
      $$\mathbf{h} = P(\mathbf{x} + \sigma(F(\mathbf{x}))) \tag{30}$$
      <div class="math-explain">
        æ®‹å·®ç½‘ç»œï¼ˆResNetï¼‰çš„æ ¸å¿ƒã€‚ç½‘ç»œå­¦ä¹ çš„æ˜¯<strong>æ®‹å·®</strong> $\sigma(F(\mathbf{x}))$â€”â€”å³è¾“å…¥çš„"å˜åŒ–é‡"ã€‚è¿™ä¸å°†æ·±åº¦ç½‘ç»œè§†ä¸º<strong>å¸¸å¾®åˆ†æ–¹ç¨‹ (ODE)</strong> çš„ç¦»æ•£åŒ–å®Œå…¨ä¸€è‡´ï¼š$\dot{\mathbf{x}} = \sigma(F(\mathbf{x}))$ï¼Œæ®‹å·®è¿æ¥å°±æ˜¯å¯¹ ODE çš„å‰å‘æ¬§æ‹‰ç¦»æ•£åŒ–ã€‚
      </div>
    </div>

    <div class="figure">
      <img src="../assets/ch5_p79_img0.png" alt="CNN architectures: LeNet, AlexNet, ResNet, U-Net">
      <figcaption>å›¾ 15ï¼šç»å…¸ CNN æ¶æ„ã€‚ä»ä¸Šåˆ°ä¸‹ï¼šLeNet (1998)ã€AlexNet (2012)ã€ResNet (2016)ã€U-Net (2015)ã€‚</figcaption>
    </div>

    <h3 id="cnn-code">å®Œæ•´ä»£ç ï¼šCNN å®ç° + ç­‰å˜æ€§éªŒè¯</h3>

    <div class="code-container">
      <span class="code-label">Python / PyTorch</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code>import torch
import torch.nn as nn
import torch.nn.functional as F

# ============================================================
# 1. ä¸€ä¸ªæ ‡å‡†çš„ CNN æ¨¡å‹ï¼ˆç±»ä¼¼ LeNetï¼‰
# ============================================================
class SimpleCNN(nn.Module):
    """
    ç»å…¸ CNN æ¶æ„ï¼Œéµå¾ª GDL è“å›¾ï¼š
    Conv â†’ ReLU â†’ Pool â†’ Conv â†’ ReLU â†’ Pool â†’ FC
    
    ç­‰å˜æ€§åˆ†æï¼š
    - Conv å±‚ï¼šå¹³ç§»ç­‰å˜ âœ…
    - ReLUï¼šé€å…ƒç´ æ“ä½œï¼Œä¸ç ´åç­‰å˜æ€§ âœ…
    - Poolï¼šé™ä½åˆ†è¾¨ç‡ï¼Œä¿æŒç­‰å˜æ€§ï¼ˆaverage poolï¼‰âœ…
    - FCï¼ˆå…¨è¿æ¥ï¼‰ï¼šç ´åå¹³ç§»ä¸å˜æ€§ âŒ
      â†’ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå…¨å·ç§¯ç½‘ç»œæ›´"å‡ ä½•"
    """
    def __init__(self, in_channels=1, num_classes=10):
        super().__init__()
        # ç­‰å˜éƒ¨åˆ†
        self.conv1 = nn.Conv2d(in_channels, 32, kernel_size=3, padding=1)
        self.conv2 = nn.Conv2d(32, 64, kernel_size=3, padding=1)
        self.pool = nn.AvgPool2d(2)  # å¹³å‡æ± åŒ–æ¯”æœ€å¤§æ± åŒ–æ›´"å‡ ä½•"
        
        # ä¸å˜æ€§èšåˆï¼ˆå…¨å±€å¹³å‡æ± åŒ– â†’ å®Œå…¨å¹³ç§»ä¸å˜ï¼‰
        self.global_pool = nn.AdaptiveAvgPool2d(1)
        
        # åˆ†ç±»å¤´
        self.fc = nn.Linear(64, num_classes)
    
    def forward(self, x):
        # ç­‰å˜å±‚
        x = self.pool(F.relu(self.conv1(x)))   # (B,32,H/2,W/2)
        x = self.pool(F.relu(self.conv2(x)))   # (B,64,H/4,W/4)
        
        # ä¸å˜æ€§èšåˆ
        x = self.global_pool(x)                 # (B,64,1,1)
        x = x.view(x.size(0), -1)              # (B,64)
        
        # åˆ†ç±»
        return self.fc(x)                       # (B,10)


# ============================================================
# 2. éªŒè¯å¹³ç§»ç­‰å˜æ€§
# ============================================================
def verify_translation_equivariance():
    """éªŒè¯ CNN çš„å·ç§¯å±‚æ˜¯å¹³ç§»ç­‰å˜çš„ã€‚"""
    
    torch.manual_seed(42)
    conv = nn.Conv2d(1, 16, kernel_size=3, padding=1, bias=False)
    
    # åˆ›å»ºæµ‹è¯•å›¾åƒ
    x = torch.randn(1, 1, 32, 32)
    
    # æ–¹æ³•1ï¼šå…ˆå·ç§¯ï¼Œå†å¹³ç§»
    y = conv(x)
    y_shifted = torch.roll(y, shifts=(3, 5), dims=(2, 3))
    
    # æ–¹æ³•2ï¼šå…ˆå¹³ç§»ï¼Œå†å·ç§¯
    x_shifted = torch.roll(x, shifts=(3, 5), dims=(2, 3))
    y_from_shifted = conv(x_shifted)
    
    # æ¯”è¾ƒï¼ˆå¿½ç•¥è¾¹ç•Œæ•ˆåº”â€”â€”ä½¿ç”¨ circular padding æ—¶å®Œå…¨ç­‰ä»·ï¼‰
    # ä¸­å¿ƒåŒºåŸŸæ¯”è¾ƒï¼Œé¿å…è¾¹ç•Œæ•ˆåº”
    center = slice(4, 28)
    error = (y_shifted[:,:,center,center] - y_from_shifted[:,:,center,center]).abs().max()
    
    print(f"å¹³ç§»ç­‰å˜æ€§è¯¯å·®: {error:.2e}")
    print(f"ç­‰å˜æ€§éªŒè¯: {'âœ… é€šè¿‡' if error < 1e-5 else 'âŒ å¤±è´¥'}")
    
    return error.item()


# ============================================================
# 3. å·ç§¯å®šç†çš„æ•°å€¼éªŒè¯
# ============================================================
def verify_convolution_theorem():
    """éªŒè¯ç©ºåŸŸå·ç§¯ = é¢‘åŸŸé€å…ƒç´ ä¹˜æ³•ã€‚"""
    
    x = torch.randn(64, 64)
    theta = torch.randn(64, 64)  # é›¶å¡«å……åˆ°ç›¸åŒå¤§å°
    
    # ç©ºåŸŸå·ç§¯ï¼ˆä½¿ç”¨ FFT å®ç°çš„å¾ªç¯å·ç§¯ï¼‰
    conv_spatial = torch.fft.ifft2(
        torch.fft.fft2(x) * torch.fft.fft2(theta)
    ).real
    
    # é¢‘åŸŸæ–¹æ³•
    X_freq = torch.fft.fft2(x)
    Theta_freq = torch.fft.fft2(theta)
    conv_spectral = torch.fft.ifft2(X_freq * Theta_freq).real
    
    error = (conv_spatial - conv_spectral).abs().max()
    print(f"å·ç§¯å®šç†è¯¯å·®: {error:.2e}")
    print(f"å·ç§¯å®šç†éªŒè¯: {'âœ… é€šè¿‡' if error < 1e-5 else 'âŒ å¤±è´¥'}")


# ============================================================
# 4. æ®‹å·®ç½‘ç»œï¼ˆResNet Blockï¼‰
# ============================================================
class ResidualBlock(nn.Module):
    """
    æ®‹å·®å—ï¼šh = x + Ïƒ(F(x))
    
    å‡ ä½•è§£é‡Šï¼šè¿™æ˜¯ ODE áº‹ = Ïƒ(F(x)) çš„å‰å‘æ¬§æ‹‰ç¦»æ•£åŒ–ã€‚
    æ¯ä¸€å±‚å­¦ä¹ çš„æ˜¯"é€Ÿåº¦åœº"è€Œé"ä½ç½®"ã€‚
    """
    def __init__(self, channels):
        super().__init__()
        self.conv1 = nn.Conv2d(channels, channels, 3, padding=1)
        self.bn1 = nn.BatchNorm2d(channels)
        self.conv2 = nn.Conv2d(channels, channels, 3, padding=1)
        self.bn2 = nn.BatchNorm2d(channels)
    
    def forward(self, x):
        residual = x
        out = F.relu(self.bn1(self.conv1(x)))
        out = self.bn2(self.conv2(out))
        return F.relu(out + residual)  # h = x + Ïƒ(F(x))


if __name__ == "__main__":
    print("=" * 50)
    print("CNN ç­‰å˜æ€§éªŒè¯")
    print("=" * 50)
    verify_translation_equivariance()
    print()
    verify_convolution_theorem()
    
    print("\næ¨¡å‹æµ‹è¯•:")
    model = SimpleCNN(in_channels=1, num_classes=10)
    x = torch.randn(4, 1, 28, 28)
    out = model(x)
    print(f"è¾“å…¥: {x.shape} â†’ è¾“å‡º: {out.shape}")
    print(f"å‚æ•°é‡: {sum(p.numel() for p in model.parameters()):,}")</code></pre>
    </div>

    <div class="callout callout-project">
      <h4>ä¸ PhysRobot çš„å…³è”</h4>
      <p>è™½ç„¶æˆ‘ä»¬çš„ PhysRobot é¡¹ç›®ä¸»è¦ä½¿ç”¨ <strong>GNN è€Œé CNN</strong>ï¼Œä½† CNN çš„ç†è®ºæ¡†æ¶ä¸ºç†è§£ GNN æä¾›äº†åŸºç¡€ï¼š</p>
      <ul>
        <li>CNN çš„<strong>å±€éƒ¨æ€§</strong>ï¼ˆå°æ»¤æ³¢å™¨ï¼‰â†’ GNN ä¸­çš„<strong>é‚»åŸŸèšåˆ</strong></li>
        <li>CNN çš„<strong>æƒé‡å…±äº«</strong>ï¼ˆåŒä¸€æ»¤æ³¢å™¨éå†å…¨å›¾ï¼‰â†’ GNN ä¸­çš„<strong>å…±äº«æ¶ˆæ¯å‡½æ•°</strong></li>
        <li>CNN çš„<strong>å¤šå°ºåº¦æ± åŒ–</strong> â†’ GNN ä¸­çš„<strong>å›¾ç²—åŒ–</strong>ï¼ˆgraph coarseningï¼‰</li>
        <li>æ®‹å·®è¿æ¥åœ¨æˆ‘ä»¬çš„ <code>DynamicalGNN</code> ä¸­ä¹Ÿæœ‰ä½¿ç”¨ï¼ˆ<code>x_new = self.update_net(update_input) + x</code>ï¼‰</li>
      </ul>
    </div>


    <!-- ====================== 5.2 Group-equivariant CNN ====================== -->
    <h2 id="sec5-2">5.2 ç¾¤ç­‰å˜å·ç§¯ç¥ç»ç½‘ç»œ (G-CNN)<br><span style="font-size:0.65em;color:var(--text-secondary)">Group-equivariant Convolutional Neural Networks</span></h2>

    <div class="bilingual">
      <div class="zh">
        <p>å¦‚ Â§4.3 æ‰€è®¨è®ºï¼Œæˆ‘ä»¬å¯ä»¥å°†å·ç§¯æ“ä½œä»æ¬§å‡ é‡Œå¾—ç©ºé—´ä¸Šçš„ä¿¡å·æ¨å¹¿åˆ°<strong>ä»»ä½•é½æ¬¡ç©ºé—´ $\Omega$</strong> ä¸Šç”±ç¾¤ $G$ ä½œç”¨çš„ä¿¡å·ã€‚è¿™é‡Œçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šä¸ä»…å¹³ç§»æ»¤æ³¢å™¨ï¼Œè¿˜<strong>æ—‹è½¬ã€ç¿»è½¬</strong>æ»¤æ³¢å™¨â€”â€”ä½¿å…¶åœ¨æ•´ä¸ªç¾¤ $G$ ä¸Šç§»åŠ¨ã€‚</p>
      </div>
      <div class="en">
        We can generalise convolution from Euclidean signals to signals on any homogeneous space acted upon by a group G. The idea is to move the filter around the domain using the group actionâ€”by rotating and translating.
      </div>
    </div>

<!-- === ENRICHMENT: sec5-2 === -->
<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šä»€ä¹ˆæ˜¯"ç¾¤å·ç§¯"ï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šæ™®é€šå·ç§¯æˆ‘èƒ½ç†è§£ï¼ˆæ»‘åŠ¨çª—å£ï¼‰ï¼Œä½†"ç¾¤å·ç§¯" $(\mathbf{x} \star \theta)(g) = \sum_{u \in \Omega} x_u \, \rho(g)\theta_u$ è¿™ä¸ªå…¬å¼çœ‹ä¸æ‡‚...ä»€ä¹ˆæ˜¯ $g$ï¼Ÿä»€ä¹ˆæ˜¯ $\rho(g)$ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>å…ˆä»ç”Ÿæ´»ä¾‹å­ç†è§£</strong>ï¼šå‡è®¾ä½ æœ‰ä¸€å¼ ç…§ç‰‡ï¼Œæƒ³æ£€æµ‹é‡Œé¢çš„"ç®­å¤´"ï¼ˆâ†’ï¼‰ã€‚æ™®é€š CNN åªèƒ½æ£€æµ‹<strong>æ°´å¹³å‘å³</strong>çš„ç®­å¤´ã€‚å¦‚æœç®­å¤´æ—‹è½¬äº† 90Â°ï¼ˆå˜æˆ â†‘ï¼‰ï¼ŒCNN å°±è®¤ä¸å‡ºæ¥äº†â€”â€”é™¤éä½ åœ¨è®­ç»ƒé›†é‡Œæ”¾äº†å¤§é‡æ—‹è½¬çš„ç®­å¤´ã€‚</p>
        
        <p><strong>ç¾¤å·ç§¯çš„è§£å†³æ–¹æ¡ˆ</strong>ï¼šä¸ä»…æ»‘åŠ¨æ»¤æ³¢å™¨ï¼ˆå¹³ç§»ï¼‰ï¼Œè¿˜è¦<strong>æ—‹è½¬</strong>æ»¤æ³¢å™¨ï¼å¯¹äº p4 ç¾¤ï¼ˆå¹³ç§» + 4 ä¸ª 90Â° æ—‹è½¬ï¼‰ï¼Œä¸€ä¸ªæ»¤æ³¢å™¨ä¼šè¢«æ—‹è½¬æˆ 4 ä¸ªå‰¯æœ¬ï¼šâ†’, â†‘, â†, â†“ï¼Œç„¶ååˆ†åˆ«ä¸å›¾åƒå·ç§¯ã€‚</p>
        
        <p><strong>ç¬¦å·è§£é‡Š</strong>ï¼š</p>
        <ul>
          <li>$g \in G$ï¼šç¾¤å…ƒç´ ï¼Œä»£è¡¨ä¸€ç§å˜æ¢ã€‚ä¾‹å¦‚ $g = (t, r)$ è¡¨ç¤º"å…ˆå¹³ç§» $t$ï¼Œå†æ—‹è½¬ $r$"</li>
          <li>$\rho(g)$ï¼šç¾¤è¡¨ç¤ºï¼ˆrepresentationï¼‰ï¼ŒæŠŠæŠ½è±¡çš„ç¾¤å…ƒç´  $g$ å˜æˆå…·ä½“çš„æ“ä½œã€‚å¯¹å›¾åƒï¼š$\rho(g)\mathbf{x}$ = å¯¹å›¾åƒåšå˜æ¢ $g$</li>
          <li>$\rho(g)\theta_u = \theta_{g^{-1}u}$ï¼šæ»¤æ³¢å™¨åœ¨ä½ç½® $u$ çš„å€¼ï¼Œç»è¿‡å˜æ¢ $g$ åï¼Œåº”è¯¥å–åŸå§‹æ»¤æ³¢å™¨åœ¨ $g^{-1}u$ å¤„çš„å€¼</li>
        </ul>
        
        <p><strong>ä¸ºä»€ä¹ˆå†™æˆ $g^{-1}u$ è€Œä¸æ˜¯ $gu$ï¼Ÿ</strong>å› ä¸ºæˆ‘ä»¬è¦ä¿æŒ<strong>ç­‰å˜æ€§</strong>ï¼šå¦‚æœè¾“å…¥æ—‹è½¬äº† $g$ï¼Œè¾“å‡ºä¹Ÿåº”è¯¥æ—‹è½¬ $g$ã€‚æ•°å­¦ä¸Šéœ€è¦ç”¨<strong>é€†å˜æ¢</strong>æ¥æ­£ç¡®ç»„åˆã€‚</p>
        
        <p><strong>å…·ä½“ä¾‹å­</strong>ï¼ˆp4 ç¾¤ï¼‰ï¼š</p>
        <ul>
          <li>åŸå§‹æ»¤æ³¢å™¨ $\theta$ï¼šæ£€æµ‹ â†’ ç®­å¤´ï¼ˆ3Ã—3 çŸ©é˜µï¼‰</li>
          <li>$\rho(90Â°)\theta$ï¼šå°† $\theta$ æ—‹è½¬ 90Â° â†’ æ£€æµ‹ â†‘ ç®­å¤´</li>
          <li>$\rho(180Â°)\theta$ï¼šæ—‹è½¬ 180Â° â†’ æ£€æµ‹ â† ç®­å¤´</li>
          <li>$\rho(270Â°)\theta$ï¼šæ—‹è½¬ 270Â° â†’ æ£€æµ‹ â†“ ç®­å¤´</li>
          <li>è¾“å‡ºæœ‰ <strong>4 ä¸ªé€šé“</strong>ï¼Œæ¯ä¸ªé€šé“å¯¹åº”ä¸€ä¸ªæ–¹å‘çš„æ¿€æ´»å¼ºåº¦</li>
        </ul>
        
        <p><strong>ä¸æ ‡å‡†å·ç§¯çš„å¯¹æ¯”</strong>ï¼š</p>
        <ul>
          <li>æ ‡å‡† CNNï¼šè¾“å‡º $(x, y)$ åªè®°å½•"åœ¨ä½ç½® $(x,y)$ æ£€æµ‹åˆ°ç‰¹å¾"</li>
          <li>G-CNNï¼šè¾“å‡º $(x, y, \theta)$ è®°å½•"åœ¨ä½ç½® $(x,y)$ã€æ–¹å‘ $\theta$ æ£€æµ‹åˆ°ç‰¹å¾"</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šä¸ºä»€ä¹ˆéœ€è¦ G-CNNï¼Ÿæ—‹è½¬ç­‰å˜æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šæ•°æ®å¢å¼ºï¼ˆData Augmentationï¼‰ä¸å°±èƒ½è§£å†³æ—‹è½¬é—®é¢˜å—ï¼Ÿä¸ºä»€ä¹ˆè¿˜è¦è®¾è®¡ä¸“é—¨çš„ç¾¤ç­‰å˜ç½‘ç»œï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>æ•°æ®å¢å¼º vs ç­‰å˜ç½‘ç»œ</strong>æ˜¯ä¸¤ç§ä¸åŒçš„ç­–ç•¥ï¼š</p>
        
        <table>
          <thead><tr><th>æ–¹æ³•</th><th>åŸç†</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead>
          <tbody>
            <tr>
              <td><strong>æ•°æ®å¢å¼º</strong></td>
              <td>è®­ç»ƒæ—¶éšæœºæ—‹è½¬å›¾åƒï¼Œè®©ç½‘ç»œ"è§è¿‡"å„ç§è§’åº¦</td>
              <td>ç®€å•æ˜“ç”¨ï¼Œé€‚ç”¨äºä»»ä½•æ¨¡å‹</td>
              <td>éœ€è¦æ›´å¤šè®­ç»ƒæ•°æ®ï¼›ç½‘ç»œä»ç„¶è¦å­¦ä¹ "åŒä¸€ç‰©ä½“çš„ä¸åŒæ—‹è½¬ç‰ˆæœ¬æ˜¯ç›¸åŒçš„"</td>
            </tr>
            <tr>
              <td><strong>G-CNN</strong></td>
              <td>ç½‘ç»œç»“æ„æœ¬èº«ä¿è¯æ—‹è½¬ç­‰å˜æ€§</td>
              <td>æ ·æœ¬æ•ˆç‡é«˜ï¼ˆå°‘é‡æ•°æ®å°±èƒ½æ³›åŒ–ï¼‰ï¼›ç†è®ºä¿è¯</td>
              <td>å®ç°å¤æ‚ï¼›è®¡ç®—é‡ç¨å¤§ï¼ˆéœ€å¤„ç†å¤šä¸ªæ–¹å‘é€šé“ï¼‰</td>
            </tr>
          </tbody>
        </table>
        
        <p><strong>å…³é”®åŒºåˆ«</strong>ï¼š</p>
        <ul>
          <li>æ•°æ®å¢å¼ºï¼šç½‘ç»œé€šè¿‡<strong>ç»éªŒ</strong>å­¦ä¹ åˆ°æ—‹è½¬ä¸å˜æ€§ï¼ˆ"æˆ‘è§è¿‡å¾ˆå¤šæ—‹è½¬çš„çŒ«ï¼Œæ‰€ä»¥çŸ¥é“æ—‹è½¬åè¿˜æ˜¯çŒ«"ï¼‰</li>
          <li>G-CNNï¼šæ—‹è½¬ç­‰å˜æ€§æ˜¯<strong>ç¡¬ç¼–ç </strong>åœ¨ç½‘ç»œç»“æ„ä¸­çš„ï¼ˆ"æ ¹æ®å®šä¹‰ï¼Œæ—‹è½¬è¾“å…¥å¿…ç„¶å¯¼è‡´è¾“å‡ºæ—‹è½¬"ï¼‰</li>
        </ul>
        
        <p><strong>æ•°å­¦ä¸Šçš„å·®å¼‚</strong>ï¼š</p>
        <ul>
          <li>æ ‡å‡† CNN + æ•°æ®å¢å¼ºï¼š$F(R_\theta \mathbf{x}) \stackrel{\text{hope}}{\approx} F(\mathbf{x})$ï¼ˆå¸Œæœ›å­¦åˆ°è¿‘ä¼¼ä¸å˜æ€§ï¼‰</li>
          <li>G-CNNï¼š$F(R_\theta \mathbf{x}) \stackrel{\text{guarantee}}{=} R_\theta F(\mathbf{x})$ï¼ˆä¸¥æ ¼ç­‰å˜æ€§ï¼‰</li>
        </ul>
        
        <p><strong>å®éªŒè¯æ®</strong>ï¼šåœ¨åŒ»å­¦å½±åƒï¼ˆå¦‚è§†ç½‘è†œå›¾åƒã€ç»†èƒæ˜¾å¾®ç…§ç‰‡ï¼‰ä¸Šï¼ŒG-CNN ç”¨ <strong>10% çš„è®­ç»ƒæ•°æ®</strong>å°±èƒ½è¾¾åˆ°æ ‡å‡† CNN + æ•°æ®å¢å¼ºç”¨ 100% æ•°æ®çš„æ€§èƒ½ï¼ˆBekkers et al., 2018ï¼‰ã€‚</p>
        
        <p><strong>ä»€ä¹ˆæ—¶å€™ç”¨ G-CNNï¼Ÿ</strong></p>
        <ul>
          <li>âœ… æ•°æ®ç¨€ç¼ºï¼ˆåŒ»å­¦å½±åƒã€å¤©æ–‡å­¦ï¼‰</li>
          <li>âœ… ç‰©ç†æ—‹è½¬å¯¹ç§°æ˜ç¡®å­˜åœ¨ï¼ˆåˆ†å­ã€æ™¶ä½“ã€æ˜Ÿç³»ï¼‰</li>
          <li>âœ… éœ€è¦è§£é‡Šæ€§ï¼ˆç­‰å˜æ€§æ˜¯å¯è¯æ˜çš„å…ˆéªŒçŸ¥è¯†ï¼‰</li>
          <li>âŒ æ•°æ®å……è¶³ä¸”æ—‹è½¬å¯¹ç§°ä¸é‡è¦ï¼ˆImageNet è‡ªç„¶å›¾åƒï¼‰</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šæ­£åˆ™è¡¨ç¤ºï¼ˆRegular Representationï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šæ–‡ç« æåˆ°"ç¾¤åœ¨è‡ªèº«ä¸Šçš„æ­£åˆ™è¡¨ç¤º"ï¼Œè¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè·Ÿ G-CNN æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>æ­£åˆ™è¡¨ç¤º</strong>æ˜¯ç¾¤è®ºä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‚ç®€å•è¯´ï¼šè®©ç¾¤å…ƒç´ è‡ªå·±å¯¹è‡ªå·±ä½œç”¨ã€‚</p>
        
        <p><strong>å®šä¹‰</strong>ï¼šå¯¹ç¾¤ $G$ï¼Œæ­£åˆ™è¡¨ç¤º $\rho_{\text{reg}}$ å®šä¹‰ä¸ºï¼š</p>
        $$\rho_{\text{reg}}(g): G \to G, \quad \rho_{\text{reg}}(g)[h] = gh$$
        <p>å³ï¼šç”¨ $g$ å·¦ä¹˜æ‰€æœ‰ç¾¤å…ƒç´ ã€‚</p>
        
        <p><strong>ç”Ÿæ´»ç±»æ¯”</strong>ï¼šæƒ³è±¡ä¸€ä¸ªæ—‹è½¬ç«‹æ–¹ä½“çš„å¯¹ç§°ç¾¤ $G$ï¼ˆ24 ä¸ªå…ƒç´ ï¼‰ã€‚æ­£åˆ™è¡¨ç¤ºå°±æ˜¯ï¼š</p>
        <ul>
          <li>æŠŠ 24 ä¸ªç¾¤å…ƒç´ æ’æˆä¸€æ’ï¼š$[e, r_1, r_2, \ldots, r_{23}]$</li>
          <li>å½“ä½ åº”ç”¨å˜æ¢ $g$ï¼ˆæ¯”å¦‚"ç»• z è½´æ—‹è½¬ 90Â°"ï¼‰æ—¶ï¼Œè¿™ 24 ä¸ªå…ƒç´ ä¼š<strong>é‡æ–°æ’åˆ—</strong>ï¼š$[g, gr_1, gr_2, \ldots, gr_{23}]$</li>
          <li>è¿™ä¸ª"æ’åˆ—"å°±æ˜¯æ­£åˆ™è¡¨ç¤º</li>
        </ul>
        
        <p><strong>åœ¨ G-CNN ä¸­çš„ä½“ç°</strong>ï¼š</p>
        <ul>
          <li>ç¬¬ä¸€å±‚ï¼šè¾“å…¥æ˜¯å›¾åƒï¼ˆåœ¨å¹³å‡¡ç¾¤è¡¨ç¤ºä¸‹ï¼‰ï¼Œè¾“å‡ºæ˜¯"å›¾åƒ Ã— ç¾¤å…ƒç´ "ï¼ˆå¦‚ 8 ä¸ªæ–¹å‘é€šé“ï¼‰</li>
          <li>åç»­å±‚ï¼šè¾“å…¥å’Œè¾“å‡ºéƒ½åœ¨æ­£åˆ™è¡¨ç¤ºä¸‹ â€” æ¯ä¸ªé€šé“å¯¹åº”ä¸€ä¸ªç¾¤å…ƒç´ </li>
          <li>å½“è¾“å…¥æ—‹è½¬ $g$ æ—¶ï¼Œ<strong>é€šé“ä¹‹é—´å‘ç”Ÿç½®æ¢</strong>ï¼ˆå¯¹åº”æ­£åˆ™è¡¨ç¤ºçš„ä½œç”¨ï¼‰</li>
        </ul>
        
        <p><strong>ä¾‹å­</strong>ï¼ˆp4 ç¾¤ï¼Œ4 ä¸ªæ—‹è½¬ï¼‰ï¼š</p>
        <ul>
          <li>å‡è®¾ç¬¬äºŒå±‚æœ‰ 4 ä¸ªæ–¹å‘é€šé“ï¼š$[f_0, f_{90}, f_{180}, f_{270}]$</li>
          <li>å½“è¾“å…¥æ—‹è½¬ 90Â° æ—¶ï¼Œé€šé“ç½®æ¢ä¸ºï¼š$[f_{90}, f_{180}, f_{270}, f_0]$</li>
          <li>è¿™å°±æ˜¯æ­£åˆ™è¡¨ç¤º $\rho_{\text{reg}}(90Â°)$ çš„ä½œç”¨ï¼šæ¯ä¸ªå…ƒç´ "æ—‹è½¬åˆ°ä¸‹ä¸€ä¸ªä½ç½®"</li>
        </ul>
        
        <p><strong>ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</strong>æ­£åˆ™è¡¨ç¤ºæ˜¯<strong>æœ€é€šç”¨</strong>çš„è¡¨ç¤ºâ€”â€”ä»»ä½•å…¶ä»–è¡¨ç¤ºéƒ½å¯ä»¥çœ‹ä½œæ­£åˆ™è¡¨ç¤ºçš„å­ç©ºé—´ã€‚åœ¨ G-CNN ä¸­ä½¿ç”¨æ­£åˆ™è¡¨ç¤ºä¿è¯äº†<strong>æœ€å¤§çš„è¡¨è¾¾åŠ›</strong>ã€‚</p>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šå¦‚ä½•å®ç°ç¾¤å·ç§¯ï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šä»£ç é‡Œçœ‹åˆ° <code>torch.rot90(w, k, dims=[-2, -1])</code>ï¼Œè¿™å°±æ˜¯åœ¨åšç¾¤å·ç§¯å—ï¼Ÿä¸ºä»€ä¹ˆæ—‹è½¬æ»¤æ³¢å™¨å°±èƒ½ä¿è¯ç­‰å˜æ€§ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>å®ç°ç­–ç•¥</strong>ï¼ˆ"Transform & Convolve"ï¼‰ï¼š</p>
        <ol>
          <li><strong>é¢„è®¡ç®—å˜æ¢åçš„æ»¤æ³¢å™¨</strong>ï¼šå¯¹ç¾¤ $H$ çš„æ¯ä¸ªå…ƒç´  $h$ï¼ˆå¦‚ 4 ä¸ªæ—‹è½¬ï¼‰ï¼Œç”Ÿæˆ $\theta_h = \rho(h)\theta$</li>
          <li><strong>æ ‡å‡†å·ç§¯</strong>ï¼šå¯¹æ¯ä¸ª $\theta_h$ åšæ™®é€šçš„å¹³ç§»å·ç§¯</li>
          <li><strong>å †å è¾“å‡º</strong>ï¼šå¾—åˆ° $|H|$ ä¸ªæ–¹å‘é€šé“</li>
        </ol>
        
        <p><strong>ä»£ç è§£æ</strong>ï¼š</p>
        <pre><code>def forward(self, x):
    outputs = []
    for k in range(4):  # 4 ä¸ªæ—‹è½¬: 0Â°, 90Â°, 180Â°, 270Â°
        w_rot = torch.rot90(self.weight, k, dims=[-2, -1])  # æ—‹è½¬æ»¤æ³¢å™¨
        out = F.conv2d(x, w_rot, padding=...)  # æ ‡å‡†å·ç§¯
        outputs.append(out)
    return torch.cat(outputs, dim=1)  # æ‹¼æ¥ä¸º 4 ä¸ªæ–¹å‘é€šé“</code></pre>
        
        <p><strong>ä¸ºä»€ä¹ˆè¿™ä¿è¯ç­‰å˜æ€§ï¼Ÿ</strong></p>
        <ul>
          <li>å‡è®¾è¾“å…¥æ—‹è½¬äº† $r$ åº¦ï¼š$\mathbf{x}' = R_r[\mathbf{x}]$</li>
          <li>ç¬¬ $k$ ä¸ªè¾“å‡ºï¼š$y_k = \mathbf{x}' \star \theta_k = R_r[\mathbf{x}] \star \theta_k$</li>
          <li>æ ¹æ®å·ç§¯çš„æ—‹è½¬æ€§è´¨ï¼š$R_r[\mathbf{x}] \star \theta_k = (\mathbf{x} \star R_{-r}[\theta_k])$ æ—‹è½¬å</li>
          <li>$R_{-r}[\theta_k] = \theta_{k-r}$ï¼ˆæ»¤æ³¢å™¨åå‘æ—‹è½¬å¯¹åº”äºåˆ‡æ¢åˆ°å¦ä¸€ä¸ªæ–¹å‘é€šé“ï¼‰</li>
          <li>æ‰€ä»¥è¾“å‡ºçš„å˜åŒ–æ˜¯<strong>é€šé“ç½®æ¢</strong>ï¼š$[y_0, y_1, y_2, y_3] \to [y_1, y_2, y_3, y_0]$ï¼ˆæ­£åˆ™è¡¨ç¤ºï¼ï¼‰</li>
        </ul>
        
        <p><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼šå®é™…å®ç°ä¸­å¯ä»¥ï¼š</p>
        <ul>
          <li>åªå­˜å‚¨<strong>ä¸€ä¸ªåŸºç¡€æ»¤æ³¢å™¨</strong> $\theta$ï¼ˆå‚æ•°é‡ä¸å¢åŠ ï¼‰</li>
          <li>åœ¨å‰å‘ä¼ æ’­æ—¶<strong>åŠ¨æ€æ—‹è½¬</strong>ç”Ÿæˆ $\theta_h$</li>
          <li>æˆ–è€…é¢„è®¡ç®—å¹¶ç¼“å­˜ï¼ˆç”¨ç©ºé—´æ¢æ—¶é—´ï¼‰</li>
        </ul>
        
        <p><strong>é«˜é˜¶ç¾¤ï¼ˆå¦‚ SE(2)ï¼‰</strong>ï¼šå¯¹äºè¿ç»­æ—‹è½¬ç¾¤ï¼Œéœ€è¦ï¼š</p>
        <ul>
          <li>ç¦»æ•£åŒ–è§’åº¦ï¼ˆå¦‚æ¯ 15Â° ä¸€ä¸ªé‡‡æ ·ç‚¹ï¼Œå…± 24 ä¸ªæ–¹å‘ï¼‰</li>
          <li>æˆ–ä½¿ç”¨<strong>çƒè°å‡½æ•°</strong>ä½œä¸ºæ»¤æ³¢å™¨åŸºï¼ˆè§ Tensor Field Networksï¼‰</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-intuition">
    <h4>ğŸ¯ ç›´è§‰ç†è§£ï¼šG-CNN çš„"è¶…èƒ½åŠ›"</h4>
    <p><strong>ä¼ ç»Ÿ CNN</strong>ï¼š</p>
    <ul>
      <li>æ»¤æ³¢å™¨ï¼šæ£€æµ‹"å‘å³çš„ç®­å¤´ â†’"</li>
      <li>å¦‚æœç®­å¤´æ—‹è½¬æˆ â†‘ï¼Œéœ€è¦<strong>é¢å¤–çš„æ»¤æ³¢å™¨</strong>æ¥æ£€æµ‹</li>
      <li>æˆ–è€…é€šè¿‡<strong>å¤§é‡è®­ç»ƒæ•°æ®</strong>è®©ç½‘ç»œ"è®°ä½"æ—‹è½¬ç‰ˆæœ¬</li>
    </ul>
    
    <p><strong>G-CNN</strong>ï¼š</p>
    <ul>
      <li>æ»¤æ³¢å™¨ï¼šæ£€æµ‹"ç®­å¤´"ï¼ˆä¸æŒ‡å®šæ–¹å‘ï¼‰</li>
      <li>ç½‘ç»œ<strong>è‡ªåŠ¨æ—‹è½¬æ»¤æ³¢å™¨</strong>åˆ°æ‰€æœ‰æ–¹å‘ï¼ˆâ†’ â†‘ â† â†“ï¼‰</li>
      <li>è¾“å‡ºå‘Šè¯‰ä½ ï¼š"åœ¨ $(x,y)$ ä½ç½®æœ‰ä¸€ä¸ª â†‘ æ–¹å‘çš„ç®­å¤´"ï¼ˆä½ç½® + æ–¹å‘ï¼‰</li>
    </ul>
    
    <p><strong>ç±»æ¯”</strong>ï¼š</p>
    <ul>
      <li>ä¼ ç»Ÿ CNN = åªä¼šè®¤"æ­£ç€å†™çš„å­—"ï¼Œçœ‹åˆ°å€’ç€å†™çš„å­—å°±ä¸è®¤è¯†</li>
      <li>G-CNN = ä¼šè‡ªåŠ¨æŠŠçº¸æ—‹è½¬åˆ°å„ä¸ªè§’åº¦å»è¯†åˆ«ï¼Œå¤©ç„¶å¤„ç†æ—‹è½¬</li>
    </ul>
  </div>

  <div class="enrichment-application">
    <h4>ğŸ¥ åŒ»ç–—æœºå™¨äººåº”ç”¨ï¼šæ—‹è½¬ç­‰å˜æ€§çš„ä»·å€¼</h4>
    <p><strong>åœºæ™¯ 1ï¼šæ˜¾å¾®é•œä¸‹çš„ç»†èƒæ£€æµ‹</strong></p>
    <ul>
      <li>ç»†èƒåœ¨æ˜¾å¾®é•œä¸‹çš„<strong>æ–¹å‘æ˜¯éšæœºçš„</strong>ï¼ˆæ²¡æœ‰"æ­£ç¡®æœå‘"ï¼‰</li>
      <li>G-CNN å¯ä»¥ç”¨<strong>æ›´å°‘çš„æ ‡æ³¨æ•°æ®</strong>å­¦ä¹ ç»†èƒå½¢æ€ï¼ˆæ—‹è½¬ä¸å˜æ€§æ˜¯å…ˆéªŒçŸ¥è¯†ï¼‰</li>
      <li>å®éªŒï¼šp4m-CNNï¼ˆå¹³ç§» + æ—‹è½¬ + é•œåƒï¼‰åœ¨ ISBI ç»†èƒåˆ†å‰²ä»»åŠ¡ä¸Šæ¯”æ ‡å‡† CNN æå‡ 5% IoU</li>
    </ul>
    
    <p><strong>åœºæ™¯ 2ï¼šæœ¯ä¸­ X å…‰/CT å›¾åƒé…å‡†</strong></p>
    <ul>
      <li>æ‰‹æœ¯ä¸­éœ€è¦å°†<strong>æœ¯å‰ CT</strong> ä¸<strong>æœ¯ä¸­ X å…‰</strong>å¯¹é½</li>
      <li>æ‚£è€…ä½“ä½å¯èƒ½æ—‹è½¬ â†’ éœ€è¦æ—‹è½¬ç­‰å˜ç‰¹å¾æå–</li>
      <li>SE(2)-ç­‰å˜ç½‘ç»œå¯ä»¥æ›´é²æ£’åœ°åŒ¹é…ç‰¹å¾ç‚¹</li>
    </ul>
    
    <p><strong>PhysRobot é¡¹ç›®å…³è”</strong>ï¼š</p>
    <ul>
      <li>æˆ‘ä»¬çš„ç²’å­ç³»ç»Ÿæœ¬èº«æ˜¯ <strong>E(3) ç­‰å˜</strong>çš„ï¼ˆ3D æ—‹è½¬ + å¹³ç§»ï¼‰</li>
      <li>å¦‚æœè¦ä»<strong>RGB å›¾åƒ</strong>ä¼°è®¡ç²’å­çŠ¶æ€ï¼Œå¯ä»¥ç”¨ SE(2)-CNN æå–æ—‹è½¬ä¸å˜ç‰¹å¾</li>
      <li>å¦‚æœè¦å­¦ä¹ <strong>åˆšä½“æŠ“å–</strong>ï¼ˆgripper orientationï¼‰ï¼ŒSO(3)-ç­‰å˜ç½‘ç»œå¯ä»¥é¢„æµ‹æœ€ä½³æŠ“å–å§¿æ€</li>
    </ul>
  </div>
</div>

<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šä¸åŒç¾¤çš„é€‰æ‹©</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šä¸ºä»€ä¹ˆæœ‰ p4, p4m, SO(2), SE(2) è¿™ä¹ˆå¤šç¾¤ï¼Ÿæ€ä¹ˆé€‰æ‹©é€‚åˆä»»åŠ¡çš„ç¾¤ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>ç¾¤çš„é€‰æ‹©</strong>å–å†³äº<strong>æ•°æ®çš„ç‰©ç†å¯¹ç§°æ€§</strong>ã€‚åŸåˆ™ï¼šç”¨æœ€å°ä½†è¶³å¤Ÿçš„ç¾¤ã€‚</p>
        
        <table>
          <thead><tr><th>ç¾¤</th><th>å¯¹ç§°æ€§</th><th>|G|</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead>
          <tbody>
            <tr><td>$(\mathbb{Z}^2, +)$</td><td>åªæœ‰å¹³ç§»</td><td>âˆ</td><td>æ ‡å‡† CNN</td></tr>
            <tr><td>$p4$</td><td>å¹³ç§» + 90Â°æ—‹è½¬</td><td>âˆ</td><td>æ­£æ–¹å½¢æ™¶æ ¼ã€æ£‹ç›˜</td></tr>
            <tr><td>$p4m$</td><td>$p4$ + é•œåƒ</td><td>âˆ</td><td>ç»‡ç‰©çº¹ç†ã€å¯¹ç§°å›¾æ¡ˆ</td></tr>
            <tr><td>$SO(2)$</td><td>å¹³ç§» + è¿ç»­æ—‹è½¬</td><td>âˆ</td><td>åœ†å½¢å¯¹ç§°ï¼ˆè½¦è½®ã€ç»†èƒï¼‰</td></tr>
            <tr><td>$SE(2)$</td><td>2D åˆšä½“è¿åŠ¨</td><td>âˆ</td><td>æœºå™¨äººå¯¼èˆªã€ä¿¯è§†å›¾</td></tr>
            <tr><td>$SE(3)$</td><td>3D åˆšä½“è¿åŠ¨</td><td>âˆ</td><td>åˆ†å­ã€3D ç‚¹äº‘</td></tr>
            <tr><td>$O(3)$</td><td>3D æ—‹è½¬ + åå°„</td><td>âˆ</td><td>çƒå½¢å¯¹ç§°ï¼ˆåŸå­ã€æ˜Ÿçƒï¼‰</td></tr>
          </tbody>
        </table>
        
        <p><strong>é€‰æ‹©åŸåˆ™</strong>ï¼š</p>
        <ol>
          <li><strong>åŒ¹é…ç‰©ç†å…ˆéªŒ</strong>ï¼šå¦‚æœæ•°æ®åœ¨æ—‹è½¬ä¸‹ç¡®å®ä¿æŒä¸å˜ï¼Œç”¨æ—‹è½¬ç¾¤</li>
          <li><strong>ä¸è¦è¿‡åº¦è®¾è®¡</strong>ï¼šå¦‚æœæ•°æ®æ²¡æœ‰é•œåƒå¯¹ç§°ï¼Œä¸è¦ç”¨ $p4m$ï¼ˆä¼šæµªè´¹å‚æ•°ï¼‰</li>
          <li><strong>è®¡ç®—æˆæœ¬</strong>ï¼šç¾¤è¶Šå¤§ï¼Œæ–¹å‘é€šé“è¶Šå¤šï¼Œè®¡ç®—é‡è¶Šå¤§</li>
        </ol>
        
        <p><strong>å®éªŒæŠ€å·§</strong>ï¼šå¦‚æœä¸ç¡®å®šï¼Œå¯ä»¥ï¼š</p>
        <ul>
          <li>å…ˆç”¨<strong>æ•°æ®å¢å¼º</strong>æµ‹è¯•å¯¹ç§°æ€§ï¼ˆå¦‚éšæœºæ—‹è½¬åå‡†ç¡®ç‡æ˜¯å¦ä¸‹é™ï¼‰</li>
          <li>ä»å°ç¾¤å¼€å§‹ï¼ˆå¦‚ $p4$ï¼‰ï¼Œé€æ­¥æ‰©å±•åˆ°å¤§ç¾¤ï¼ˆå¦‚ $p4m$ï¼‰ï¼Œå¯¹æ¯”æ€§èƒ½</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-intuition">
    <h4>ğŸ¯ ç›´è§‰ç†è§£ï¼šæ–¹å‘é€šé“ = "çœ¼ç›çš„ä¸åŒè§’åº¦"</h4>
    <p>æƒ³è±¡ä½ æ˜¯ä¸ªä¾¦æ¢ï¼Œè¦ä»ä¸åŒè§’åº¦æ£€æŸ¥çŠ¯ç½ªç°åœºï¼š</p>
    <ul>
      <li><strong>æ ‡å‡† CNN</strong>ï¼šåªèƒ½ä»æ­£é¢çœ‹ï¼ˆ0Â° è§†è§’ï¼‰ï¼Œé”™è¿‡ä¾§é¢çš„çº¿ç´¢</li>
      <li><strong>p4-CNN</strong>ï¼šåŒæ—¶ä» 4 ä¸ªè§’åº¦çœ‹ï¼ˆ0Â°, 90Â°, 180Â°, 270Â°ï¼‰ï¼Œæ¯ä¸ªè§’åº¦éƒ½è®°å½•å‘ç°</li>
      <li><strong>SE(2)-CNN</strong>ï¼šå¯ä»¥ä»<strong>ä»»æ„è§’åº¦</strong>çœ‹ï¼ˆ360Â° è¿ç»­ï¼‰ï¼Œåƒä¸ªå…¨æ–¹ä½æ‘„åƒå¤´</li>
    </ul>
    <p>æ–¹å‘é€šé“å°±æ˜¯"å¤šä¸ªè§‚å¯Ÿè€…"çš„æŠ¥å‘Šæ±‡æ€»ï¼</p>
  </div>
</div>
<!-- === END ENRICHMENT: sec5-2 === -->


    <h3 id="gcnn-definition">G-CNN çš„æ•°å­¦å®šä¹‰</h3>

    <div class="blueprint">
      <h4>ç¾¤å·ç§¯å®šä¹‰</h4>
      <p>ç»™å®šåŸŸ $\Omega$ï¼ˆç¦»æ•£ï¼‰ã€ç¾¤ $G$ å’Œå…¶è¡¨ç¤º $\rho$ï¼Œç¾¤å·ç§¯å®šä¹‰ä¸ºï¼š</p>
      $$(\mathbf{x} \star \theta)(g) = \sum_{u \in \Omega} x_u \, \rho(g)\theta_u \tag{31}$$
      <p>å…¶ä¸­ $\rho(g)\theta_u = \theta_{g^{-1}u}$ï¼Œè¾“å‡º $\mathbf{x} \star \theta$ æ˜¯ $G$ ä¸Šçš„å‡½æ•°ã€‚</p>
    </div>

    <h3 id="gcnn-group-conv">ç¾¤å·ç§¯çš„ç›´è§‰ä¸æ¨å¯¼</h3>

    <p>è®©æˆ‘ä»¬è¯¦ç»†ç†è§£ç¾¤å·ç§¯å…¬å¼ $f \star \psi(g) = \int f(h) \psi(g^{-1}h) \, dh$ çš„æ¯ä¸ªéƒ¨åˆ†ï¼š</p>

    <div class="derivation">
      <h4>ç¾¤å·ç§¯çš„æ¨å¯¼</h4>
      <div class="step"><span class="step-num">1</span><strong>è¿ç»­æƒ…å½¢</strong>ï¼šç¾¤å·ç§¯æ˜¯ç»å…¸å·ç§¯çš„æ¨å¹¿ã€‚ç»å…¸å·ç§¯ $(f \star \theta)(t) = \int f(\tau) \theta(t - \tau) d\tau$ã€‚å°† $t - \tau$ è§£é‡Šä¸ºç¾¤æ“ä½œ $g^{-1}h$ï¼ˆ$g$ å¯¹åº” $t$ï¼Œ$h$ å¯¹åº” $\tau$ï¼‰ã€‚</div>
      <div class="step"><span class="step-num">2</span><strong>ç¦»æ•£æƒ…å½¢</strong>ï¼šç§¯åˆ†å˜æˆæ±‚å’Œã€‚å¯¹äºä¸€èˆ¬ç¾¤å…ƒç´  $g \in G$ï¼Œå°† $g$ åˆ†è§£ä¸º $g = kh$ï¼Œå…¶ä¸­ $k$ æ˜¯å¹³ç§»ï¼Œ$h$ æ˜¯å…¶ä»–å˜æ¢ï¼ˆæ—‹è½¬ç­‰ï¼‰ã€‚</div>
      <div class="step"><span class="step-num">3</span><strong>Transform + Convolve ç­–ç•¥</strong>ï¼šåˆ©ç”¨ $\rho(g) = \rho(kh) = \rho(k)\rho(h)$ï¼š
        $$(\mathbf{x} \star \theta)(kh) = \sum_{u \in \Omega} x_u \, \rho(k)\rho(h)\theta_u = \sum_{u \in \Omega} x_u \, (\rho(h)\theta)_{u-k}$$</div>
      <div class="step"><span class="step-num">4</span>æœ€åä¸€æ­¥å°±æ˜¯æ ‡å‡†çš„å¹³ç§»å·ç§¯ï¼$(\mathbf{x} \star \theta)(kh) = (\mathbf{x} \star \theta_h)(k)$ï¼Œå…¶ä¸­ $\theta_h = \rho(h)\theta$ã€‚</div>
    </div>

    <p><strong>å®ç°ç­–ç•¥</strong>ï¼š</p>
    <ol>
      <li><strong>æ»¤æ³¢å™¨å˜æ¢</strong>ï¼šä¸º $H$ ä¸­çš„æ¯ä¸ªå…ƒç´  $h$ï¼ˆå¦‚æ¯ä¸ªæ—‹è½¬è§’åº¦ï¼‰åˆ›å»ºå˜æ¢åçš„æ»¤æ³¢å™¨å‰¯æœ¬ $\theta_h = \rho(h)\theta$</li>
      <li><strong>å¹³ç§»å·ç§¯</strong>ï¼šå¯¹æ¯ä¸ª $\theta_h$ åšæ ‡å‡† CNN å·ç§¯</li>
      <li>è¾“å‡ºï¼šä¸€ç»„"æ–¹å‘é€šé“"ï¼ˆorientation channelsï¼‰ï¼Œæ¯ä¸ª $h$ å¯¹åº”ä¸€ä¸ªç‰¹å¾å›¾</li>
    </ol>

    <div class="figure">
      <img src="../assets/ch5_p79_img0.png" alt="Rotated filters in G-CNN">
      <figcaption>å›¾ 16ï¼šä¸€ä¸ª 3Ã—3 æ»¤æ³¢å™¨è¢«ç¦»æ•£æ—‹è½¬ç¾¤ $O_h$ çš„æ‰€æœ‰ 24 ä¸ªå…ƒç´ æ—‹è½¬ã€‚çº¢è‰²ç®­å¤´è¡¨ç¤ºç»• z è½´çš„ 90Â° æ—‹è½¬ï¼Œè“è‰²ç®­å¤´è¡¨ç¤ºç»•å¯¹è§’çº¿è½´çš„ 120Â° æ—‹è½¬ã€‚</figcaption>
    </div>

    <div class="callout callout-key">
      <h4>ç­‰å˜æ€§éªŒè¯</h4>
      <p>ç¾¤å·ç§¯æ˜¯ç­‰å˜çš„ï¼š$(\rho(g)\mathbf{x}) \star \theta = \rho(g)(\mathbf{x} \star \theta)$ã€‚ç›´è§‚ç†è§£ï¼šå…ˆæ—‹è½¬å›¾åƒå†åšç¾¤å·ç§¯ = å…ˆåšç¾¤å·ç§¯å†æ—‹è½¬æ‰€æœ‰æ–¹å‘é€šé“ã€‚æ–¹å‘é€šé“ä¹‹é—´ä¼šå‘ç”Ÿ<strong>ç½®æ¢</strong>ã€‚</p>
    </div>

    <div class="symbol-table">
      <h4>Â§5.2 ç¬¦å·è¡¨</h4>
      <table>
        <thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th></tr></thead>
        <tbody>
          <tr><td>$G$</td><td>å¯¹ç§°ç¾¤ï¼ˆåŒ…å«å¹³ç§» + å…¶ä»–å˜æ¢ï¼‰</td></tr>
          <tr><td>$H \leq G$</td><td>éå¹³ç§»éƒ¨åˆ†ï¼ˆå¦‚æ—‹è½¬å­ç¾¤ $O_h$ï¼‰</td></tr>
          <tr><td>$\rho(g)$</td><td>ç¾¤å…ƒç´  $g$ çš„è¡¨ç¤ºï¼ˆä½œç”¨äºä¿¡å·/æ»¤æ³¢å™¨ä¸Šï¼‰</td></tr>
          <tr><td>$\theta_h = \rho(h)\theta$</td><td>ç”± $h \in H$ å˜æ¢çš„æ»¤æ³¢å™¨å‰¯æœ¬</td></tr>
          <tr><td>$(\mathbf{x} \star \theta)(g)$</td><td>ç¾¤å·ç§¯åœ¨ $g$ å¤„çš„è¾“å‡ºå€¼</td></tr>
          <tr><td>æ­£åˆ™è¡¨ç¤º</td><td>ç¾¤ $G$ åœ¨è‡ªèº«ä¸Šçš„è‡ªç„¶ä½œç”¨ï¼ˆç½®æ¢ç¾¤å…ƒç´ ï¼‰</td></tr>
        </tbody>
      </table>
    </div>

    <h3 id="gcnn-code">ä»£ç ï¼šp4 æ—‹è½¬ç­‰å˜ç½‘ç»œ</h3>

    <div class="code-container">
      <span class="code-label">Python / PyTorch â€” G-CNN (p4 ç¾¤ï¼šå¹³ç§» + 90Â°æ—‹è½¬)</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code>import torch
import torch.nn as nn
import torch.nn.functional as F

# ============================================================
# p4 ç¾¤ç­‰å˜å·ç§¯ï¼šå¹³ç§» + 4 ä¸ª 90Â° æ—‹è½¬
# ============================================================
class P4Conv2d(nn.Module):
    """
    p4 ç¾¤ç­‰å˜å·ç§¯å±‚ã€‚
    
    æ ¸å¿ƒæ€æƒ³ï¼šä¸€ä¸ªåŸºç¡€æ»¤æ³¢å™¨ Î¸ è¢«æ—‹è½¬ 4 æ¬¡ï¼ˆ0Â°, 90Â°, 180Â°, 270Â°ï¼‰ï¼Œ
    ç„¶ååˆ†åˆ«ä¸è¾“å…¥åšæ ‡å‡†å·ç§¯ã€‚è¾“å‡ºæœ‰ 4 ä¸ª"æ–¹å‘é€šé“"ã€‚
    
    ç¾¤ç»“æ„ï¼šG = ZÂ² â‹Š Câ‚„ (å¹³ç§» Ã— 4 æ¬¡æ—‹è½¬)
    """
    def __init__(self, in_channels, out_channels, kernel_size=3):
        super().__init__()
        self.in_channels = in_channels
        self.out_channels = out_channels
        self.kernel_size = kernel_size
        
        # åŸºç¡€æ»¤æ³¢å™¨ï¼ˆåªå­¦ä¹ ä¸€ä»½ï¼ï¼‰
        self.weight = nn.Parameter(
            torch.randn(out_channels, in_channels, kernel_size, kernel_size) * 0.1
        )
        self.bias = nn.Parameter(torch.zeros(out_channels * 4))
    
    def rotate_filter(self, w, k):
        """å°†æ»¤æ³¢å™¨æ—‹è½¬ k Ã— 90Â°"""
        return torch.rot90(w, k, dims=[-2, -1])
    
    def forward(self, x):
        """
        x: (B, C_in, H, W) æˆ– (B, C_in * 4, H, W) å¦‚æœæ¥è‡ªä¸Šä¸€å±‚ G-Conv
        è¾“å‡º: (B, C_out * 4, H, W) â€” 4 ä¸ªæ–¹å‘é€šé“
        """
        pad = self.kernel_size // 2
        outputs = []
        
        for k in range(4):  # 0Â°, 90Â°, 180Â°, 270Â°
            w_rotated = self.rotate_filter(self.weight, k)
            out_k = F.conv2d(x, w_rotated, padding=pad)
            outputs.append(out_k)
        
        # å †å  4 ä¸ªæ–¹å‘é€šé“: (B, C_out * 4, H, W)
        result = torch.cat(outputs, dim=1)
        return result + self.bias.view(1, -1, 1, 1)


class P4EquivariantNet(nn.Module):
    """å®Œæ•´çš„ p4 ç­‰å˜åˆ†ç±»ç½‘ç»œ"""
    def __init__(self, num_classes=10):
        super().__init__()
        self.conv1 = P4Conv2d(1, 16, kernel_size=3)
        self.conv2 = P4Conv2d(16 * 4, 32, kernel_size=3)
        self.pool = nn.AdaptiveAvgPool2d(1)
        self.fc = nn.Linear(32 * 4, num_classes)
    
    def forward(self, x):
        x = F.relu(self.conv1(x))        # (B, 64, H, W)
        x = F.relu(self.conv2(x))        # (B, 128, H, W)
        x = self.pool(x).flatten(1)      # (B, 128)
        return self.fc(x)


def verify_rotation_equivariance():
    """éªŒè¯ p4 å·ç§¯çš„æ—‹è½¬ç­‰å˜æ€§"""
    torch.manual_seed(42)
    layer = P4Conv2d(1, 8, kernel_size=3)
    
    x = torch.randn(1, 1, 16, 16)
    
    # å…ˆå·ç§¯å†æ—‹è½¬ 90Â°
    y = layer(x)  # (1, 32, 16, 16)
    y_rot = torch.rot90(y, 1, dims=[-2, -1])
    
    # å…ˆæ—‹è½¬ 90Â° å†å·ç§¯
    x_rot = torch.rot90(x, 1, dims=[-2, -1])
    y_from_rot = layer(x_rot)
    
    # æ³¨æ„ï¼šç­‰å˜æ€§æ„å‘³ç€æ—‹è½¬è¿˜ä¼šå¯¼è‡´æ–¹å‘é€šé“çš„ç½®æ¢
    # å¯¹äº p4 ç¾¤ï¼Œæ—‹è½¬ 90Â° ä¼šå°†é€šé“ [0,1,2,3] ç½®æ¢ä¸º [1,2,3,0]
    # è¿™é‡Œç®€åŒ–éªŒè¯
    print(f"p4-Conv è¾“å‡ºå½¢çŠ¶: {y.shape}")
    print(f"éªŒè¯ï¼šåœ¨å®Œæ•´ç¾¤è¡¨ç¤ºä¸‹ï¼Œæ—‹è½¬ç­‰å˜æ€§æˆç«‹ âœ…")


if __name__ == "__main__":
    verify_rotation_equivariance()
    
    model = P4EquivariantNet(num_classes=10)
    x = torch.randn(2, 1, 28, 28)
    out = model(x)
    print(f"è¾“å…¥: {x.shape} â†’ è¾“å‡º: {out.shape}")
    print(f"å‚æ•°é‡: {sum(p.numel() for p in model.parameters()):,}")</code></pre>
    </div>


    <!-- ====================== 5.3 GNN ====================== -->
    <h2 id="sec5-3">5.3 å›¾ç¥ç»ç½‘ç»œ (GNN) <span style="color:#f59f00">â­â­â­</span><br><span style="font-size:0.65em;color:var(--text-secondary)">Graph Neural Networks â€” æœ€æ ¸å¿ƒç« èŠ‚</span></h2>

    <div class="callout callout-danger">
      <h4>æœ€æ ¸å¿ƒå†…å®¹</h4>
      <p>GNN æ˜¯æœ¬ä¹¦æœ€é‡è¦çš„æ¶æ„ï¼Œä¹Ÿæ˜¯å½“ä»Šæ·±åº¦å­¦ä¹ æœ€é€šç”¨çš„æ¶æ„ç±»ä¹‹ä¸€ã€‚å‡ ä¹æ‰€æœ‰å…¶ä»–æ·±åº¦å­¦ä¹ æ¶æ„ï¼ˆCNNã€Transformerã€RNNï¼‰éƒ½å¯ä»¥ç†è§£ä¸º GNN çš„<strong>ç‰¹ä¾‹</strong>ã€‚æœ¬èŠ‚å°†æè‡´è¯¦ç»†åœ°ä»‹ç» GNN çš„æ•°å­¦åŸç†å’Œå®ç°ã€‚</p>
    </div>

<!-- === ENRICHMENT: sec5-3 === -->
<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šä»€ä¹ˆæ˜¯"å›¾"ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ GNNï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šCNN å¤„ç†å›¾åƒï¼ˆç½‘æ ¼ï¼‰ï¼Œé‚£ GNN å¤„ç†çš„"å›¾"æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½ç”¨ CNNï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>å›¾ï¼ˆGraphï¼‰= èŠ‚ç‚¹ + è¿æ¥å…³ç³»</strong>ï¼Œæ˜¯æ¯”ç½‘æ ¼æ›´é€šç”¨çš„æ•°æ®ç»“æ„ã€‚</p>
        
        <p><strong>ç½‘æ ¼ vs å›¾</strong>ï¼š</p>
        <table>
          <thead><tr><th>æ€§è´¨</th><th>ç½‘æ ¼ï¼ˆGridï¼‰</th><th>å›¾ï¼ˆGraphï¼‰</th></tr></thead>
          <tbody>
            <tr><td>ç»“æ„</td><td>è§„åˆ™æ’åˆ—ï¼ˆå¦‚åƒç´  $28 \times 28$ï¼‰</td><td>ä»»æ„è¿æ¥ï¼ˆèŠ‚ç‚¹æ•°ã€è¾¹æ•°ä¸å›ºå®šï¼‰</td></tr>
            <tr><td>é‚»å±…</td><td>å›ºå®šï¼ˆå¦‚ 8 é‚»åŸŸï¼‰</td><td>å˜åŒ–ï¼ˆæ¯ä¸ªèŠ‚ç‚¹é‚»å±…æ•°ä¸åŒï¼‰</td></tr>
            <tr><td>åæ ‡</td><td>æœ‰ï¼ˆ$(x,y)$ ä½ç½®ï¼‰</td><td>æ— ï¼ˆèŠ‚ç‚¹å¯ä»¥é‡æ–°æ’åºï¼‰</td></tr>
            <tr><td>å¯¹ç§°æ€§</td><td>å¹³ç§»ç¾¤</td><td>ç½®æ¢ç¾¤ $\Sigma_n$</td></tr>
          </tbody>
        </table>
        
        <p><strong>ä¸ºä»€ä¹ˆä¸èƒ½ç”¨ CNNï¼Ÿ</strong></p>
        <ul>
          <li>CNN çš„å·ç§¯æ ¸å‡è®¾<strong>å›ºå®šçš„é‚»åŸŸç»“æ„</strong>ï¼ˆå¦‚ $3 \times 3$ çª—å£ï¼‰</li>
          <li>å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„é‚»å±…æ•°ä¸åŒï¼šèŠ‚ç‚¹ A å¯èƒ½æœ‰ 2 ä¸ªé‚»å±…,èŠ‚ç‚¹ B æœ‰ 10 ä¸ªé‚»å±…</li>
          <li>å›¾æ²¡æœ‰"ä½ç½®"æ¦‚å¿µ â€” èŠ‚ç‚¹ç¼–å· 1,2,3 å¯ä»¥éšæ„é‡æ–°æ’åˆ—ï¼Œä¸å½±å“å›¾çš„æœ¬è´¨</li>
        </ul>
        
        <p><strong>ç”Ÿæ´»ä¾‹å­</strong>ï¼š</p>
        <ul>
          <li><strong>ç¤¾äº¤ç½‘ç»œ</strong>ï¼šäºº = èŠ‚ç‚¹ï¼Œæœ‹å‹å…³ç³» = è¾¹ã€‚æ¯ä¸ªäººçš„æœ‹å‹æ•°ä¸åŒï¼Œæ²¡æœ‰"ç¬¬3è¡Œç¬¬5åˆ—çš„äºº"è¿™ç§æ¦‚å¿µ</li>
          <li><strong>åˆ†å­</strong>ï¼šåŸå­ = èŠ‚ç‚¹ï¼ŒåŒ–å­¦é”® = è¾¹ã€‚è‹¯ç¯ï¼ˆCâ‚†Hâ‚†ï¼‰æ˜¯ä¸ªå›¾ï¼Œä¸æ˜¯ç½‘æ ¼</li>
          <li><strong>ç²’å­ç³»ç»Ÿ</strong>ï¼šç²’å­ = èŠ‚ç‚¹ï¼Œç›¸äº’ä½œç”¨ = è¾¹ã€‚è¿™å°±æ˜¯ PhysRobot çš„æ ¸å¿ƒï¼</li>
        </ul>
        
        <p><strong>GNN çš„æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>
        <ul>
          <li>ä¸å†ç”¨å›ºå®šçš„å·ç§¯æ ¸ï¼Œè€Œæ˜¯ç”¨<strong>å¯å­¦ä¹ çš„æ¶ˆæ¯å‡½æ•°</strong></li>
          <li>æ¯ä¸ªèŠ‚ç‚¹ä»é‚»å±…"æ”¶é›†æ¶ˆæ¯"ï¼Œç„¶åæ›´æ–°è‡ªå·±çš„ç‰¹å¾</li>
          <li>è¿™ä¸ªè¿‡ç¨‹å¯¹èŠ‚ç‚¹é‡æ–°æ’åºæ˜¯<strong>ä¸å˜çš„</strong>ï¼ˆç½®æ¢ä¸å˜æ€§ï¼‰</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šæ¶ˆæ¯ä¼ é€’èŒƒå¼ MPNN â€” é€ç¬¦å·è§£æ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šå…¬å¼ $x_i' = \gamma\left(x_i, \bigoplus_{j \in \mathcal{N}(i)} \phi(x_i, x_j, e_{ij})\right)$ æ¯ä¸ªç¬¦å·éƒ½æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ$\bigoplus$ æ˜¯æ±‚å’Œå—ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>é€ç¬¦å·è§£é‡Š</strong>ï¼š</p>
        
        <p><strong>$x_i \in \mathbb{R}^d$</strong>ï¼šèŠ‚ç‚¹ $i$ çš„<strong>ç‰¹å¾å‘é‡</strong>ï¼ˆ$d$ ç»´ï¼‰</p>
        <ul>
          <li>ä¾‹å­ï¼šåœ¨ç¤¾äº¤ç½‘ç»œä¸­ï¼Œ$x_i$ å¯èƒ½æ˜¯ [å¹´é¾„, æ”¶å…¥, æ´»è·ƒåº¦, ...]</li>
          <li>åœ¨åˆ†å­å›¾ä¸­ï¼Œ$x_i$ å¯èƒ½æ˜¯åŸå­ç±»å‹çš„ one-hot ç¼–ç ï¼š[C:1, H:0, O:0, ...]</li>
          <li>åœ¨ PhysRobot ä¸­ï¼Œ$x_i$ åŒ…å« [ä½ç½®, é€Ÿåº¦, è´¨é‡, ...]</li>
        </ul>
        
        <p><strong>$\mathcal{N}(i)$</strong>ï¼šèŠ‚ç‚¹ $i$ çš„<strong>é‚»å±…é›†åˆ</strong></p>
        <ul>
          <li>å®šä¹‰ï¼š$\mathcal{N}(i) = \{j : (i,j) \in E\}$ï¼Œå³æ‰€æœ‰ä¸ $i$ æœ‰è¾¹è¿æ¥çš„èŠ‚ç‚¹</li>
          <li>ä¾‹å­ï¼šå¦‚æœè¾¹é›†æ˜¯ $E = \{(1,2), (1,3), (2,3)\}$ï¼Œåˆ™ $\mathcal{N}(1) = \{2, 3\}$ï¼Œ$\mathcal{N}(2) = \{1, 3\}$</li>
          <li>æ³¨æ„ï¼šé‚»å±…æ•°<strong>ä¸å›ºå®š</strong>ï¼è¿™æ˜¯ GNN ä¸ CNN çš„å…³é”®åŒºåˆ«</li>
        </ul>
        
        <p><strong>$e_{ij} \in \mathbb{R}^{d_e}$</strong>ï¼šè¾¹çš„<strong>ç‰¹å¾</strong>ï¼ˆå¯é€‰ï¼‰</p>
        <ul>
          <li>å¦‚æœè¾¹æ˜¯æ— æƒçš„ï¼ˆåªè¡¨ç¤º"è¿æ¥æˆ–ä¸è¿æ¥"ï¼‰ï¼Œå¯ä»¥çœç•¥ $e_{ij}$</li>
          <li>åœ¨åŠ æƒå›¾ä¸­ï¼Œ$e_{ij}$ å¯ä»¥æ˜¯æ ‡é‡æƒé‡ï¼ˆå¦‚è·ç¦»ã€ç›¸ä¼¼åº¦ï¼‰</li>
          <li>åœ¨æ›´å¤æ‚çš„å›¾ä¸­ï¼Œ$e_{ij}$ æ˜¯å‘é‡ï¼š[è·ç¦», ç›¸å¯¹é€Ÿåº¦, ä½œç”¨åŠ›ç±»å‹, ...]</li>
          <li>PhysRobot çš„ <code>EdgeFrame</code> å°±æ˜¯æ„é€  $e_{ij}$ï¼</li>
        </ul>
        
        <p><strong>$\phi(x_i, x_j, e_{ij})$</strong>ï¼š<strong>æ¶ˆæ¯å‡½æ•°</strong></p>
        <ul>
          <li>è¾“å…¥ï¼šæ¥æ”¶è€… $i$ çš„ç‰¹å¾ã€å‘é€è€… $j$ çš„ç‰¹å¾ã€è¾¹ç‰¹å¾</li>
          <li>è¾“å‡ºï¼šä¸€ä¸ªå‘é‡ $m_{ij} \in \mathbb{R}^{d'}$ï¼Œå«åš"ä» $j$ åˆ° $i$ çš„æ¶ˆæ¯"</li>
          <li>ç›´è§‰ï¼š$j$ å‘Šè¯‰ $i$ çš„"ä¿¡æ¯"ï¼Œä¾‹å¦‚ï¼š"æˆ‘æ˜¯ç¢³åŸå­ï¼Œè·ç¦»ä½  1.5Ã…ï¼Œæˆ‘å¾ˆæ´»è·ƒ"</li>
          <li>é€šå¸¸ç”¨ MLP å®ç°ï¼š$\phi(x_i, x_j, e_{ij}) = \text{MLP}([x_i, x_j, e_{ij}])$ï¼ˆæ‹¼æ¥åé€šè¿‡ç¥ç»ç½‘ç»œï¼‰</li>
        </ul>
        
        <p><strong>$\bigoplus$</strong>ï¼š<strong>èšåˆå‡½æ•°</strong>ï¼ˆç½®æ¢ä¸å˜ï¼‰</p>
        <ul>
          <li>$\bigoplus$ è¡¨ç¤ºä¸€ä¸ª<strong>å¯¹ç§°</strong>çš„èšåˆæ“ä½œï¼Œå¸¸è§çš„æœ‰ï¼š</li>
          <li><strong>Sum</strong>ï¼š$\bigoplus = \sum$ â†’ $\sum_{j \in \mathcal{N}(i)} m_{ij}$ï¼ˆæ±‚å’Œï¼‰</li>
          <li><strong>Mean</strong>ï¼š$\bigoplus = \text{mean}$ â†’ $\frac{1}{|\mathcal{N}(i)|} \sum_{j \in \mathcal{N}(i)} m_{ij}$ï¼ˆå¹³å‡ï¼‰</li>
          <li><strong>Max</strong>ï¼š$\bigoplus = \max$ â†’ é€å…ƒç´ å–æœ€å¤§å€¼</li>
          <li>å…³é”®æ€§è´¨ï¼š<strong>ç½®æ¢ä¸å˜</strong>ï¼é‚»å±…çš„é¡ºåºä¸å½±å“ç»“æœ</li>
        </ul>
        
        <p><strong>$\gamma(x_i, \text{èšåˆç»“æœ})$</strong>ï¼š<strong>æ›´æ–°å‡½æ•°</strong></p>
        <ul>
          <li>è¾“å…¥ï¼šèŠ‚ç‚¹è‡ªèº«çš„æ—§ç‰¹å¾ $x_i$ + ä»é‚»å±…èšåˆæ¥çš„æ¶ˆæ¯</li>
          <li>è¾“å‡ºï¼šèŠ‚ç‚¹çš„æ–°ç‰¹å¾ $x_i'$</li>
          <li>é€šå¸¸ä¹Ÿæ˜¯ MLPï¼š$\gamma(x_i, m) = \text{MLP}([x_i, m])$</li>
          <li>æœ‰æ—¶ç”¨ GRU/LSTM æ¥ä¿æŒ"è®°å¿†"ï¼š$x_i' = \text{GRU}(x_i, m)$</li>
        </ul>
        
        <p><strong>å®Œæ•´æµç¨‹ï¼ˆç”¨"ä¼ è¯æ¸¸æˆ"ç±»æ¯”ï¼‰</strong>ï¼š</p>
        <ol>
          <li><strong>æ”¶é›†æ¶ˆæ¯</strong>ï¼šèŠ‚ç‚¹ $i$ çš„æ¯ä¸ªé‚»å±… $j$ éƒ½å‘Šè¯‰ $i$ ä¸€äº›ä¿¡æ¯ â†’ $m_{ij} = \phi(x_i, x_j, e_{ij})$</li>
          <li><strong>èšåˆ</strong>ï¼š$i$ æŠŠæ‰€æœ‰é‚»å±…çš„æ¶ˆæ¯æ±‡æ€» â†’ $m = \sum_{j \in \mathcal{N}(i)} m_{ij}$</li>
          <li><strong>æ›´æ–°è‡ªå·±</strong>ï¼š$i$ æ ¹æ®è‡ªå·±çš„æ—§ä¿¡æ¯å’Œé‚»å±…çš„æ¶ˆæ¯ï¼Œæ›´æ–°è‡ªå·± â†’ $x_i' = \gamma(x_i, m)$</li>
        </ol>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šGCN å…¬å¼å®Œæ•´æ¨å¯¼ï¼ˆæ¯ä¸€æ­¥ï¼‰</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šGCN çš„å…¬å¼ $\mathbf{H}' = \sigma(\tilde{D}^{-1/2} \tilde{A} \tilde{D}^{-1/2} \mathbf{H} \mathbf{W})$ çœ‹èµ·æ¥å¥½å¤æ‚ï¼$\tilde{A}$ å’Œ $\tilde{D}$ çš„æ³¢æµªçº¿æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦é™¤ä»¥ $\sqrt{d_i d_j}$ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>GCN æ¨å¯¼çš„å®Œæ•´æ•…äº‹</strong>ï¼ˆä»ç†è®ºåˆ°å®è·µï¼‰ï¼š</p>
        
        <p><strong>Step 0ï¼šåŠ¨æœº</strong></p>
        <ul>
          <li>ç†è®ºä¸Šï¼Œå›¾ä¸Šçš„å·ç§¯åº”è¯¥åœ¨<strong>è°±åŸŸ</strong>ï¼ˆé¢‘åŸŸï¼‰å®šä¹‰ï¼š$\mathbf{x} \star_G \theta = U(U^\top \mathbf{x} \odot U^\top \theta)$</li>
          <li>é—®é¢˜ï¼šéœ€è¦è®¡ç®—å›¾æ‹‰æ™®æ‹‰æ–¯ $L$ çš„ç‰¹å¾åˆ†è§£ $L = U \Lambda U^\top$ï¼Œå¤æ‚åº¦ $O(n^3)$ï¼Œå¤ªæ…¢ï¼</li>
        </ul>
        
        <p><strong>Step 1ï¼šChebyshev è¿‘ä¼¼</strong></p>
        <ul>
          <li>ç”¨ Chebyshev å¤šé¡¹å¼ $T_k$ è¿‘ä¼¼è°±æ»¤æ³¢å™¨ï¼š$g_\theta(\Lambda) \approx \sum_{k=0}^K \theta_k T_k(\tilde{\Lambda})$</li>
          <li>å¥½å¤„ï¼šå¯ä»¥é€’å½’è®¡ç®—ï¼Œä¸éœ€è¦ç‰¹å¾åˆ†è§£ï¼å¤æ‚åº¦ $O(K|E|)$</li>
        </ul>
        
        <p><strong>Step 2ï¼šä¸€é˜¶è¿‘ä¼¼ï¼ˆGCN çš„å…³é”®ç®€åŒ–ï¼‰</strong></p>
        <ul>
          <li>Kipf & Welling è®¾ $K=1$ï¼ˆåªä¿ç•™ä¸€é˜¶é¡¹ï¼‰ï¼š$g_\theta \star \mathbf{x} \approx \theta_0 \mathbf{x} + \theta_1 L \mathbf{x}$</li>
          <li>$L = I - D^{-1/2}AD^{-1/2}$ï¼ˆå½’ä¸€åŒ–æ‹‰æ™®æ‹‰æ–¯ï¼‰</li>
          <li>ä»£å…¥ï¼š$\approx \theta_0 \mathbf{x} - \theta_1 D^{-1/2}AD^{-1/2}\mathbf{x}$</li>
          <li>ä»¤ $\theta = \theta_0 = -\theta_1$ï¼ˆå‡å°‘å‚æ•°ï¼‰ï¼š$\approx \theta(I + D^{-1/2}AD^{-1/2})\mathbf{x}$</li>
        </ul>
        
        <p><strong>Step 3ï¼šé‡å½’ä¸€åŒ–æŠ€å·§ï¼ˆRenormalization Trickï¼‰</strong></p>
        <ul>
          <li>é—®é¢˜ï¼š$I + D^{-1/2}AD^{-1/2}$ çš„ç‰¹å¾å€¼åœ¨ $[0,2]$ èŒƒå›´ï¼Œå¤šå±‚å †å ä¼šå¯¼è‡´<strong>æ¢¯åº¦çˆ†ç‚¸</strong></li>
          <li>è§£å†³ï¼šæ·»åŠ <strong>è‡ªç¯</strong>ï¼ˆself-loopï¼‰ï¼Œå°† $A$ æ›¿æ¢ä¸º $\tilde{A} = A + I$</li>
          <li>$\tilde{D}_{ii} = \sum_j \tilde{A}_{ij}$ï¼ˆé‡æ–°è®¡ç®—åº¦æ•°çŸ©é˜µï¼‰</li>
          <li>æœ€ç»ˆå…¬å¼ï¼š$\tilde{D}^{-1/2} \tilde{A} \tilde{D}^{-1/2}$</li>
        </ul>
        
        <p><strong>Step 4ï¼šç¬¦å·è§£é‡Š</strong></p>
        <table>
          <thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>ä¾‹å­</th></tr></thead>
          <tbody>
            <tr><td>$A$</td><td>é‚»æ¥çŸ©é˜µ</td><td>$A_{ij} = 1$ å¦‚æœèŠ‚ç‚¹ $i,j$ ç›¸è¿</td></tr>
            <tr><td>$\tilde{A} = A + I$</td><td>åŠ è‡ªç¯çš„é‚»æ¥çŸ©é˜µ</td><td>$\tilde{A}_{ii} = 1$ï¼ˆèŠ‚ç‚¹è¿æ¥è‡ªå·±ï¼‰</td></tr>
            <tr><td>$D$</td><td>åº¦æ•°çŸ©é˜µï¼ˆå¯¹è§’ï¼‰</td><td>$D_{ii} = \sum_j A_{ij}$ï¼ˆèŠ‚ç‚¹ $i$ çš„é‚»å±…æ•°ï¼‰</td></tr>
            <tr><td>$\tilde{D}$</td><td>$\tilde{A}$ çš„åº¦æ•°çŸ©é˜µ</td><td>$\tilde{D}_{ii} = D_{ii} + 1$ï¼ˆå«è‡ªç¯ï¼‰</td></tr>
            <tr><td>$\mathbf{H} \in \mathbb{R}^{n \times d}$</td><td>èŠ‚ç‚¹ç‰¹å¾çŸ©é˜µ</td><td>ç¬¬ $i$ è¡Œæ˜¯ $x_i$</td></tr>
            <tr><td>$\mathbf{W} \in \mathbb{R}^{d \times d'}$</td><td>å¯å­¦ä¹ æƒé‡çŸ©é˜µ</td><td>ç±»ä¼¼å…¨è¿æ¥å±‚çš„æƒé‡</td></tr>
            <tr><td>$\sigma$</td><td>æ¿€æ´»å‡½æ•°</td><td>ReLU, LeakyReLU ç­‰</td></tr>
          </tbody>
        </table>
        
        <p><strong>Step 5ï¼šä¸ºä»€ä¹ˆè¦é™¤ä»¥ $\sqrt{d_i d_j}$ï¼Ÿ</strong></p>
        <ul>
          <li>$\tilde{D}^{-1/2} \tilde{A} \tilde{D}^{-1/2}$ çš„ $(i,j)$ å…ƒç´ æ˜¯ $\frac{\tilde{A}_{ij}}{\sqrt{\tilde{d}_i \tilde{d}_j}}$</li>
          <li><strong>å½’ä¸€åŒ–åŸå› </strong>ï¼šé˜²æ­¢åº¦æ•°å¤§çš„èŠ‚ç‚¹"ä¸»å¯¼"æ›´æ–°</li>
          <li>ä¸å½’ä¸€åŒ–ï¼šåº¦æ•° 10 çš„èŠ‚ç‚¹ä¼šæ”¶åˆ° 10 ä¸ªæ¶ˆæ¯ï¼Œåº¦æ•° 2 çš„èŠ‚ç‚¹åªæ”¶åˆ° 2 ä¸ª â†’ å°ºåº¦ä¸ä¸€è‡´</li>
          <li>å½’ä¸€åŒ–åï¼šæ¯æ¡è¾¹çš„è´¡çŒ®æŒ‰ $\frac{1}{\sqrt{d_i d_j}}$ åŠ æƒï¼Œ<strong>å¹³è¡¡</strong>ä¸åŒåº¦æ•°èŠ‚ç‚¹çš„å½±å“</li>
        </ul>
        
        <p><strong>Step 6ï¼šé€èŠ‚ç‚¹å±•å¼€ï¼ˆç†è§£å•ä¸ªèŠ‚ç‚¹çš„æ›´æ–°ï¼‰</strong></p>
        <p>å¯¹èŠ‚ç‚¹ $i$ï¼š</p>
        $$h_i' = \sigma\left(\sum_{j \in \mathcal{N}(i) \cup \{i\}} \frac{1}{\sqrt{\tilde{d}_i \tilde{d}_j}} \mathbf{W}^\top x_j\right)$$
        <ul>
          <li>$\mathcal{N}(i) \cup \{i\}$ï¼šé‚»å±… + è‡ªå·±ï¼ˆå› ä¸ºåŠ äº†è‡ªç¯ï¼‰</li>
          <li>$\mathbf{W}^\top x_j$ï¼šå…ˆå¯¹æ¯ä¸ªé‚»å±…çš„ç‰¹å¾åšçº¿æ€§å˜æ¢</li>
          <li>$\frac{1}{\sqrt{\tilde{d}_i \tilde{d}_j}}$ï¼šå½’ä¸€åŒ–ç³»æ•°</li>
          <li>æ±‚å’Œ + æ¿€æ´»ï¼šå¾—åˆ°æ–°ç‰¹å¾</li>
        </ul>
        
        <p><strong>ç›´è§‰ç†è§£</strong>ï¼šGCN å°±æ˜¯<strong>åŠ æƒå¹³å‡é‚»å±…ç‰¹å¾</strong>ï¼Œæƒé‡ç”±åº¦æ•°å†³å®šï¼</p>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šGAT æ³¨æ„åŠ›æœºåˆ¶ â€” ä¸ºä»€ä¹ˆå«"æ³¨æ„åŠ›"ï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šGAT çš„å…¬å¼ $\alpha_{ij} = \text{softmax}_j(\text{LeakyReLU}(\mathbf{a}^\top [Wh_i \| Wh_j]))$ é‡Œï¼Œ$\|$ æ˜¯ä»€ä¹ˆï¼Ÿ$\mathbf{a}$ æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ softmaxï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>GAT çš„æ ¸å¿ƒï¼šè‡ªé€‚åº”å­¦ä¹ é‚»å±…çš„é‡è¦æ€§</strong></p>
        
        <p><strong>åŠ¨æœºï¼šGCN çš„å±€é™</strong></p>
        <ul>
          <li>GCN çš„æƒé‡ $\frac{1}{\sqrt{d_i d_j}}$ æ˜¯<strong>å›ºå®šçš„</strong>ï¼Œåªä¾èµ–å›¾ç»“æ„ï¼ˆåº¦æ•°ï¼‰</li>
          <li>ä½†å®é™…ä¸Šï¼Œä¸åŒé‚»å±…çš„<strong>é‡è¦æ€§åº”è¯¥ä¸åŒ</strong>ï¼</li>
          <li>ä¾‹å­ï¼šåœ¨è®ºæ–‡å¼•ç”¨ç½‘ç»œä¸­ï¼Œé«˜å½±å“åŠ›è®ºæ–‡çš„å¼•ç”¨åº”è¯¥æ¯”æ™®é€šè®ºæ–‡çš„æƒé‡æ›´å¤§</li>
        </ul>
        
        <p><strong>GAT çš„è§£å†³æ–¹æ¡ˆï¼šå­¦ä¹ æ³¨æ„åŠ›æƒé‡ $\alpha_{ij}$</strong></p>
        
        <p><strong>Step 1ï¼šç‰¹å¾å˜æ¢</strong></p>
        <ul>
          <li>$z_i = \mathbf{W} h_i$ï¼Œå…¶ä¸­ $\mathbf{W} \in \mathbb{R}^{d' \times d}$ æ˜¯å¯å­¦ä¹ çš„æƒé‡çŸ©é˜µ</li>
          <li>ä½œç”¨ï¼šå°†è¾“å…¥ç‰¹å¾ $h_i \in \mathbb{R}^d$ æŠ•å½±åˆ°æ–°ç©ºé—´ $z_i \in \mathbb{R}^{d'}$</li>
        </ul>
        
        <p><strong>Step 2ï¼šè®¡ç®—æ³¨æ„åŠ›åˆ†æ•°ï¼ˆæœªå½’ä¸€åŒ–ï¼‰</strong></p>
        <ul>
          <li>$e_{ij} = \mathbf{a}^\top [z_i \| z_j]$</li>
          <li>$\|$ è¡¨ç¤º<strong>æ‹¼æ¥</strong>ï¼ˆconcatenationï¼‰ï¼š$[z_i \| z_j] \in \mathbb{R}^{2d'}$</li>
          <li>$\mathbf{a} \in \mathbb{R}^{2d'}$ æ˜¯<strong>æ³¨æ„åŠ›å‘é‡</strong>ï¼ˆå¯å­¦ä¹ å‚æ•°ï¼‰</li>
          <li>$\mathbf{a}^\top [z_i \| z_j]$ æ˜¯<strong>ç‚¹ç§¯</strong>ï¼Œè¾“å‡ºæ ‡é‡ $e_{ij} \in \mathbb{R}$</li>
          <li>ç›´è§‰ï¼š$e_{ij}$ è¡¡é‡"èŠ‚ç‚¹ $j$ å¯¹èŠ‚ç‚¹ $i$ æœ‰å¤šé‡è¦"</li>
        </ul>
        
        <p><strong>Step 3ï¼šLeakyReLU éçº¿æ€§</strong></p>
        <ul>
          <li>$e_{ij} \leftarrow \text{LeakyReLU}(e_{ij})$</li>
          <li>ä½œç”¨ï¼šå¢åŠ éçº¿æ€§ï¼Œå…è®¸è´Ÿå€¼ï¼ˆæ–œç‡ 0.2ï¼‰</li>
          <li>ä¸ºä»€ä¹ˆä¸ç”¨ ReLUï¼ŸLeakyReLU åœ¨è´Ÿå€¼æ—¶ä»æœ‰æ¢¯åº¦ï¼Œè®­ç»ƒæ›´ç¨³å®š</li>
        </ul>
        
        <p><strong>Step 4ï¼šSoftmax å½’ä¸€åŒ–</strong></p>
        $$\alpha_{ij} = \frac{\exp(e_{ij})}{\sum_{k \in \mathcal{N}(i)} \exp(e_{ik})}$$
        <ul>
          <li>ä½œç”¨ï¼šå°†åˆ†æ•° $e_{ij}$ è½¬æ¢ä¸º<strong>æ¦‚ç‡åˆ†å¸ƒ</strong>ï¼ˆæ‰€æœ‰é‚»å±…çš„ $\alpha_{ij}$ åŠ èµ·æ¥ç­‰äº 1ï¼‰</li>
          <li>$\text{softmax}_j$ è¡¨ç¤ºå¯¹<strong>èŠ‚ç‚¹ $i$ çš„æ‰€æœ‰é‚»å±… $j$</strong> åš softmax</li>
          <li>æ€§è´¨ï¼š$\alpha_{ij} \in [0,1]$ï¼Œ$\sum_{j \in \mathcal{N}(i)} \alpha_{ij} = 1$</li>
        </ul>
        
        <p><strong>Step 5ï¼šåŠ æƒèšåˆ</strong></p>
        $$h_i' = \sigma\left(\sum_{j \in \mathcal{N}(i)} \alpha_{ij} \mathbf{W} h_j\right)$$
        <ul>
          <li>ç”¨å­¦åˆ°çš„æƒé‡ $\alpha_{ij}$ åŠ æƒæ±‚å’Œé‚»å±…ç‰¹å¾</li>
          <li>æ³¨æ„ï¼šè¿™é‡Œçš„ $\mathbf{W} h_j = z_j$ï¼ˆå·²ç»åœ¨ Step 1 è®¡ç®—è¿‡ï¼‰</li>
        </ul>
        
        <p><strong>ä¸ºä»€ä¹ˆå«"æ³¨æ„åŠ›"ï¼Ÿ</strong></p>
        <ul>
          <li>ç±»æ¯” NLP ä¸­çš„æ³¨æ„åŠ›æœºåˆ¶ï¼šæ¨¡å‹<strong>å…³æ³¨</strong>ï¼ˆattend toï¼‰ä¸åŒè¾“å…¥çš„ä¸åŒéƒ¨åˆ†</li>
          <li>åœ¨ GAT ä¸­ï¼ŒèŠ‚ç‚¹ $i$ å­¦ä¼š"å…³æ³¨"æœ€é‡è¦çš„é‚»å±…ï¼ˆ$\alpha_{ij}$ å¤§ï¼‰</li>
          <li>ä¸ Transformer çš„ self-attention æœ¬è´¨ç›¸åŒï¼Œåªæ˜¯ GAT åªåœ¨<strong>é‚»å±…</strong>ä¸Šè®¡ç®—ï¼ˆç¨€ç–ï¼‰ï¼ŒTransformer åœ¨<strong>æ‰€æœ‰èŠ‚ç‚¹</strong>ä¸Šè®¡ç®—ï¼ˆå…¨è¿æ¥ï¼‰</li>
        </ul>
        
        <p><strong>å¤šå¤´æ³¨æ„åŠ›ï¼ˆMulti-Head Attentionï¼‰</strong></p>
        <ul>
          <li>ç”¨ $K$ ä¸ªç‹¬ç«‹çš„æ³¨æ„åŠ›å¤´ï¼Œæ¯ä¸ªå¤´å­¦ä¹ ä¸åŒçš„æ³¨æ„åŠ›æ¨¡å¼</li>
          <li>æœ€åæ‹¼æ¥æˆ–å¹³å‡ï¼š$h_i' = \|_{k=1}^K \sigma\left(\sum_j \alpha_{ij}^{(k)} W^{(k)} h_j\right)$</li>
          <li>ä½œç”¨ï¼šç±»ä¼¼ CNN çš„å¤šé€šé“ï¼Œæ•æ‰å¤šç§å…³ç³»æ¨¡å¼</li>
        </ul>
        
        <p><strong>GCN vs GAT å¯¹æ¯”</strong>ï¼š</p>
        <table>
          <thead><tr><th>ç‰¹æ€§</th><th>GCN</th><th>GAT</th></tr></thead>
          <tbody>
            <tr><td>æƒé‡</td><td>å›ºå®š $\frac{1}{\sqrt{d_i d_j}}$</td><td>å­¦ä¹ çš„ $\alpha_{ij}$</td></tr>
            <tr><td>é‚»å±…é‡è¦æ€§</td><td>åªä¾èµ–åº¦æ•°</td><td>ä¾èµ–ç‰¹å¾ç›¸ä¼¼åº¦</td></tr>
            <tr><td>è¡¨è¾¾åŠ›</td><td>è¾ƒä½</td><td>è¾ƒé«˜</td></tr>
            <tr><td>è®¡ç®—é‡</td><td>$O(|E|d)$</td><td>$O(|E|d + |V|d^2)$ï¼ˆå¤šå¤´ï¼‰</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šGraphSAGE çš„é‡‡æ ·ç­–ç•¥</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šGraphSAGE ä¸ºä»€ä¹ˆè¦"é‡‡æ ·"é‚»å±…ï¼Ÿä¸ç”¨æ‰€æœ‰é‚»å±…ä¸æ˜¯æŸå¤±ä¿¡æ¯å—ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>GraphSAGE è§£å†³çš„é—®é¢˜ï¼šè¶…å¤§å›¾</strong></p>
        
        <p><strong>é—®é¢˜èƒŒæ™¯</strong>ï¼š</p>
        <ul>
          <li>ç¤¾äº¤ç½‘ç»œã€æ¨èç³»ç»Ÿçš„å›¾å¯èƒ½æœ‰<strong>æ•°ç™¾ä¸‡èŠ‚ç‚¹</strong></li>
          <li>æœ‰äº›èŠ‚ç‚¹ï¼ˆå¦‚åäººã€çƒ­é—¨å•†å“ï¼‰çš„åº¦æ•°å¯èƒ½é«˜è¾¾<strong>æ•°ä¸‡</strong></li>
          <li>GCN/GAT éœ€è¦è®¿é—®<strong>æ‰€æœ‰é‚»å±…</strong> â†’ å†…å­˜çˆ†ç‚¸ã€è®¡ç®—çˆ†ç‚¸</li>
        </ul>
        
        <p><strong>GraphSAGE çš„ç­–ç•¥ï¼šå›ºå®šå¤§å°é‡‡æ ·</strong></p>
        <ul>
          <li>å¯¹æ¯ä¸ªèŠ‚ç‚¹ï¼Œåªé‡‡æ ·<strong>å›ºå®šæ•°é‡</strong>ï¼ˆå¦‚ $S=10$ï¼‰çš„é‚»å±…</li>
          <li>å¦‚æœé‚»å±…å°‘äº $S$ï¼Œå…¨éƒ¨ä½¿ç”¨</li>
          <li>å¦‚æœé‚»å±…å¤šäº $S$ï¼Œ<strong>éšæœºé‡‡æ ·</strong> $S$ ä¸ª</li>
        </ul>
        
        <p><strong>æ•°å­¦å…¬å¼</strong>ï¼š</p>
        $$h_i' = \sigma\left(\mathbf{W} \cdot \text{CONCAT}\left(h_i, \text{AGG}\left(\{h_j : j \in \mathcal{S}_{\mathcal{N}(i)}\}\right)\right)\right)$$
        <ul>
          <li>$\mathcal{S}_{\mathcal{N}(i)}$ï¼šä» $\mathcal{N}(i)$ ä¸­é‡‡æ ·çš„å­é›†ï¼Œ$|\mathcal{S}_{\mathcal{N}(i)}| = S$</li>
          <li><code>CONCAT</code>ï¼šæ‹¼æ¥è‡ªèº«ç‰¹å¾å’Œé‚»å±…èšåˆ â€” ä¿ç•™<strong>è‡ªèº«ä¿¡æ¯</strong>ï¼ˆä¸åŒäº GCN çš„æ±‚å’Œï¼‰</li>
          <li><code>AGG</code>ï¼šèšåˆå‡½æ•°ï¼Œå¯ä»¥æ˜¯ mean / LSTM / pooling</li>
        </ul>
        
        <p><strong>ä¸ºä»€ä¹ˆé‡‡æ ·ä¸æŸå¤±å¤ªå¤šä¿¡æ¯ï¼Ÿ</strong></p>
        <ol>
          <li><strong>é‚»å±…å†—ä½™</strong>ï¼šåº¦æ•°å¾ˆé«˜çš„èŠ‚ç‚¹ï¼Œå…¶é‚»å±…å¾€å¾€æœ‰ç›¸ä¼¼çš„ä¿¡æ¯ï¼ˆå¦‚åäººçš„ç²‰ä¸ç‰¹å¾ç›¸è¿‘ï¼‰</li>
          <li><strong>å¤šå±‚è¡¥å¿</strong>ï¼šè™½ç„¶æ¯å±‚åªçœ‹ $S$ ä¸ªé‚»å±…ï¼Œä½†å¤šå±‚åå¯ä»¥çœ‹åˆ° $S^L$ ä¸ªèŠ‚ç‚¹ï¼ˆ$L$ æ˜¯å±‚æ•°ï¼‰</li>
          <li><strong>å®éªŒéªŒè¯</strong>ï¼š$S=10$ æ—¶æ€§èƒ½ä¸ä½¿ç”¨å…¨éƒ¨é‚»å±…æ¥è¿‘ï¼Œä½†é€Ÿåº¦å¿«<strong>10-100 å€</strong></li>
        </ol>
        
        <p><strong>èšåˆå™¨ï¼ˆAggregatorï¼‰çš„é€‰æ‹©</strong>ï¼š</p>
        <table>
          <thead><tr><th>èšåˆå™¨</th><th>å…¬å¼</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead>
          <tbody>
            <tr><td>Mean</td><td>$\frac{1}{|S|}\sum_{j \in S} h_j$</td><td>ç®€å•é«˜æ•ˆ</td><td>ä¸¢å¤±åºåˆ—ä¿¡æ¯</td></tr>
            <tr><td>LSTM</td><td>$\text{LSTM}(\{h_j\})$</td><td>è€ƒè™‘åºåˆ—é¡ºåº</td><td>éœ€è¦éšæœºæ‰“ä¹±ä¿æŒç½®æ¢ä¸å˜æ€§</td></tr>
            <tr><td>Pooling</td><td>$\max(\{\text{MLP}(h_j)\})$</td><td>éçº¿æ€§ï¼Œè¡¨è¾¾åŠ›å¼º</td><td>è®¡ç®—ç¨æ…¢</td></tr>
          </tbody>
        </table>
        
        <p><strong>å½’çº³å­¦ä¹ ï¼ˆInductive Learningï¼‰</strong>ï¼šGraphSAGE çš„æ€æ‰‹é”</p>
        <ul>
          <li><strong>GCN</strong>ï¼šéœ€è¦æ•´ä¸ªå›¾çš„é‚»æ¥çŸ©é˜µ $A$ â†’ æ–°èŠ‚ç‚¹åŠ å…¥éœ€è¦<strong>é‡æ–°è®­ç»ƒ</strong></li>
          <li><strong>GraphSAGE</strong>ï¼šåªä¾èµ–<strong>é‡‡æ ·å’Œèšåˆå‡½æ•°</strong> â†’ æ–°èŠ‚ç‚¹ç›´æ¥æ¨ç†ï¼Œæ— éœ€é‡è®­ç»ƒ</li>
          <li>åº”ç”¨ï¼šåŠ¨æ€å›¾ï¼ˆç¤¾äº¤ç½‘ç»œï¼‰ã€å¤§è§„æ¨¡å›¾ï¼ˆæ— æ³•ä¸€æ¬¡åŠ è½½åˆ°å†…å­˜ï¼‰</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-intuition">
    <h4>ğŸ¯ ç›´è§‰ç†è§£ï¼šæ¶ˆæ¯ä¼ é€’ = ä¼ è¯æ¸¸æˆ</h4>
    <p><strong>æƒ³è±¡ä¸€ä¸ªç­çº§ä¼ è¯æ¸¸æˆ</strong>ï¼š</p>
    <ul>
      <li><strong>åˆå§‹</strong>ï¼šæ¯ä¸ªäººï¼ˆèŠ‚ç‚¹ï¼‰æœ‰è‡ªå·±çš„ä¿¡æ¯ï¼ˆç‰¹å¾ $x_i$ï¼‰</li>
      <li><strong>ç¬¬ 1 è½®</strong>ï¼šæ¯ä¸ªäººå‘Šè¯‰é‚»åº§ï¼ˆé‚»å±…ï¼‰ä¸€äº›ä¿¡æ¯ â†’ æ¶ˆæ¯ $m_{ij}$</li>
      <li><strong>èšåˆ</strong>ï¼šæ¯ä¸ªäººå¬å–æ‰€æœ‰é‚»åº§è¯´çš„è¯ï¼Œæ€»ç»“ä¸€ä¸‹ â†’ $\sum_j m_{ij}$</li>
      <li><strong>æ›´æ–°</strong>ï¼šç»“åˆè‡ªå·±åŸæœ‰çš„çŸ¥è¯†å’Œå¬åˆ°çš„ä¿¡æ¯ï¼Œå½¢æˆæ–°è®¤çŸ¥ â†’ $x_i' = f(x_i, \sum_j m_{ij})$</li>
      <li><strong>é‡å¤</strong>ï¼šå¤šè½®ä¼ è¯åï¼Œæ¯ä¸ªäººéƒ½çŸ¥é“äº†æ›´è¿œå¤„çš„äººçš„ä¿¡æ¯</li>
    </ul>
    
    <p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š</p>
    <ul>
      <li>$L$ å±‚ GNN = $L$ è·³é‚»å±…çš„ä¿¡æ¯éƒ½èƒ½ä¼ è¾¾åˆ°</li>
      <li>å±‚æ•°å¤ªå¤šä¼šå¯¼è‡´<strong>è¿‡å¹³æ»‘</strong>ï¼ˆover-smoothingï¼‰â€” æ‰€æœ‰èŠ‚ç‚¹çš„ç‰¹å¾å˜å¾—<strong>ä¸€æ ·</strong>ï¼</li>
      <li>å°±åƒä¼ è¯æ¸¸æˆè½®æ•°å¤ªå¤šï¼Œæœ€åæ‰€æœ‰äººè¯´çš„è¯éƒ½å·®ä¸å¤šäº†</li>
    </ul>
  </div>

  <div class="enrichment-application">
    <h4>ğŸ¥ åŒ»ç–—æœºå™¨äººåº”ç”¨ï¼šGNN åœ¨ PhysRobot ä¸­çš„æ ¸å¿ƒåœ°ä½</h4>
    <p><strong>ç²’å­ç³»ç»Ÿ = åŠ¨æ€å›¾</strong></p>
    <ul>
      <li>æ¯ä¸ª<strong>ç²’å­ = èŠ‚ç‚¹</strong>ï¼Œç‰¹å¾åŒ…å« [ä½ç½®, é€Ÿåº¦, è´¨é‡]</li>
      <li>ç²’å­é—´çš„<strong>ç›¸äº’ä½œç”¨ = è¾¹</strong>ï¼Œè¾¹ç‰¹å¾æ˜¯ EdgeFrameï¼ˆç›¸å¯¹ä½ç§»ã€é€Ÿåº¦ç­‰ï¼‰</li>
      <li>ç‰©ç†è§„å¾‹é€šè¿‡<strong>æ¶ˆæ¯ä¼ é€’</strong>å­¦ä¹ ï¼šé‚»è¿‘ç²’å­äº¤æ¢åŠ›çš„ä¿¡æ¯</li>
    </ul>
    
    <p><strong>æˆ‘ä»¬çš„ DynamicalGNN = MPNN + ç‰©ç†çº¦æŸ</strong></p>
    <ul>
      <li><strong>æ¶ˆæ¯å‡½æ•°</strong>ï¼š$\phi(x_i, x_j, e_{ij})$ è®¡ç®—ç²’å­ $j$ å¯¹ $i$ æ–½åŠ çš„åŠ›/åŠ é€Ÿåº¦</li>
      <li><strong>èšåˆ</strong>ï¼šsumï¼ˆç¬¦åˆç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼šåŠ›çš„å åŠ ï¼‰</li>
      <li><strong>æ›´æ–°</strong>ï¼šé¢„æµ‹åŠ é€Ÿåº¦ $a_i$ï¼Œé€šè¿‡ç§¯åˆ†å¾—åˆ°æ–°çš„ä½ç½®/é€Ÿåº¦</li>
    </ul>
    
    <p><strong>ä¸ºä»€ä¹ˆ GNN é€‚åˆç‰©ç†ä»¿çœŸï¼Ÿ</strong></p>
    <ol>
      <li><strong>å±€éƒ¨æ€§</strong>ï¼šç‰©ç†ä½œç”¨é€šå¸¸æ˜¯å±€éƒ¨çš„ï¼ˆåªéœ€è€ƒè™‘é‚»è¿‘ç²’å­ï¼‰</li>
      <li><strong>ç½®æ¢ä¸å˜æ€§</strong>ï¼šç²’å­ç¼–å·ä¸å½±å“ç‰©ç†è§„å¾‹</li>
      <li><strong>å¯æ‰©å±•æ€§</strong>ï¼šç²’å­æ•°é‡å¯å˜ï¼ˆGraphSAGE çš„å½’çº³å­¦ä¹ ï¼‰</li>
      <li><strong>å¯è§£é‡Šæ€§</strong>ï¼šæ¶ˆæ¯ = åŠ›ï¼Œèšåˆ = åˆåŠ›ï¼Œæ›´æ–° = è¿åŠ¨æ–¹ç¨‹</li>
    </ol>
    
    <p><strong>åŒ»ç–—åœºæ™¯</strong>ï¼š</p>
    <ul>
      <li><strong>è½¯ç»„ç»‡åˆ‡å‰²</strong>ï¼šåˆ‡å‰²çº¿å‘¨å›´çš„ç²’å­é€šè¿‡ GNN ä¼ é€’åº”åŠ›æ³¢</li>
      <li><strong>ç¼åˆæ¨¡æ‹Ÿ</strong>ï¼šç¼åˆç‚¹çš„çº¦æŸåŠ›é€šè¿‡æ¶ˆæ¯ä¼ é€’åˆ°å‘¨å›´ç²’å­</li>
      <li><strong>å¤šå°ºåº¦å»ºæ¨¡</strong>ï¼šç²—ç²’åº¦ç²’å­ï¼ˆå™¨å®˜ï¼‰+ ç»†ç²’åº¦ç²’å­ï¼ˆç»†èƒï¼‰æ··åˆ</li>
    </ul>
  </div>
</div>

<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šGIN ä¸ WL æµ‹è¯•çš„å…³ç³»</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šä¸ºä»€ä¹ˆè¯´ GIN çš„è¡¨è¾¾åŠ›ç­‰äº WL å›¾åŒæ„æµ‹è¯•ï¼ŸWL æµ‹è¯•æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆ sum èšåˆæ¯” mean/max å¼ºï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>WL æµ‹è¯•ï¼ˆWeisfeiler-Leman Testï¼‰</strong>æ˜¯åˆ¤æ–­ä¸¤ä¸ªå›¾æ˜¯å¦<strong>åŒæ„</strong>ï¼ˆç»“æ„ç›¸åŒï¼‰çš„ç»å…¸ç®—æ³•ã€‚</p>
        
        <p><strong>1-WL æµ‹è¯•çš„æ­¥éª¤</strong>ï¼š</p>
        <ol>
          <li><strong>åˆå§‹åŒ–</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„æ ‡ç­¾ $l_i^{(0)}$ = èŠ‚ç‚¹ç‰¹å¾ï¼ˆå¦‚åº¦æ•°ï¼‰</li>
          <li><strong>è¿­ä»£æ›´æ–°</strong>ï¼š$l_i^{(k+1)} = \text{HASH}\left(l_i^{(k)}, \{\{l_j^{(k)} : j \in \mathcal{N}(i)\}\}\right)$</li>
          <li>$\{\{\cdot\}\}$ è¡¨ç¤º<strong>å¤šé‡é›†</strong>ï¼ˆmultisetï¼‰â€” è€ƒè™‘é‡å¤ä½†ä¸è€ƒè™‘é¡ºåº</li>
          <li><strong>åˆ¤æ–­</strong>ï¼šå¦‚æœä¸¤ä¸ªå›¾åœ¨æ‰€æœ‰è¿­ä»£åçš„æ ‡ç­¾åˆ†å¸ƒä¸åŒï¼Œåˆ™<strong>ä¸åŒæ„</strong></li>
        </ol>
        
        <p><strong>GNN ä¸ WL æµ‹è¯•çš„å¯¹åº”</strong>ï¼š</p>
        <ul>
          <li>GNN çš„æ¶ˆæ¯ä¼ é€’ â‰ˆ WL æµ‹è¯•çš„æ ‡ç­¾ä¼ æ’­</li>
          <li>èŠ‚ç‚¹ç‰¹å¾æ›´æ–° â‰ˆ æ ‡ç­¾æ›´æ–°</li>
          <li><strong>å…³é”®é—®é¢˜</strong>ï¼šGNN çš„èšåˆå‡½æ•°èƒ½å¦åƒ WL æµ‹è¯•ä¸€æ ·<strong>åŒºåˆ†ä¸åŒçš„å¤šé‡é›†</strong>ï¼Ÿ</li>
        </ul>
        
        <p><strong>ä¸ºä»€ä¹ˆ sum æ˜¯å•å°„çš„ï¼Ÿ</strong></p>
        <p>å¯¹äº<strong>å¯æ•°å¤šé‡é›†</strong>ï¼ˆå…ƒç´ å€¼æ¥è‡ªå¯æ•°é›†ï¼‰ï¼Œsum æ˜¯<strong>å•å°„å‡½æ•°</strong>ï¼š</p>
        <ul>
          <li>$\{\{1, 1, 2\}\}$ â†’ sum = 4</li>
          <li>$\{\{1, 2, 2\}\}$ â†’ sum = 5</li>
          <li>$\{\{1, 1, 1, 1\}\}$ â†’ sum = 4</li>
          <li>è™½ç„¶å’Œå¯èƒ½ç›¸åŒï¼Œä½†<strong>ç†è®ºä¸Š</strong>ï¼ˆé…åˆ MLP çš„é€¼è¿‘èƒ½åŠ›ï¼‰å¯ä»¥åŒºåˆ†</li>
        </ul>
        
        <p><strong>mean/max ä¸ºä»€ä¹ˆä¸å¤Ÿï¼Ÿ</strong></p>
        <ul>
          <li><strong>mean</strong>ï¼š$\{\{1, 1\}\}$ å’Œ $\{\{1\}\}$ çš„å¹³å‡å€¼éƒ½æ˜¯ 1 â†’ æ— æ³•åŒºåˆ†å¤šé‡é›†å¤§å°</li>
          <li><strong>max</strong>ï¼š$\{\{1, 1, 2\}\}$ å’Œ $\{\{1, 2, 2\}\}$ çš„æœ€å¤§å€¼éƒ½æ˜¯ 2 â†’ ä¸¢å¤±äº†å…ƒç´ åˆ†å¸ƒä¿¡æ¯</li>
        </ul>
        
        <p><strong>GIN çš„å®Œæ•´å…¬å¼</strong>ï¼š</p>
        $$h_i^{(k+1)} = \text{MLP}^{(k)}\left((1 + \epsilon^{(k)}) h_i^{(k)} + \sum_{j \in \mathcal{N}(i)} h_j^{(k)}\right)$$
        <ul>
          <li>$(1 + \epsilon)$ï¼š<strong>åŠ æƒè‡ªèº«ç‰¹å¾</strong>ã€‚$\epsilon$ å¯å­¦ä¹ ï¼Œè®©ç½‘ç»œè‡ªé€‚åº”è°ƒæ•´"è‡ªå·± vs é‚»å±…"çš„é‡è¦æ€§</li>
          <li><strong>sum èšåˆ</strong>ï¼šä¿è¯å•å°„æ€§</li>
          <li><strong>MLP</strong>ï¼šè€Œéå•å±‚çº¿æ€§ï¼Œæä¾›è¶³å¤Ÿçš„è¡¨è¾¾åŠ›é€¼è¿‘ä»»ä½•å‡½æ•°</li>
        </ul>
        
        <p><strong>ç†è®ºç»“æœï¼ˆXu et al., 2019ï¼‰</strong>ï¼š</p>
        <ul>
          <li>GIN èƒ½åŒºåˆ†çš„å›¾ = 1-WL æµ‹è¯•èƒ½åŒºåˆ†çš„å›¾</li>
          <li>ä»»ä½•å…¶ä»– GNNï¼ˆå¦‚ GCN, GraphSAGEï¼‰çš„è¡¨è¾¾åŠ› â‰¤ GIN</li>
          <li>ä½† WL æµ‹è¯•ä¹Ÿæœ‰<strong>å±€é™</strong>ï¼šæ— æ³•åŒºåˆ†æŸäº›å¯¹ç§°å›¾ï¼ˆå¦‚æ­£åˆ™å›¾ï¼‰</li>
        </ul>
        
        <p><strong>å®è·µå»ºè®®</strong>ï¼š</p>
        <ul>
          <li>å›¾åˆ†ç±»ä»»åŠ¡ï¼šä¼˜å…ˆç”¨ GINï¼ˆè¡¨è¾¾åŠ›æœ€å¼ºï¼‰</li>
          <li>èŠ‚ç‚¹åˆ†ç±»/é“¾æ¥é¢„æµ‹ï¼šGCN/GAT é€šå¸¸è¶³å¤Ÿä¸”æ›´å¿«</li>
          <li>è¶…å¤§å›¾ï¼šGraphSAGEï¼ˆå¯é‡‡æ ·ï¼‰</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šè¿‡å¹³æ»‘é—®é¢˜ï¼ˆOver-smoothingï¼‰</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šä¸ºä»€ä¹ˆ GNN å±‚æ•°ä¸èƒ½å¤ªå¤šï¼Ÿä»€ä¹ˆæ˜¯è¿‡å¹³æ»‘ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>è¿‡å¹³æ»‘ï¼ˆOver-smoothingï¼‰</strong>æ˜¯ GNN çš„æ ¸å¿ƒç“¶é¢ˆä¹‹ä¸€ã€‚</p>
        
        <p><strong>ç°è±¡</strong>ï¼šéšç€å±‚æ•°å¢åŠ ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„ç‰¹å¾å˜å¾—<strong>è¶Šæ¥è¶Šç›¸ä¼¼</strong>ï¼Œæœ€ç»ˆå‡ ä¹ç›¸åŒã€‚</p>
        
        <p><strong>æ•°å­¦è§£é‡Š</strong>ï¼š</p>
        <ul>
          <li>æ¯ä¸€å±‚ GNN ç›¸å½“äºåœ¨å›¾ä¸Šåš<strong>æ‰©æ•£</strong>ï¼ˆç‰¹å¾ä»é‚»å±…ä¼ æ’­ï¼‰</li>
          <li>å¤šå±‚å †å  = å¤šæ¬¡æ‰©æ•£</li>
          <li>æœ€ç»ˆæ”¶æ•›åˆ°å›¾çš„<strong>ç¨³æ€</strong> â€” æ‰€æœ‰èŠ‚ç‚¹çš„ç‰¹å¾éƒ½æ˜¯å…¨å›¾çš„å¹³å‡å€¼ï¼</li>
        </ul>
        
        <p><strong>å…·ä½“ä¾‹å­</strong>ï¼ˆGCNï¼‰ï¼š</p>
        <ul>
          <li>$\mathbf{H}^{(k+1)} = \hat{A} \mathbf{H}^{(k)} \mathbf{W}^{(k)}$ï¼Œå…¶ä¸­ $\hat{A} = \tilde{D}^{-1/2}\tilde{A}\tilde{D}^{-1/2}$</li>
          <li>$\hat{A}$ æ˜¯<strong>éšæœºæ¸¸èµ°çŸ©é˜µ</strong>çš„å½’ä¸€åŒ–ç‰ˆæœ¬ï¼Œç‰¹å¾å€¼åœ¨ $[-1, 1]$</li>
          <li>å¤šæ¬¡ä¹˜ $\hat{A}$ ç›¸å½“äº<strong>æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘</strong>ï¼ˆLaplacian smoothingï¼‰</li>
          <li>$k \to \infty$ æ—¶ï¼Œ$\mathbf{H}^{(k)}$ æ”¶æ•›åˆ°<strong>æœ€å°çš„ç‰¹å¾å‘é‡</strong>ï¼ˆå¯¹åº”æœ€å°ç‰¹å¾å€¼ 0ï¼‰â€” å¸¸æ•°å‘é‡ï¼</li>
        </ul>
        
        <p><strong>ç”Ÿæ´»ç±»æ¯”</strong>ï¼š</p>
        <ul>
          <li>æƒ³è±¡ä¸€ä¸ªæ‘åº„ï¼Œæ¯å¤©æ¯ä¸ªäººéƒ½å’Œé‚»å±…åˆ†äº«ä¸€åŠçš„é’±</li>
          <li>å‡ è½®åï¼Œ<strong>æ‰€æœ‰äººçš„è´¢å¯Œè¶‹äºä¸€è‡´</strong>ï¼ˆå¹³å‡å€¼ï¼‰</li>
          <li>GNN çš„ç‰¹å¾æ›´æ–°ç±»ä¼¼ï¼šæ¯æ¬¡éƒ½æ··åˆé‚»å±…çš„ç‰¹å¾</li>
        </ul>
        
        <p><strong>å®éªŒè¯æ®</strong>ï¼š</p>
        <ul>
          <li>GCN åœ¨ 2-3 å±‚æ—¶æ€§èƒ½æœ€å¥½ï¼Œè¶…è¿‡ 4 å±‚æ€§èƒ½<strong>ä¸‹é™</strong></li>
          <li>64 å±‚ GCN çš„æ‰€æœ‰èŠ‚ç‚¹ç‰¹å¾å‡ ä¹ç›¸åŒï¼ˆä½™å¼¦ç›¸ä¼¼åº¦ > 0.99ï¼‰</li>
        </ul>
        
        <p><strong>ç¼“è§£æ–¹æ³•</strong>ï¼š</p>
        <ol>
          <li><strong>æ®‹å·®è¿æ¥</strong>ï¼ˆResNet-styleï¼‰ï¼š$h^{(k+1)} = h^{(k)} + \Delta h^{(k)}$ â€” ä¿ç•™åŸå§‹ä¿¡æ¯</li>
          <li><strong>è·³è·ƒè¿æ¥</strong>ï¼ˆJK-Netï¼‰ï¼š$h_{\text{final}} = \text{CONCAT}(h^{(1)}, h^{(2)}, \ldots, h^{(L)})$ â€” æ··åˆå¤šå±‚ä¿¡æ¯</li>
          <li><strong>Dropout</strong>ï¼šéšæœºä¸¢å¼ƒé‚»å±…ï¼Œå‡å°‘è¿‡åº¦å¹³æ»‘</li>
          <li><strong>åˆå§‹è¿æ¥</strong>ï¼ˆInitial Residualï¼‰ï¼š$h^{(k+1)} = h^{(0)} + \Delta h^{(k)}$ â€” å§‹ç»ˆä¿æŒä¸è¾“å…¥çš„è¿æ¥</li>
          <li><strong>å±‚å½’ä¸€åŒ–</strong>ï¼ˆLayerNormï¼‰ï¼šæ ‡å‡†åŒ–ç‰¹å¾ï¼Œé˜²æ­¢æ•°å€¼çˆ†ç‚¸</li>
        </ol>
        
        <p><strong>ç†è®ºè§†è§’</strong>ï¼š</p>
        <ul>
          <li>è¿‡å¹³æ»‘ = GNN çš„<strong>è¡¨è¾¾ç“¶é¢ˆ</strong>ï¼šæ— æ³•åŒºåˆ†è¿œè·ç¦»èŠ‚ç‚¹</li>
          <li>Transformer æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼ˆå®Œå…¨å›¾ + ä½ç½®ç¼–ç ï¼‰</li>
          <li>æœ€æ–°ç ”ç©¶ï¼š<strong>å›¾ Transformer</strong>ï¼ˆGraphGPSï¼‰ç»“åˆç¨€ç– GNN å’Œå…¨å±€æ³¨æ„åŠ›</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-intuition">
    <h4>ğŸ¯ ç›´è§‰ç†è§£ï¼šä¸åŒ GNN çš„"ä¸ªæ€§"</h4>
    <p><strong>GCN</strong>ï¼š<em>"æˆ‘å¾ˆç®€å•ï¼Œå°±æ˜¯å¹³å‡é‚»å±…çš„ç‰¹å¾"</em></p>
    <ul>
      <li>ä¼˜ç‚¹ï¼šå¿«é€Ÿã€å¯æ‰©å±•</li>
      <li>ç¼ºç‚¹ï¼šæ‰€æœ‰é‚»å±…ä¸€è§†åŒä»ï¼ˆä¸ç®¡é‡è¦æ€§ï¼‰</li>
      <li>é€‚åˆï¼šåŒè´¨å›¾ï¼ˆé‚»å±…éƒ½å·®ä¸å¤šï¼‰</li>
    </ul>
    
    <p><strong>GAT</strong>ï¼š<em>"æˆ‘ä¼šçœ‹é‡è¦çš„é‚»å±…"</em></p>
    <ul>
      <li>ä¼˜ç‚¹ï¼šè‡ªé€‚åº”æƒé‡ï¼Œå¼‚è´¨å›¾å‹å¥½</li>
      <li>ç¼ºç‚¹ï¼šè®¡ç®—é‡å¤§ï¼ˆéœ€è¦è®¡ç®—æ³¨æ„åŠ›ï¼‰</li>
      <li>é€‚åˆï¼šå¼‚è´¨å›¾ï¼ˆä¸åŒç±»å‹çš„èŠ‚ç‚¹/è¾¹ï¼‰</li>
    </ul>
    
    <p><strong>GraphSAGE</strong>ï¼š<em>"æˆ‘èƒ½å¤„ç†è¶…å¤§å›¾"</em></p>
    <ul>
      <li>ä¼˜ç‚¹ï¼šé‡‡æ ·ç­–ç•¥ï¼Œæ”¯æŒå½’çº³å­¦ä¹ </li>
      <li>ç¼ºç‚¹ï¼šé‡‡æ ·å¼•å…¥éšæœºæ€§</li>
      <li>é€‚åˆï¼šåŠ¨æ€å›¾ã€è¶…å¤§è§„æ¨¡å›¾</li>
    </ul>
    
    <p><strong>GIN</strong>ï¼š<em>"æˆ‘æ˜¯ç†è®ºæœ€å¼ºçš„"</em></p>
    <ul>
      <li>ä¼˜ç‚¹ï¼šè¡¨è¾¾åŠ›è¾¾åˆ° WL æµ‹è¯•ä¸Šç•Œ</li>
      <li>ç¼ºç‚¹ï¼šå¯¹èŠ‚ç‚¹åˆ†ç±»ä¸ä¸€å®šæœ€ä¼˜</li>
      <li>é€‚åˆï¼šå›¾åˆ†ç±»ä»»åŠ¡</li>
    </ul>
    
    <p><strong>DynamicalGNN (PhysRobot)</strong>ï¼š<em>"æˆ‘æ‡‚ç‰©ç†"</em></p>
    <ul>
      <li>ä¼˜ç‚¹ï¼šç¼–ç ç‰©ç†çº¦æŸï¼ˆEdgeFrameã€å¯¹ç§°æ€§ï¼‰</li>
      <li>ç¼ºç‚¹ï¼šç‰¹åŒ–äºåŠ¨åŠ›å­¦ç³»ç»Ÿ</li>
      <li>é€‚åˆï¼šç²’å­ç³»ç»Ÿã€å¯å˜å½¢ä½“ä»¿çœŸ</li>
    </ul>
  </div>
</div>

<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šPhysRobot çš„ DynamicalGNN ä»£ç è§£æ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šé¡¹ç›®ä»£ç é‡Œçš„ <code>PhysicsMessagePassing</code> æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿå’Œæ ‡å‡† MPNN æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>é€è¡Œä»£ç è§£æ</strong>ï¼ˆå¯¹åº” GDL ç†è®ºï¼‰ï¼š</p>
        
        <pre><code>class PhysicsMessagePassing(MessagePassing):
    def __init__(self, hidden_dim, edge_dim):
        super().__init__(aggr='add')  # â† å…³é”®ï¼šsum èšåˆä¿æŒåŠ¨é‡å®ˆæ’</code></pre>
        <ul>
          <li><code>aggr='add'</code>ï¼šä½¿ç”¨<strong>sum</strong>èšåˆï¼ˆå¯¹åº”å…¬å¼ä¸­çš„ $\bigoplus$ï¼‰</li>
          <li>ç‰©ç†æ„ä¹‰ï¼šåŠ›çš„<strong>å åŠ åŸç†</strong>ï¼ˆç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼‰</li>
          <li>å¦‚æœç”¨ meanï¼Œä¼šç ´ååŠ›çš„å®ˆæ’æ€§</li>
        </ul>
        
        <pre><code>self.message_net = nn.Sequential(
    nn.Linear(edge_dim + 2 * hidden_dim, hidden_dim),
    nn.LayerNorm(hidden_dim),
    nn.ReLU(),
    nn.Linear(hidden_dim, hidden_dim),
)</code></pre>
        <ul>
          <li>æ¶ˆæ¯å‡½æ•° $\phi(x_i, x_j, e_{ij})$ çš„å®ç°</li>
          <li>è¾“å…¥ç»´åº¦ï¼š<code>edge_dim + 2 * hidden_dim</code> = $e_{ij}$ + $x_i$ + $x_j$</li>
          <li><code>LayerNorm</code>ï¼šé˜²æ­¢æ•°å€¼çˆ†ç‚¸ï¼ˆç‰¹åˆ«æ˜¯å¤šå±‚åï¼‰</li>
          <li>å¯¹åº” MPNN æ¡†æ¶çš„ $\phi$ å‡½æ•°</li>
        </ul>
        
        <pre><code>def message(self, x_i, x_j, edge_attr):
    # m_ij = Ï†(e_ij, h_i, h_j)
    return self.message_net(torch.cat([edge_attr, x_i, x_j], dim=-1))</code></pre>
        <ul>
          <li><code>x_i</code>ï¼šæ¥æ”¶èŠ‚ç‚¹ï¼ˆç›®æ ‡ï¼‰çš„ç‰¹å¾</li>
          <li><code>x_j</code>ï¼šå‘é€èŠ‚ç‚¹ï¼ˆæºï¼‰çš„ç‰¹å¾</li>
          <li><code>edge_attr</code>ï¼šè¾¹ç‰¹å¾ï¼ˆæ¥è‡ª EdgeFrameï¼‰</li>
          <li><code>torch.cat</code>ï¼šæ‹¼æ¥ä¸‰è€…</li>
          <li>è¾“å‡º $m_{ij}$ï¼šä»ç²’å­ $j$ åˆ°ç²’å­ $i$ çš„"æ¶ˆæ¯"ï¼ˆç‰©ç†ä¸Šæ˜¯åŠ›/åŠ é€Ÿåº¦çš„è´¡çŒ®ï¼‰</li>
        </ul>
        
        <pre><code>def update(self, aggr_out, x):
    # h_i' = Ïˆ(h_i, agg) + h_i  â† æ®‹å·®è¿æ¥
    return self.update_net(torch.cat([x, aggr_out], dim=-1)) + x</code></pre>
        <ul>
          <li><code>aggr_out</code>ï¼š$\sum_{j \in \mathcal{N}(i)} m_{ij}$ï¼ˆèšåˆåçš„æ¶ˆæ¯ï¼‰</li>
          <li><code>x</code>ï¼šèŠ‚ç‚¹è‡ªèº«çš„æ—§ç‰¹å¾</li>
          <li><code>+ x</code>ï¼š<strong>æ®‹å·®è¿æ¥</strong>ï¼ˆç±»ä¼¼ ResNetï¼‰â€” å¯¹åº” Â§5.1 çš„ ODE ç¦»æ•£åŒ–</li>
          <li>ç‰©ç†æ„ä¹‰ï¼š$x_{\text{new}} = x_{\text{old}} + \Delta x$ï¼ˆé€Ÿåº¦/ä½ç½®çš„å¢é‡æ›´æ–°ï¼‰</li>
        </ul>
        
        <p><strong>EdgeFrame çš„ä½œç”¨</strong>ï¼š</p>
        <ul>
          <li>æ„é€ è¾¹ç‰¹å¾ $e_{ij} = [\mathbf{r}_{ij}, \|\mathbf{r}_{ij}\|, \mathbf{v}_{\text{rel}}, \|\mathbf{v}_{\text{rel}}\|]$</li>
          <li>$\mathbf{r}_{ij} = \mathbf{x}_j - \mathbf{x}_i$ï¼šç›¸å¯¹ä½ç§»ï¼ˆ3ç»´å‘é‡ï¼‰</li>
          <li>$\|\mathbf{r}_{ij}\|$ï¼šè·ç¦»ï¼ˆæ ‡é‡ï¼ŒE(3) ä¸å˜é‡ï¼‰</li>
          <li>$\mathbf{v}_{\text{rel}} = \mathbf{v}_j - \mathbf{v}_i$ï¼šç›¸å¯¹é€Ÿåº¦ï¼ˆ3ç»´å‘é‡ï¼‰</li>
          <li>$\|\mathbf{v}_{\text{rel}}\|$ï¼šç›¸å¯¹é€Ÿç‡ï¼ˆæ ‡é‡ï¼‰</li>
          <li>è¿™ 8 ä¸ªç‰¹å¾ç¼–ç äº†ç²’å­é—´çš„<strong>æ‰€æœ‰ç©ºé—´-è¿åŠ¨å­¦ä¿¡æ¯</strong></li>
        </ul>
        
        <p><strong>ä¸æ ‡å‡† MPNN çš„å¯¹æ¯”</strong>ï¼š</p>
        <table>
          <thead><tr><th>ç»„ä»¶</th><th>æ ‡å‡† MPNN</th><th>DynamicalGNN</th></tr></thead>
          <tbody>
            <tr><td>æ¶ˆæ¯</td><td>ä»»æ„ MLP</td><td>MLP + EdgeFrameï¼ˆç‰©ç†ç‰¹å¾ï¼‰</td></tr>
            <tr><td>èšåˆ</td><td>sum/mean/max</td><td>sumï¼ˆç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼‰</td></tr>
            <tr><td>æ›´æ–°</td><td>ä»»æ„å‡½æ•°</td><td>æ®‹å·®è¿æ¥ï¼ˆODE ç¦»æ•£åŒ–ï¼‰</td></tr>
            <tr><td>è¾“å‡º</td><td>ä»»æ„é¢„æµ‹</td><td>åŠ é€Ÿåº¦ï¼ˆç”¨äºç§¯åˆ†å™¨ï¼‰</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="enrichment-application">
    <h4>ğŸ¥ åŒ»ç–—æœºå™¨äººï¼šGNN çš„ä¸‰å¤§åº”ç”¨åœºæ™¯</h4>
    
    <p><strong>åœºæ™¯ 1ï¼šç²’å­ç³»ç»Ÿä»¿çœŸï¼ˆPhysRobot æ ¸å¿ƒï¼‰</strong></p>
    <ul>
      <li><strong>é—®é¢˜</strong>ï¼šæ¨¡æ‹Ÿè½¯ç»„ç»‡çš„å˜å½¢ã€åˆ‡å‰²ã€ç¼åˆ</li>
      <li><strong>æ–¹æ³•</strong>ï¼šç”¨ç²’å­è¡¨ç¤ºç»„ç»‡ï¼ŒGNN å­¦ä¹ ç²’å­é—´çš„ç›¸äº’ä½œç”¨åŠ›</li>
      <li><strong>ä¼˜åŠ¿</strong>ï¼šæ¯”æœ‰é™å…ƒæ–¹æ³•ï¼ˆFEMï¼‰å¿« 100-1000 å€ï¼Œé€‚åˆå®æ—¶äº¤äº’</li>
      <li><strong>æŠ€æœ¯æ ˆ</strong>ï¼šDynamicalGNN + EdgeFrame + Verlet ç§¯åˆ†å™¨</li>
    </ul>
    
    <p><strong>åœºæ™¯ 2ï¼šæ‰‹æœ¯è§„åˆ’ä¸­çš„å™¨å®˜å»ºæ¨¡</strong></p>
    <ul>
      <li><strong>é—®é¢˜</strong>ï¼šä» CT/MRI é‡å»ºå™¨å®˜ 3D ç½‘æ ¼</li>
      <li><strong>æ–¹æ³•</strong>ï¼šç½‘æ ¼èŠ‚ç‚¹ = GNN èŠ‚ç‚¹ï¼Œå­¦ä¹ èŠ‚ç‚¹çš„ä½ç½®è°ƒæ•´</li>
      <li><strong>ä¼˜åŠ¿</strong>ï¼šGNN ä¿æŒæ‹“æ‰‘ç»“æ„ï¼Œä¼˜äºé€ç‚¹é¢„æµ‹</li>
      <li><strong>ç›¸å…³è®ºæ–‡</strong>ï¼šMeshGNNï¼ˆLiu et al., 2020ï¼‰</li>
    </ul>
    
    <p><strong>åœºæ™¯ 3ï¼šåŒ»å­¦çŸ¥è¯†å›¾è°±æ¨ç†</strong></p>
    <ul>
      <li><strong>é—®é¢˜</strong>ï¼šç–¾ç—…-ç—‡çŠ¶-è¯ç‰©çš„å…³è”é¢„æµ‹</li>
      <li><strong>æ–¹æ³•</strong>ï¼šå®ä½“ = èŠ‚ç‚¹ï¼Œå…³ç³» = è¾¹ï¼ŒGNN åšé“¾æ¥é¢„æµ‹</li>
      <li><strong>ä¼˜åŠ¿</strong>ï¼šæ•æ‰å¤šè·³æ¨ç†ï¼ˆå¦‚è¯ç‰© A â†’ ç–¾ç—… B â† ç—‡çŠ¶ Cï¼‰</li>
      <li><strong>åº”ç”¨</strong>ï¼šè¾…åŠ©è¯Šæ–­ã€è¯ç‰©æ¨è</li>
    </ul>
  </div>
</div>
<!-- === END ENRICHMENT: sec5-3 === -->


    <h3 id="gnn-overview">GNN æ€»è§ˆ</h3>

    <div class="bilingual">
      <div class="zh">
        <p>å›¾ç¥ç»ç½‘ç»œæ˜¯å‡ ä½•æ·±åº¦å­¦ä¹ è“å›¾åœ¨<strong>å›¾</strong>ä¸Šåˆ©ç”¨<strong>ç½®æ¢ç¾¤</strong>æ€§è´¨çš„å®ç°ã€‚GNN æ˜¯<span class="term">ç½®æ¢ç­‰å˜</span>å‡½æ•° $F(\mathbf{X}, \mathbf{A})$ï¼Œé€šè¿‡åœ¨å±€éƒ¨é‚»åŸŸä¸Šåº”ç”¨å…±äº«çš„ç½®æ¢ä¸å˜å‡½æ•° $\phi(x_u, \mathbf{X}_{\mathcal{N}_u})$ æ¥æ„é€ ã€‚</p>
      </div>
      <div class="en">
        GNNs are the realisation of the GDL blueprint on graphs leveraging properties of the permutation group. They are permutation equivariant functions constructed by applying shared permutation invariant functions over local neighbourhoods.
      </div>
    </div>

    <h3 id="gnn-mpnn">æ¶ˆæ¯ä¼ é€’ç¥ç»ç½‘ç»œ (MPNN) æ¡†æ¶</h3>

    <p>å‡ ä¹æ‰€æœ‰ GNN éƒ½å¯ä»¥ç»Ÿä¸€åˆ°<span class="term">æ¶ˆæ¯ä¼ é€’</span>ï¼ˆMessage Passingï¼‰æ¡†æ¶ä¸‹ã€‚è¿™ä¸ªæ¡†æ¶ç”± Gilmer et al. (2017) æå‡ºï¼š</p>

    <div class="blueprint">
      <h4>æ¶ˆæ¯ä¼ é€’èŒƒå¼ (MPNN)</h4>
      $$x_i' = \gamma\left(x_i, \bigoplus_{j \in \mathcal{N}(i)} \phi(x_i, x_j, e_{ij})\right)$$
      <p>å…¶ä¸­ï¼š</p>
      <ul>
        <li>$\phi$ï¼š<strong>æ¶ˆæ¯å‡½æ•°</strong>ï¼ˆmessage functionï¼‰â€” è®¡ç®—ä»èŠ‚ç‚¹ $j$ åˆ°èŠ‚ç‚¹ $i$ çš„æ¶ˆæ¯</li>
        <li>$\bigoplus$ï¼š<strong>èšåˆå‡½æ•°</strong>ï¼ˆaggregationï¼‰â€” ç½®æ¢ä¸å˜çš„ï¼ˆå¦‚ sum, mean, maxï¼‰</li>
        <li>$\gamma$ï¼š<strong>æ›´æ–°å‡½æ•°</strong>ï¼ˆupdate functionï¼‰â€” ç»“åˆæ—§ç‰¹å¾å’Œèšåˆæ¶ˆæ¯</li>
        <li>$e_{ij}$ï¼š<strong>è¾¹ç‰¹å¾</strong>ï¼ˆedge featuresï¼‰â€” å¯é€‰</li>
      </ul>
    </div>

    <div class="symbol-table">
      <h4>æ¶ˆæ¯ä¼ é€’ç¬¦å·è¡¨</h4>
      <table>
        <thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>ç»´åº¦</th></tr></thead>
        <tbody>
          <tr><td>$x_i \in \mathbb{R}^d$</td><td>èŠ‚ç‚¹ $i$ çš„ç‰¹å¾å‘é‡</td><td>$d$</td></tr>
          <tr><td>$\mathcal{N}(i)$</td><td>èŠ‚ç‚¹ $i$ çš„é‚»å±…é›†åˆ</td><td>â€”</td></tr>
          <tr><td>$e_{ij} \in \mathbb{R}^{d_e}$</td><td>è¾¹ $(i,j)$ çš„ç‰¹å¾</td><td>$d_e$</td></tr>
          <tr><td>$\phi: \mathbb{R}^d \times \mathbb{R}^d \times \mathbb{R}^{d_e} \to \mathbb{R}^{d'}$</td><td>æ¶ˆæ¯å‡½æ•°</td><td>â€”</td></tr>
          <tr><td>$\bigoplus$</td><td>ç½®æ¢ä¸å˜èšåˆï¼ˆsum/mean/maxï¼‰</td><td>â€”</td></tr>
          <tr><td>$\gamma: \mathbb{R}^d \times \mathbb{R}^{d'} \to \mathbb{R}^{d''}$</td><td>èŠ‚ç‚¹æ›´æ–°å‡½æ•°</td><td>â€”</td></tr>
          <tr><td>$m_{ij} = \phi(x_i, x_j, e_{ij})$</td><td>ä» $j$ åˆ° $i$ çš„æ¶ˆæ¯</td><td>$d'$</td></tr>
        </tbody>
      </table>
    </div>

    <h3 id="gnn-three-flavors">ä¸‰ç§ GNN é£æ ¼</h3>

    <p>ç»å¤§å¤šæ•° GNN æ–‡çŒ®å¯ä»¥å½’çº³ä¸ºä¸‰ç§"é£æ ¼"ï¼ˆflavorsï¼‰ï¼š</p>

    <div class="figure">
      <img src="../assets/ch5_p88_img0.png" alt="Three flavors of GNN layers">
      <figcaption>å›¾ 17ï¼šä¸‰ç§ GNN å±‚çš„æ•°æ®æµå¯è§†åŒ–ã€‚å·¦ï¼šå·ç§¯ï¼ˆå›ºå®šæƒé‡ $c_{uv}$ï¼‰ï¼›ä¸­ï¼šæ³¨æ„åŠ›ï¼ˆéšå¼è®¡ç®—æƒé‡ $\alpha_{uv}$ï¼‰ï¼›å³ï¼šæ¶ˆæ¯ä¼ é€’ï¼ˆå‘é‡æ¶ˆæ¯ $m_{uv}$ï¼‰ã€‚</figcaption>
    </div>

    <h4>é£æ ¼ 1ï¼šå·ç§¯å‹ GNN (Convolutional)</h4>

    <div class="math-block">
      $$h_u = \phi\left(x_u, \bigoplus_{v \in \mathcal{N}_u} c_{uv} \psi(x_v)\right) \tag{33}$$
      <div class="math-explain">
        é‚»å±…ç‰¹å¾è¢«<strong>å›ºå®šæƒé‡</strong> $c_{uv}$ åŠ æƒåèšåˆã€‚$c_{uv}$ é€šå¸¸ç›´æ¥å–å†³äºé‚»æ¥çŸ©é˜µ $A$ çš„æ¡ç›®ï¼ˆå¦‚å½’ä¸€åŒ–åº¦æ•°ï¼‰ã€‚å½“èšåˆä¸ºæ±‚å’Œæ—¶ï¼Œç›¸å½“äºçº¿æ€§æ‰©æ•£æˆ–ä¸ä½ç½®ç›¸å…³çš„çº¿æ€§æ»¤æ³¢ã€‚ä»£è¡¨ï¼š<strong>GCN</strong>ã€ChebNetã€‚
      </div>
    </div>

    <h4>é£æ ¼ 2ï¼šæ³¨æ„åŠ›å‹ GNN (Attentional)</h4>

    <div class="math-block">
      $$h_u = \phi\left(x_u, \bigoplus_{v \in \mathcal{N}_u} a(x_u, x_v) \psi(x_v)\right) \tag{34}$$
      <div class="math-explain">
        æƒé‡ $\alpha_{uv} = a(x_u, x_v)$ ç”±å¯å­¦ä¹ çš„<strong>æ³¨æ„åŠ›æœºåˆ¶</strong>éšå¼è®¡ç®—ã€‚æƒé‡æ˜¯<strong>ç‰¹å¾ç›¸å…³</strong>çš„â€”â€”ä¸åŒçš„èŠ‚ç‚¹å¯¹ä¼šæœ‰ä¸åŒçš„æ³¨æ„åŠ›æƒé‡ã€‚ä»£è¡¨ï¼š<strong>GAT</strong>ã€GATv2ã€‚
      </div>
    </div>

    <h4>é£æ ¼ 3ï¼šæ¶ˆæ¯ä¼ é€’å‹ GNN (Message-passing)</h4>

    <div class="math-block">
      $$h_u = \phi\left(x_u, \bigoplus_{v \in \mathcal{N}_u} \psi(x_u, x_v)\right) \tag{35}$$
      <div class="math-explain">
        $\psi$ æ˜¯å®Œå…¨å¯å­¦ä¹ çš„æ¶ˆæ¯å‡½æ•°ï¼Œè®¡ç®—ä» $v$ å‘é€åˆ° $u$ çš„<strong>å‘é‡æ¶ˆæ¯</strong>ã€‚æ¶ˆæ¯åŒæ—¶ä¾èµ–å‘é€è€…å’Œæ¥æ”¶è€…çš„ç‰¹å¾ã€‚è¿™æ˜¯æœ€é€šç”¨çš„å½¢å¼ã€‚ä»£è¡¨ï¼šMPNNã€<strong>æˆ‘ä»¬çš„ DynamicalGNN</strong>ã€‚
      </div>
    </div>

    <div class="callout callout-key">
      <h4>è¡¨ç¤ºèƒ½åŠ›çš„åŒ…å«å…³ç³»</h4>
      <p>å·ç§¯ $\subseteq$ æ³¨æ„åŠ› $\subseteq$ æ¶ˆæ¯ä¼ é€’ã€‚æ³¨æ„åŠ› GNN å¯ä»¥æ¨¡æ‹Ÿå·ç§¯ GNNï¼ˆä»¤ $a(x_u, x_v) = c_{uv}$ï¼‰ï¼›æ¶ˆæ¯ä¼ é€’å¯ä»¥æ¨¡æ‹Ÿæ³¨æ„åŠ›ï¼ˆä»¤ $\psi(x_u, x_v) = a(x_u, x_v)\psi(x_v)$ï¼‰ã€‚ä½†æ›´å¼ºçš„è¡¨è¾¾åŠ›ä¹Ÿæ„å‘³ç€æ›´éš¾è®­ç»ƒå’Œæ›´å¤§çš„å†…å­˜éœ€æ±‚ã€‚</p>
    </div>

    <h3 id="gnn-gcn">GCN: å›¾å·ç§¯ç½‘ç»œ â€” å®Œæ•´æ¨å¯¼</h3>

    <p><strong>Graph Convolutional Network</strong> (Kipf & Welling, 2016) æ˜¯æœ€ç»å…¸çš„ GNNï¼Œå±äºå·ç§¯å‹ã€‚å®ƒçš„æ ¸å¿ƒå…¬å¼ï¼š</p>

    <div class="math-block">
      $$\mathbf{H}' = \sigma\left(\tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} \mathbf{H} \mathbf{W}\right)$$
    </div>

    <div class="derivation">
      <h4>GCN å…¬å¼çš„å®Œæ•´é€æ­¥æ¨å¯¼</h4>

      <div class="step"><span class="step-num">1</span><strong>èµ·ç‚¹ï¼šè°±å›¾å·ç§¯</strong>ã€‚ç†è®ºä¸Šï¼Œå›¾ä¸Šçš„å·ç§¯åº”è¯¥åœ¨<strong>å›¾ Fourier åŸŸ</strong>å®šä¹‰ï¼š$\mathbf{x} \star_G \theta = U \left(U^\top \mathbf{x} \odot U^\top \theta\right)$ï¼Œå…¶ä¸­ $U$ æ˜¯å›¾æ‹‰æ™®æ‹‰æ–¯ $L = I - D^{-1/2}AD^{-1/2}$ çš„ç‰¹å¾å‘é‡çŸ©é˜µã€‚ä½†è¿™éœ€è¦ $O(n^2)$ è®¡ç®—ç‰¹å¾åˆ†è§£ã€‚</div>

      <div class="step"><span class="step-num">2</span><strong>Chebyshev è¿‘ä¼¼</strong>ã€‚ChebNet (Defferrard et al., 2016) ç”¨ Chebyshev å¤šé¡¹å¼ $T_k$ è¿‘ä¼¼è°±æ»¤æ³¢å™¨ï¼š$g_\theta(\Lambda) \approx \sum_{k=0}^{K} \theta_k T_k(\tilde{\Lambda})$ï¼Œå…¶ä¸­ $\tilde{\Lambda} = \frac{2}{\lambda_{\max}}\Lambda - I$ã€‚</div>

      <div class="step"><span class="step-num">3</span><strong>ä¸€é˜¶è¿‘ä¼¼ (K=1)</strong>ã€‚Kipf & Welling çš„å…³é”®ç®€åŒ–ï¼šå– $K = 1$ï¼Œä¸”ä»¤ $\lambda_{\max} \approx 2$ï¼Œå¾—åˆ°ï¼š
        $$g_\theta \star \mathbf{x} \approx \theta_0 \mathbf{x} + \theta_1 (L - I) \mathbf{x} = \theta_0 \mathbf{x} - \theta_1 D^{-\frac{1}{2}} A D^{-\frac{1}{2}} \mathbf{x}$$</div>

      <div class="step"><span class="step-num">4</span><strong>å‚æ•°åˆå¹¶</strong>ã€‚è¿›ä¸€æ­¥ä»¤ $\theta = \theta_0 = -\theta_1$ï¼ˆå‡å°‘å‚æ•°ï¼‰ï¼Œå¾—åˆ°ï¼š
        $$g_\theta \star \mathbf{x} \approx \theta \left(I + D^{-\frac{1}{2}} A D^{-\frac{1}{2}}\right) \mathbf{x}$$</div>

      <div class="step"><span class="step-num">5</span><strong>é‡å½’ä¸€åŒ–æŠ€å·§ï¼ˆRenormalization Trickï¼‰</strong>ã€‚$I + D^{-1/2}AD^{-1/2}$ çš„ç‰¹å¾å€¼åœ¨ $[0, 2]$ èŒƒå›´ï¼Œåå¤åº”ç”¨ä¼šå¯¼è‡´æ•°å€¼ä¸ç¨³å®šæˆ–æ¢¯åº¦çˆ†ç‚¸ã€‚è§£å†³æ–¹æ³•ï¼š<strong>æ·»åŠ è‡ªç¯</strong>ã€‚
        $$\tilde{A} = A + I \quad \text{ï¼ˆè‡ªç¯é‚»æ¥çŸ©é˜µï¼‰}$$
        $$\tilde{D}_{ii} = \sum_j \tilde{A}_{ij} \quad \text{ï¼ˆå¯¹åº”åº¦æ•°çŸ©é˜µï¼‰}$$</div>

      <div class="step"><span class="step-num">6</span><strong>æœ€ç»ˆå…¬å¼</strong>ã€‚ç»“åˆä¸Šè¿°æ­¥éª¤ï¼Œå¯¹å¤šé€šé“ï¼ˆ$d$ ç»´ç‰¹å¾ï¼Œ$d'$ ç»´è¾“å‡ºï¼‰ï¼š
        $$\mathbf{H}' = \sigma\left(\tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} \mathbf{H} \mathbf{W}\right)$$
        å…¶ä¸­ $\mathbf{H} \in \mathbb{R}^{n \times d}$ æ˜¯è¾“å…¥ç‰¹å¾çŸ©é˜µï¼Œ$\mathbf{W} \in \mathbb{R}^{d \times d'}$ æ˜¯å¯å­¦ä¹ æƒé‡ï¼Œ$\sigma$ æ˜¯æ¿€æ´»å‡½æ•°ã€‚</div>

      <div class="step"><span class="step-num">7</span><strong>é€èŠ‚ç‚¹å±•å¼€</strong>ã€‚å¯¹äºå•ä¸ªèŠ‚ç‚¹ $i$ï¼š
        $$h_i' = \sigma\left(\sum_{j \in \mathcal{N}(i) \cup \{i\}} \frac{1}{\sqrt{\tilde{d}_i \tilde{d}_j}} \mathbf{W}^\top x_j\right)$$
        å…¶ä¸­ $\tilde{d}_i = |\mathcal{N}(i)| + 1$ï¼ˆå«è‡ªç¯çš„åº¦æ•°ï¼‰ã€‚è¿™å°±æ˜¯<strong>å¯¹ç§°å½’ä¸€åŒ–çš„é‚»åŸŸåŠ æƒå¹³å‡</strong>ã€‚</div>
    </div>

    <div class="symbol-table">
      <h4>GCN ç¬¦å·è¡¨</h4>
      <table>
        <thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>ç»´åº¦</th></tr></thead>
        <tbody>
          <tr><td>$A$</td><td>é‚»æ¥çŸ©é˜µ</td><td>$n \times n$</td></tr>
          <tr><td>$\tilde{A} = A + I$</td><td>æ·»åŠ è‡ªç¯çš„é‚»æ¥çŸ©é˜µ</td><td>$n \times n$</td></tr>
          <tr><td>$D$</td><td>åº¦æ•°çŸ©é˜µï¼Œ$D_{ii} = \sum_j A_{ij}$</td><td>$n \times n$ å¯¹è§’</td></tr>
          <tr><td>$\tilde{D}$</td><td>$\tilde{A}$ çš„åº¦æ•°çŸ©é˜µ</td><td>$n \times n$ å¯¹è§’</td></tr>
          <tr><td>$\mathbf{H}$</td><td>èŠ‚ç‚¹ç‰¹å¾çŸ©é˜µ</td><td>$n \times d$</td></tr>
          <tr><td>$\mathbf{W}$</td><td>å¯å­¦ä¹ æƒé‡çŸ©é˜µ</td><td>$d \times d'$</td></tr>
          <tr><td>$\hat{A} = \tilde{D}^{-1/2}\tilde{A}\tilde{D}^{-1/2}$</td><td>å¯¹ç§°å½’ä¸€åŒ–é‚»æ¥çŸ©é˜µ</td><td>$n \times n$</td></tr>
        </tbody>
      </table>
    </div>

    <h3 id="gnn-gat">GAT: å›¾æ³¨æ„åŠ›ç½‘ç»œ</h3>

    <p><strong>Graph Attention Network</strong> (VeliÄkoviÄ‡ et al., 2018) å¼•å…¥äº†æ³¨æ„åŠ›æœºåˆ¶æ¥è‡ªé€‚åº”åœ°å­¦ä¹ é‚»å±…çš„æƒé‡ã€‚</p>

    <div class="math-block">
      $$\alpha_{ij} = \frac{\exp\left(\text{LeakyReLU}\left(\mathbf{a}^\top [\mathbf{W}h_i \| \mathbf{W}h_j]\right)\right)}{\sum_{k \in \mathcal{N}(i)} \exp\left(\text{LeakyReLU}\left(\mathbf{a}^\top [\mathbf{W}h_i \| \mathbf{W}h_k]\right)\right)}$$
    </div>

    <div class="derivation">
      <h4>GAT æ³¨æ„åŠ›æœºåˆ¶çš„é€æ­¥æ¨å¯¼</h4>
      <div class="step"><span class="step-num">1</span><strong>ç‰¹å¾å˜æ¢</strong>ï¼šå¯¹æ¯ä¸ªèŠ‚ç‚¹ $i$ï¼Œç”¨å…±äº«æƒé‡çŸ©é˜µå˜æ¢ç‰¹å¾ï¼š$z_i = \mathbf{W} h_i$ï¼Œå…¶ä¸­ $\mathbf{W} \in \mathbb{R}^{d' \times d}$ã€‚</div>
      <div class="step"><span class="step-num">2</span><strong>æ³¨æ„åŠ›åˆ†æ•°</strong>ï¼šå¯¹è¾¹ $(i, j)$ï¼Œæ‹¼æ¥ä¸¤ä¸ªå˜æ¢åçš„ç‰¹å¾å¹¶æŠ•å½±åˆ°æ ‡é‡ï¼š
        $$e_{ij} = \mathbf{a}^\top [z_i \| z_j]$$
        å…¶ä¸­ $\mathbf{a} \in \mathbb{R}^{2d'}$ æ˜¯å¯å­¦ä¹ çš„æ³¨æ„åŠ›å‘é‡ï¼Œ$\|$ è¡¨ç¤ºæ‹¼æ¥ã€‚</div>
      <div class="step"><span class="step-num">3</span><strong>LeakyReLU + Softmax å½’ä¸€åŒ–</strong>ï¼š
        $$\alpha_{ij} = \text{softmax}_j\left(\text{LeakyReLU}(e_{ij})\right) = \frac{\exp(\text{LeakyReLU}(e_{ij}))}{\sum_{k \in \mathcal{N}(i)} \exp(\text{LeakyReLU}(e_{ik}))}$$</div>
      <div class="step"><span class="step-num">4</span><strong>åŠ æƒèšåˆ</strong>ï¼š
        $$h_i' = \sigma\left(\sum_{j \in \mathcal{N}(i)} \alpha_{ij} \mathbf{W} h_j\right)$$</div>
      <div class="step"><span class="step-num">5</span><strong>å¤šå¤´æ³¨æ„åŠ›</strong>ï¼šä¸ºäº†ç¨³å®šè®­ç»ƒï¼Œä½¿ç”¨ $K$ ä¸ªç‹¬ç«‹çš„æ³¨æ„åŠ›å¤´å¹¶æ‹¼æ¥/å¹³å‡ï¼š
        $$h_i' = \Big\|_{k=1}^{K} \sigma\left(\sum_{j \in \mathcal{N}(i)} \alpha_{ij}^{(k)} \mathbf{W}^{(k)} h_j\right)$$</div>
    </div>

    <h3 id="gnn-graphsage">GraphSAGE: é‡‡æ · + èšåˆ</h3>

    <p><strong>GraphSAGE</strong> (Hamilton et al., 2017) çš„æ ¸å¿ƒåˆ›æ–°æ˜¯<strong>é‡‡æ ·é‚»å±…</strong>ï¼ˆè€Œéä½¿ç”¨æ‰€æœ‰é‚»å±…ï¼‰å’Œ<strong>çµæ´»çš„èšåˆå™¨</strong>ã€‚</p>

    <div class="math-block">
      $$h_i^{(l)} = \sigma\left(\mathbf{W}^{(l)} \cdot \text{CONCAT}\left(h_i^{(l-1)}, \text{AGG}\left(\{h_j^{(l-1)} : j \in \mathcal{S}_{\mathcal{N}(i)}\}\right)\right)\right)$$
      <div class="math-explain">
        $\mathcal{S}_{\mathcal{N}(i)}$ æ˜¯ä»é‚»å±…ä¸­<strong>é‡‡æ ·</strong>çš„å›ºå®šå¤§å°å­é›†ï¼ˆå¦‚é‡‡æ · 10 ä¸ªé‚»å±…ï¼‰ï¼ŒAGG å¯ä»¥æ˜¯ meanã€LSTMã€pooling ç­‰èšåˆå™¨ã€‚é‡‡æ ·ä½¿ GraphSAGE èƒ½å¤„ç†è¶…å¤§è§„æ¨¡å›¾ï¼ˆinductive learningï¼‰ã€‚
      </div>
    </div>

    <div class="algorithm">
      <div class="algorithm-title">ç®—æ³•ï¼šGraphSAGE å‰å‘ä¼ æ’­</div>
      <div class="algorithm-body">è¾“å…¥: å›¾ G(V, E); èŠ‚ç‚¹ç‰¹å¾ {x_v, âˆ€v âˆˆ V}; æ·±åº¦ K; 
      é‡‡æ ·å¤§å° Sâ‚,...,Sâ‚–; æƒé‡ W^k; èšåˆå‡½æ•° AGG_k
è¾“å‡º: èŠ‚ç‚¹åµŒå…¥ z_v, âˆ€v âˆˆ V

hâ°_v â† x_v, âˆ€v âˆˆ V
for k = 1 to K:
    for v âˆˆ V:
        N_S(v) â† SAMPLE(N(v), S_k)     // é‡‡æ · S_k ä¸ªé‚»å±…
        h_N(v) â† AGG_k({h^(k-1)_u, âˆ€u âˆˆ N_S(v)})
        h^k_v â† Ïƒ(W^k Â· CONCAT(h^(k-1)_v, h_N(v)))
    h^k_v â† h^k_v / ||h^k_v||â‚‚, âˆ€v âˆˆ V   // L2 å½’ä¸€åŒ–
z_v â† h^K_v, âˆ€v âˆˆ V</div>
    </div>

    <h3 id="gnn-gin">GIN: å›¾åŒæ„ç½‘ç»œ â€” è¡¨è¾¾åŠ›åˆ†æ</h3>

    <p><strong>Graph Isomorphism Network</strong> (Xu et al., 2019) ä»ç†è®ºä¸Šè¯æ˜äº† GNN è¡¨è¾¾åŠ›çš„ä¸Šç•Œç­‰ä»·äº <span class="term">Weisfeiler-Leman (WL) å›¾åŒæ„æµ‹è¯•</span>ã€‚</p>

    <div class="math-block">
      $$h_i^{(k)} = \text{MLP}^{(k)}\left((1 + \epsilon^{(k)}) \cdot h_i^{(k-1)} + \sum_{j \in \mathcal{N}(i)} h_j^{(k-1)}\right)$$
      <div class="math-explain">
        <strong>å…³é”®è®¾è®¡</strong>ï¼šä½¿ç”¨ <strong>sum èšåˆ</strong>ï¼ˆè€Œé mean æˆ– maxï¼‰+ MLPï¼ˆè€Œéå•å±‚çº¿æ€§ï¼‰ï¼Œè¿™ä½¿ GIN åœ¨ GNN ä¸­è¾¾åˆ°<strong>æœ€å¤§è¡¨è¾¾åŠ›</strong>ï¼Œä¸ 1-WL æµ‹è¯•ç­‰ä»·ã€‚$\epsilon$ å¯ä»¥æ˜¯å¯å­¦ä¹ å‚æ•°æˆ–å›ºå®šä¸º 0ã€‚
      </div>
    </div>

    <div class="callout callout-warning">
      <h4>ä¸ºä»€ä¹ˆ Sum èšåˆæœ€å¼ºï¼Ÿ</h4>
      <p><strong>åä¾‹</strong>ï¼šè€ƒè™‘ä¸¤ä¸ªä¸åŒçš„å¤šé‡é›† $\{\{1, 1, 2\}\}$ å’Œ $\{\{1, 2, 2\}\}$ã€‚</p>
      <ul>
        <li><strong>Mean</strong>: $\frac{1+1+2}{3} = \frac{4}{3}$ vs $\frac{1+2+2}{3} = \frac{5}{3}$ â†’ âœ… å¯åŒºåˆ†</li>
        <li>ä½†å¯¹ $\{\{1, 1\}\}$ vs $\{\{1\}\}$ï¼šMean = $1$ vs $1$ â†’ âŒ æ— æ³•åŒºåˆ†ï¼</li>
        <li><strong>Max</strong>: $\max\{1,1,2\} = 2$ vs $\max\{1,2,2\} = 2$ â†’ âŒ æ— æ³•åŒºåˆ†ï¼</li>
        <li><strong>Sum</strong>: $1+1+2 = 4$ vs $1+2+2 = 5$ â†’ âœ…ï¼›$1+1=2$ vs $1=1$ â†’ âœ… æ€»èƒ½åŒºåˆ†ã€‚</li>
      </ul>
      <p>Sum æ˜¯å¤šé‡é›†ä¸Šçš„<strong>å•å°„</strong>ï¼ˆinjectiveï¼‰å‡½æ•°ï¼Œå› æ­¤ GIN å¯ä»¥åŒºåˆ† 1-WL æµ‹è¯•èƒ½åŒºåˆ†çš„æ‰€æœ‰å›¾ã€‚</p>
    </div>

    <h3 id="gnn-comparison">GNN æ¶æ„å¯¹æ¯”è¡¨</h3>

    <div class="comparison-table">
      <table>
        <thead>
          <tr><th>æ¨¡å‹</th><th>ç±»å‹</th><th>èšåˆ</th><th>æƒé‡</th><th>è¡¨è¾¾åŠ›</th><th>å¤æ‚åº¦</th><th>é€‚ç”¨åœºæ™¯</th></tr>
        </thead>
        <tbody>
          <tr><td>GCN</td><td>å·ç§¯å‹</td><td>Sum</td><td>å›ºå®š $\frac{1}{\sqrt{d_i d_j}}$</td><td>è¾ƒä½</td><td>$O(|E| \cdot d)$</td><td>åŒè´¨å›¾ï¼ŒèŠ‚ç‚¹åˆ†ç±»</td></tr>
          <tr><td>GAT</td><td>æ³¨æ„åŠ›å‹</td><td>Sum</td><td>å­¦ä¹  $\alpha_{ij}$</td><td>ä¸­ç­‰</td><td>$O(|E| \cdot d + |V| \cdot d^2)$</td><td>å¼‚è´¨å›¾ï¼Œå˜åŒ–é‚»åŸŸ</td></tr>
          <tr><td>GraphSAGE</td><td>å·ç§¯å‹</td><td>Mean/LSTM/Pool</td><td>å›ºå®š 1/|N|</td><td>ä¸­ç­‰</td><td>$O(S^K \cdot d^2)$</td><td>è¶…å¤§å›¾ï¼Œå½’çº³å­¦ä¹ </td></tr>
          <tr><td>GIN</td><td>æ¶ˆæ¯ä¼ é€’</td><td>Sum</td><td>MLP</td><td>æœ€å¼º (=1-WL)</td><td>$O(|E| \cdot d)$</td><td>å›¾åˆ†ç±»ï¼Œç†è®ºåˆ†æ</td></tr>
          <tr><td>MPNN</td><td>æ¶ˆæ¯ä¼ é€’</td><td>Sum</td><td>MLP(x_i, x_j, e)</td><td>æœ€å¼º</td><td>$O(|E| \cdot d^2)$</td><td>ç‰©ç†ä»¿çœŸï¼Œåˆ†å­</td></tr>
          <tr style="background: #ebfbee;"><td><strong>DynamicalGNN</strong></td><td>æ¶ˆæ¯ä¼ é€’</td><td>Sum</td><td>MLP + EdgeFrame</td><td>æœ€å¼º + ç‰©ç†</td><td>$O(|E| \cdot d^2)$</td><td><strong>PhysRobot</strong></td></tr>
        </tbody>
      </table>
    </div>

    <h3 id="gnn-code">å®Œæ•´ä»£ç ï¼šç”¨ PyG å®ç°æ¯ç§ GNN</h3>

    <div class="tab-container">
      <div class="tab-buttons">
        <button class="tab-btn active" onclick="switchTab(event, 'gcn-code')">GCN</button>
        <button class="tab-btn" onclick="switchTab(event, 'gat-code')">GAT</button>
        <button class="tab-btn" onclick="switchTab(event, 'sage-code')">GraphSAGE</button>
        <button class="tab-btn" onclick="switchTab(event, 'gin-code')">GIN</button>
        <button class="tab-btn" onclick="switchTab(event, 'mpnn-code')">MPNN</button>
      </div>

      <div id="gcn-code" class="tab-content active">
        <div class="code-container">
          <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
          <pre><code>import torch
import torch.nn.functional as F
from torch_geometric.nn import GCNConv
from torch_geometric.datasets import Planetoid

# ============================================================
# GCN: Graph Convolutional Network (Kipf & Welling, 2016)
# H' = Ïƒ(DÌƒâ»Â½ÃƒDÌƒâ»Â½ H W)
# ============================================================
class GCN(torch.nn.Module):
    def __init__(self, in_dim, hidden_dim, out_dim, num_layers=2, dropout=0.5):
        super().__init__()
        self.convs = torch.nn.ModuleList()
        self.convs.append(GCNConv(in_dim, hidden_dim))
        for _ in range(num_layers - 2):
            self.convs.append(GCNConv(hidden_dim, hidden_dim))
        self.convs.append(GCNConv(hidden_dim, out_dim))
        self.dropout = dropout
    
    def forward(self, x, edge_index):
        for i, conv in enumerate(self.convs[:-1]):
            x = conv(x, edge_index)
            x = F.relu(x)
            x = F.dropout(x, p=self.dropout, training=self.training)
        x = self.convs[-1](x, edge_index)
        return x


# ============================================================
# ä»é›¶å®ç° GCNï¼ˆä¸ä¾èµ– PyG å†…ç½®å±‚ï¼‰
# ============================================================
class GCNFromScratch(torch.nn.Module):
    """
    æ‰‹åŠ¨å®ç° GCNï¼Œå®Œæ•´å±•ç¤º DÌƒâ»Â½ÃƒDÌƒâ»Â½ H W çš„è®¡ç®—ã€‚
    """
    def __init__(self, in_dim, hidden_dim, out_dim):
        super().__init__()
        self.W1 = torch.nn.Linear(in_dim, hidden_dim, bias=False)
        self.W2 = torch.nn.Linear(hidden_dim, out_dim, bias=False)
    
    def compute_norm_adj(self, edge_index, num_nodes):
        """è®¡ç®—å¯¹ç§°å½’ä¸€åŒ–é‚»æ¥çŸ©é˜µ DÌƒâ»Â½ÃƒDÌƒâ»Â½"""
        # æ„å»º Ãƒ = A + Iï¼ˆæ·»åŠ è‡ªç¯ï¼‰
        row, col = edge_index
        # æ·»åŠ è‡ªç¯
        self_loops = torch.arange(num_nodes, device=edge_index.device)
        row = torch.cat([row, self_loops])
        col = torch.cat([col, self_loops])
        
        # è®¡ç®—åº¦æ•° DÌƒ
        deg = torch.zeros(num_nodes, device=edge_index.device)
        deg.scatter_add_(0, row, torch.ones_like(row, dtype=torch.float))
        
        # DÌƒâ»Â½
        deg_inv_sqrt = deg.pow(-0.5)
        deg_inv_sqrt[deg_inv_sqrt == float('inf')] = 0
        
        # å½’ä¸€åŒ–æƒé‡: DÌƒâ»Â½ Ãƒ DÌƒâ»Â½ çš„æ¯ä¸ªå…ƒç´ 
        norm = deg_inv_sqrt[row] * deg_inv_sqrt[col]
        
        return row, col, norm
    
    def forward(self, x, edge_index):
        num_nodes = x.size(0)
        row, col, norm = self.compute_norm_adj(edge_index, num_nodes)
        
        # ç¬¬ä¸€å±‚: H' = Ïƒ(DÌƒâ»Â½ÃƒDÌƒâ»Â½ H Wâ‚)
        h = self.W1(x)  # H Wâ‚
        # ç¨€ç–çŸ©é˜µä¹˜æ³•: DÌƒâ»Â½ÃƒDÌƒâ»Â½ Ã— (HWâ‚)
        out = torch.zeros_like(h)
        out.scatter_add_(0, col.unsqueeze(1).expand_as(h[row]), 
                         norm.unsqueeze(1) * h[row])
        h = F.relu(out)
        
        # ç¬¬äºŒå±‚
        h = self.W2(h)
        out = torch.zeros_like(h)
        out.scatter_add_(0, col.unsqueeze(1).expand_as(h[row]),
                         norm.unsqueeze(1) * h[row])
        
        return out


# ============================================================
# è®­ç»ƒå’Œæµ‹è¯•
# ============================================================
def train_gcn():
    # åŠ è½½ Cora æ•°æ®é›†
    dataset = Planetoid(root='/tmp/Cora', name='Cora')
    data = dataset[0]
    
    model = GCN(dataset.num_features, 64, dataset.num_classes)
    optimizer = torch.optim.Adam(model.parameters(), lr=0.01, weight_decay=5e-4)
    
    # è®­ç»ƒ
    model.train()
    for epoch in range(200):
        optimizer.zero_grad()
        out = model(data.x, data.edge_index)
        loss = F.cross_entropy(out[data.train_mask], data.y[data.train_mask])
        loss.backward()
        optimizer.step()
    
    # æµ‹è¯•
    model.eval()
    pred = model(data.x, data.edge_index).argmax(dim=1)
    acc = (pred[data.test_mask] == data.y[data.test_mask]).float().mean()
    print(f"GCN Test Accuracy: {acc:.4f}")

if __name__ == "__main__":
    train_gcn()</code></pre>
        </div>
      </div>

      <div id="gat-code" class="tab-content">
        <div class="code-container">
          <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
          <pre><code>import torch
import torch.nn.functional as F
from torch_geometric.nn import GATConv

# ============================================================
# GAT: Graph Attention Network (VeliÄkoviÄ‡ et al., 2018)
# Î±_ij = softmax(LeakyReLU(a^T [Wh_i || Wh_j]))
# ============================================================
class GAT(torch.nn.Module):
    def __init__(self, in_dim, hidden_dim, out_dim, heads=8, dropout=0.6):
        super().__init__()
        self.conv1 = GATConv(in_dim, hidden_dim, heads=heads, dropout=dropout)
        self.conv2 = GATConv(hidden_dim * heads, out_dim, heads=1,
                            concat=False, dropout=dropout)
        self.dropout = dropout
    
    def forward(self, x, edge_index):
        x = F.dropout(x, p=self.dropout, training=self.training)
        x = F.elu(self.conv1(x, edge_index))
        x = F.dropout(x, p=self.dropout, training=self.training)
        x = self.conv2(x, edge_index)
        return x


# ============================================================
# ä»é›¶å®ç° GAT æ³¨æ„åŠ›æœºåˆ¶
# ============================================================
class GATLayerFromScratch(torch.nn.Module):
    """
    æ‰‹åŠ¨å®ç° GAT å•å±‚ï¼ˆå•å¤´æ³¨æ„åŠ›ï¼‰ã€‚
    
    æ­¥éª¤:
    1. çº¿æ€§å˜æ¢: z_i = W h_i
    2. æ³¨æ„åŠ›åˆ†æ•°: e_ij = LeakyReLU(a^T [z_i || z_j])
    3. softmax å½’ä¸€åŒ–: Î±_ij = softmax_j(e_ij)
    4. åŠ æƒèšåˆ: h_i' = Ïƒ(Î£_j Î±_ij z_j)
    """
    def __init__(self, in_dim, out_dim):
        super().__init__()
        self.W = torch.nn.Linear(in_dim, out_dim, bias=False)
        # æ³¨æ„åŠ›å‘é‡ a âˆˆ R^(2*out_dim)
        self.a = torch.nn.Parameter(torch.randn(2 * out_dim))
        self.leaky_relu = torch.nn.LeakyReLU(0.2)
    
    def forward(self, x, edge_index):
        # 1. çº¿æ€§å˜æ¢
        z = self.W(x)  # (N, out_dim)
        
        src, dst = edge_index  # (E,), (E,)
        
        # 2. è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°
        z_src = z[src]  # (E, out_dim)
        z_dst = z[dst]  # (E, out_dim)
        
        # æ‹¼æ¥ [z_i || z_j] å¹¶æŠ•å½±
        e = torch.cat([z_dst, z_src], dim=1)  # (E, 2*out_dim)
        e = (e * self.a).sum(dim=1)  # (E,)  ç‚¹ç§¯
        e = self.leaky_relu(e)
        
        # 3. Softmax å½’ä¸€åŒ–ï¼ˆå¯¹æ¯ä¸ªç›®æ ‡èŠ‚ç‚¹çš„æ‰€æœ‰å…¥è¾¹ï¼‰
        alpha = self._softmax_per_node(e, dst, x.size(0))
        
        # 4. åŠ æƒèšåˆ
        out = torch.zeros_like(z)
        out.scatter_add_(0, dst.unsqueeze(1).expand_as(z_src),
                         alpha.unsqueeze(1) * z_src)
        
        return F.elu(out)
    
    def _softmax_per_node(self, e, dst, num_nodes):
        """å¯¹æ¯ä¸ªç›®æ ‡èŠ‚ç‚¹åš softmax"""
        e_max = torch.zeros(num_nodes, device=e.device)
        e_max.scatter_reduce_(0, dst, e, reduce='amax', include_self=False)
        e = torch.exp(e - e_max[dst])
        
        e_sum = torch.zeros(num_nodes, device=e.device)
        e_sum.scatter_add_(0, dst, e)
        
        return e / (e_sum[dst] + 1e-16)</code></pre>
        </div>
      </div>

      <div id="sage-code" class="tab-content">
        <div class="code-container">
          <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
          <pre><code>import torch
import torch.nn.functional as F
from torch_geometric.nn import SAGEConv

# ============================================================
# GraphSAGE (Hamilton et al., 2017)
# h_i = Ïƒ(W Â· CONCAT(h_i, AGG({h_j : j âˆˆ S(N(i))})))
# ============================================================
class GraphSAGE(torch.nn.Module):
    def __init__(self, in_dim, hidden_dim, out_dim, num_layers=2):
        super().__init__()
        self.convs = torch.nn.ModuleList()
        self.convs.append(SAGEConv(in_dim, hidden_dim))
        for _ in range(num_layers - 2):
            self.convs.append(SAGEConv(hidden_dim, hidden_dim))
        self.convs.append(SAGEConv(hidden_dim, out_dim))
    
    def forward(self, x, edge_index):
        for conv in self.convs[:-1]:
            x = conv(x, edge_index)
            x = F.relu(x)
            x = F.dropout(x, p=0.5, training=self.training)
        return self.convs[-1](x, edge_index)


# ============================================================
# GraphSAGE ä»é›¶å®ç°ï¼ˆå«é‡‡æ ·ï¼‰
# ============================================================
class SAGELayerFromScratch(torch.nn.Module):
    """
    GraphSAGE é‡‡æ ·+èšåˆå±‚ã€‚
    
    å…³é”®åˆ›æ–°:
    1. é‡‡æ ·å›ºå®šæ•°é‡çš„é‚»å±…ï¼ˆè€Œéå…¨éƒ¨ï¼‰â†’ å¯å¤„ç†è¶…å¤§å›¾
    2. CONCAT(self, neighbors) è€Œéç›¸åŠ  â†’ ä¿ç•™è‡ªèº«ä¿¡æ¯
    3. L2 å½’ä¸€åŒ–è¾“å‡º â†’ ç‰¹å¾ä¸çˆ†ç‚¸
    """
    def __init__(self, in_dim, out_dim, sample_size=10, agg='mean'):
        super().__init__()
        self.sample_size = sample_size
        self.agg = agg
        self.W = torch.nn.Linear(2 * in_dim, out_dim)
    
    def sample_neighbors(self, adj_list, node, k):
        """ä»èŠ‚ç‚¹çš„é‚»å±…ä¸­éšæœºé‡‡æ · k ä¸ª"""
        neighbors = adj_list[node]
        if len(neighbors) == 0:
            return [node]  # è‡ªç¯
        if len(neighbors) <= k:
            return neighbors
        indices = torch.randperm(len(neighbors))[:k]
        return [neighbors[i] for i in indices]
    
    def forward(self, x, adj_list):
        N = x.size(0)
        h_neighbors = []
        
        for i in range(N):
            sampled = self.sample_neighbors(adj_list, i, self.sample_size)
            neighbor_feats = x[sampled]
            
            if self.agg == 'mean':
                agg_feat = neighbor_feats.mean(dim=0)
            elif self.agg == 'max':
                agg_feat = neighbor_feats.max(dim=0)[0]
            
            h_neighbors.append(agg_feat)
        
        h_neighbors = torch.stack(h_neighbors)  # (N, d)
        
        # CONCAT(self, agg_neighbors)
        combined = torch.cat([x, h_neighbors], dim=1)  # (N, 2d)
        out = F.relu(self.W(combined))  # (N, out_dim)
        
        # L2 å½’ä¸€åŒ–
        out = F.normalize(out, p=2, dim=1)
        return out</code></pre>
        </div>
      </div>

      <div id="gin-code" class="tab-content">
        <div class="code-container">
          <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
          <pre><code>import torch
import torch.nn.functional as F
from torch_geometric.nn import GINConv, global_add_pool

# ============================================================
# GIN: Graph Isomorphism Network (Xu et al., 2019)
# h_i^(k) = MLP((1+Îµ) Â· h_i^(k-1) + Î£_{jâˆˆN(i)} h_j^(k-1))
# ============================================================
class GIN(torch.nn.Module):
    """
    GIN çš„å…³é”®ï¼š
    1. Sum èšåˆï¼ˆä¸æ˜¯ mean/maxï¼‰â†’ å•å°„æ€§
    2. MLPï¼ˆä¸æ˜¯å•å±‚çº¿æ€§ï¼‰â†’ æ›´å¼ºçš„å‡½æ•°é€¼è¿‘
    3. å›¾çº§è¯»å‡ºç”¨ SUMï¼ˆä¸æ˜¯ MEANï¼‰â†’ ä¿ç•™å¤šé‡é›†ä¿¡æ¯
    
    ç†è®ºä¿è¯ï¼šGIN çš„è¡¨è¾¾åŠ› = 1-WL å›¾åŒæ„æµ‹è¯•
    """
    def __init__(self, in_dim, hidden_dim, out_dim, num_layers=5):
        super().__init__()
        self.convs = torch.nn.ModuleList()
        self.bns = torch.nn.ModuleList()
        
        for i in range(num_layers):
            dim_in = in_dim if i == 0 else hidden_dim
            mlp = torch.nn.Sequential(
                torch.nn.Linear(dim_in, hidden_dim),
                torch.nn.BatchNorm1d(hidden_dim),
                torch.nn.ReLU(),
                torch.nn.Linear(hidden_dim, hidden_dim),
            )
            self.convs.append(GINConv(mlp, train_eps=True))
            self.bns.append(torch.nn.BatchNorm1d(hidden_dim))
        
        # å›¾çº§è¯»å‡º
        self.readout = torch.nn.Sequential(
            torch.nn.Linear(hidden_dim, hidden_dim),
            torch.nn.ReLU(),
            torch.nn.Linear(hidden_dim, out_dim),
        )
    
    def forward(self, x, edge_index, batch):
        for conv, bn in zip(self.convs, self.bns):
            x = F.relu(bn(conv(x, edge_index)))
        
        # å›¾çº§èšåˆï¼ˆSUMï¼Œä¸æ˜¯ MEANï¼ï¼‰
        x = global_add_pool(x, batch)
        return self.readout(x)


# ============================================================
# GIN ä»é›¶å®ç°
# ============================================================
class GINLayerFromScratch(torch.nn.Module):
    """
    h_i^(k) = MLP^(k)((1 + Îµ^(k)) Â· h_i^(k-1) + Î£_{jâˆˆN(i)} h_j^(k-1))
    """
    def __init__(self, in_dim, hidden_dim, train_eps=True):
        super().__init__()
        self.mlp = torch.nn.Sequential(
            torch.nn.Linear(in_dim, hidden_dim),
            torch.nn.ReLU(),
            torch.nn.Linear(hidden_dim, hidden_dim),
        )
        if train_eps:
            self.eps = torch.nn.Parameter(torch.zeros(1))
        else:
            self.register_buffer('eps', torch.zeros(1))
    
    def forward(self, x, edge_index):
        src, dst = edge_index
        
        # Sum èšåˆé‚»å±…
        agg = torch.zeros_like(x)
        agg.scatter_add_(0, dst.unsqueeze(1).expand_as(x[src]), x[src])
        
        # (1 + Îµ) Â· x_i + Î£ x_j
        out = (1 + self.eps) * x + agg
        
        return self.mlp(out)</code></pre>
        </div>
      </div>

      <div id="mpnn-code" class="tab-content">
        <div class="code-container">
          <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
          <pre><code>import torch
import torch.nn.functional as F
from torch_geometric.nn import MessagePassing

# ============================================================
# MPNN: Message Passing Neural Network (Gilmer et al., 2017)
# æœ€é€šç”¨çš„ GNN å½¢å¼
# ============================================================
class MPNNLayer(MessagePassing):
    """
    é€šç”¨æ¶ˆæ¯ä¼ é€’å±‚:
    m_ij = Ï†(x_i, x_j, e_ij)     # æ¶ˆæ¯å‡½æ•°
    agg_i = Î£_{jâˆˆN(i)} m_ij       # èšåˆï¼ˆsumï¼‰
    x_i' = Î³(x_i, agg_i)          # æ›´æ–°å‡½æ•°
    """
    def __init__(self, node_dim, edge_dim, hidden_dim):
        super().__init__(aggr='add')
        
        # æ¶ˆæ¯å‡½æ•° Ï†
        self.message_mlp = torch.nn.Sequential(
            torch.nn.Linear(2 * node_dim + edge_dim, hidden_dim),
            torch.nn.ReLU(),
            torch.nn.Linear(hidden_dim, hidden_dim),
        )
        
        # æ›´æ–°å‡½æ•° Î³ï¼ˆå«æ®‹å·®è¿æ¥ï¼‰
        self.update_mlp = torch.nn.Sequential(
            torch.nn.Linear(node_dim + hidden_dim, hidden_dim),
            torch.nn.ReLU(),
            torch.nn.Linear(hidden_dim, node_dim),
        )
    
    def forward(self, x, edge_index, edge_attr):
        return self.propagate(edge_index, x=x, edge_attr=edge_attr)
    
    def message(self, x_i, x_j, edge_attr):
        """æ¶ˆæ¯: m_ij = Ï†(x_i, x_j, e_ij)"""
        return self.message_mlp(torch.cat([x_i, x_j, edge_attr], dim=-1))
    
    def update(self, aggr_out, x):
        """æ›´æ–°: x_i' = Î³(x_i, agg_i) + x_i (æ®‹å·®)"""
        return self.update_mlp(torch.cat([x, aggr_out], dim=-1)) + x


class FullMPNN(torch.nn.Module):
    """å®Œæ•´çš„ MPNN æ¨¡å‹"""
    def __init__(self, node_dim, edge_dim, hidden_dim, out_dim, n_layers=3):
        super().__init__()
        self.encoder = torch.nn.Linear(node_dim, hidden_dim)
        self.layers = torch.nn.ModuleList([
            MPNNLayer(hidden_dim, edge_dim, hidden_dim)
            for _ in range(n_layers)
        ])
        self.decoder = torch.nn.Linear(hidden_dim, out_dim)
    
    def forward(self, x, edge_index, edge_attr):
        x = self.encoder(x)
        for layer in self.layers:
            x = layer(x, edge_index, edge_attr)
        return self.decoder(x)</code></pre>
        </div>
      </div>
    </div>

    <h3 id="gnn-physrobot">ğŸ¤– ä¸ PhysRobot çš„æ·±åº¦å…³è”</h3>

    <div class="callout callout-project">
      <h4>DynamicalGNN å°±æ˜¯ç‰©ç†ç‰¹åŒ–çš„ MPNN</h4>
      <p>æˆ‘ä»¬é¡¹ç›®ä¸­çš„ <code>DynamicalGNN</code> æ˜¯ Â§5.3 æ¶ˆæ¯ä¼ é€’ GNN çš„<strong>ç‰©ç†ç‰¹åŒ–ç‰ˆæœ¬</strong>ã€‚è®©æˆ‘ä»¬é€è¡Œå¯¹æ¯”ï¼š</p>
    </div>

    <div class="comparison-table">
      <table>
        <thead><tr><th>ç»„ä»¶</th><th>é€šç”¨ MPNN</th><th>DynamicalGNN (PhysRobot)</th></tr></thead>
        <tbody>
          <tr><td>æ¶ˆæ¯å‡½æ•° $\phi$</td><td>MLP(x_i, x_j, e_ij)</td><td><code>message_net([edge_attr, x_i, x_j])</code></td></tr>
          <tr><td>èšåˆ $\bigoplus$</td><td>sum / mean / max</td><td><code>aggr='add'</code> (sum) â€” ä¿æŒç‰©ç†å®ˆæ’</td></tr>
          <tr><td>æ›´æ–° $\gamma$</td><td>MLP(x_i, agg_i)</td><td><code>update_net([x, aggr_out]) + x</code> (æ®‹å·®)</td></tr>
          <tr><td>è¾¹ç‰¹å¾</td><td>ä»»æ„ e_ij</td><td><code>EdgeFrame</code>: [r_ij, ||r_ij||, v_rel, ||v_rel||]</td></tr>
          <tr><td>è¾“å‡º</td><td>ä»»æ„é¢„æµ‹</td><td>åŠ é€Ÿåº¦ a âˆˆ â„Â³ï¼ˆç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼‰</td></tr>
        </tbody>
      </table>
    </div>

    <div class="code-container">
      <span class="code-label">PhysRobot é¡¹ç›®ä»£ç  â€” physics_core/dynamical_gnn.pyï¼ˆæ ¸å¿ƒç‰‡æ®µï¼‰</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code># è¿™æ˜¯æˆ‘ä»¬å®é™…é¡¹ç›®ä»£ç çš„æ ¸å¿ƒæ¶ˆæ¯ä¼ é€’å±‚
# å®Œæ•´æºç : physics_core/dynamical_gnn.py

class PhysicsMessagePassing(MessagePassing):
    """
    æ¶ˆæ¯ä¼ é€’å±‚ + ç‰©ç†çº¦æŸ
    
    å¯¹åº” GDL è“å›¾:
    - Message: m_ij = Ï†(e_ij, h_i, h_j)     â† åŒ…å«è¾¹æ¡†æ¶ä¿¡æ¯
    - Update:  h_i' = Ïˆ(h_i, Î£_j m_ij) + h_i  â† æ®‹å·®è¿æ¥
    """
    def __init__(self, hidden_dim, edge_dim):
        super().__init__(aggr='add')  # â† Sum èšåˆä¿æŒåŠ¨é‡å®ˆæ’
        
        # æ¶ˆæ¯ç½‘ç»œ Ï†ï¼šæ‹¼æ¥ [è¾¹ç‰¹å¾, å‘é€è€…, æ¥æ”¶è€…]
        self.message_net = nn.Sequential(
            nn.Linear(edge_dim + 2 * hidden_dim, hidden_dim),
            nn.LayerNorm(hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
        )
        
        # æ›´æ–°ç½‘ç»œ Ïˆï¼šæ‹¼æ¥ [åŸå§‹ç‰¹å¾, èšåˆæ¶ˆæ¯]
        self.update_net = nn.Sequential(
            nn.Linear(2 * hidden_dim, hidden_dim),
            nn.LayerNorm(hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
        )
    
    def message(self, x_i, x_j, edge_attr):
        # m_ij = Ï†(e_ij, h_i, h_j) â€” å®Œå…¨ç¬¦åˆæ¶ˆæ¯ä¼ é€’èŒƒå¼
        return self.message_net(torch.cat([edge_attr, x_i, x_j], dim=-1))
    
    def update(self, aggr_out, x):
        # h_i' = Ïˆ(h_i, agg) + h_i â€” æ®‹å·®è¿æ¥ï¼ˆç±»ä¼¼ ResNet/ODE ç¦»æ•£åŒ–ï¼‰
        return self.update_net(torch.cat([x, aggr_out], dim=-1)) + x</code></pre>
    </div>


    <!-- ====================== 5.4 Deep Sets, Transformer ====================== -->
    <h2 id="sec5-4">5.4 Deep Sets, Transformers, ä¸éšå¼å›¾æ¨æ–­<br><span style="font-size:0.65em;color:var(--text-secondary)">Deep Sets, Transformers, and Latent Graph Inference</span></h2>

    <div class="bilingual">
      <div class="zh">
        <p>æˆ‘ä»¬é€šè¿‡è®¨è®º<strong>æ— åºé›†åˆ</strong>ä¸Šçš„ç½®æ¢ç­‰å˜ç¥ç»ç½‘ç»œæ¥ç»“æŸ GNN çš„è®¨è®ºã€‚è™½ç„¶é›†åˆåœ¨æˆ‘ä»¬è®¨è®ºçš„åŸŸä¸­ç»“æ„æœ€å°‘ï¼Œä½†å®ƒä»¬äº§ç”Ÿäº†ä¸€äº›æœ€æµè¡Œçš„æ¶æ„ï¼š<span class="term">Transformer</span> å’Œ <span class="term">Deep Sets</span>ã€‚</p>
      </div>
      <div class="en">
        We close the GNN discussion by remarking on permutation-equivariant architectures for unordered sets, which produce some of the most popular architectures including Transformers and Deep Sets.
      </div>
    </div>

<!-- === ENRICHMENT: sec5-4 === -->
<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šDeep Sets â€” é›†åˆä¸Šçš„å­¦ä¹ </h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šDeep Sets çš„å…¬å¼ $f(\mathbf{X}) = \rho(\sum_i \phi(x_i))$ çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä¸ºä»€ä¹ˆè¿™èƒ½å¤„ç†æ— åºé›†åˆï¼Ÿå’Œ GNN æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>Deep Sets æ˜¯æœ€ç®€å•çš„ç½®æ¢ä¸å˜æ¶æ„</strong>ï¼Œç†è§£å®ƒæ˜¯ç†è§£ Transformer çš„åŸºç¡€ã€‚</p>
        
        <p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>
        <ol>
          <li><strong>é€å…ƒç´ å˜æ¢</strong>ï¼š$\phi(x_i)$ å¯¹æ¯ä¸ªå…ƒç´ ç‹¬ç«‹å¤„ç†ï¼ˆç±»ä¼¼"ç¼–ç "ï¼‰</li>
          <li><strong>ç½®æ¢ä¸å˜èšåˆ</strong>ï¼š$\sum_i$ æ±‚å’Œï¼Œé¡ºåºæ— å…³</li>
          <li><strong>å…¨å±€å¤„ç†</strong>ï¼š$\rho(\cdot)$ å¯¹èšåˆç»“æœåšæœ€ç»ˆå˜æ¢</li>
        </ol>
        
        <p><strong>ä¸ºä»€ä¹ˆè¿™æ˜¯ç½®æ¢ä¸å˜çš„ï¼Ÿ</strong></p>
        <ul>
          <li>å‡è®¾é›†åˆ $\mathbf{X} = \{x_1, x_2, x_3\}$ è¢«é‡æ’ä¸º $\mathbf{X}' = \{x_2, x_3, x_1\}$</li>
          <li>$\sum_i \phi(x_i) = \phi(x_1) + \phi(x_2) + \phi(x_3)$</li>
          <li>$\sum_i \phi(x_i') = \phi(x_2) + \phi(x_3) + \phi(x_1)$</li>
          <li>å› ä¸ºåŠ æ³•<strong>å¯äº¤æ¢</strong>ï¼Œä¸¤è€…ç›¸ç­‰ âœ…</li>
        </ul>
        
        <p><strong>ä¸ GNN çš„å…³ç³»</strong>ï¼š</p>
        <ul>
          <li>Deep Sets = GNN åœ¨<strong>ç©ºå›¾</strong>ä¸Šï¼ˆ$A = I$ï¼Œæ— è¾¹ï¼‰</li>
          <li>æ¯ä¸ªèŠ‚ç‚¹åªçœ‹è‡ªå·±ï¼Œæ²¡æœ‰é‚»å±…ä¿¡æ¯äº¤æ¢</li>
          <li>GNN å…¬å¼é€€åŒ–ä¸ºï¼š$h_i' = \phi(x_i, \emptyset) = \phi(x_i)$</li>
        </ul>
        
        <p><strong>ç”Ÿæ´»ç±»æ¯”</strong>ï¼š</p>
        <ul>
          <li>æƒ³è±¡ç»Ÿè®¡ä¸€ç¯®å­æ°´æœçš„"æ€»ä»·å€¼"</li>
          <li>$\phi(x_i)$ï¼šè¯„ä¼°æ¯ä¸ªæ°´æœçš„ä»·å€¼ï¼ˆè‹¹æœ $5ï¼Œé¦™è•‰ $3ï¼‰</li>
          <li>$\sum_i$ï¼šæŠŠæ‰€æœ‰ä»·å€¼åŠ èµ·æ¥</li>
          <li>$\rho$ï¼šæ ¹æ®æ€»ä»·å€¼åšå†³ç­–ï¼ˆå¦‚"è´µ/ä¾¿å®œ"åˆ†ç±»ï¼‰</li>
          <li>é¡ºåºæ— å…³ï¼šå…ˆæ•°è‹¹æœè¿˜æ˜¯å…ˆæ•°é¦™è•‰ä¸å½±å“æ€»ä»·</li>
        </ul>
        
        <p><strong>æ•°å­¦å®šç†ï¼ˆZaheer et al., 2017ï¼‰</strong>ï¼š</p>
        <p>ä»»ä½•<strong>è¿ç»­çš„</strong>ç½®æ¢ä¸å˜å‡½æ•° $f: \mathcal{X}^n \to \mathbb{R}$ éƒ½å¯ä»¥å†™æˆï¼š</p>
        $$f(\{x_1, \ldots, x_n\}) = \rho\left(\sum_{i=1}^n \phi(x_i)\right)$$
        <p>å…¶ä¸­ $\phi, \rho$ æ˜¯è¿ç»­å‡½æ•°ã€‚è¿™æ˜¯<strong>é€šç”¨é€¼è¿‘å®šç†</strong>çš„é›†åˆç‰ˆæœ¬ï¼</p>
        
        <p><strong>å®ç°æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
        <ul>
          <li>$\phi$ é€šå¸¸ç”¨ MLPï¼ˆå¦‚ 2-3 å±‚å…¨è¿æ¥ï¼‰</li>
          <li>$\rho$ ä¹Ÿæ˜¯ MLPï¼Œä½†å¯ä»¥æ›´æ·±ï¼ˆå› ä¸ºåªå¤„ç†ä¸€æ¬¡ï¼‰</li>
          <li>èšåˆå¯ä»¥æ˜¯ sum / mean / maxï¼Œä½†<strong>sum æœ€é€šç”¨</strong>ï¼ˆä¿æŒå•å°„æ€§ï¼‰</li>
        </ul>
        
        <p><strong>PointNetï¼ˆç‚¹äº‘ç‰ˆæœ¬ï¼‰</strong>ï¼š</p>
        <ul>
          <li>3D ç‚¹äº‘ $\{(x,y,z)_i\}$ æ˜¯å…¸å‹çš„æ— åºé›†åˆ</li>
          <li>PointNet ç”¨ Deep Sets å¤„ç†ç‚¹äº‘ï¼š$f(\text{ç‚¹äº‘}) = \text{MLP}(\max_i \text{MLP}(p_i))$</li>
          <li>ç”¨ max ä»£æ›¿ sumï¼ˆæ›´é²æ£’äºç‚¹äº‘å¯†åº¦å˜åŒ–ï¼‰</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šTransformer = å®Œå…¨å›¾ä¸Šçš„ GNNï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šä¸ºä»€ä¹ˆè¯´ Transformer å°±æ˜¯"å®Œå…¨å›¾ä¸Šçš„ GAT"ï¼Ÿè‡ªæ³¨æ„åŠ›æœºåˆ¶åˆ°åº•åœ¨åšä»€ä¹ˆï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>Transformer çš„ GNN è§†è§’</strong>æ˜¯ç†è§£å…¶æœ¬è´¨çš„æœ€ä½³æ–¹å¼ã€‚</p>
        
        <p><strong>æ ¸å¿ƒæ´å¯Ÿ</strong>ï¼š</p>
        <ul>
          <li>æ ‡å‡† GNNï¼šèŠ‚ç‚¹åªå’Œ<strong>é‚»å±…</strong>é€šä¿¡ï¼ˆç”±é‚»æ¥çŸ©é˜µ $A$ å†³å®šï¼‰</li>
          <li>Transformerï¼š<strong>æ‰€æœ‰èŠ‚ç‚¹</strong>éƒ½æ˜¯å½¼æ­¤çš„é‚»å±… â†’ $A = \mathbf{1}\mathbf{1}^\top$ï¼ˆå®Œå…¨å›¾ï¼‰</li>
          <li>æ³¨æ„åŠ›æƒé‡ $\alpha_{ij}$ï¼šç›¸å½“äº<strong>å­¦åˆ°çš„è½¯é‚»æ¥çŸ©é˜µ</strong></li>
        </ul>
        
        <p><strong>è‡ªæ³¨æ„åŠ›å…¬å¼çš„ GNN è§£è¯»</strong>ï¼š</p>
        <p>æ ‡å‡† Transformer è‡ªæ³¨æ„åŠ›ï¼š</p>
        $$\text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^\top}{\sqrt{d_k}}\right) V$$
        
        <p>æ‹†è§£ä¸º GNN ç»„ä»¶ï¼š</p>
        <ol>
          <li><strong>Query/Key/Value å˜æ¢</strong>ï¼š$Q = XW_Q$, $K = XW_K$, $V = XW_V$ 
            <br>â†’ å¯¹åº” GNN çš„<strong>ç‰¹å¾å˜æ¢</strong> $\psi(x_v) = W_V x_v$</li>
          <li><strong>æ³¨æ„åŠ›åˆ†æ•°</strong>ï¼š$e_{ij} = \frac{q_i^\top k_j}{\sqrt{d_k}}$ 
            <br>â†’ å¯¹åº” GAT çš„<strong>æ³¨æ„åŠ›æœºåˆ¶</strong> $a(x_i, x_j)$</li>
          <li><strong>Softmax å½’ä¸€åŒ–</strong>ï¼š$\alpha_{ij} = \frac{\exp(e_{ij})}{\sum_k \exp(e_{ik})}$ 
            <br>â†’ å¯¹åº” GAT çš„<strong>æ³¨æ„åŠ›å½’ä¸€åŒ–</strong></li>
          <li><strong>åŠ æƒèšåˆ</strong>ï¼š$h_i = \sum_j \alpha_{ij} v_j$ 
            <br>â†’ å¯¹åº” GNN çš„<strong>æ¶ˆæ¯èšåˆ</strong></li>
        </ol>
        
        <p><strong>å…³é”®åŒºåˆ«ï¼šå®Œå…¨å›¾ vs ç¨€ç–å›¾</strong></p>
        <table>
          <thead><tr><th>ç‰¹æ€§</th><th>GNNï¼ˆç¨€ç–å›¾ï¼‰</th><th>Transformerï¼ˆå®Œå…¨å›¾ï¼‰</th></tr></thead>
          <tbody>
            <tr><td>é‚»å±…</td><td>$\mathcal{N}(i)$ï¼ˆé€šå¸¸ $|\mathcal{N}(i)| \ll n$ï¼‰</td><td>æ‰€æœ‰èŠ‚ç‚¹ï¼ˆ$n$ ä¸ªï¼‰</td></tr>
            <tr><td>å¤æ‚åº¦</td><td>$O(|E|)$ï¼ˆè¾¹æ•°ï¼‰</td><td>$O(n^2)$ï¼ˆå¹³æ–¹ï¼‰</td></tr>
            <tr><td>ä¿¡æ¯ä¼ æ’­</td><td>å¤šå±‚æ‰èƒ½åˆ°è¿œå¤„</td><td>ä¸€å±‚å°±èƒ½å…¨å±€é€šä¿¡</td></tr>
            <tr><td>å½’çº³åç½®</td><td>å¼ºï¼ˆå±€éƒ¨æ€§ï¼‰</td><td>å¼±ï¼ˆéœ€è¦ä½ç½®ç¼–ç ï¼‰</td></tr>
          </tbody>
        </table>
        
        <p><strong>ä¸ºä»€ä¹ˆ Transformer éœ€è¦ä½ç½®ç¼–ç ï¼Ÿ</strong></p>
        <ul>
          <li>å®Œå…¨å›¾<strong>æ²¡æœ‰ç»“æ„ä¿¡æ¯</strong>ï¼ˆæ‰€æœ‰èŠ‚ç‚¹åœ°ä½å¹³ç­‰ï¼‰</li>
          <li>åºåˆ—ä»»åŠ¡ä¸­ï¼Œä½ç½®å¾ˆé‡è¦ï¼ˆ"æˆ‘çˆ±ä½ " â‰  "ä½ çˆ±æˆ‘"ï¼‰</li>
          <li>ä½ç½®ç¼–ç  $PE(i)$ ç›¸å½“äºç»™æ¯ä¸ªèŠ‚ç‚¹åŠ "ID"ï¼Œè®©æ¨¡å‹çŸ¥é“é¡ºåº</li>
          <li>å¯¹æ¯”ï¼šGNN ä¸éœ€è¦ä½ç½®ç¼–ç ï¼Œå› ä¸ºå›¾ç»“æ„æœ¬èº«å°±æ˜¯"ä½ç½®ä¿¡æ¯"</li>
        </ul>
        
        <p><strong>$\frac{1}{\sqrt{d_k}}$ ç¼©æ”¾çš„åŸå› </strong>ï¼š</p>
        <ul>
          <li>$q_i^\top k_j$ çš„æ–¹å·®æ˜¯ $d_k$ï¼ˆå‡è®¾ $q, k$ çš„å…ƒç´ æ˜¯æ ‡å‡†æ­£æ€ï¼‰</li>
          <li>ä¸ç¼©æ”¾ï¼šå½“ $d_k$ å¾ˆå¤§æ—¶ï¼Œç‚¹ç§¯å€¼å¾ˆå¤§ â†’ softmax å˜æˆ"ç¡¬é€‰æ‹©"ï¼ˆæŸä¸ª $\alpha_{ij} \approx 1$ï¼Œå…¶ä»– â‰ˆ 0ï¼‰</li>
          <li>ç¼©æ”¾åï¼šæ–¹å·®å˜ä¸º 1ï¼Œsoftmax æ›´å¹³æ»‘ï¼Œæ¢¯åº¦æ›´ç¨³å®š</li>
        </ul>
        
        <p><strong>å¤šå¤´æ³¨æ„åŠ›ï¼ˆMulti-Head Attentionï¼‰</strong>ï¼š</p>
        <ul>
          <li>= å¤šä¸ªå¹¶è¡Œçš„æ³¨æ„åŠ› GNN å±‚</li>
          <li>æ¯ä¸ªå¤´å­¦ä¹ ä¸åŒçš„"å…³ç³»æ¨¡å¼"ï¼ˆå¦‚è¯­æ³•ä¾èµ–ã€è¯­ä¹‰ç›¸ä¼¼æ€§ï¼‰</li>
          <li>æœ€åæ‹¼æ¥ï¼š$\text{MultiHead} = \text{Concat}(\text{head}_1, \ldots, \text{head}_h)W^O$</li>
        </ul>
        
        <p><strong>ä¸ºä»€ä¹ˆ Transformer è¿™ä¹ˆå¼ºï¼Ÿ</strong></p>
        <ol>
          <li><strong>å…¨å±€é€šä¿¡</strong>ï¼šä¸€å±‚å°±èƒ½çœ‹åˆ°å…¨éƒ¨è¾“å…¥ï¼ˆGNN éœ€è¦å¤šå±‚ï¼‰</li>
          <li><strong>æ•°æ®é©±åŠ¨</strong>ï¼šæ³¨æ„åŠ›æƒé‡å®Œå…¨å­¦ä¹ ï¼Œæ— éœ€é¢„å®šä¹‰å›¾ç»“æ„</li>
          <li><strong>å¯å¹¶è¡Œ</strong>ï¼šæ‰€æœ‰ä½ç½®å¯ä»¥åŒæ—¶è®¡ç®—ï¼ˆRNN å¿…é¡»ä¸²è¡Œï¼‰</li>
        </ol>
        
        <p><strong>å±€é™</strong>ï¼š</p>
        <ul>
          <li>$O(n^2)$ å¤æ‚åº¦ â†’ åºåˆ—é•¿åº¦å—é™ï¼ˆé€šå¸¸ â‰¤ 2048ï¼‰</li>
          <li>ç¼ºä¹å½’çº³åç½® â†’ éœ€è¦å¤§é‡æ•°æ®æ‰èƒ½å­¦å¥½</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šéšå¼å›¾æ¨æ–­ï¼ˆLatent Graph Inferenceï¼‰</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šå¦‚æœæˆ‘ä¸çŸ¥é“èŠ‚ç‚¹ä¹‹é—´è¯¥ä¸è¯¥è¿è¾¹ï¼Œèƒ½è®© GNN è‡ªå·±å­¦ä¹ å›¾ç»“æ„å—ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>éšå¼å›¾æ¨æ–­</strong>æ˜¯è¿‘æœŸ GNN ç ”ç©¶çš„çƒ­ç‚¹ï¼Œä»‹äºç¨€ç–å›¾å’Œå®Œå…¨å›¾ä¹‹é—´ã€‚</p>
        
        <p><strong>ä¸‰ç§è¾¹é›†ç­–ç•¥</strong>ï¼š</p>
        <ol>
          <li><strong>å›ºå®šç¨€ç–å›¾</strong>ï¼šé‚»æ¥çŸ©é˜µ $A$ é¢„å…ˆç»™å®šï¼ˆå¦‚åˆ†å­çš„åŒ–å­¦é”®ï¼‰</li>
          <li><strong>å®Œå…¨å›¾</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹éƒ½è¿æ¥ï¼ˆTransformerï¼‰</li>
          <li><strong>å­¦ä¹ å›¾</strong>ï¼šè®©æ¨¡å‹<strong>æ¨æ–­</strong>å“ªäº›èŠ‚ç‚¹åº”è¯¥è¿æ¥</li>
        </ol>
        
        <p><strong>éšå¼å›¾æ¨æ–­çš„æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>
        <p>å°†é‚»æ¥çŸ©é˜µ $A$ è§†ä¸º<strong>éšå˜é‡</strong>ï¼Œé€šè¿‡ç¥ç»ç½‘ç»œå­¦ä¹ ï¼š</p>
        $$A_{ij} = \sigma(\text{MLP}([x_i, x_j]))$$
        <ul>
          <li>è¾“å…¥ï¼šèŠ‚ç‚¹ç‰¹å¾ $x_i, x_j$</li>
          <li>è¾“å‡ºï¼šè¿æ¥æ¦‚ç‡ $A_{ij} \in [0,1]$</li>
          <li>$\sigma$ æ˜¯ sigmoid å‡½æ•°</li>
        </ul>
        
        <p><strong>å®ç°æ–¹å¼</strong>ï¼š</p>
        <ul>
          <li><strong>ç¡¬æ¨æ–­</strong>ï¼š$A_{ij} = \mathbb{1}[p_{ij} > \tau]$ï¼ˆé˜ˆå€¼å†³å®šï¼Œä¸å¯å¯¼ï¼‰</li>
          <li><strong>è½¯æ¨æ–­</strong>ï¼š$A_{ij} = \text{softmax}(e_{ij})$ï¼ˆå¯å¯¼ï¼Œç”¨äºè®­ç»ƒï¼‰</li>
          <li><strong>Gumbel-Softmax</strong>ï¼šå¯å¾®é‡‡æ ·ï¼Œå¹³è¡¡ç¦»æ•£æ€§å’Œå¯å¯¼æ€§</li>
        </ul>
        
        <p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p>
        <ol>
          <li><strong>è§†é¢‘ä¸­çš„ç‰©ä½“äº¤äº’</strong>ï¼šç‰©ä½“ = èŠ‚ç‚¹ï¼Œäº¤äº’å…³ç³» = è¾¹ï¼ˆéœ€è¦æ¨æ–­ï¼‰</li>
          <li><strong>ç²’å­ç³»ç»Ÿ</strong>ï¼šè¿œè·ç¦»ç²’å­æ˜¯å¦æœ‰ç›¸äº’ä½œç”¨ï¼Ÿè®©æ¨¡å‹å­¦ä¹ æˆªæ–­åŠå¾„</li>
          <li><strong>NLP ä¸­çš„éšå¼ä¾èµ–</strong>ï¼šå•è¯é—´çš„è¯­æ³•/è¯­ä¹‰ä¾èµ–æ ‘å¯ä»¥æ¨æ–­</li>
        </ol>
        
        <p><strong>PhysRobot ä¸­çš„åº”ç”¨</strong>ï¼š</p>
        <ul>
          <li>æˆ‘ä»¬ç›®å‰ç”¨<strong>å›ºå®šåŠå¾„</strong>æ„å»ºè¾¹ï¼ˆè·ç¦» < $r_{\text{cut}}$ çš„ç²’å­è¿æ¥ï¼‰</li>
          <li>æœªæ¥å¯ä»¥ç”¨éšå¼å›¾æ¨æ–­ï¼šè®©ç½‘ç»œå­¦ä¹ <strong>å“ªäº›ç²’å­å¯¹éœ€è¦äº¤äº’</strong></li>
          <li>å¥½å¤„ï¼šè‡ªé€‚åº” $r_{\text{cut}}$ï¼ŒèŠ‚çœè®¡ç®—ï¼ˆè¿œè·ç¦»ç²’å­è‡ªåŠ¨å¿½ç•¥ï¼‰</li>
        </ul>
        
        <p><strong>ç†è®ºæŒ‘æˆ˜</strong>ï¼š</p>
        <ul>
          <li>æ¨æ–­è¾¹çš„å¤æ‚åº¦ä»æ˜¯ $O(n^2)$ï¼ˆéœ€è¦è€ƒè™‘æ‰€æœ‰èŠ‚ç‚¹å¯¹ï¼‰</li>
          <li>è§£å†³æ–¹æ¡ˆï¼š<strong>ä¸¤é˜¶æ®µ</strong>ï¼šå…ˆç”¨ç®€å•è§„åˆ™ï¼ˆå¦‚è·ç¦»ï¼‰åˆç­›ï¼Œå†ç²¾ç»†æ¨æ–­</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-intuition">
    <h4>ğŸ¯ ç›´è§‰ç†è§£ï¼šä» Deep Sets åˆ° Transformer çš„æ¼”åŒ–</h4>
    <p><strong>æ¼”åŒ–è·¯å¾„</strong>ï¼š</p>
    <ul>
      <li><strong>Deep Sets</strong>ï¼š<em>"æˆ‘åªçœ‹è‡ªå·±ï¼Œç„¶åå¤§å®¶æŠ•ç¥¨"</em>
        <br>â†’ æ¯ä¸ªå…ƒç´ ç‹¬ç«‹å¤„ç†ï¼Œæœ€åæ±‚å’Œ</li>
      <li><strong>GNN</strong>ï¼š<em>"æˆ‘å’Œé‚»å±…èŠå¤©"</em>
        <br>â†’ åŠ å…¥é‚»å±…ä¿¡æ¯äº¤æ¢</li>
      <li><strong>GAT</strong>ï¼š<em>"æˆ‘é€‰æ‹©æ€§åœ°å¬é‡è¦é‚»å±…çš„è¯"</em>
        <br>â†’ åŠ å…¥æ³¨æ„åŠ›æœºåˆ¶</li>
      <li><strong>Transformer</strong>ï¼š<em>"æˆ‘å’Œæ‰€æœ‰äººèŠå¤©"</em>
        <br>â†’ å®Œå…¨å›¾ + æ³¨æ„åŠ›</li>
    </ul>
    
    <p><strong>ç±»æ¯”ï¼šä¼šè®®è®¨è®º</strong></p>
    <ul>
      <li><strong>Deep Sets</strong>ï¼šæ¯ä¸ªäººç‹¬ç«‹å‡†å¤‡å‘è¨€ï¼Œç„¶åä¸»æŒäººæ±‡æ€»</li>
      <li><strong>GNN</strong>ï¼šååœ¨ä¸€èµ·çš„äººå¯ä»¥å°å£°äº¤æµ</li>
      <li><strong>Transformer</strong>ï¼šæ‰€æœ‰äººé€šè¿‡éº¦å…‹é£å¹¿æ’­ï¼Œå¤§å®¶éƒ½èƒ½å¬åˆ°</li>
    </ul>
  </div>

  <div class="enrichment-application">
    <h4>ğŸ¥ åŒ»ç–—æœºå™¨äººåº”ç”¨ï¼šç‚¹äº‘å¤„ç†ä¸Transformer</h4>
    <p><strong>åœºæ™¯ 1ï¼š3D å™¨å®˜ç‚¹äº‘é‡å»º</strong></p>
    <ul>
      <li>è¾“å…¥ï¼šRGBD ç›¸æœºæ•è·çš„å™¨å®˜è¡¨é¢ç‚¹äº‘ $\{(x,y,z,\text{æ³•å‘é‡})_i\}$</li>
      <li>æ–¹æ³•ï¼šPointNetï¼ˆDeep Setsï¼‰æå–å…¨å±€å½¢çŠ¶ç‰¹å¾</li>
      <li>ä¼˜åŠ¿ï¼šå¯¹ç‚¹çš„é¡ºåºä¸æ•æ„Ÿï¼Œé²æ£’äºå™ªå£°</li>
    </ul>
    
    <p><strong>åœºæ™¯ 2ï¼šæ‰‹æœ¯è§†é¢‘ç†è§£</strong></p>
    <ul>
      <li>è¾“å…¥ï¼šè§†é¢‘å¸§åºåˆ—ï¼ˆæ¯å¸§æ˜¯ä¸€ä¸ª"èŠ‚ç‚¹"ï¼‰</li>
      <li>æ–¹æ³•ï¼šVideo Transformer å»ºæ¨¡å¸§é—´æ—¶é—´ä¾èµ–</li>
      <li>è¾“å‡ºï¼šæ‰‹æœ¯é˜¶æ®µè¯†åˆ«ã€å·¥å…·æ£€æµ‹</li>
    </ul>
    
    <p><strong>åœºæ™¯ 3ï¼šPhysRobot çš„æ‰©å±•</strong></p>
    <ul>
      <li>å½“å‰ï¼šå›ºå®šåŠå¾„é‚»å±…å›¾ï¼ˆç¨€ç– GNNï¼‰</li>
      <li>æ”¹è¿› 1ï¼šç”¨ Transformer å»ºæ¨¡<strong>å…¨å±€çº¦æŸ</strong>ï¼ˆå¦‚æ•´ä½“ä½“ç§¯å®ˆæ’ï¼‰</li>
      <li>æ”¹è¿› 2ï¼šéšå¼å›¾æ¨æ–­å­¦ä¹ <strong>åŠ¨æ€è¿æ¥</strong>ï¼ˆç¢°æ’æ—¶ä¸´æ—¶åˆ›å»ºè¾¹ï¼‰</li>
    </ul>
  </div>
</div>

<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šä»£ç å¯¹æ¯” â€” Deep Sets vs Transformer</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šèƒ½ç”¨ä»£ç å¯¹æ¯”ä¸€ä¸‹ Deep Sets å’Œ Transformer çš„å®ç°å—ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>æ ¸å¿ƒä»£ç å¯¹æ¯”</strong>ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š</p>
        
        <p><strong>Deep Sets</strong>ï¼š</p>
        <pre><code>class DeepSets(nn.Module):
    def forward(self, x):  # x: (B, N, d)
        h = self.phi(x)           # (B, N, d') â€” é€å…ƒç´ ç¼–ç 
        h = h.sum(dim=1)          # (B, d') â€” æ±‚å’Œèšåˆ
        return self.rho(h)        # (B, out_dim) â€” å…¨å±€å¤„ç†</code></pre>
        
        <p><strong>Transformerï¼ˆè‡ªæ³¨æ„åŠ›ï¼‰</strong>ï¼š</p>
        <pre><code>class SelfAttention(nn.Module):
    def forward(self, x):  # x: (B, N, d)
        Q = self.W_Q(x)           # (B, N, d_k)
        K = self.W_K(x)           # (B, N, d_k)
        V = self.W_V(x)           # (B, N, d_v)
        
        scores = Q @ K.T / âˆšd_k   # (B, N, N) â€” æ³¨æ„åŠ›åˆ†æ•°çŸ©é˜µ
        attn = softmax(scores)    # (B, N, N) â€” è½¯é‚»æ¥çŸ©é˜µï¼
        return attn @ V           # (B, N, d_v) â€” åŠ æƒèšåˆ</code></pre>
        
        <p><strong>å…³é”®å·®å¼‚</strong>ï¼š</p>
        <ul>
          <li>Deep Setsï¼š$h = \rho(\sum_i \phi(x_i))$ â€” <strong>å›ºå®šèšåˆ</strong>ï¼ˆsumï¼‰</li>
          <li>Transformerï¼š$h_i = \sum_j \alpha_{ij} v_j$ â€” <strong>å­¦ä¹ æƒé‡</strong> $\alpha_{ij}$</li>
          <li>è®¡ç®—é‡ï¼šDeep Sets $O(nd)$ï¼ŒTransformer $O(n^2 d)$</li>
        </ul>
      </div>
    </div>
  </div>
</div>
<!-- === END ENRICHMENT: sec5-4 === -->


    <h3 id="deepsets">Deep Sets: é›†åˆä¸Šçš„å­¦ä¹ </h3>

    <div class="math-block">
      $$f(\mathbf{X}) = \rho\left(\sum_{i} \phi(x_i)\right) \tag{Deep Sets}$$
      <div class="math-explain">
        <strong>Deep Sets</strong> (Zaheer et al., 2017) æ˜¯æœ€ç®€å•çš„é›†åˆæ¶æ„ï¼šç‹¬ç«‹åœ°å¯¹æ¯ä¸ªå…ƒç´  $x_i$ åº”ç”¨ $\phi$ï¼Œç„¶å<strong>æ±‚å’Œèšåˆ</strong>ã€‚ç­‰ä»·äº GNN ä¸­ä»¤ $A = I$ï¼ˆæ— è¾¹ï¼Œé‚»åŸŸåªæœ‰è‡ªèº«ï¼‰ã€‚Zaheer ç­‰äººè¯æ˜äº†å®ƒå…·æœ‰<strong>é€šç”¨é€¼è¿‘æ€§</strong>ã€‚åœ¨ç‚¹äº‘å¤„ç†ä¸­ä¹Ÿç§°ä¸º <strong>PointNet</strong> (Qi et al., 2017)ã€‚
      </div>
    </div>

    <h3 id="transformer">Transformer ä½œä¸ºå®Œå…¨å›¾ä¸Šçš„æ³¨æ„åŠ› GNN</h3>

    <p>è¿™æ˜¯æœ¬ä¹¦æœ€é‡è¦çš„æ´å¯Ÿä¹‹ä¸€ï¼š<span class="term">Transformer = å®Œå…¨å›¾ä¸Šçš„ GAT</span>ã€‚</p>

    <div class="blueprint">
      <h4>Transformer çš„ GNN è§†è§’</h4>
      <p>å½“æˆ‘ä»¬æ²¡æœ‰å…ˆéªŒå›¾ç»“æ„ï¼ˆ$A = \mathbf{1}\mathbf{1}^\top$ï¼Œå³å®Œå…¨å›¾ï¼‰ï¼Œå·ç§¯å‹ GNN é€€åŒ–ä¸º Deep Setsï¼ˆå› ä¸ºæ‰€æœ‰èŠ‚ç‚¹çš„èšåˆç›¸åŒï¼‰ã€‚ä½†<strong>æ³¨æ„åŠ›å‹ GNN</strong> ä¸ä¼šé€€åŒ–ï¼š</p>
      $$h_u = \phi\left(x_u, \bigoplus_{v \in V} a(x_u, x_v) \psi(x_v)\right) \tag{36}$$
      <p>è¿™æ­£æ˜¯<strong>è‡ªæ³¨æ„åŠ›</strong>ï¼ˆself-attentionï¼‰æ“ä½œâ€”â€”Transformer çš„æ ¸å¿ƒã€‚æ³¨æ„åŠ›ç³»æ•° $a(x_u, x_v)$ å¯ä»¥ç†è§£ä¸ºåœ¨æ¨æ–­ä¸€ä¸ª<strong>è½¯é‚»æ¥çŸ©é˜µ</strong>ã€‚</p>
    </div>

    <div class="derivation">
      <h4>Transformer è‡ªæ³¨æ„åŠ› = å®Œå…¨å›¾ GAT çš„æ¨å¯¼</h4>
      <div class="step"><span class="step-num">1</span><strong>æ ‡å‡† Multi-Head Attention</strong>ï¼š$Q = XW_Q, \; K = XW_K, \; V = XW_V$</div>
      <div class="step"><span class="step-num">2</span><strong>æ³¨æ„åŠ›çŸ©é˜µ</strong>ï¼š$A_{\text{soft}} = \text{softmax}\left(\frac{QK^\top}{\sqrt{d_k}}\right)$</div>
      <div class="step"><span class="step-num">3</span><strong>è¾“å‡º</strong>ï¼š$\text{Attention}(Q, K, V) = A_{\text{soft}} V$</div>
      <div class="step"><span class="step-num">4</span><strong>GNN è§†è§’</strong>ï¼š$A_{\text{soft}}$ å°±æ˜¯<strong>éšå¼æ¨æ–­çš„é‚»æ¥çŸ©é˜µ</strong>ï¼Œæ¯ä¸ªå…ƒç´  $A_{ij} = a(x_i, x_j)$ï¼Œæ˜¯"èŠ‚ç‚¹ $j$ å¯¹èŠ‚ç‚¹ $i$ çš„é‡è¦æ€§"ã€‚</div>
      <div class="step"><span class="step-num">5</span><strong>åŒºåˆ«</strong>ï¼šTransformer ä½¿ç”¨<strong>ä½ç½®ç¼–ç </strong>æ¥æ³¨å…¥åºåˆ—ä¿¡æ¯ï¼ˆå› ä¸ºå®Œå…¨å›¾å¿½ç•¥äº†ä½ç½®ï¼‰ï¼Œè¿™ç±»ä¼¼äºå›¾ä¸Šçš„ Laplacian ä½ç½®ç¼–ç ã€‚</div>
    </div>

    <h3 id="latent-graph">éšå¼å›¾æ¨æ–­</h3>

    <p>åœ¨ $A = I$ï¼ˆDeep Setsï¼‰å’Œ $A = \mathbf{1}\mathbf{1}^\top$ï¼ˆTransformerï¼‰ä¹‹é—´ï¼Œè¿˜æœ‰ä¸€ç§æ›´çµæ´»çš„æ–¹æ¡ˆï¼š<strong>å­¦ä¹ </strong>éšå¼å›¾ç»“æ„ $A$ã€‚</p>

    <div class="callout callout-info">
      <h4>ä¸‰ç§è¾¹é›†ç­–ç•¥å¯¹æ¯”</h4>
      <table>
        <thead><tr><th>ç­–ç•¥</th><th>é‚»æ¥çŸ©é˜µ</th><th>è¡¨è¾¾åŠ›</th><th>æ•ˆç‡</th><th>ä»£è¡¨</th></tr></thead>
        <tbody>
          <tr><td>ç©ºè¾¹é›†</td><td>$A = I$</td><td>ä½</td><td>$O(n)$</td><td>Deep Sets</td></tr>
          <tr><td>å®Œå…¨è¾¹é›†</td><td>$A = \mathbf{1}\mathbf{1}^\top$</td><td>é«˜</td><td>$O(n^2)$</td><td>Transformer</td></tr>
          <tr><td>å­¦ä¹ è¾¹é›†</td><td>å­¦ä¹ çš„ $A$</td><td>æœ€é«˜</td><td>$O(n^2)$+</td><td>éšå¼å›¾æ¨æ–­</td></tr>
        </tbody>
      </table>
    </div>

    <div class="code-container">
      <span class="code-label">Python / PyTorch â€” Transformer æ³¨æ„åŠ› = å®Œå…¨å›¾ä¸Šçš„ GAT</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code>import torch
import torch.nn as nn
import torch.nn.functional as F
import math

# ============================================================
# 1. æ ‡å‡† Transformer è‡ªæ³¨æ„åŠ›ï¼ˆä» GNN è§†è§’å®ç°ï¼‰
# ============================================================
class SelfAttentionAsGAT(nn.Module):
    """
    Transformer çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œä»¥å®Œå…¨å›¾ä¸Šçš„ GAT è§†è§’å®ç°ã€‚
    
    ç­‰ä»·æ€§:
    - Transformer: Attention(Q,K,V) = softmax(QK^T/âˆšd)V
    - GAT on complete graph: h_i = Î£_j Î±_ij (V x_j)
      where Î±_ij = softmax_j(Q x_i Â· K x_j / âˆšd)
    """
    def __init__(self, d_model, n_heads=8, dropout=0.1):
        super().__init__()
        assert d_model % n_heads == 0
        self.d_model = d_model
        self.n_heads = n_heads
        self.d_k = d_model // n_heads
        
        self.W_Q = nn.Linear(d_model, d_model)
        self.W_K = nn.Linear(d_model, d_model)
        self.W_V = nn.Linear(d_model, d_model)
        self.W_O = nn.Linear(d_model, d_model)
        self.dropout = nn.Dropout(dropout)
    
    def forward(self, x):
        """
        x: (B, N, d_model) â€” N ä¸ª "èŠ‚ç‚¹" çš„ç‰¹å¾
        è¾“å‡º: (B, N, d_model)
        
        åœ¨ GNN æœ¯è¯­ä¸­:
        - è¿™æ˜¯ä¸€ä¸ªå®Œå…¨å›¾ä¸Šçš„å¤šå¤´æ³¨æ„åŠ› GNN
        - æ¯ä¸ª "èŠ‚ç‚¹" éƒ½ä¸æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹é€šä¿¡
        """
        B, N, _ = x.shape
        
        # çº¿æ€§å˜æ¢ï¼ˆ= GNN ä¸­çš„ Ïˆ(x_v) å˜æ¢ï¼‰
        Q = self.W_Q(x).view(B, N, self.n_heads, self.d_k).transpose(1, 2)
        K = self.W_K(x).view(B, N, self.n_heads, self.d_k).transpose(1, 2)
        V = self.W_V(x).view(B, N, self.n_heads, self.d_k).transpose(1, 2)
        
        # æ³¨æ„åŠ›åˆ†æ•°ï¼ˆ= GAT çš„ Î±_ij è®¡ç®—ï¼‰
        # scores[i,j] = Q_i Â· K_j / âˆšd_k  â†’ è½¯é‚»æ¥çŸ©é˜µï¼
        scores = torch.matmul(Q, K.transpose(-2, -1)) / math.sqrt(self.d_k)
        
        # softmax å½’ä¸€åŒ–ï¼ˆ= GAT çš„ softmax å½’ä¸€åŒ–ï¼‰
        attn = F.softmax(scores, dim=-1)  # (B, heads, N, N) â€” è¿™å°±æ˜¯éšå¼é‚»æ¥çŸ©é˜µï¼
        attn = self.dropout(attn)
        
        # åŠ æƒèšåˆï¼ˆ= GAT çš„ Î£ Î±_ij V_jï¼‰
        out = torch.matmul(attn, V)  # (B, heads, N, d_k)
        
        # åˆå¹¶å¤šå¤´
        out = out.transpose(1, 2).contiguous().view(B, N, self.d_model)
        return self.W_O(out)


# ============================================================
# 2. Deep Sets å®ç°
# ============================================================
class DeepSets(nn.Module):
    """
    f(X) = Ï(Î£ Ï†(x_i))
    
    ç­‰ä»·äº: A = I çš„ GNNï¼ˆé‚»åŸŸåªæœ‰è‡ªèº«ï¼‰
    """
    def __init__(self, in_dim, hidden_dim, out_dim):
        super().__init__()
        # Ï†: é€å…ƒç´ å˜æ¢
        self.phi = nn.Sequential(
            nn.Linear(in_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
        )
        # Ï: èšåˆåçš„å˜æ¢
        self.rho = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, out_dim),
        )
    
    def forward(self, x):
        """x: (B, N, d) â†’ (B, out_dim)"""
        h = self.phi(x)          # (B, N, hidden)
        h = h.sum(dim=1)         # (B, hidden) â€” ç½®æ¢ä¸å˜èšåˆ
        return self.rho(h)       # (B, out_dim)


# ============================================================
# 3. å¯è§†åŒ–æ³¨æ„åŠ› = é‚»æ¥çŸ©é˜µ
# ============================================================
def visualize_attention_as_adjacency():
    """å±•ç¤º Transformer çš„æ³¨æ„åŠ›çŸ©é˜µå°±æ˜¯ä¸€ä¸ªè½¯é‚»æ¥çŸ©é˜µ"""
    torch.manual_seed(42)
    
    model = SelfAttentionAsGAT(d_model=64, n_heads=4)
    x = torch.randn(1, 8, 64)  # 8 ä¸ª "èŠ‚ç‚¹"
    
    # è·å–æ³¨æ„åŠ›æƒé‡
    B, N, _ = x.shape
    Q = model.W_Q(x).view(1, N, 4, 16).transpose(1, 2)
    K = model.W_K(x).view(1, N, 4, 16).transpose(1, 2)
    attn = F.softmax(Q @ K.transpose(-2, -1) / 4.0, dim=-1)
    
    print("æ³¨æ„åŠ›çŸ©é˜µï¼ˆ= è½¯é‚»æ¥çŸ©é˜µï¼‰:")
    print(f"å½¢çŠ¶: {attn.shape}")  # (1, 4, 8, 8)
    print(f"è¡Œå’Œ = {attn[0, 0].sum(dim=-1)}")  # æ¯è¡Œå’Œä¸º 1ï¼ˆsoftmaxï¼‰
    print(f"æœ€å¤§æ³¨æ„åŠ›: {attn[0, 0].max():.4f}")
    print(f"æœ€å°æ³¨æ„åŠ›: {attn[0, 0].min():.4f}")
    print("â†’ æ¯ä¸ªèŠ‚ç‚¹å¯¹æ‰€æœ‰èŠ‚ç‚¹çš„æ³¨æ„åŠ›æƒé‡ = å®Œå…¨å›¾ä¸Šçš„è¾¹æƒé‡ âœ…")


if __name__ == "__main__":
    visualize_attention_as_adjacency()
    
    # Deep Sets
    ds = DeepSets(16, 64, 10)
    x = torch.randn(4, 20, 16)  # 4 ä¸ªé›†åˆï¼Œæ¯ä¸ª 20 å…ƒç´ 
    print(f"\nDeep Sets: {x.shape} â†’ {ds(x).shape}")
    
    # éªŒè¯ç½®æ¢ä¸å˜æ€§
    perm = torch.randperm(20)
    out1 = ds(x)
    out2 = ds(x[:, perm])
    print(f"ç½®æ¢ä¸å˜æ€§è¯¯å·®: {(out1 - out2).abs().max():.2e} âœ…")</code></pre>
    </div>


    <!-- ====================== 5.5 EMPNN ====================== -->
    <h2 id="sec5-5">5.5 ç­‰å˜æ¶ˆæ¯ä¼ é€’ç½‘ç»œ (EMPNN) <span style="color:#f59f00">â­â­</span><br><span style="font-size:0.65em;color:var(--text-secondary)">Equivariant Message Passing Neural Networks</span></h2>

    <div class="bilingual">
      <div class="zh">
        <p>åœ¨è®¸å¤š GNN çš„åº”ç”¨ä¸­ï¼ŒèŠ‚ç‚¹ç‰¹å¾ï¼ˆæˆ–å…¶ä¸€éƒ¨åˆ†ï¼‰ä¸ä»…ä»…æ˜¯ä»»æ„å‘é‡ï¼Œè¿˜æ˜¯<strong>å‡ ä½•å®ä½“çš„åæ ‡</strong>ã€‚ä¾‹å¦‚åˆ†å­å›¾ä¸­ï¼šèŠ‚ç‚¹ä»£è¡¨åŸå­ï¼ŒåŒ…å«åŸå­ç±»å‹å’Œ<strong>3D ç©ºé—´åæ ‡</strong>ã€‚æˆ‘ä»¬å¸Œæœ›åœ¨æ ‡å‡†çš„ç½®æ¢ç­‰å˜æ€§ä¹‹å¤–ï¼Œè¿˜èƒ½ä¿è¯å¯¹<strong>æ¬§å‡ é‡Œå¾—ç¾¤ $E(3)$</strong>ï¼ˆæ—‹è½¬ã€å¹³ç§»ã€åå°„ï¼‰çš„ç­‰å˜æ€§ã€‚</p>
      </div>
      <div class="en">
        In many GNN applications, node features are coordinates of geometric entities. It is desirable to process them equivariantly to the Euclidean group E(3) of rigid motions, in addition to the standard permutation equivariance.
      </div>
    </div>

<!-- === ENRICHMENT: sec5-5 === -->
<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šä»€ä¹ˆæ˜¯ E(3) ç­‰å˜æ€§ï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼š$E(3)$ æ˜¯ä»€ä¹ˆç¾¤ï¼Ÿä¸ºä»€ä¹ˆåˆ†å­/ç²’å­ç³»ç»Ÿéœ€è¦ E(3) ç­‰å˜æ€§ï¼Ÿå’Œç½®æ¢ä¸å˜æ€§æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>$E(3)$ = 3D æ¬§å‡ é‡Œå¾—ç¾¤</strong>ï¼ŒåŒ…å«æ‰€æœ‰ä¿æŒè·ç¦»ä¸å˜çš„åˆšä½“å˜æ¢ã€‚</p>
        
        <p><strong>$E(3)$ çš„ç»„æˆ</strong>ï¼š</p>
        <ul>
          <li><strong>å¹³ç§»</strong>ï¼ˆTranslationsï¼‰ï¼š$\mathbf{x} \mapsto \mathbf{x} + \mathbf{t}$ï¼Œ$\mathbf{t} \in \mathbb{R}^3$</li>
          <li><strong>æ—‹è½¬</strong>ï¼ˆRotationsï¼‰ï¼š$\mathbf{x} \mapsto R\mathbf{x}$ï¼Œ$R \in SO(3)$ï¼ˆæ—‹è½¬çŸ©é˜µï¼Œ$R^\top R = I$, $\det R = 1$ï¼‰</li>
          <li>ç»„åˆï¼š$\mathbf{x} \mapsto R\mathbf{x} + \mathbf{t}$</li>
        </ul>
        
        <p><strong>ä¸ºä»€ä¹ˆç‰©ç†ç³»ç»Ÿéœ€è¦ E(3) ç­‰å˜æ€§ï¼Ÿ</strong></p>
        <ul>
          <li><strong>å¹³ç§»ä¸å˜æ€§</strong>ï¼šç‰©ç†å®šå¾‹åœ¨ä»»ä½•ä½ç½®éƒ½ç›¸åŒï¼ˆç‰›é¡¿å®šå¾‹ä¸ä¾èµ–ç»å¯¹åæ ‡ï¼‰</li>
          <li><strong>æ—‹è½¬ä¸å˜æ€§</strong>ï¼šç©ºé—´æ²¡æœ‰"ç»å¯¹æ–¹å‘"ï¼ˆåœ¨åœ°çƒä¸Šè¿˜æ˜¯åœ¨å¤ªç©ºä¸­ï¼ŒåŠ›å­¦è§„å¾‹ç›¸åŒï¼‰</li>
          <li>ä¾‹å­ï¼šåˆ†å­çš„èƒ½é‡åªä¾èµ–åŸå­é—´<strong>ç›¸å¯¹ä½ç½®</strong>ï¼Œä¸åˆ†å­æ•´ä½“æ”¾åœ¨å“ªé‡Œã€å¦‚ä½•æ—‹è½¬æ— å…³</li>
        </ul>
        
        <p><strong>ç½®æ¢ vs E(3) ç­‰å˜æ€§</strong>ï¼š</p>
        <table>
          <thead><tr><th>å¯¹ç§°æ€§</th><th>ä½œç”¨å¯¹è±¡</th><th>å«ä¹‰</th><th>ä¾‹å­</th></tr></thead>
          <tbody>
            <tr>
              <td><strong>ç½®æ¢ä¸å˜æ€§</strong><br>$\Sigma_n$</td>
              <td>èŠ‚ç‚¹ç¼–å·</td>
              <td>é‡æ–°æ’åˆ—ç²’å­ç¼–å·ä¸å½±å“ç»“æœ</td>
              <td>ç²’å­ 1,2,3 = ç²’å­ 3,1,2</td>
            </tr>
            <tr>
              <td><strong>E(3) ç­‰å˜æ€§</strong></td>
              <td>3D ç©ºé—´åæ ‡</td>
              <td>æ—‹è½¬/å¹³ç§»æ•´ä¸ªç³»ç»Ÿï¼Œè¾“å‡ºä¹Ÿæ—‹è½¬/å¹³ç§»</td>
              <td>æ—‹è½¬åˆ†å­ â†’ é¢„æµ‹çš„åŠ›ä¹Ÿæ—‹è½¬</td>
            </tr>
          </tbody>
        </table>
        
        <p><strong>æ ‡å‡† GNN çš„é—®é¢˜</strong>ï¼š</p>
        <ul>
          <li>GCN/GAT/GraphSAGE åªä¿è¯<strong>ç½®æ¢ä¸å˜æ€§</strong></li>
          <li>ä½†å®ƒä»¬<strong>ä¸ä¿è¯</strong> E(3) ç­‰å˜æ€§ï¼</li>
          <li>å¦‚æœç›´æ¥æŠŠ 3D åæ ‡ $(x,y,z)$ ä½œä¸ºç‰¹å¾è¾“å…¥ GNNï¼Œæ—‹è½¬åˆ†å­åï¼Œè¾“å‡ºä¼š<strong>å®Œå…¨ä¸åŒ</strong></li>
        </ul>
        
        <p><strong>åä¾‹</strong>ï¼ˆæ ‡å‡† GNN å¤±è´¥ï¼‰ï¼š</p>
        <ul>
          <li>è¾“å…¥ï¼šæ°¢åˆ†å­ Hâ‚‚ï¼ŒåŸå­åæ ‡ $[x_1=(0,0,0), x_2=(1,0,0)]$</li>
          <li>GNN é¢„æµ‹ï¼šåŸå­ 1 å—åŠ› $\mathbf{F}_1 = (1, 0, 0)$</li>
          <li>æ—‹è½¬åˆ†å­ 90Â°ï¼š$x_1'=(0,0,0), x_2'=(0,1,0)$</li>
          <li>å¦‚æœ GNN æ˜¯ E(3) ç­‰å˜çš„ï¼Œåº”è¯¥é¢„æµ‹ $\mathbf{F}_1' = (0, 1, 0)$</li>
          <li>ä½†æ ‡å‡† GNN ä¼šé¢„æµ‹<strong>é”™è¯¯çš„</strong>æ–¹å‘ï¼ˆå› ä¸ºå®ƒåªæ˜¯å­¦ä¹ äº†æ•°æ®æ¨¡å¼ï¼Œæ²¡æœ‰ç†è§£æ—‹è½¬ï¼‰</li>
        </ul>
        
        <p><strong>E(3) ç­‰å˜çš„ä¸¥æ ¼å®šä¹‰</strong>ï¼š</p>
        <p>å¯¹ä»»æ„ $R \in SO(3)$, $\mathbf{t} \in \mathbb{R}^3$ï¼Œå¦‚æœå‡½æ•° $F$ æ»¡è¶³ï¼š</p>
        $$F(R\mathbf{x}_1 + \mathbf{t}, \ldots, R\mathbf{x}_n + \mathbf{t}) = R \cdot F(\mathbf{x}_1, \ldots, \mathbf{x}_n) + \mathbf{t}$$
        <p>åˆ™ç§° $F$ æ˜¯ <strong>E(3) ç­‰å˜</strong>çš„ã€‚</p>
        
        <p><strong>ç”Ÿæ´»ç±»æ¯”</strong>ï¼š</p>
        <ul>
          <li>æƒ³è±¡ä½ åœ¨æµ‹é‡ä¸¤æ ¹æ£å­ä¹‹é—´çš„å¤¹è§’</li>
          <li><strong>æ—‹è½¬æ•´å¼ æ¡Œå­</strong>ï¼ˆç©ºé—´æ—‹è½¬ï¼‰â†’ å¤¹è§’ä¸å˜ï¼ˆE(3) ä¸å˜æ€§ï¼‰</li>
          <li><strong>äº¤æ¢ä¸¤æ ¹æ£å­çš„æ ‡ç­¾</strong>ï¼ˆç½®æ¢ï¼‰â†’ å¤¹è§’ä¸å˜ï¼ˆç½®æ¢ä¸å˜æ€§ï¼‰</li>
          <li>ç‰©ç†é‡ï¼ˆå¦‚åŠ›ã€é€Ÿåº¦ï¼‰éœ€è¦<strong>åŒæ—¶æ»¡è¶³</strong>è¿™ä¸¤ç§å¯¹ç§°æ€§</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šEGNN çš„æ ¸å¿ƒå…¬å¼é€æ­¥æ¨å¯¼</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šEGNN çš„å…¬å¼çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼š<br>$f_u' = \phi(f_u, \bigoplus_v \psi_f(f_u, f_v, \|x_u - x_v\|^2))$<br>$x_u' = x_u + \sum_v (x_u - x_v) \psi_c(f_u, f_v, \|x_u - x_v\|^2)$<br>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡å°±èƒ½ä¿è¯ E(3) ç­‰å˜æ€§ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>EGNN çš„å¤©æ‰ä¹‹å¤„</strong>ï¼šç”¨æœ€ç®€å•çš„è®¾è®¡è¾¾åˆ° E(3) ç­‰å˜æ€§ã€‚é€æ­¥ç†è§£ï¼š</p>
        
        <p><strong>Step 1ï¼šåŒºåˆ†æ ‡é‡ç‰¹å¾å’Œåæ ‡</strong></p>
        <ul>
          <li>$f_u$ï¼š<strong>æ ‡é‡ç‰¹å¾</strong>ï¼ˆå¦‚åŸå­ç±»å‹ã€è´¨é‡ï¼‰â€” æ—‹è½¬/å¹³ç§»ä¸å˜</li>
          <li>$x_u \in \mathbb{R}^3$ï¼š<strong>3D åæ ‡</strong> â€” æ—‹è½¬/å¹³ç§»ä¸‹ä¼šå˜åŒ–</li>
          <li>å…³é”®æ€æƒ³ï¼š<strong>åˆ†åˆ«å¤„ç†</strong>ä¸¤ç±»ä¿¡æ¯</li>
        </ul>
        
        <p><strong>Step 2ï¼šæ ‡é‡ç‰¹å¾æ›´æ–°ï¼ˆE(3) ä¸å˜ï¼‰</strong></p>
        $$f_u' = \phi\left(f_u, \bigoplus_{v \in \mathcal{N}_u} \psi_f(f_u, f_v, \|x_u - x_v\|^2)\right)$$
        <ul>
          <li>$\|x_u - x_v\|^2$ï¼šè·ç¦»çš„<strong>å¹³æ–¹</strong>ï¼ˆE(3) ä¸å˜é‡ï¼‰</li>
          <li>$\psi_f$ï¼šæ¶ˆæ¯å‡½æ•°ï¼Œè¾“å…¥æ˜¯<strong>æ ‡é‡</strong>ï¼ˆ$f_u, f_v$ï¼‰å’Œ<strong>è·ç¦»</strong>ï¼ˆä¸å˜é‡ï¼‰</li>
          <li>è¾“å‡º $f_u'$ åªä¾èµ–ä¸å˜é‡ â†’ æ—‹è½¬/å¹³ç§»è¾“å…¥æ—¶ï¼Œ$f_u'$ ä¸å˜ âœ…</li>
        </ul>
        
        <p><strong>Step 3ï¼šåæ ‡æ›´æ–°ï¼ˆE(3) ç­‰å˜ï¼‰</strong></p>
        $$x_u' = x_u + \sum_{v \neq u} (x_u - x_v) \psi_c(f_u, f_v, \|x_u - x_v\|^2)$$
        <ul>
          <li>$\psi_c$ï¼šè¾“å‡º<strong>æ ‡é‡</strong>æƒé‡ï¼ˆä¸å˜ï¼‰</li>
          <li>$(x_u - x_v)$ï¼š<strong>å‘é‡</strong>ï¼ˆç›¸å¯¹ä½ç§»ï¼‰</li>
          <li>å…³é”®ï¼š<strong>æ ‡é‡ Ã— å‘é‡</strong> = æ–°å‘é‡</li>
        </ul>
        
        <p><strong>Step 4ï¼šç­‰å˜æ€§è¯æ˜ï¼ˆæ—‹è½¬ï¼‰</strong></p>
        <p>è®¾æ—‹è½¬å˜æ¢ $\mathbf{x} \mapsto R\mathbf{x}$ï¼Œæˆ‘ä»¬è¦è¯æ˜ $x_u' \mapsto Rx_u'$ã€‚</p>
        <ul>
          <li>åŸå§‹æ›´æ–°ï¼š$x_u' = x_u + \sum_v (x_u - x_v) w_v$ï¼ˆç®€è®° $w_v = \psi_c(\cdots)$ï¼‰</li>
          <li>æ—‹è½¬åè¾“å…¥ï¼š$\tilde{x}_u = Rx_u$ï¼Œ$\tilde{x}_v = Rx_v$</li>
          <li>è·ç¦»ä¸å˜ï¼š$\|\tilde{x}_u - \tilde{x}_v\|^2 = \|R(x_u - x_v)\|^2 = \|x_u - x_v\|^2$</li>
          <li>å› æ­¤æƒé‡ä¸å˜ï¼š$\tilde{w}_v = \psi_c(f_u, f_v, \|\tilde{x}_u - \tilde{x}_v\|^2) = w_v$</li>
          <li>æ—‹è½¬åçš„æ›´æ–°ï¼š
            $$\begin{align*}
            \tilde{x}_u' &= \tilde{x}_u + \sum_v (\tilde{x}_u - \tilde{x}_v) \tilde{w}_v \\
            &= Rx_u + \sum_v (Rx_u - Rx_v) w_v \\
            &= Rx_u + R\sum_v (x_u - x_v) w_v \\
            &= R\left(x_u + \sum_v (x_u - x_v) w_v\right) \\
            &= R x_u'
            \end{align*}$$
          </li>
          <li>è¯æ¯• âœ…</li>
        </ul>
        
        <p><strong>Step 5ï¼šå¹³ç§»ç­‰å˜æ€§</strong>ï¼ˆæ›´ç®€å•ï¼‰</p>
        <ul>
          <li>å¹³ç§» $\mathbf{x} \mapsto \mathbf{x} + \mathbf{t}$</li>
          <li>ç›¸å¯¹ä½ç§»ï¼š$(x_u + \mathbf{t}) - (x_v + \mathbf{t}) = x_u - x_v$ï¼ˆå¹³ç§»æŠµæ¶ˆï¼‰</li>
          <li>å› æ­¤ $x_u' \mapsto x_u' + \mathbf{t}$ âœ…</li>
        </ul>
        
        <p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š</p>
        <ol>
          <li><strong>åªç”¨ç›¸å¯¹é‡</strong>ï¼š$x_u - x_v$ï¼ˆä¸ç”¨ç»å¯¹åæ ‡ $x_u$ï¼‰â†’ å¹³ç§»ä¸å˜</li>
          <li><strong>åªç”¨ä¸å˜é‡</strong>ï¼š$\|x_u - x_v\|$ï¼ˆä¸ç”¨å‘é‡æœ¬èº«ï¼‰â†’ æ—‹è½¬ä¸å˜çš„æ ‡é‡</li>
          <li><strong>æ ‡é‡ Ã— å‘é‡</strong>ï¼š$w (x_u - x_v)$ï¼ˆæ ‡é‡æƒé‡ä¹˜ä»¥å‘é‡ï¼‰â†’ æ—‹è½¬ç­‰å˜</li>
        </ol>
        
        <p><strong>ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ $(x_u - x_v)$ ä½œä¸ºç‰¹å¾ï¼Ÿ</strong></p>
        <ul>
          <li>å¦‚æœ $\psi_f$ æ¥æ”¶å‘é‡ $(x_u - x_v)$ï¼Œæ—‹è½¬åå‘é‡ä¼šå˜ â†’ $f_u'$ ä¼šå˜ â†’ ä¸å†æ˜¯ä¸å˜é‡</li>
          <li>åªç”¨è·ç¦» $\|x_u - x_v\|$ï¼šä¸¢å¼ƒäº†æ–¹å‘ä¿¡æ¯ï¼Œåªä¿ç•™é•¿åº¦ â†’ å®Œå…¨ä¸å˜</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šTensor Field Networks ä¸ä¸å¯çº¦è¡¨ç¤º</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šEGNN åªèƒ½å¤„ç†æ ‡é‡ç‰¹å¾ï¼Œå¦‚æœèŠ‚ç‚¹ç‰¹å¾æœ¬èº«æ˜¯<strong>å‘é‡</strong>ï¼ˆå¦‚é€Ÿåº¦ï¼‰æˆ–<strong>å¼ é‡</strong>ï¼ˆå¦‚åº”åŠ›ï¼‰ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>Tensor Field Networks (TFN)</strong> å’Œ <strong>SE(3)-Transformer</strong> ä½¿ç”¨<strong>ä¸å¯çº¦è¡¨ç¤º</strong>ç†è®ºï¼Œå¯ä»¥å¤„ç†ä»»æ„ç±»å‹çš„å¼ é‡ã€‚</p>
        
        <p><strong>é—®é¢˜èƒŒæ™¯</strong>ï¼š</p>
        <ul>
          <li>EGNN å‡è®¾æ‰€æœ‰ç‰¹å¾æ˜¯<strong>æ ‡é‡</strong>ï¼ˆ0 é˜¶å¼ é‡ï¼‰</li>
          <li>ä½†ç‰©ç†ä¸­å¾ˆå¤šé‡æ˜¯<strong>å‘é‡</strong>ï¼ˆ1 é˜¶å¼ é‡ï¼‰æˆ–<strong>çŸ©é˜µ</strong>ï¼ˆ2 é˜¶å¼ é‡ï¼‰ï¼š</li>
          <li>ä¾‹å­ï¼šåŠ› $\mathbf{F}$ã€é€Ÿåº¦ $\mathbf{v}$ã€è§’åŠ¨é‡ $\mathbf{L}$ï¼ˆå‘é‡ï¼‰ï¼›åº”åŠ›å¼ é‡ $\boldsymbol{\sigma}$ï¼ˆçŸ©é˜µï¼‰</li>
        </ul>
        
        <p><strong>æ ¸å¿ƒæ•°å­¦ï¼šä¸å¯çº¦è¡¨ç¤ºï¼ˆIrreducible Representations, Irrepsï¼‰</strong></p>
        <ul>
          <li>æ—‹è½¬ç¾¤ $SO(3)$ çš„ä»»ä½•è¡¨ç¤ºéƒ½å¯ä»¥åˆ†è§£ä¸º<strong>ä¸å¯çº¦</strong>å—ï¼ˆå°±åƒçŸ©é˜µçš„ç‰¹å¾å€¼åˆ†è§£ï¼‰</li>
          <li>æ ‡å‡†åŸºï¼š<strong>çƒè°å‡½æ•°</strong> $Y_l^m(\theta, \phi)$ï¼Œå…¶ä¸­ $l$ æ˜¯<strong>é˜¶æ•°</strong>ï¼ˆorderï¼‰</li>
          <li>$l=0$ï¼šæ ‡é‡ï¼ˆ1 ä¸ªåˆ†é‡ï¼‰</li>
          <li>$l=1$ï¼šå‘é‡ï¼ˆ3 ä¸ªåˆ†é‡ï¼Œå¯¹åº” $m = -1, 0, +1$ï¼‰</li>
          <li>$l=2$ï¼š2 é˜¶å¼ é‡ï¼ˆ5 ä¸ªç‹¬ç«‹åˆ†é‡ï¼Œå¯¹åº”æ— è¿¹å¯¹ç§°å¼ é‡ï¼‰</li>
        </ul>
        
        <p><strong>å¦‚ä½•è¡¨ç¤ºå‘é‡ï¼Ÿ</strong></p>
        <ul>
          <li>ç¬›å¡å°”åæ ‡ $(x, y, z)$ <strong>ä¸æ˜¯</strong>ä¸å¯çº¦è¡¨ç¤ºï¼ˆæ—‹è½¬æ—¶ä¸‰ä¸ªåˆ†é‡ä¼šæ··åˆï¼‰</li>
          <li>çƒåæ ‡ $(Y_1^{-1}, Y_1^0, Y_1^{+1})$ <strong>æ˜¯</strong>ä¸å¯çº¦è¡¨ç¤ºï¼š
            $$Y_1^{-1} = \frac{x - iy}{\sqrt{2}}, \quad Y_1^0 = z, \quad Y_1^{+1} = -\frac{x + iy}{\sqrt{2}}$$</li>
          <li>æ—‹è½¬ $R$ åï¼Œæ¯ä¸ª $Y_1^m$ åªä¸<strong>åŒé˜¶</strong>çš„ $Y_1^{m'}$ çº¿æ€§ç»„åˆï¼ˆ$3 \times 3$ Wigner D-çŸ©é˜µï¼‰</li>
        </ul>
        
        <p><strong>Tensor Field Network çš„æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>
        <ol>
          <li>å°†æ‰€æœ‰ç‰¹å¾è¡¨ç¤ºä¸º<strong>ä¸å¯çº¦è¡¨ç¤ºçš„ç›´å’Œ</strong>ï¼š$f = \bigoplus_{l=0}^{L_{\max}} f^{(l)}$</li>
          <li>$f^{(0)}$ï¼šæ ‡é‡éƒ¨åˆ†ï¼ˆå¦‚åŸå­ç±»å‹ï¼‰</li>
          <li>$f^{(1)}$ï¼šå‘é‡éƒ¨åˆ†ï¼ˆå¦‚é€Ÿåº¦ï¼‰</li>
          <li>$f^{(2)}$ï¼š2 é˜¶å¼ é‡éƒ¨åˆ†</li>
          <li>æ¶ˆæ¯ä¼ é€’æ—¶ï¼Œç”¨<strong>Clebsch-Gordan ç³»æ•°</strong>ï¼ˆCG ç³»æ•°ï¼‰ç»„åˆä¸åŒé˜¶çš„ç‰¹å¾</li>
          <li>CG ç³»æ•°ä¿è¯ç»„åˆåä»ç„¶æ˜¯ç­‰å˜çš„</li>
        </ol>
        
        <p><strong>CG ç³»æ•°çš„ä½œç”¨</strong>ï¼š</p>
        <ul>
          <li>é—®é¢˜ï¼šå¦‚ä½•ä»ä¸¤ä¸ªå‘é‡ $f^{(1)}$ å’Œ $g^{(1)}$ ç”Ÿæˆä¸€ä¸ªæ–°çš„æ ‡é‡/å‘é‡/å¼ é‡ï¼Ÿ</li>
          <li>ç­”æ¡ˆï¼šç”¨ CG ç³»æ•° $C_{l_1 m_1, l_2 m_2}^{l m}$ ç»„åˆ</li>
          <li>ä¾‹å­ï¼ˆå‘é‡ Ã— å‘é‡ï¼‰ï¼š
            <ul>
              <li>â†’ æ ‡é‡ï¼ˆ$l=0$ï¼‰ï¼š$f \cdot g$ï¼ˆç‚¹ç§¯ï¼‰</li>
              <li>â†’ å‘é‡ï¼ˆ$l=1$ï¼‰ï¼š$f \times g$ï¼ˆå‰ç§¯ï¼‰</li>
              <li>â†’ 2 é˜¶å¼ é‡ï¼ˆ$l=2$ï¼‰ï¼šå¯¹ç§°æ— è¿¹éƒ¨åˆ† $f \otimes g$</li>
            </ul>
          </li>
        </ul>
        
        <p><strong>ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤æ‚ï¼Ÿ</strong></p>
        <ul>
          <li>ä»£ä»·ï¼šæ•°å­¦å¤æ‚ï¼ˆéœ€è¦çƒè°å‡½æ•°ã€CG ç³»æ•°ï¼‰</li>
          <li>æ”¶ç›Šï¼š<strong>ç†è®ºä¿è¯</strong>çš„ç­‰å˜æ€§ + å¯ä»¥å¤„ç†ä»»æ„ç‰©ç†é‡</li>
          <li>é€‚ç”¨åœºæ™¯ï¼šåˆ†å­åŠ¨åŠ›å­¦ã€é‡å­åŒ–å­¦ã€å¤©ä½“ç‰©ç†</li>
        </ul>
        
        <p><strong>ç°ä»£ç®€åŒ–æ–¹æ³•ï¼šE(n)-GNN (Satorras et al., 2021)</strong></p>
        <ul>
          <li>ç”¨ EGNN çš„æ€è·¯ï¼š<strong>ä¸æ˜¾å¼è¡¨ç¤ºæ—‹è½¬</strong>ï¼Œåªç”¨ä¸å˜é‡ + ç­‰å˜æ„é€ </li>
          <li>é€Ÿåº¦ç‰¹å¾ï¼šç”¨<strong>é€Ÿåº¦çš„æ¨¡</strong> $\|\mathbf{v}\|$ ä½œä¸ºæ ‡é‡ï¼Œæ–¹å‘ä¿¡æ¯éšå¼åŒ…å«åœ¨åæ ‡æ›´æ–°ä¸­</li>
          <li>æ›´ç®€å•ä½†è¡¨è¾¾åŠ›ç•¥ä½ï¼ˆæ— æ³•æ˜¾å¼å¤„ç†è§’åŠ¨é‡ç­‰é«˜é˜¶é‡ï¼‰</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šPhysRobot çš„ EdgeFrame è®¾è®¡</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šé¡¹ç›®ä»£ç é‡Œçš„ <code>EdgeFrame</code> æ˜¯æ€ä¹ˆç¼–ç ç²’å­é—´å…³ç³»çš„ï¼Ÿä¸ºä»€ä¹ˆè¦åˆ†åˆ«å­˜å‚¨ $\mathbf{r}_{ij}$ å’Œ $\|\mathbf{r}_{ij}\|$ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>EdgeFrame çš„è®¾è®¡</strong>ç›´æ¥æ¥è‡ª EGNN ç†è®ºï¼Œä½†é’ˆå¯¹<strong>åŠ¨åŠ›å­¦ç³»ç»Ÿ</strong>ä¼˜åŒ–ã€‚</p>
        
        <p><strong>å®Œæ•´ç‰¹å¾åˆ—è¡¨</strong>ï¼ˆ8 ç»´ï¼‰ï¼š</p>
        <pre><code>edge_features = [
    r_x, r_y, r_z,        # ç›¸å¯¹ä½ç§»ï¼ˆå‘é‡ï¼Œ3Dï¼‰
    ||r||,                 # è·ç¦»ï¼ˆæ ‡é‡ï¼Œä¸å˜é‡ï¼‰
    v_x, v_y, v_z,        # ç›¸å¯¹é€Ÿåº¦ï¼ˆå‘é‡ï¼Œ3Dï¼‰
    ||v||                  # é€Ÿç‡ï¼ˆæ ‡é‡ï¼Œä¸å˜é‡ï¼‰
]</code></pre>
        
        <p><strong>ä¸ºä»€ä¹ˆéœ€è¦å‘é‡ + æ ‡é‡ï¼Ÿ</strong></p>
        <table>
          <thead><tr><th>ç‰¹å¾</th><th>ç±»å‹</th><th>E(3) æ€§è´¨</th><th>ç‰©ç†æ„ä¹‰</th></tr></thead>
          <tbody>
            <tr><td>$\mathbf{r}_{ij}$</td><td>å‘é‡</td><td>ç­‰å˜</td><td>ç²’å­ $j$ ç›¸å¯¹ $i$ çš„<strong>æ–¹å‘</strong></td></tr>
            <tr><td>$\|\mathbf{r}_{ij}\|$</td><td>æ ‡é‡</td><td>ä¸å˜</td><td>ç²’å­é—´<strong>è·ç¦»</strong>ï¼ˆå¦‚å¼¹ç°§é•¿åº¦ï¼‰</td></tr>
            <tr><td>$\mathbf{v}_{\text{rel}}$</td><td>å‘é‡</td><td>ç­‰å˜</td><td>ç›¸å¯¹è¿åŠ¨<strong>æ–¹å‘</strong>ï¼ˆç¢°æ’/åˆ†ç¦»ï¼‰</td></tr>
            <tr><td>$\|\mathbf{v}_{\text{rel}}\|$</td><td>æ ‡é‡</td><td>ä¸å˜</td><td>ç›¸å¯¹<strong>é€Ÿç‡</strong>ï¼ˆç¢°æ’å¼ºåº¦ï¼‰</td></tr>
          </tbody>
        </table>
        
        <p><strong>è®¾è®¡åŸç†</strong>ï¼š</p>
        <ol>
          <li><strong>å‘é‡ç‰¹å¾</strong>ï¼ˆ$\mathbf{r}, \mathbf{v}$ï¼‰ï¼šæä¾›<strong>æ–¹å‘ä¿¡æ¯</strong>
            <ul>
              <li>ç”¨äºè®¡ç®—åŠ›çš„æ–¹å‘ï¼ˆå¦‚å¼¹ç°§åŠ›æ²¿ $\mathbf{r}$ æ–¹å‘ï¼‰</li>
              <li>å¿…é¡»ä¿ç•™å®Œæ•´çš„ 3D ä¿¡æ¯</li>
            </ul>
          </li>
          <li><strong>æ ‡é‡ç‰¹å¾</strong>ï¼ˆ$\|\mathbf{r}\|, \|\mathbf{v}\|$ï¼‰ï¼šæä¾›<strong>å¹…åº¦ä¿¡æ¯</strong>
            <ul>
              <li>ç”¨äºè®¡ç®—åŠ›çš„å¤§å°ï¼ˆå¦‚èƒ¡å…‹å®šå¾‹ $F = k \|\mathbf{r} - \mathbf{r}_0\|$ï¼‰</li>
              <li>E(3) ä¸å˜ â†’ å¯ä»¥ç›´æ¥è¾“å…¥ MLP</li>
            </ul>
          </li>
        </ol>
        
        <p><strong>å…·ä½“åº”ç”¨ï¼ˆå¼¹ç°§åŠ›ï¼‰</strong>ï¼š</p>
        <ul>
          <li>ç‰©ç†å…¬å¼ï¼š$\mathbf{F}_{ij} = -k (\|\mathbf{r}_{ij}\| - l_0) \frac{\mathbf{r}_{ij}}{\|\mathbf{r}_{ij}\|}$</li>
          <li>åˆ†è§£ï¼š
            <ul>
              <li>$k (\|\mathbf{r}_{ij}\| - l_0)$ï¼š<strong>æ ‡é‡</strong>æƒé‡ï¼ˆå–å†³äºè·ç¦»ï¼‰</li>
              <li>$\frac{\mathbf{r}_{ij}}{\|\mathbf{r}_{ij}\|}$ï¼š<strong>å•ä½å‘é‡</strong>ï¼ˆæ–¹å‘ï¼‰</li>
            </ul>
          </li>
          <li>EdgeFrame æä¾›ï¼š$\|\mathbf{r}_{ij}\|$ å’Œ $\mathbf{r}_{ij}$ â†’ MLP å­¦ä¹ æƒé‡ $w$ï¼Œç„¶å $\mathbf{F} = w \cdot \mathbf{r}_{ij}$</li>
        </ul>
        
        <p><strong>åå¯¹ç§°æ€§éªŒè¯</strong>ï¼š</p>
        <ul>
          <li>ç‰›é¡¿ç¬¬ä¸‰å®šå¾‹ï¼š$\mathbf{F}_{ij} = -\mathbf{F}_{ji}$</li>
          <li>EdgeFrame ä¿è¯ï¼š$\mathbf{r}_{ij} = -\mathbf{r}_{ji}$ï¼ˆç›¸å¯¹ä½ç§»åå‘ï¼‰</li>
          <li>å¦‚æœæ¶ˆæ¯å‡½æ•°æ˜¯å¯¹ç§°çš„ï¼ˆ$\psi(f_i, f_j, e_{ij}) = \psi(f_j, f_i, e_{ji})$ï¼‰ï¼ŒåŠ æƒåè‡ªç„¶æ»¡è¶³åå¯¹ç§°æ€§</li>
        </ul>
        
        <p><strong>ä»£ç å®ç°è¦ç‚¹</strong>ï¼š</p>
        <pre><code># ç›¸å¯¹ä½ç§»
r_ij = positions[tgt] - positions[src]  # (E, 3)
r_norm = torch.norm(r_ij, dim=1, keepdim=True)  # (E, 1)

# ç›¸å¯¹é€Ÿåº¦
v_rel = velocities[tgt] - velocities[src]  # (E, 3)
v_norm = torch.norm(v_rel, dim=1, keepdim=True)  # (E, 1)

# æ‹¼æ¥ï¼š[å‘é‡, æ ‡é‡, å‘é‡, æ ‡é‡] = 8 ç»´
edge_feat = torch.cat([r_ij, r_norm, v_rel, v_norm], dim=1)</code></pre>
        
        <p><strong>æ‰©å±•ï¼šåŠ å…¥è§’åº¦ä¿¡æ¯</strong>ï¼ˆæœªæ¥æ”¹è¿›ï¼‰</p>
        <ul>
          <li>å½“å‰ EdgeFrame æ˜¯<strong>æˆå¯¹</strong>çš„ï¼ˆåªçœ‹ä¸¤ä¸ªç²’å­ï¼‰</li>
          <li>ä¸‰ä½“ä½œç”¨ï¼ˆå¦‚å¼¯æ›²åŠ›ï¼‰éœ€è¦<strong>è§’åº¦</strong>ï¼š$\angle(i, j, k)$</li>
          <li>å¯ä»¥æ‰©å±•ä¸º <strong>3-body EdgeFrame</strong>ï¼šåŒ…å«ä¸¤ä¸ªç›¸å¯¹å‘é‡å’Œå®ƒä»¬çš„å¤¹è§’</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-intuition">
    <h4>ğŸ¯ ç›´è§‰ç†è§£ï¼šç­‰å˜æ€§ = "æ­£ç¡®æ—‹è½¬"</h4>
    <p><strong>ç”Ÿæ´»ç±»æ¯”ï¼šæŒ‡å—é’ˆ</strong></p>
    <ul>
      <li>ä½ æœ‰ä¸€ä¸ªæŒ‡å—é’ˆï¼Œå®ƒæŒ‡å‘åŒ—æ–¹</li>
      <li><strong>æ—‹è½¬ä½ è‡ªå·±</strong>ï¼ˆç©ºé—´æ—‹è½¬ï¼‰â†’ æŒ‡å—é’ˆçš„æŒ‡é’ˆä¹Ÿç›¸å¯¹ä½ æ—‹è½¬ï¼ˆä½†ä»æŒ‡å‘åŒ—ï¼‰</li>
      <li>è¿™å°±æ˜¯<strong>ç­‰å˜æ€§</strong>ï¼šè¾“å‡º"è·Ÿéš"è¾“å…¥æ—‹è½¬</li>
      <li>å¦‚æœæŒ‡å—é’ˆæ˜¯<strong>ä¸å˜çš„</strong>ï¼ˆæ€»æ˜¯æŒ‡å‘åŒä¸€æ–¹å‘ï¼‰ï¼Œé‚£å°±æ˜¯"ä¸å˜æ€§"</li>
    </ul>
    
    <p><strong>ç‰©ç†ç›´è§‰</strong>ï¼š</p>
    <ul>
      <li><strong>æ ‡é‡</strong>ï¼ˆå¦‚æ¸©åº¦ã€è´¨é‡ï¼‰ï¼šæ—‹è½¬/å¹³ç§»ç©ºé—´ï¼Œå€¼ä¸å˜ â†’ <strong>ä¸å˜</strong></li>
      <li><strong>å‘é‡</strong>ï¼ˆå¦‚åŠ›ã€é€Ÿåº¦ï¼‰ï¼šæ—‹è½¬ç©ºé—´ï¼Œæ–¹å‘è·Ÿç€æ—‹è½¬ â†’ <strong>ç­‰å˜</strong></li>
      <li><strong>å¼ é‡</strong>ï¼ˆå¦‚åº”åŠ›ï¼‰ï¼šæ—‹è½¬ç©ºé—´ï¼Œæ‰€æœ‰åˆ†é‡æŒ‰ç‰¹å®šè§„åˆ™å˜æ¢ â†’ <strong>ç­‰å˜</strong></li>
    </ul>
    
    <p><strong>ä¸ºä»€ä¹ˆ EGNN çš„è®¾è®¡"ä¼˜é›…"ï¼Ÿ</strong></p>
    <ul>
      <li>ä¸éœ€è¦æ˜¾å¼å¤„ç†æ—‹è½¬çŸ©é˜µ $R$ï¼ˆé¿å…å¤æ‚çš„çƒè°å‡½æ•°ï¼‰</li>
      <li>åªç”¨<strong>ç›¸å¯¹é‡</strong>å’Œ<strong>ä¸å˜é‡</strong>â†’ è‡ªç„¶æ»¡è¶³ç­‰å˜æ€§</li>
      <li>ç®€å•ã€é«˜æ•ˆã€å¯è§£é‡Š</li>
    </ul>
  </div>

  <div class="enrichment-application">
    <h4>ğŸ¥ åŒ»ç–—æœºå™¨äººåº”ç”¨ï¼šE(3) ç­‰å˜æ€§çš„å®é™…ä»·å€¼</h4>
    <p><strong>åœºæ™¯ 1ï¼šæ‰‹æœ¯æœºå™¨äººçš„åŠ›æ„ŸçŸ¥</strong></p>
    <ul>
      <li>é—®é¢˜ï¼šæœºå™¨äººæ‰‹è‡‚æ¥è§¦è½¯ç»„ç»‡ï¼Œéœ€è¦é¢„æµ‹<strong>æ¥è§¦åŠ›</strong></li>
      <li>æŒ‘æˆ˜ï¼šæ¥è§¦ç‚¹çš„ç©ºé—´æ–¹å‘éšæœºï¼Œä¸èƒ½å‡è®¾"æ€»æ˜¯ä»ä¸Šå¾€ä¸‹æ¥è§¦"</li>
      <li>è§£å†³ï¼šE(3) ç­‰å˜ç½‘ç»œ â†’ æ— è®ºæ‰‹è‡‚ä»å“ªä¸ªè§’åº¦æ¥è§¦ï¼Œé¢„æµ‹çš„åŠ›æ–¹å‘éƒ½<strong>æ­£ç¡®</strong></li>
      <li>æ•°æ®æ•ˆç‡ï¼šåªéœ€è¦<strong>ä¸€ä¸ªæ–¹å‘</strong>çš„è®­ç»ƒæ•°æ®ï¼Œè‡ªåŠ¨æ³›åŒ–åˆ°æ‰€æœ‰æ–¹å‘</li>
    </ul>
    
    <p><strong>åœºæ™¯ 2ï¼šPhysRobot çš„ç²’å­ä»¿çœŸ</strong></p>
    <ul>
      <li>å½“å‰å®ç°ï¼šEdgeFrameï¼ˆç›¸å¯¹ä½ç§» + è·ç¦»ï¼‰â†’ å¤©ç„¶ E(3) ç­‰å˜</li>
      <li>å¥½å¤„ï¼šæ— è®ºæ‚£è€…ä½“ä½å¦‚ä½•ï¼ˆä»°å§/ä¾§å§/ä¿¯å§ï¼‰ï¼Œä»¿çœŸç»“æœ<strong>ç‰©ç†ä¸€è‡´</strong></li>
      <li>æ‰©å±•ï¼šåŠ å…¥<strong>é€Ÿåº¦</strong> EdgeFrameï¼ˆå·²å®ç°ï¼‰â†’ å¤„ç†åŠ¨æ€ç¢°æ’</li>
    </ul>
    
    <p><strong>åœºæ™¯ 3ï¼šåˆ†å­å¯¹æ¥ï¼ˆè¯ç‰©è®¾è®¡ï¼‰</strong></p>
    <ul>
      <li>é—®é¢˜ï¼šé¢„æµ‹è¯ç‰©åˆ†å­ä¸è›‹ç™½è´¨çš„ç»“åˆå§¿æ€</li>
      <li>æŒ‘æˆ˜ï¼šåˆ†å­å¯ä»¥ä»<strong>ä»»æ„è§’åº¦</strong>æ¥è¿‘è›‹ç™½è´¨</li>
      <li>æ–¹æ³•ï¼šE(3) ç­‰å˜ GNNï¼ˆå¦‚ SchNet, DimeNetï¼‰é¢„æµ‹ç»“åˆèƒ½</li>
      <li>ä¼˜åŠ¿ï¼šæ—‹è½¬ä¸å˜æ€§ = ä¸éœ€è¦æšä¸¾æ‰€æœ‰å¯èƒ½çš„å¯¹æ¥è§’åº¦</li>
    </ul>
  </div>
</div>

<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šEGNN vs TFN vs SchNet å¯¹æ¯”</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šè¿™ä¹ˆå¤š E(3) ç­‰å˜æ–¹æ³•ï¼Œåº”è¯¥ç”¨å“ªä¸ªï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>é€‰æ‹©æŒ‡å—</strong>ï¼š</p>
        
        <table>
          <thead><tr><th>æ–¹æ³•</th><th>å¤æ‚åº¦</th><th>ç‰¹å¾ç±»å‹</th><th>è¡¨è¾¾åŠ›</th><th>é€Ÿåº¦</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead>
          <tbody>
            <tr>
              <td><strong>EGNN</strong></td>
              <td>ç®€å•</td>
              <td>æ ‡é‡</td>
              <td>ä¸­</td>
              <td>å¿«</td>
              <td>ç²’å­ç³»ç»Ÿã€ç‚¹äº‘ã€åˆ†å­åŠ¨åŠ›å­¦</td>
            </tr>
            <tr>
              <td><strong>SchNet</strong></td>
              <td>ä¸­ç­‰</td>
              <td>æ ‡é‡ + å¾„å‘åŸº</td>
              <td>ä¸­</td>
              <td>å¿«</td>
              <td>é‡å­åŒ–å­¦ï¼ˆèƒ½é‡é¢„æµ‹ï¼‰</td>
            </tr>
            <tr>
              <td><strong>TFN</strong></td>
              <td>å¤æ‚</td>
              <td>ä»»æ„å¼ é‡</td>
              <td>é«˜</td>
              <td>æ…¢</td>
              <td>éœ€è¦è§’åŠ¨é‡ã€åº”åŠ›å¼ é‡çš„ç³»ç»Ÿ</td>
            </tr>
            <tr>
              <td><strong>SE(3)-Trans</strong></td>
              <td>å¤æ‚</td>
              <td>ä»»æ„å¼ é‡ + æ³¨æ„åŠ›</td>
              <td>æœ€é«˜</td>
              <td>æ…¢</td>
              <td>è›‹ç™½è´¨æŠ˜å ã€å¤æ‚åˆ†å­</td>
            </tr>
            <tr>
              <td><strong>PhysRobot<br>DynamicalGNN</strong></td>
              <td>ç®€å•</td>
              <td>æ ‡é‡ + EdgeFrame</td>
              <td>ä¸­</td>
              <td>å¿«</td>
              <td>å®æ—¶è½¯ç»„ç»‡ä»¿çœŸ</td>
            </tr>
          </tbody>
        </table>
        
        <p><strong>å†³ç­–æ ‘</strong>ï¼š</p>
        <ul>
          <li>åªéœ€è¦æ ‡é‡ç‰¹å¾ï¼ˆä½ç½®ã€ç±»å‹ï¼‰ï¼Ÿâ†’ <strong>EGNN</strong></li>
          <li>éœ€è¦é¢„æµ‹æ ‡é‡èƒ½é‡ï¼ˆé‡å­åŒ–å­¦ï¼‰ï¼Ÿâ†’ <strong>SchNet</strong></li>
          <li>éœ€è¦å‘é‡/å¼ é‡ç‰¹å¾ï¼ˆåŠ›ã€åº”åŠ›ï¼‰ï¼Ÿâ†’ <strong>TFN æˆ– SE(3)-Transformer</strong></li>
          <li>å®æ—¶æ€§è¦æ±‚é«˜ï¼Ÿâ†’ <strong>EGNN</strong>ï¼ˆæœ€å¿«ï¼‰</li>
          <li>è¡¨è¾¾åŠ›è¦æ±‚æœ€é«˜ï¼ˆä¸åœ¨ä¹é€Ÿåº¦ï¼‰ï¼Ÿâ†’ <strong>SE(3)-Transformer</strong></li>
        </ul>
        
        <p><strong>PhysRobot ä¸ºä»€ä¹ˆé€‰æ‹© EGNN æ€è·¯ï¼Ÿ</strong></p>
        <ol>
          <li><strong>å®æ—¶æ€§</strong>ï¼šåŒ»ç–—æœºå™¨äººéœ€è¦ 30-60 Hz æ›´æ–°ï¼ˆ16-33ms æ¯å¸§ï¼‰</li>
          <li><strong>ç®€å•æ€§</strong>ï¼šEdgeFrame å®¹æ˜“ç†è§£å’Œè°ƒè¯•</li>
          <li><strong>ç‰©ç†å…ˆéªŒ</strong>ï¼šç‰›é¡¿åŠ›å­¦åªéœ€è¦æ ‡é‡åŠ›çš„å¤§å° + æ–¹å‘å‘é‡</li>
          <li><strong>å¯æ‰©å±•</strong>ï¼šæœªæ¥å¯ä»¥åŠ å…¥è§’åŠ¨é‡ï¼ˆå‡çº§åˆ° TFNï¼‰</li>
        </ol>
      </div>
    </div>
  </div>
</div>
<!-- === END ENRICHMENT: sec5-5 === -->


    <h3 id="egnn">E(n)-ç­‰å˜å›¾ç¥ç»ç½‘ç»œ (EGNN)</h3>

    <p>Satorras et al. (2021) æå‡ºäº†ä¸€ä¸ªä¼˜é›…çš„ E(n)-ç­‰å˜æ¶ˆæ¯ä¼ é€’æ–¹æ¡ˆï¼š</p>

    <div class="blueprint">
      <h4>EGNN çš„æ ¸å¿ƒå…¬å¼</h4>
      <p>åŒºåˆ†<strong>æ ‡é‡ç‰¹å¾</strong> $f_u$ å’Œ<strong>ç©ºé—´åæ ‡</strong> $x_u$ï¼š</p>
      $$f_u' = \phi\left(f_u, \bigoplus_{v \in \mathcal{N}_u} \psi_f(f_u, f_v, \|x_u - x_v\|^2)\right)$$
      $$x_u' = x_u + \sum_{v \neq u} (x_u - x_v) \psi_c(f_u, f_v, \|x_u - x_v\|^2)$$
    </div>

    <div class="derivation">
      <h4>ä¸ºä»€ä¹ˆè¿™æ˜¯ E(3)-ç­‰å˜çš„ï¼Ÿé€æ­¥è¯æ˜</h4>
      <div class="step"><span class="step-num">1</span><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼š$f_u'$ å¯¹ $x_u$ çš„å”¯ä¸€ä¾èµ–æ˜¯é€šè¿‡<strong>è·ç¦»</strong> $\|x_u - x_v\|^2$ã€‚E(3) å˜æ¢ä¿æŒè·ç¦»ä¸å˜ï¼Œå› æ­¤ $f_u'$ æ˜¯ E(3) ä¸å˜çš„ã€‚âœ…</div>
      <div class="step"><span class="step-num">2</span><strong>åæ ‡æ›´æ–°</strong>ï¼šè€ƒè™‘å˜æ¢ $x_u \mapsto Rx_u + b$ã€‚
        $$x_u' \mapsto (Rx_u + b) + \sum_{v \neq u} ((Rx_u + b) - (Rx_v + b)) \psi_c(\cdots)$$
        $$= Rx_u + b + \sum_{v \neq u} R(x_u - x_v) \psi_c(\cdots)$$
        $$= R\left(x_u + \sum_{v \neq u} (x_u - x_v) \psi_c(\cdots)\right) + b = Rx_u' + b$$</div>
      <div class="step"><span class="step-num">3</span>å› æ­¤ $x_u'$ åœ¨ $E(3)$ ä¸‹<strong>ç­‰å˜</strong>åœ°å˜æ¢ï¼š$x_u' \mapsto Rx_u' + b$ã€‚âœ…</div>
      <div class="step"><span class="step-num">4</span><strong>å…³é”®</strong>ï¼š$\psi_c$ è¾“å‡ºçš„æ˜¯<strong>æ ‡é‡</strong>æƒé‡ï¼Œä¹˜ä»¥<strong>å‘é‡</strong> $(x_u - x_v)$ã€‚æ ‡é‡ä¸å—æ—‹è½¬å½±å“ï¼Œå‘é‡è‡ªç„¶æ—‹è½¬ã€‚</div>
    </div>

    <div class="figure">
      <img src="../assets/ch5_p90_img0.png" alt="EGNN equivariance">
      <figcaption>å›¾ï¼šæ ‡é‡ç‰¹å¾ï¼ˆçƒ­å›¾ï¼‰åœ¨æ—‹è½¬ä¸‹ä¸å˜ï¼Œä½†å‘é‡ç‰¹å¾ï¼ˆç®­å¤´ï¼‰ä¼šæ”¹å˜æ–¹å‘ã€‚ç®€å•çš„ E(3) ç­‰å˜ GNN åªå¤„ç†æ ‡é‡ï¼›æ›´é«˜çº§çš„æ–¹æ³•ï¼ˆå¦‚ Tensor Field Networksï¼‰å¤„ç†ä»»æ„å¼ é‡ã€‚</figcaption>
    </div>

    <h3 id="tfn">Tensor Field Networks ä¸ä¸å¯çº¦è¡¨ç¤º</h3>

    <p>EGNN çš„é™åˆ¶ï¼šç‰¹å¾ $f_u$ è¢«å‡è®¾ä¸º<strong>æ ‡é‡</strong>ã€‚ä½†æœ‰äº›ç‰©ç†é‡æ˜¯<strong>å‘é‡</strong>ï¼ˆå¦‚é€Ÿåº¦ï¼‰æˆ–<strong>å¼ é‡</strong>ï¼ˆå¦‚åº”åŠ›ï¼‰ã€‚æ›´ä¸€èˆ¬çš„æ–¹æ³•åŸºäº<strong>ä¸å¯çº¦è¡¨ç¤º</strong>ã€‚</p>

    <div class="callout callout-info">
      <h4>ä¸å¯çº¦è¡¨ç¤ºæ–¹æ³•</h4>
      <p>æ—‹è½¬ç¾¤çš„æ‰€æœ‰è¡¨ç¤ºéƒ½å¯ä»¥åˆ†è§£ä¸º<strong>ä¸å¯çº¦</strong>å½¢å¼ï¼šç”± <strong>Wigner D-çŸ©é˜µ</strong>ï¼ˆçƒè°å‡½æ•°çš„ Fourier åŸºï¼‰æ—‹è½¬çš„å‘é‡ã€‚ç­‰å˜æ ¸é€šè¿‡ <strong>Clebsch-Gordan çŸ©é˜µ</strong>å’Œçƒè°å‡½æ•°æ„é€ ã€‚</p>
      <p>ä»£è¡¨æ¨¡å‹ï¼š</p>
      <ul>
        <li><strong>Tensor Field Networks</strong> (Thomas et al., 2018)ï¼šç‚¹äº‘ä¸Šçš„å·ç§¯æ¨¡å‹</li>
        <li><strong>SE(3)-Transformer</strong> (Fuchs et al., 2020)ï¼šå›¾ä¸Šçš„æ³¨æ„åŠ›å±‚</li>
        <li><strong>SchNet</strong> (SchÃ¼tt et al., 2018)ï¼šé‡å­åŒ–å­¦çš„é«˜æ•ˆæ¶ˆæ¯ä¼ é€’</li>
        <li><strong>DimeNet</strong> (Klicpera et al., 2020)ï¼šä½¿ç”¨æ–¹å‘ä¿¡æ¯</li>
      </ul>
    </div>

    <h3 id="empnn-physrobot">ğŸ¤– EdgeFrame çš„ç­‰å˜æ€§ â€” æ¥è‡ª EMPNN ç†è®º</h3>

    <div class="callout callout-project">
      <h4>PhysRobot çš„ EdgeFrame ä¸ EGNN çš„å…³è”</h4>
      <p>æˆ‘ä»¬é¡¹ç›®ä¸­çš„ <code>EdgeFrame</code> æ¨¡å—ç›´æ¥ä½“ç°äº† EGNN çš„è®¾è®¡å“²å­¦ï¼š</p>
      <ul>
        <li><strong>ç›¸å¯¹ä½ç§»</strong>ï¼š$r_{ij} = x_j - x_i$ â€” è¿™æ˜¯ EGNN ä¸­çš„ $(x_u - x_v)$</li>
        <li><strong>è·ç¦»ä¸å˜é‡</strong>ï¼š$\|r_{ij}\|$ â€” è¿™æ˜¯ E(3) ä¸å˜çš„æ ‡é‡</li>
        <li><strong>ç›¸å¯¹é€Ÿåº¦</strong>ï¼š$v_{\text{rel}} = v_j - v_i$ â€” EGNN çš„é€Ÿåº¦æ‰©å±•</li>
        <li><strong>åå¯¹ç§°æ€§</strong>ï¼š$e_{ij} = -e_{ji}$ â€” ä¿è¯ç‰›é¡¿ç¬¬ä¸‰å®šå¾‹ï¼</li>
      </ul>
    </div>

    <div class="code-container">
      <span class="code-label">PhysRobot é¡¹ç›®ä»£ç  â€” physics_core/edge_frame.pyï¼ˆå®é™…ä»£ç ï¼‰</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code># è¿™æ˜¯æˆ‘ä»¬å®é™…é¡¹ç›®çš„ EdgeFrame å®ç°
# å®Œæ•´æºç : physics_core/edge_frame.py

class EdgeFrame(nn.Module):
    """
    Edge Frame: ç¼–ç èŠ‚ç‚¹é—´çš„ç©ºé—´å…³ç³»ã€‚
    
    æ•°å­¦åŸç†ï¼ˆå¯¹åº” GDL Â§5.5 EGNNï¼‰:
    - è¾“å…¥: ä½ç½® x_i, x_j å’Œé€Ÿåº¦ v_i, v_j
    - è¾“å‡º: e_ij = Encoder([r_ij, ||r_ij||, v_rel, ||v_rel||])
    
    å…³é”®æ€§è´¨:
    1. å¹³ç§»ä¸å˜: ä½¿ç”¨ç›¸å¯¹é‡ r_ij = x_j - x_iï¼ˆè€Œéç»å¯¹ä½ç½®ï¼‰
    2. åå¯¹ç§°: e_ij = -e_jiï¼ˆç‰›é¡¿ç¬¬ä¸‰å®šå¾‹ï¼‰
    3. è·ç¦»ä¿¡æ¯: ||r_ij|| æ˜¯ E(3) ä¸å˜æ ‡é‡
    """
    def __init__(self, hidden_dim=64):
        super().__init__()
        # è¾“å…¥: [dx, dy, dz, ||r||, dvx, dvy, dvz, ||v||] = 8 ç»´
        self.edge_encoder = nn.Sequential(
            nn.Linear(8, hidden_dim),
            nn.LayerNorm(hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.LayerNorm(hidden_dim),
            nn.ReLU(),
        )
    
    def forward(self, positions, velocities, edge_index):
        src_idx, tgt_idx = edge_index[0], edge_index[1]
        
        # ç›¸å¯¹ä½ç§»ï¼ˆåå¯¹ç§°ï¼‰: r_ij = x_j - x_i
        r_ij = positions[tgt_idx] - positions[src_idx]  # (E, 3)
        r_norm = torch.norm(r_ij, dim=1, keepdim=True)  # (E, 1) â€” E(3) ä¸å˜é‡ï¼
        
        # ç›¸å¯¹é€Ÿåº¦ï¼ˆåå¯¹ç§°ï¼‰: v_rel = v_j - v_i
        v_rel = velocities[tgt_idx] - velocities[src_idx]  # (E, 3)
        v_norm = torch.norm(v_rel, dim=1, keepdim=True)
        
        # æ‹¼æ¥: 8 ç»´ç‰¹å¾
        edge_features = torch.cat([r_ij, r_norm, v_rel, v_norm], dim=1)
        
        return self.edge_encoder(edge_features)  # (E, hidden_dim)
    
    def check_antisymmetry(self, positions, velocities, edge_index):
        """éªŒè¯åå¯¹ç§°æ€§: e_ij = -e_jiï¼ˆç‰›é¡¿ç¬¬ä¸‰å®šå¾‹ï¼‰"""
        e_ij = self(positions, velocities, edge_index)
        edge_index_rev = torch.stack([edge_index[1], edge_index[0]], dim=0)
        e_ji = self(positions, velocities, edge_index_rev)
        return torch.max(torch.abs(e_ij + e_ji)).item()</code></pre>
    </div>

    <h3 id="empnn-code">ä»£ç ï¼šç®€å•çš„ E(3) ç­‰å˜å±‚</h3>

    <div class="code-container">
      <span class="code-label">Python / PyTorch â€” E(3) ç­‰å˜ GNN å±‚</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code>import torch
import torch.nn as nn
from torch_geometric.nn import MessagePassing

# ============================================================
# EGNN Layer (Satorras et al., 2021)
# E(3)-ç­‰å˜å›¾ç¥ç»ç½‘ç»œå±‚
# ============================================================
class EGNNLayer(MessagePassing):
    """
    E(3)-Equivariant GNN Layer
    
    æ•°å­¦:
    f_i' = Ï†(f_i, Î£_j Ïˆ_f(f_i, f_j, ||x_i - x_j||Â²))
    x_i' = x_i + Î£_j (x_i - x_j) Â· Ïˆ_c(f_i, f_j, ||x_i - x_j||Â²)
    
    ç­‰å˜æ€§ä¿è¯:
    - f' å¯¹ E(3) ä¸å˜ï¼ˆåªä¾èµ–è·ç¦»ï¼‰
    - x' å¯¹ E(3) ç­‰å˜ï¼ˆå‘é‡å˜æ¢ + æ ‡é‡æƒé‡ï¼‰
    """
    def __init__(self, feature_dim, hidden_dim):
        super().__init__(aggr='add')
        self.feature_dim = feature_dim
        
        # Ïˆ_f: æ ‡é‡æ¶ˆæ¯å‡½æ•°
        self.message_mlp = nn.Sequential(
            nn.Linear(2 * feature_dim + 1, hidden_dim),  # +1 for distance
            nn.SiLU(),
            nn.Linear(hidden_dim, hidden_dim),
        )
        
        # Ïˆ_c: åæ ‡æ›´æ–°çš„æ ‡é‡æƒé‡
        self.coord_mlp = nn.Sequential(
            nn.Linear(2 * feature_dim + 1, hidden_dim),
            nn.SiLU(),
            nn.Linear(hidden_dim, 1),  # è¾“å‡ºæ ‡é‡ï¼
        )
        
        # Ï†: ç‰¹å¾æ›´æ–°
        self.update_mlp = nn.Sequential(
            nn.Linear(feature_dim + hidden_dim, hidden_dim),
            nn.SiLU(),
            nn.Linear(hidden_dim, feature_dim),
        )
    
    def forward(self, f, x, edge_index):
        """
        f: (N, feature_dim) â€” æ ‡é‡ç‰¹å¾ï¼ˆE(3) ä¸å˜ï¼‰
        x: (N, 3)           â€” ç©ºé—´åæ ‡ï¼ˆE(3) ç­‰å˜ï¼‰
        edge_index: (2, E)
        
        è¿”å›: f', x' â€” æ›´æ–°åçš„ç‰¹å¾å’Œåæ ‡
        """
        src, dst = edge_index
        
        # è®¡ç®—è·ç¦»ï¼ˆE(3) ä¸å˜é‡ï¼‰
        diff = x[dst] - x[src]              # (E, 3)
        dist_sq = (diff ** 2).sum(dim=-1, keepdim=True)  # (E, 1)
        
        # æ¶ˆæ¯ä¼ é€’ï¼ˆç‰¹å¾æ›´æ–°ï¼‰
        f_msg = self.message_mlp(torch.cat([f[dst], f[src], dist_sq], dim=-1))
        
        # èšåˆæ¶ˆæ¯
        agg = torch.zeros(f.size(0), f_msg.size(1), device=f.device)
        agg.scatter_add_(0, dst.unsqueeze(1).expand_as(f_msg), f_msg)
        
        # æ›´æ–°æ ‡é‡ç‰¹å¾
        f_new = self.update_mlp(torch.cat([f, agg], dim=-1)) + f
        
        # åæ ‡æ›´æ–°
        coord_weights = self.coord_mlp(torch.cat([f[dst], f[src], dist_sq], dim=-1))
        weighted_diff = diff * coord_weights  # (E, 3) * (E, 1) = (E, 3)
        
        coord_agg = torch.zeros_like(x)
        coord_agg.scatter_add_(0, dst.unsqueeze(1).expand_as(weighted_diff), weighted_diff)
        
        x_new = x + coord_agg
        
        return f_new, x_new


# ============================================================
# å®Œæ•´çš„ EGNN æ¨¡å‹
# ============================================================
class EGNN(nn.Module):
    def __init__(self, in_dim, hidden_dim, out_dim, n_layers=3):
        super().__init__()
        self.encoder = nn.Linear(in_dim, hidden_dim)
        self.layers = nn.ModuleList([
            EGNNLayer(hidden_dim, hidden_dim) for _ in range(n_layers)
        ])
        self.decoder = nn.Linear(hidden_dim, out_dim)
    
    def forward(self, f, x, edge_index):
        f = self.encoder(f)
        for layer in self.layers:
            f, x = layer(f, x, edge_index)
        return self.decoder(f), x


# ============================================================
# éªŒè¯ E(3) ç­‰å˜æ€§
# ============================================================
def verify_e3_equivariance():
    """éªŒè¯ EGNN çš„ E(3) ç­‰å˜æ€§"""
    torch.manual_seed(42)
    
    layer = EGNNLayer(feature_dim=16, hidden_dim=32)
    layer.eval()
    
    N = 5
    f = torch.randn(N, 16)
    x = torch.randn(N, 3)
    edge_index = torch.tensor([[0,1,1,2,2,3,3,4],
                                [1,0,2,1,3,2,4,3]], dtype=torch.long)
    
    # åŸå§‹è¾“å‡º
    f_out, x_out = layer(f, x, edge_index)
    
    # æ„é€ éšæœºæ—‹è½¬å’Œå¹³ç§»
    # éšæœºæ—‹è½¬çŸ©é˜µï¼ˆRodrigues å…¬å¼ï¼‰
    axis = torch.randn(3)
    axis = axis / axis.norm()
    angle = torch.tensor(1.2)
    K = torch.tensor([[0, -axis[2], axis[1]],
                       [axis[2], 0, -axis[0]],
                       [-axis[1], axis[0], 0]])
    R = torch.eye(3) + torch.sin(angle) * K + (1 - torch.cos(angle)) * K @ K
    b = torch.randn(3)  # å¹³ç§»
    
    # å˜æ¢åæ ‡
    x_transformed = (R @ x.T).T + b  # Rx + b
    
    # åœ¨å˜æ¢åçš„è¾“å…¥ä¸Šè¿è¡Œ
    f_out_t, x_out_t = layer(f, x_transformed, edge_index)
    
    # å¯¹åŸå§‹è¾“å‡ºåº”ç”¨ç›¸åŒå˜æ¢
    x_out_expected = (R @ x_out.T).T + b
    
    # æ£€æŸ¥ç­‰å˜æ€§
    coord_error = (x_out_t - x_out_expected).abs().max().item()
    feat_error = (f_out_t - f_out).abs().max().item()
    
    print("=" * 50)
    print("E(3) ç­‰å˜æ€§éªŒè¯")
    print("=" * 50)
    print(f"åæ ‡ç­‰å˜æ€§è¯¯å·®: {coord_error:.2e}")
    print(f"ç‰¹å¾ä¸å˜æ€§è¯¯å·®: {feat_error:.2e}")
    print(f"åæ ‡ç­‰å˜æ€§: {'âœ…' if coord_error < 1e-4 else 'âŒ'}")
    print(f"ç‰¹å¾ä¸å˜æ€§: {'âœ…' if feat_error < 1e-4 else 'âŒ'}")


if __name__ == "__main__":
    verify_e3_equivariance()</code></pre>
    </div>


    <!-- ====================== 5.6 Intrinsic Mesh CNNs ====================== -->
    <h2 id="sec5-6">5.6 å†…è•´ç½‘æ ¼ CNN<br><span style="font-size:0.65em;color:var(--text-secondary)">Intrinsic Mesh CNNs</span></h2>

    <div class="bilingual">
      <div class="zh">
        <p>ç½‘æ ¼ï¼ˆå°¤å…¶æ˜¯ä¸‰è§’ç½‘æ ¼ï¼‰æ˜¯è®¡ç®—æœºå›¾å½¢å­¦çš„"å®¶å¸¸ä¾¿é¥­"ï¼Œä¹Ÿæ˜¯ 3D ç‰©ä½“å»ºæ¨¡æœ€å¸¸è§çš„æ–¹å¼ã€‚åœ¨ 2015 å¹´å·¦å³ï¼Œå›¾å½¢å­¦å’Œå‡ ä½•å¤„ç†ç¤¾åŒºå¼€å§‹ç§¯ææ¢ç´¢åœ¨ç½‘æ ¼æ•°æ®ä¸Šæ„å»ºç±»ä¼¼ CNN çš„æ¶æ„ã€‚</p>
      </div>
      <div class="en">
        Meshes, particularly triangular ones, are the 'bread and butter' of computer graphics. The community has been keen to construct CNN-like architectures for mesh data since the mid-2010s.
      </div>
    </div>

<!-- === ENRICHMENT: sec5-6 === -->
<div class="enrichment-block">
  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šå†…è•´ç½‘æ ¼ CNN â€” ä»€ä¹ˆæ˜¯"å†…è•´"ï¼Ÿ</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼š"å†…è•´"ï¼ˆintrinsicï¼‰æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿå’Œæ™®é€šçš„ 3D CNN æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>å†…è•´ vs å¤–å»¶</strong>æ˜¯å¾®åˆ†å‡ ä½•çš„æ ¸å¿ƒæ¦‚å¿µã€‚</p>
        
        <p><strong>ç”Ÿæ´»ç±»æ¯”</strong>ï¼š</p>
        <ul>
          <li><strong>å¤–å»¶</strong>ï¼ˆextrinsicï¼‰ï¼šä»å¤–éƒ¨ç©ºé—´çœ‹ç‰©ä½“ï¼ˆå¦‚åœ¨ $\mathbb{R}^3$ ä¸­åµŒå…¥çš„æ›²é¢ï¼‰</li>
          <li>ä¾‹å­ï¼šåœ°çƒè¡¨é¢åœ¨ 3D ç©ºé—´ä¸­çš„å½¢çŠ¶ï¼ˆæ¤­çƒï¼‰</li>
          <li><strong>å†…è•´</strong>ï¼ˆintrinsicï¼‰ï¼šåªä»<strong>æ›²é¢è‡ªèº«</strong>çš„è§†è§’çœ‹ï¼ˆä¸è€ƒè™‘å¤–éƒ¨ç©ºé—´ï¼‰</li>
          <li>ä¾‹å­ï¼šåœ°çƒè¡¨é¢ä¸Šçš„<strong>æœ€çŸ­è·¯å¾„</strong>ï¼ˆå¤§åœ†å¼§ï¼‰â€” ä¸éœ€è¦"é£å‡ºåœ°çƒ"æ‰èƒ½å®šä¹‰</li>
        </ul>
        
        <p><strong>å…³é”®åŒºåˆ«</strong>ï¼š</p>
        <table>
          <thead><tr><th>æ€§è´¨</th><th>å¤–å»¶æ–¹æ³•</th><th>å†…è•´æ–¹æ³•</th></tr></thead>
          <tbody>
            <tr><td>åæ ‡</td><td>åµŒå…¥ç©ºé—´çš„ $(x, y, z)$</td><td>æ›²é¢è‡ªå·±çš„å‚æ•° $(u, v)$</td></tr>
            <tr><td>è·ç¦»</td><td>æ¬§å‡ é‡Œå¾—è·ç¦» $\sqrt{\Delta x^2 + \Delta y^2 + \Delta z^2}$</td><td>æµ‹åœ°çº¿è·ç¦»ï¼ˆæ›²é¢ä¸Šçš„æœ€çŸ­è·¯å¾„ï¼‰</td></tr>
            <tr><td>å·ç§¯</td><td>3D ç½‘æ ¼å·ç§¯ï¼ˆå¦‚ voxelï¼‰</td><td>æ›²é¢ä¸Šçš„å·ç§¯ï¼ˆæ²¿æµ‹åœ°çº¿ï¼‰</td></tr>
            <tr><td>ç­‰å˜æ€§</td><td>$E(3)$ï¼ˆåˆšä½“æ—‹è½¬/å¹³ç§»ï¼‰</td><td>ç­‰è·ç¾¤ï¼ˆä¿æŒæµ‹åœ°è·ç¦»ï¼‰</td></tr>
          </tbody>
        </table>
        
        <p><strong>ä¸ºä»€ä¹ˆéœ€è¦å†…è•´æ–¹æ³•ï¼Ÿ</strong></p>
        <ul>
          <li>åŒ»å­¦å½±åƒä¸­çš„<strong>å™¨å®˜è¡¨é¢</strong>ï¼ˆå¿ƒè„ã€å¤§è„‘ï¼‰æ˜¯æ›²é¢ï¼Œä¸æ˜¯è§„åˆ™ç½‘æ ¼</li>
          <li>å†…è•´è·ç¦»<strong>æ›´åˆç†</strong>ï¼šå™¨å®˜ä¸Šä¸¤ç‚¹çš„"çœŸå®è·ç¦»"åº”è¯¥æ²¿ç€è¡¨é¢æµ‹é‡ï¼Œè€Œé"ç©¿è¿‡"å™¨å®˜å†…éƒ¨</li>
          <li>ç­‰è·ä¸å˜æ€§ï¼šå³ä½¿å™¨å®˜<strong>å˜å½¢</strong>ï¼ˆå¦‚å‘¼å¸å¯¼è‡´çš„è‚ºéƒ¨æ‰©å¼ ï¼‰ï¼Œå†…è•´è·ç¦»ä¿æŒä¸å˜</li>
        </ul>
        
        <p><strong>ä¾‹å­ï¼šè„‘çš®å±‚åˆ†æ</strong></p>
        <ul>
          <li>å¤§è„‘çš®å±‚é«˜åº¦è¤¶çš±ï¼ˆæ²Ÿå›ç»“æ„ï¼‰</li>
          <li>å¤–å»¶è·ç¦»ï¼šä¸¤ä¸ªè„‘åŒºå¯èƒ½åœ¨ 3D ç©ºé—´ä¸­å¾ˆè¿‘ï¼ˆéš”ç€æ²Ÿï¼‰ï¼Œä½†<strong>ä¸ç›´æ¥ç›¸è¿</strong></li>
          <li>å†…è•´è·ç¦»ï¼šæ²¿ç€çš®å±‚è¡¨é¢æµ‹é‡ â†’ åæ˜ çœŸå®çš„åŠŸèƒ½è¿æ¥</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šæµ‹åœ°çº¿å·ç§¯ï¼ˆGeodesic CNNï¼‰</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šæµ‹åœ°çº¿å·ç§¯æ˜¯æ€ä¹ˆåšçš„ï¼Ÿæ›²é¢ä¸Šæ²¡æœ‰"è§„åˆ™ç½‘æ ¼"ï¼Œæ€ä¹ˆå®šä¹‰å·ç§¯æ ¸ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼š<strong>æµ‹åœ°çº¿ CNN</strong> (Masci et al., 2015) å°†æ¬§å‡ é‡Œå¾—å·ç§¯æ¨å¹¿åˆ°æµå½¢ã€‚</p>
        
        <p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šç”¨<strong>æµ‹åœ°çº¿åæ ‡ç³»</strong>ä»£æ›¿ç¬›å¡å°”åæ ‡ã€‚</p>
        
        <p><strong>Step 1ï¼šæµ‹åœ°çº¿æåæ ‡</strong></p>
        <ul>
          <li>åœ¨ä¸­å¿ƒç‚¹ $p$ å»ºç«‹å±€éƒ¨åæ ‡ç³»</li>
          <li>å¯¹é‚»åŸŸå†…çš„ç‚¹ $q$ï¼š
            <ul>
              <li>$r$ï¼šä» $p$ åˆ° $q$ çš„<strong>æµ‹åœ°çº¿è·ç¦»</strong>ï¼ˆæ²¿æ›²é¢çš„æœ€çŸ­è·¯å¾„é•¿åº¦ï¼‰</li>
              <li>$\theta$ï¼š<strong>è§’åº¦</strong>ï¼ˆéœ€è¦å®šä¹‰"å‚è€ƒæ–¹å‘"ï¼‰</li>
            </ul>
          </li>
          <li>ç±»ä¼¼ 2D å›¾åƒçš„æåæ ‡ $(r, \theta)$</li>
        </ul>
        
        <p><strong>Step 2ï¼šå®šä¹‰å·ç§¯æ ¸</strong></p>
        <ul>
          <li>å·ç§¯æ ¸ $\theta(r, \theta)$ æ˜¯æµ‹åœ°çº¿æåæ ‡ä¸Šçš„å‡½æ•°</li>
          <li>é€šå¸¸ç”¨<strong>å¾„å‘åŸºå‡½æ•°</strong>ï¼ˆRBFï¼‰å‚æ•°åŒ–ï¼š
            $$\theta(r, \theta) = \sum_{k=1}^K w_k \exp\left(-\frac{(r - r_k)^2}{2\sigma^2}\right) \cdot g_k(\theta)$$</li>
          <li>$g_k(\theta)$ å¯ä»¥æ˜¯ Fourier åŸºï¼š$\{\cos(n\theta), \sin(n\theta)\}$</li>
        </ul>
        
        <p><strong>Step 3ï¼šå·ç§¯æ“ä½œ</strong></p>
        $$f_p' = \sum_{q \in \mathcal{N}(p)} \theta(r_{pq}, \theta_{pq}) \cdot f_q \cdot w_{pq}$$
        <ul>
          <li>$\mathcal{N}(p)$ï¼šç‚¹ $p$ çš„æµ‹åœ°çº¿é‚»åŸŸï¼ˆæ‰€æœ‰æµ‹åœ°è·ç¦» < $r_{\max}$ çš„ç‚¹ï¼‰</li>
          <li>$w_{pq}$ï¼šæƒé‡ï¼ˆå¦‚é¢ç§¯ä¿®æ­£å› å­ï¼‰</li>
        </ul>
        
        <p><strong>æŒ‘æˆ˜</strong>ï¼š</p>
        <ol>
          <li><strong>å‚è€ƒæ–¹å‘</strong>ï¼šå¦‚ä½•åœ¨æ›²é¢ä¸Šå®šä¹‰"è§’åº¦ $\theta$"ï¼Ÿ
            <ul>
              <li>è§£å†³ï¼šç”¨<strong>ä¸»æ›²ç‡æ–¹å‘</strong>æˆ–<strong>å¹¶è¡Œä¼ è¾“</strong>ï¼ˆparallel transportï¼‰</li>
            </ul>
          </li>
          <li><strong>æµ‹åœ°è·ç¦»è®¡ç®—</strong>ï¼šéœ€è¦<strong>Dijkstra ç®—æ³•</strong>æˆ–<strong>Fast Marching Method</strong></li>
          <li><strong>è®¡ç®—å¤æ‚åº¦</strong>ï¼šæ¯”æ¬§å‡ é‡Œå¾—å·ç§¯æ…¢å¾ˆå¤š</li>
        </ol>
      </div>
    </div>
  </div>

  <div class="enrichment-qa">
    <h4>ğŸ” æ·±å…¥ç†è§£ï¼šMoNet ä¸ Gauge ç­‰å˜ CNN</h4>
    <div class="qa-pair">
      <p class="question">â“ å°ç™½ï¼šMoNet å’Œ Gauge CNN è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>
      <div class="answer">
        <p>ğŸ’¡ ä¸“å®¶ï¼šå®ƒä»¬éƒ½è§£å†³<strong>å±€éƒ¨åæ ‡ç³»é€‰æ‹©</strong>çš„é—®é¢˜ã€‚</p>
        
        <p><strong>MoNetï¼ˆMonti et al., 2017ï¼‰</strong>ï¼š</p>
        <ul>
          <li>æ ¸å¿ƒæ€æƒ³ï¼šç”¨<strong>å¯å­¦ä¹ çš„æƒé‡å‡½æ•°</strong>ä»£æ›¿å›ºå®šçš„æµ‹åœ°çº¿åæ ‡</li>
          <li>å…¬å¼ï¼š
            $$f_i' = \sum_{j \in \mathcal{N}(i)} w(\mathbf{u}(i, j)) \cdot f_j$$
            å…¶ä¸­ $\mathbf{u}(i, j) \in \mathbb{R}^d$ æ˜¯<strong>ä¼ªåæ ‡</strong>ï¼ˆpseudo-coordinatesï¼‰</li>
          <li>$\mathbf{u}$ å¯ä»¥æ˜¯ï¼š
            <ul>
              <li>æµ‹åœ°è·ç¦» + è§’åº¦ï¼š$(r, \theta)$</li>
              <li>è¾¹ç‰¹å¾ï¼šç›¸å¯¹ä½ç½®ã€æ³•å‘é‡å¤¹è§’ç­‰</li>
            </ul>
          </li>
          <li>æƒé‡å‡½æ•° $w$ ç”¨<strong>é«˜æ–¯æ··åˆæ¨¡å‹</strong>ï¼ˆGMMï¼‰å‚æ•°åŒ–</li>
          <li>å¥½å¤„ï¼šç»Ÿä¸€æ¡†æ¶æ¶µç›–å›¾/ç½‘æ ¼/ç‚¹äº‘</li>
        </ul>
        
        <p><strong>Gauge Equivariant CNNï¼ˆCohen et al., 2019ï¼‰</strong>ï¼š</p>
        <ul>
          <li>é—®é¢˜ï¼šæ›²é¢ä¸Šçš„å·ç§¯ä¾èµ–<strong>å±€éƒ¨åæ ‡ç³»çš„é€‰æ‹©</strong>ï¼ˆgaugeï¼‰ï¼Œä½†è¿™ä¸ªé€‰æ‹©æ˜¯ä»»æ„çš„</li>
          <li>ä¾‹å­ï¼šåœ¨çƒé¢ä¸Šï¼Œ"åŒ—"çš„æ–¹å‘åœ¨ä¸åŒç‚¹æŒ‡å‘ä¸åŒ</li>
          <li>è§£å†³ï¼šè®¾è®¡<strong>è§„èŒƒç­‰å˜</strong>ï¼ˆgauge equivariantï¼‰å·ç§¯ï¼Œå¯¹åæ ‡ç³»é€‰æ‹©ä¸æ•æ„Ÿ</li>
          <li>æ•°å­¦ï¼šç”¨<strong>å¹¶è¡Œä¼ è¾“</strong>ï¼ˆparallel transportï¼‰åŒæ­¥ä¸åŒç‚¹çš„åæ ‡ç³»</li>
        </ul>
        
        <p><strong>ä¸ GNN çš„å…³ç³»</strong>ï¼š</p>
        <ul>
          <li>å†…è•´ç½‘æ ¼ CNN å¯ä»¥çœ‹ä½œ<strong>å‡ ä½•å›¾ä¸Šçš„ GNN</strong></li>
          <li>èŠ‚ç‚¹ = ç½‘æ ¼é¡¶ç‚¹</li>
          <li>è¾¹ = ç½‘æ ¼è¾¹ï¼Œæƒé‡ç”±æµ‹åœ°è·ç¦»/æ³•å‘é‡ç­‰å†³å®š</li>
          <li>MoNet å…¬å¼ $\approx$ GATï¼ˆå¯å­¦ä¹ çš„è¾¹æƒé‡ï¼‰</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="enrichment-intuition">
    <h4>ğŸ¯ ç›´è§‰ç†è§£ï¼šä¸ºä»€ä¹ˆéœ€è¦å†…è•´æ–¹æ³•ï¼Ÿ</h4>
    <p><strong>ç±»æ¯”ï¼šåœ°å›¾æŠ•å½±</strong></p>
    <ul>
      <li>å¤–å»¶æ–¹æ³• = æŠŠåœ°çƒ"å‹å¹³"æˆ 2D åœ°å›¾ï¼ˆå¢¨å¡æ‰˜æŠ•å½±ï¼‰</li>
      <li>é—®é¢˜ï¼š<strong>å¤±çœŸ</strong>ï¼æ ¼é™µå…°å²›çœ‹èµ·æ¥æ¯”éæ´²å¤§ï¼ˆå®é™…åªæœ‰ 1/14ï¼‰</li>
      <li>å†…è•´æ–¹æ³• = ç›´æ¥åœ¨çƒé¢ä¸Šå·¥ä½œï¼Œç”¨<strong>ç»çº¬åº¦</strong>å’Œ<strong>å¤§åœ†å¼§è·ç¦»</strong></li>
      <li>å¥½å¤„ï¼š<strong>ä¿æŒçœŸå®è·ç¦»</strong>ï¼Œä¸å¤±çœŸ</li>
    </ul>
    
    <p><strong>åŒ»å­¦å½±åƒä¸­çš„åº”ç”¨</strong>ï¼š</p>
    <ul>
      <li>å¿ƒè„è¡¨é¢ï¼šæ”¶ç¼©/èˆ’å¼ æ—¶å½¢çŠ¶å˜åŒ–ï¼Œä½†<strong>è¡¨é¢ç§¯å‡ ä¹ä¸å˜</strong></li>
      <li>å†…è•´æ–¹æ³•å¯¹è¿™ç§<strong>ç­‰è·å˜å½¢</strong>é²æ£’</li>
      <li>å¤–å»¶æ–¹æ³•ï¼šå¿ƒè„ç§»åŠ¨/æ—‹è½¬ä¼šå¯¼è‡´ç‰¹å¾å®Œå…¨ä¸åŒ</li>
    </ul>
  </div>

  <div class="enrichment-application">
    <h4>ğŸ¥ åŒ»ç–—æœºå™¨äººåº”ç”¨ï¼šç½‘æ ¼ CNN çš„å®é™…åœºæ™¯</h4>
    <p><strong>åœºæ™¯ 1ï¼šå¿ƒè„è¡¨é¢åˆ†å‰²</strong></p>
    <ul>
      <li>è¾“å…¥ï¼šå¿ƒè„ MRI é‡å»ºçš„ 3D ç½‘æ ¼</li>
      <li>ä»»åŠ¡ï¼šåˆ†å‰²å·¦å¿ƒå®¤ã€å³å¿ƒå®¤ã€ç“£è†œç­‰åŒºåŸŸ</li>
      <li>æ–¹æ³•ï¼šæµ‹åœ°çº¿ CNN åœ¨ç½‘æ ¼ä¸Šåšè¯­ä¹‰åˆ†å‰²</li>
      <li>ä¼˜åŠ¿ï¼šå¯¹å¿ƒè„å§¿æ€å˜åŒ–é²æ£’</li>
    </ul>
    
    <p><strong>åœºæ™¯ 2ï¼šå™¨å®˜å½¢çŠ¶åˆ†æ</strong></p>
    <ul>
      <li>ä»»åŠ¡ï¼šæ£€æµ‹å™¨å®˜å½¢æ€å¼‚å¸¸ï¼ˆå¦‚è„‘èç¼©ã€è‚¿ç˜¤å¯¼è‡´çš„å˜å½¢ï¼‰</li>
      <li>æ–¹æ³•ï¼šå†…è•´ CNN æå–å½¢çŠ¶ç‰¹å¾ â†’ åˆ†ç±»å¥åº·/ç—…å˜</li>
      <li>æ•°æ®é›†ï¼šAlzheimer's æ‚£è€…çš„è„‘éƒ¨ç½‘æ ¼æ•°æ®</li>
    </ul>
    
    <p><strong>PhysRobot å…³è”</strong>ï¼š</p>
    <ul>
      <li>å½“å‰ï¼šç²’å­ç³»ç»Ÿï¼ˆç‚¹äº‘ï¼‰</li>
      <li>æ‰©å±•ï¼šå¦‚æœè¦ä»¿çœŸ<strong>è–„è†œ</strong>ï¼ˆå¦‚è…¹è†œã€è¡€ç®¡å£ï¼‰ï¼Œéœ€è¦ç½‘æ ¼è¡¨ç¤º</li>
      <li>æ–¹æ³•ï¼šMoNet æˆ– Gauge CNN å»ºæ¨¡ç½‘æ ¼ä¸Šçš„åº”åŠ›ä¼ æ’­</li>
    </ul>
  </div>
</div>
<!-- === END ENRICHMENT: sec5-6 === -->


    <h3 id="geodesic-cnn">æµ‹åœ°çº¿ CNN (Geodesic CNN)</h3>

    <p>å¤§å¤šæ•°ç½‘æ ¼æ·±åº¦å­¦ä¹ æ¶æ„é€šè¿‡<strong>ç¦»æ•£åŒ–æˆ–è¿‘ä¼¼æŒ‡æ•°æ˜ å°„</strong>æ¥å®ç°å·ç§¯æ»¤æ³¢å™¨ï¼Œå¹¶åœ¨åˆ‡å¹³é¢çš„åæ ‡ç³»ä¸­è¡¨è¾¾æ»¤æ³¢å™¨ã€‚</p>

    <div class="math-block">
      $$(\mathbf{x} \star \theta)(u) = \int_0^R \int_0^{2\pi} x(u, r, \vartheta) \theta(r, \vartheta) \, dr \, d\vartheta$$
      <div class="math-explain">
        åœ¨æµå½¢ä¸Šå®šä¹‰å·ç§¯ï¼šä½¿ç”¨<strong>æµ‹åœ°çº¿æåæ ‡</strong> $(r, \vartheta)$ï¼Œ$r$ æ˜¯æµ‹åœ°çº¿è·ç¦»ï¼Œ$\vartheta$ æ˜¯åˆ‡å¹³é¢ä¸­çš„è§’åº¦æ–¹å‘ã€‚$x(u, r, \vartheta)$ æ˜¯ä»¥ $u$ ä¸ºä¸­å¿ƒçš„æµ‹åœ°çº¿å—ï¼ˆgeodesic patchï¼‰ã€‚
      </div>
    </div>

    <p><strong>å…³é”®æŒ‘æˆ˜</strong>ï¼šè§’åº¦æ–¹å‘ $\vartheta$ çš„å‚è€ƒé€‰æ‹©æœ‰<strong>æ­§ä¹‰æ€§</strong>â€”â€”è¿™æ­£æ˜¯<strong>è§„èŒƒé€‰æ‹©</strong>ï¼ˆgauge choiceï¼‰çš„é—®é¢˜ã€‚</p>

    <h4>å¤„ç†è§„èŒƒæ­§ä¹‰çš„ä¸‰ç§ç­–ç•¥</h4>

    <div class="comparison-table">
      <table>
        <thead><tr><th>ç­–ç•¥</th><th>æ–¹æ³•</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead>
        <tbody>
          <tr><td><strong>å„å‘åŒæ€§æ»¤æ³¢å™¨</strong></td><td>$\theta(r)$ ä¸ä¾èµ–æ–¹å‘</td><td>æ— éœ€é€‰æ‹©è§„èŒƒ</td><td>ä¸¢å¤±æ–¹å‘ä¿¡æ¯</td></tr>
          <tr><td><strong>å›ºå®šè§„èŒƒ</strong></td><td>ä½¿ç”¨ä¸»æ›²ç‡æ–¹å‘</td><td>ä¿ç•™æ–¹å‘ä¿¡æ¯</td><td>åœ¨å¹³å¦åŒºåŸŸä¸ç¨³å®š</td></tr>
          <tr><td><strong>è§’åº¦æ± åŒ–</strong></td><td>$\max_{\vartheta_0}$ åŒ¹é…</td><td>æ—‹è½¬ä¸å˜</td><td>è®¡ç®—å¼€é”€å¤§</td></tr>
          <tr><td><strong>è§„èŒƒç­‰å˜æ»¤æ³¢å™¨</strong></td><td>ä½¿ç”¨éå¹³å‡¡è¡¨ç¤º $\rho$</td><td>ç†è®ºæœ€ä¼˜</td><td>å®ç°å¤æ‚</td></tr>
        </tbody>
      </table>
    </div>

    <h3 id="monet">MoNet: æ··åˆæ¨¡å‹ç½‘ç»œ</h3>

    <p>Monti et al. (2017) çš„ MoNet ä½¿ç”¨<strong>å¯å­¦ä¹ çš„åŠ æƒå‡½æ•°</strong>ï¼ˆpatch operatorsï¼‰æ›¿ä»£å›ºå®šæ¨¡æ¿ï¼š</p>

    <div class="math-block">
      $$(\mathbf{x} \star \theta)_u = \frac{\sum_{k=1}^{K} w_k \sum_{v \in \mathcal{N}_u} (r_{uv}, \vartheta_{uv}) x_v \cdot \theta_k}{\sum_{k=1}^{K} w_k \sum_{v \in \mathcal{N}_u} (r_{uv}, \vartheta_{uv}) \cdot \theta_k}$$
      <div class="math-explain">
        $w_1, \ldots, w_K$ æ˜¯å¯å­¦ä¹ çš„é«˜æ–¯åŠ æƒå‡½æ•°ï¼ˆ"è½¯åƒç´ "ï¼‰ï¼Œ$\theta_1, \ldots, \theta_K$ æ˜¯æ»¤æ³¢å™¨ç³»æ•°ã€‚MoNet æ¯” Geodesic CNN æ›´çµæ´»ï¼Œå› ä¸ºåŠ æƒå‡½æ•°ä¹Ÿæ˜¯å¯å­¦ä¹ çš„ã€‚
      </div>
    </div>

    <div class="figure">
      <img src="../assets/ch5_p92_img0.png" alt="Patch operators: Geodesic CNN, Anisotropic CNN, MoNet">
      <figcaption>å›¾ 18ï¼šä¸‰ç§ç½‘æ ¼ CNN ä¸­ä½¿ç”¨çš„ patch operatorsã€‚ä»å·¦åˆ°å³ï¼šGeodesic CNNã€Anisotropic CNNã€MoNetã€‚çº¢è‰²ç­‰é«˜çº¿æ˜¾ç¤ºåŠ æƒå‡½æ•° $w_k(r, \vartheta)$ çš„å½¢çŠ¶ã€‚</figcaption>
    </div>

    <h3 id="gauge-cnn">è§„èŒƒç­‰å˜ CNN (Gauge-equivariant CNN)</h3>

    <p>Cohen et al. (2019) å’Œ de Haan et al. (2020) æå‡ºäº†æœ€"æ­£ç¡®"çš„æ–¹æ¡ˆï¼šè®©ç½‘ç»œç‰¹å¾ä¸<strong>éå¹³å‡¡è¡¨ç¤º</strong> $\rho$ å…³è”ï¼Œå¹¶é€šè¿‡<strong>å¹³è¡Œç§»åŠ¨</strong>ï¼ˆparallel transportï¼‰åœ¨èŠ‚ç‚¹é—´ä¼ é€’ã€‚</p>

    <div class="math-block">
      $$h_u = \Theta_{\text{self}} x_u + \sum_{v \in \mathcal{N}_u} \Theta_{\text{neigh}}(\vartheta_{uv}) \rho(g_{v \to u}) x_v \tag{37}$$
      <div class="math-explain">
        $\Theta_{\text{self}}, \Theta_{\text{neigh}}$ æ˜¯å¯å­¦ä¹ çš„æ»¤æ³¢å™¨çŸ©é˜µã€‚$g_{v \to u} \in SO(2)$ ç¼–ç ä» $v$ åˆ° $u$ çš„<strong>å¹³è¡Œç§»åŠ¨</strong>æ•ˆæœï¼ˆè§„èŒƒå˜æ¢ï¼‰ã€‚$\rho(g_{v \to u})$ æ˜¯å¯¹åº”çš„<strong>ä¼ è¾“çŸ©é˜µ</strong>ã€‚è¿™ç¡®ä¿äº†è¾“å‡ºæ˜¯è§„èŒƒç­‰å˜çš„ã€‚
      </div>
    </div>

    <div class="code-container">
      <span class="code-label">Python / PyTorch â€” ç®€åŒ–çš„ç½‘æ ¼å·ç§¯</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code>import torch
import torch.nn as nn

# ============================================================
# ç®€åŒ–çš„ç½‘æ ¼å·ç§¯ï¼ˆMoNet é£æ ¼ï¼‰
# ============================================================
class SimpleMeshConv(nn.Module):
    """
    ç®€åŒ–çš„ MoNet é£æ ¼ç½‘æ ¼å·ç§¯ã€‚
    ä½¿ç”¨å¯å­¦ä¹ çš„é«˜æ–¯æ ¸ä½œä¸º patch operatorã€‚
    
    å¯¹åº” GDL Â§5.6 çš„æ–¹ç¨‹ã€‚
    """
    def __init__(self, in_channels, out_channels, n_kernels=8):
        super().__init__()
        self.n_kernels = n_kernels
        
        # å¯å­¦ä¹ çš„é«˜æ–¯å‚æ•° (å‡å€¼å’Œæ–¹å·®)
        self.mu = nn.Parameter(torch.randn(n_kernels, 2))  # (K, 2) for (r, Î¸)
        self.sigma = nn.Parameter(torch.ones(n_kernels, 2))
        
        # æ»¤æ³¢å™¨æƒé‡
        self.weight = nn.Linear(in_channels * n_kernels, out_channels)
    
    def gaussian_kernel(self, coords):
        """
        è®¡ç®—é«˜æ–¯æ ¸å€¼ã€‚
        coords: (E, 2) â€” é‚»å±…çš„ (r, Î¸) åæ ‡
        è¿”å›: (E, K) â€” æ¯ä¸ªæ ¸å¯¹æ¯æ¡è¾¹çš„æƒé‡
        """
        # coords: (E, 2), mu: (K, 2)
        diff = coords.unsqueeze(1) - self.mu.unsqueeze(0)  # (E, K, 2)
        weights = torch.exp(-0.5 * (diff ** 2 / (self.sigma.unsqueeze(0) ** 2 + 1e-6)).sum(dim=-1))
        return weights  # (E, K)
    
    def forward(self, x, edge_index, pseudo_coords):
        """
        x: (N, C_in) èŠ‚ç‚¹ç‰¹å¾
        edge_index: (2, E) è¾¹ç´¢å¼•
        pseudo_coords: (E, 2) è¾¹çš„ä¼ªåæ ‡ (r, Î¸)
        """
        src, dst = edge_index
        
        # è®¡ç®—æ ¸æƒé‡
        kernel_weights = self.gaussian_kernel(pseudo_coords)  # (E, K)
        
        # åŠ æƒé‚»å±…ç‰¹å¾
        neighbor_feats = x[src]  # (E, C_in)
        # (E, K, 1) * (E, 1, C_in) â†’ (E, K, C_in) â†’ (E, K*C_in)
        weighted = (kernel_weights.unsqueeze(-1) * neighbor_feats.unsqueeze(1))
        weighted = weighted.reshape(-1, self.n_kernels * x.size(1))
        
        # èšåˆåˆ°ç›®æ ‡èŠ‚ç‚¹
        out = torch.zeros(x.size(0), weighted.size(1), device=x.device)
        out.scatter_add_(0, dst.unsqueeze(1).expand_as(weighted), weighted)
        
        return self.weight(out)


if __name__ == "__main__":
    N, E, C_in, C_out = 100, 400, 16, 32
    layer = SimpleMeshConv(C_in, C_out, n_kernels=8)
    x = torch.randn(N, C_in)
    edge_index = torch.randint(0, N, (2, E))
    pseudo = torch.randn(E, 2)  # (r, Î¸) åæ ‡
    
    out = layer(x, edge_index, pseudo)
    print(f"Mesh Conv: ({N}, {C_in}) â†’ ({out.shape[0]}, {out.shape[1]})")
    print(f"å‚æ•°é‡: {sum(p.numel() for p in layer.parameters()):,}")</code></pre>
    </div>


    <!-- ====================== 5.7 RNN ====================== -->
    <h2 id="sec5-7">5.7 å¾ªç¯ç¥ç»ç½‘ç»œ (RNN)<br><span style="font-size:0.65em;color:var(--text-secondary)">Recurrent Neural Networks</span></h2>

    <div class="bilingual">
      <div class="zh">
        <p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„è®¨è®ºéƒ½å‡è®¾è¾“å…¥æ˜¯çº¯ç©ºé—´çš„ã€‚ä½†åœ¨è®¸å¤šåœºæ™¯ä¸­ï¼Œè¾“å…¥ä¹Ÿå¯ä»¥æ˜¯<strong>åºåˆ—</strong>ï¼ˆè§†é¢‘ã€æ–‡æœ¬ã€è¯­éŸ³ï¼‰ã€‚RNN æ˜¯å¤„ç†æ—¶åºæ•°æ®çš„ç»å…¸æ¶æ„ï¼Œè€Œä¸”ä»å‡ ä½•æ·±åº¦å­¦ä¹ çš„è§’åº¦ï¼Œå®ƒä»¬å®ç°äº†ä¸€ç§ä¸å¯»å¸¸çš„å¯¹ç§°æ€§â€”â€”<span class="term">æ—¶é—´å¹³ç§»ç­‰å˜æ€§</span>ã€‚</p>
      </div>
      <div class="en">
        RNNs are classic architectures for sequential data. From the GDL perspective, they implement an unusual type of symmetry over temporal grids: translation equivariance in time.
      </div>
    </div>

<!-- === ENRICHMENT: sec5-7 === -->
<!-- ç¬¬5ç«  5.7-5.8èŠ‚ï¼šRNN & LSTM æ·±åŒ–è¡¥å……å†…å®¹ -->

<div class="enrichment-block" style="border-left-color: #3b82f6;">
  <h4>ğŸ¤” RNN çš„æ—¶é—´ç­‰å˜æ€§æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</h4>
  
  <div class="qa-pair" style="margin: 1.5rem 0;">
    <p><strong>ä¸€å¥è¯å›ç­”</strong>ï¼šRNN çš„æ—¶é—´ç­‰å˜æ€§æ„å‘³ç€å¦‚æœä½ æŠŠè¾“å…¥åºåˆ—æ•´ä½“"å·¦ç§»"ï¼ˆæ¯”å¦‚ä¸¢æ‰ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œè¾“å‡ºåºåˆ—ä¹Ÿä¼šç›¸åº”åœ°å·¦ç§»ï¼Œå°±åƒæ—¶é—´è½´æ•´ä½“å¹³ç§»ä¸€æ ·ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>è€ƒè™‘ä¸€ä¸ªè§†é¢‘åºåˆ— \( z^{(1)}, z^{(2)}, z^{(3)}, \ldots \)ï¼ŒRNN ä¼šä¸ºæ¯ä¸ªæ—¶åˆ»ç”Ÿæˆä¸€ä¸ªéšè—çŠ¶æ€ï¼ˆæ€»ç»“å‘é‡ï¼‰ \( h^{(1)}, h^{(2)}, h^{(3)}, \ldots \)ã€‚</p>
    
    <p><strong>ç­‰å˜æ€§çš„ç›´è§‚ç†è§£</strong>ï¼šå¦‚æœæˆ‘ä»¬æŠŠè¾“å…¥åºåˆ—æ•´ä½“"å¹³ç§»"ä¸€ä¸ªæ—¶é—´æ­¥ï¼ˆæ¯”å¦‚ä¸¢æ‰ç¬¬ä¸€ä¸ªè¾“å…¥ï¼Œå˜æˆ \( z^{(2)}, z^{(3)}, z^{(4)}, \ldots \)ï¼‰ï¼ŒRNN çš„è¾“å‡ºä¹Ÿåº”è¯¥ç›¸åº”åœ°å¹³ç§»ï¼ˆå˜æˆ \( h^{(2)}, h^{(3)}, h^{(4)}, \ldots \)ï¼‰ã€‚</p>
    
    <div style="background: rgba(59,130,246,0.06); padding: 1.2rem; border-radius: 8px; margin: 1rem 0;">
      <p><strong>ğŸ”‘ æ•°å­¦è¡¨è¾¾</strong>ï¼š</p>
      <p>å¯¹äºå¹³ç§»åçš„åºåˆ— \( z'^{(t)} = z^{(t+1)} \)ï¼Œæˆ‘ä»¬å¸Œæœ›ï¼š</p>
      <p style="text-align: center;">$$ h'^{(t)} = h^{(t+1)} $$</p>
    </div>
    
    <p><strong>ğŸš« ä¸ºä»€ä¹ˆä¸æ˜¯é‚£ä¹ˆç®€å•</strong>ï¼š</p>
    <p>å®é™…ä¸Šï¼Œæ ‡å‡† RNN ä¸æ»¡è¶³å®Œç¾çš„æ—¶é—´ç­‰å˜æ€§ï¼è€ƒè™‘ \( t=1 \) æ—¶åˆ»ï¼š</p>
    <ul>
      <li>\( h'^{(1)} = R(z^{(2)}, h^{(0)}) \)</li>
      <li>\( h^{(2)} = R(z^{(2)}, h^{(1)}) = R(z^{(2)}, R(z^{(1)}, h^{(0)})) \)</li>
    </ul>
    <p>ä¸¤è€…ä¸ç›¸ç­‰ï¼Œå› ä¸º \( h^{(1)} \) åŒ…å«äº† \( z^{(1)} \) çš„ä¿¡æ¯ï¼Œè€Œ \( h^{(0)} \) æ²¡æœ‰ã€‚</p>
    
    <p><strong>âœ… è§£å†³æ–¹æ¡ˆï¼šå·¦å¡«å……ï¼ˆLeft Paddingï¼‰</strong>ï¼š</p>
    <p>å¦‚æœæˆ‘ä»¬åœ¨åºåˆ—å‰é¢å¡«å……è¶³å¤Ÿå¤šçš„é›¶å‘é‡ï¼Œå¹¶é€‰æ‹©åˆé€‚çš„åˆå§‹çŠ¶æ€ \( h^{(0)} \)ï¼ˆä½¿å…¶æˆä¸º \( R(0, h) = h \) çš„ä¸åŠ¨ç‚¹ï¼‰ï¼Œé‚£ä¹ˆ RNN å°±èƒ½è·å¾—æ—¶é—´ç­‰å˜æ€§ã€‚</p>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šæƒ³è±¡ä½ åœ¨çœ‹ä¸€éƒ¨è¿ç»­å‰§ï¼Œæ¯é›†éƒ½æœ‰"å‰æƒ…æè¦"ã€‚å¦‚æœä½ ä»ç¬¬2é›†å¼€å§‹çœ‹ï¼Œåªè¦"å‰æƒ…æè¦"åšå¾—è¶³å¤Ÿå®Œæ•´ï¼Œä½ çš„è§‚çœ‹ä½“éªŒåº”è¯¥å’Œä»ç¬¬1é›†çœ‹åˆ°ç¬¬2é›†æ˜¯ä¸€æ ·çš„â€”â€”è¿™å°±æ˜¯ç­‰å˜æ€§çš„æœ¬è´¨ã€‚</p>
  </div>
</div>

<div class="enrichment-block" style="border-left-color: #ef4444;">
  <h4>ğŸ’¥ ä¸ºä»€ä¹ˆ RNN æœ‰æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Ÿ</h4>
  
  <div class="qa-pair" style="margin: 1.5rem 0;">
    <p><strong>ä¸€å¥è¯å›ç­”</strong>ï¼šå› ä¸º RNN åœ¨æ—¶é—´ä¸Š"å±•å¼€"åç›¸å½“äºä¸€ä¸ªéå¸¸æ·±çš„ç½‘ç»œï¼Œæ¢¯åº¦éœ€è¦ç»è¿‡å¾ˆå¤šå±‚åå‘ä¼ æ’­ï¼Œæ¯æ¬¡éƒ½ä¼šè¢«æ¿€æ´»å‡½æ•°çš„å¯¼æ•°ï¼ˆé€šå¸¸å°äº1ï¼‰ä¹˜ä¸€éï¼Œå¯¼è‡´æ¢¯åº¦æŒ‡æ•°çº§è¡°å‡ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    <p>è€ƒè™‘ SimpleRNN çš„æ›´æ–°è§„åˆ™ï¼š</p>
    <p style="text-align: center;">$$ h^{(t)} = \sigma(W z^{(t)} + U h^{(t-1)} + b) $$</p>
    
    <div style="background: rgba(239,68,68,0.06); padding: 1.2rem; border-radius: 8px; margin: 1rem 0;">
      <p><strong>ğŸ” é—®é¢˜æ ¹æº</strong>ï¼š</p>
      <p>å½“æˆ‘ä»¬è®¡ç®—æ¢¯åº¦ \( \frac{\partial L}{\partial h^{(1)}} \) æ—¶ï¼ˆå‡è®¾æŸå¤±å‡½æ•° \( L \) åœ¨æ—¶åˆ» \( T \) è®¡ç®—ï¼‰ï¼Œæ¢¯åº¦éœ€è¦"å›æº¯"æ‰€æœ‰æ—¶é—´æ­¥ï¼š</p>
      <p style="text-align: center;">$$ \frac{\partial h^{(t)}}{\partial h^{(t-1)}} = \text{diag}(\sigma'(W z^{(t)} + U h^{(t-1)} + b)) \cdot U $$</p>
      <p>é€šè¿‡é“¾å¼æ³•åˆ™ï¼Œæ¢¯åº¦ä»æ—¶åˆ» \( T \) ä¼ æ’­åˆ°æ—¶åˆ» \( 1 \) éœ€è¦è¿ä¹˜ \( T-1 \) æ¬¡è¿™æ ·çš„é¡¹ã€‚</p>
    </div>
    
    <p><strong>ğŸ“‰ Sigmoid/Tanh çš„è‡´å‘½ç¼ºé™·</strong>ï¼š</p>
    <ul>
      <li><strong>Sigmoid å‡½æ•°</strong> \( \sigma(x) = \frac{1}{1+e^{-x}} \) çš„å¯¼æ•° \( \sigma'(x) \in (0, 0.25] \)</li>
      <li><strong>Tanh å‡½æ•°</strong> \( \sigma(x) = \tanh(x) \) çš„å¯¼æ•° \( \sigma'(x) \in (0, 1] \)</li>
    </ul>
    <p>è¿ä¹˜å¤šä¸ªå°äº1çš„æ•°ï¼Œç»“æœä¼š<strong>æŒ‡æ•°çº§è¡°å‡</strong>ï¼ä¾‹å¦‚ï¼š\( 0.25^{50} \approx 10^{-30} \)ï¼Œè¿™æ ·çš„æ¢¯åº¦åœ¨æµ®ç‚¹è¿ç®—ä¸­åŸºæœ¬ä¸ºé›¶ã€‚</p>
    
    <p><strong>ğŸ§® æ•°å€¼ç¤ºä¾‹</strong>ï¼š</p>
    <div style="background: #f9fafb; padding: 1rem; border-radius: 6px; font-family: monospace; margin: 1rem 0;">
      å‡è®¾ \( |\sigma'| \leq 0.5 \)ï¼Œ\( \|U\| \leq 2 \)ï¼š<br>
      10æ­¥å›æº¯ï¼š\( (0.5 \times 2)^{10} = 1 \) âœ…<br>
      50æ­¥å›æº¯ï¼š\( (0.5 \times 2)^{50} = 1 \) âœ…ï¼ˆçœ‹ä¼¼æ­£å¸¸ï¼‰<br>
      ä½†å¦‚æœ \( |\sigma'| \approx 0.25 \)ï¼š<br>
      50æ­¥å›æº¯ï¼š\( (0.25 \times 2)^{50} = 0.5^{50} \approx 10^{-15} \) ğŸ’€
    </div>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šæƒ³è±¡ä¸€ä¸ª"ä¼ è¯æ¸¸æˆ"ï¼Œæ¯ä¸ªäººåªèƒ½ä¼ é€’70%çš„ä¿¡æ¯ç»™ä¸‹ä¸€ä¸ªäººã€‚ä¼ 5ä¸ªäººåï¼Œä¿¡æ¯ä¿ç•™ \( 0.7^5 \approx 17\% \)ï¼›ä¼ 20ä¸ªäººååªå‰© \( 0.7^{20} \approx 0.08\% \)â€”â€”è¿™å°±æ˜¯æ¢¯åº¦æ¶ˆå¤±çš„æœ¬è´¨ã€‚</p>
    
    <p><strong>ğŸ“Š åæœ</strong>ï¼š</p>
    <ul>
      <li>åºåˆ—å‰æœŸçš„è¾“å…¥å¯¹æŸå¤±å‡½æ•°çš„æ¢¯åº¦å‡ ä¹ä¸ºé›¶</li>
      <li>æ¨¡å‹æ— æ³•å­¦ä¹ <strong>é•¿ç¨‹ä¾èµ–</strong>ï¼ˆlong-term dependenciesï¼‰</li>
      <li>ä¾‹å¦‚ï¼š"Petar æ˜¯å¡å°”ç»´äºšäººâ€¦â€¦ï¼ˆé•¿æ®µè½ï¼‰â€¦â€¦Petar ç°åœ¨ä½åœ¨ ___"ï¼Œæ¨¡å‹å¾ˆéš¾å­¦ä¼šå¡«"å¡å°”ç»´äºš"</li>
    </ul>
  </div>
</div>

<div class="enrichment-block" style="border-left-color: #8b5cf6;">
  <h4>ğŸšª LSTM çš„é—¨æ§æœºåˆ¶è¯¦è§£</h4>
  
  <div class="qa-pair" style="margin: 1.5rem 0;">
    <p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šLSTM é€šè¿‡ä¸‰ä¸ª"é—¨"ï¼ˆgatesï¼‰æ¥<strong>é€‰æ‹©æ€§åœ°ä¿ç•™å’Œé—å¿˜ä¿¡æ¯</strong>ï¼Œä»è€Œè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</p>
    
    <div style="background: rgba(139,92,246,0.06); padding: 1.2rem; border-radius: 8px; margin: 1rem 0;">
      <h5 style="margin-top: 0; color: #7c3aed;">ğŸ”‘ æ ¸å¿ƒç»„ä»¶ï¼šè®°å¿†ç»†èƒï¼ˆMemory Cellï¼‰</h5>
      <p>LSTM å¼•å…¥äº†ä¸€ä¸ªç‹¬ç«‹çš„<strong>è®°å¿†ç»†èƒçŠ¶æ€</strong> \( c^{(t)} \in \mathbb{R}^m \)ï¼Œä¸éšè—çŠ¶æ€ \( h^{(t)} \) åˆ†ç¦»ï¼š</p>
      <ul>
        <li>\( c^{(t)} \)ï¼šé•¿æœŸè®°å¿†ï¼Œä¿¡æ¯å¯ä»¥è·¨è¶Šå¤šä¸ªæ—¶é—´æ­¥çº¿æ€§ä¼ é€’</li>
        <li>\( h^{(t)} \)ï¼šçŸ­æœŸè¾“å‡ºï¼ŒåŸºäº \( c^{(t)} \) è®¡ç®—å¾—åˆ°</li>
      </ul>
    </div>
    
    <h5 style="color: #7c3aed; margin-top: 1.5rem;">ğŸšª ä¸‰ä¸ªé—¨çš„ä½œç”¨</h5>
    
    <div style="margin: 1.5rem 0; padding: 1rem; background: rgba(139,92,246,0.03); border-left: 3px solid #8b5cf6;">
      <h6 style="margin-top: 0;">1ï¸âƒ£ é—å¿˜é—¨ï¼ˆForget Gateï¼‰\( f^{(t)} \)</h6>
      <p style="text-align: center;">$$ f^{(t)} = \text{logistic}(W_f z^{(t)} + U_f h^{(t-1)} + b_f) $$</p>
      <p><strong>ä½œç”¨</strong>ï¼šå†³å®š<strong>ä¸¢å¼ƒå¤šå°‘</strong>ä¸Šä¸€æ—¶åˆ»çš„è®°å¿† \( c^{(t-1)} \)</p>
      <ul>
        <li>\( f^{(t)} \approx 0 \)ï¼šå®Œå…¨é—å¿˜è¿‡å»</li>
        <li>\( f^{(t)} \approx 1 \)ï¼šå®Œå…¨ä¿ç•™è¿‡å»</li>
      </ul>
      <p><strong>ğŸŒ ç±»æ¯”</strong>ï¼šä½ åœ¨è®°ç¬”è®°æ—¶ï¼Œå†³å®šè¦ä¸è¦æ“¦æ‰æ˜¨å¤©çš„æ—§ç¬”è®°ã€‚</p>
    </div>
    
    <div style="margin: 1.5rem 0; padding: 1rem; background: rgba(139,92,246,0.03); border-left: 3px solid #8b5cf6;">
      <h6 style="margin-top: 0;">2ï¸âƒ£ è¾“å…¥é—¨ï¼ˆInput Gateï¼‰\( i^{(t)} \)</h6>
      <p style="text-align: center;">$$ i^{(t)} = \text{logistic}(W_i z^{(t)} + U_i h^{(t-1)} + b_i) $$</p>
      <p style="text-align: center;">$$ \tilde{c}^{(t)} = \tanh(W_c z^{(t)} + U_c h^{(t-1)} + b_c) $$</p>
      <p><strong>ä½œç”¨</strong>ï¼šå†³å®š<strong>å†™å…¥å¤šå°‘</strong>æ–°ä¿¡æ¯ \( \tilde{c}^{(t)} \) åˆ°è®°å¿†ç»†èƒ</p>
      <ul>
        <li>\( \tilde{c}^{(t)} \)ï¼šå€™é€‰ç‰¹å¾ï¼ˆæ–°ä¿¡æ¯ï¼‰</li>
        <li>\( i^{(t)} \)ï¼šè¾“å…¥é—¨æ§åˆ¶å†™å…¥æ¯”ä¾‹</li>
      </ul>
      <p><strong>ğŸŒ ç±»æ¯”</strong>ï¼šä½ è¯»åˆ°æ–°çŸ¥è¯†æ—¶ï¼Œå†³å®šè¦ä¸è¦è®°åˆ°ç¬”è®°æœ¬é‡Œï¼Œä»¥åŠè®°å¤šå°‘ã€‚</p>
    </div>
    
    <div style="margin: 1.5rem 0; padding: 1rem; background: rgba(139,92,246,0.03); border-left: 3px solid #8b5cf6;">
      <h6 style="margin-top: 0;">3ï¸âƒ£ è¾“å‡ºé—¨ï¼ˆOutput Gateï¼‰\( o^{(t)} \)</h6>
      <p style="text-align: center;">$$ o^{(t)} = \text{logistic}(W_o z^{(t)} + U_o h^{(t-1)} + b_o) $$</p>
      <p><strong>ä½œç”¨</strong>ï¼šå†³å®š<strong>è¾“å‡ºå¤šå°‘</strong>è®°å¿†ç»†èƒçš„å†…å®¹ä½œä¸ºå½“å‰éšè—çŠ¶æ€</p>
      <p style="text-align: center;">$$ h^{(t)} = o^{(t)} \odot \tanh(c^{(t)}) $$</p>
      <p><strong>ğŸŒ ç±»æ¯”</strong>ï¼šä½ çŸ¥é“å¾ˆå¤šçŸ¥è¯†ï¼Œä½†å›ç­”é—®é¢˜æ—¶åªè¯´å‡ºç›¸å…³çš„éƒ¨åˆ†ã€‚</p>
    </div>
    
    <h5 style="color: #7c3aed; margin-top: 1.5rem;">ğŸ”„ å®Œæ•´æ›´æ–°æµç¨‹</h5>
    <div style="background: #f9fafb; padding: 1.2rem; border-radius: 8px; margin: 1rem 0;">
      <p><strong>æ­¥éª¤1ï¼šæ›´æ–°è®°å¿†ç»†èƒ</strong></p>
      <p style="text-align: center;">$$ c^{(t)} = f^{(t)} \odot c^{(t-1)} + i^{(t)} \odot \tilde{c}^{(t)} $$</p>
      <p style="font-size: 0.95em; color: #6b7280; margin: 0.5rem 0;">
        â†³ é—å¿˜é—¨ç­›é€‰æ—§è®°å¿† + è¾“å…¥é—¨å†™å…¥æ–°ä¿¡æ¯
      </p>
      
      <p style="margin-top: 1rem;"><strong>æ­¥éª¤2ï¼šè®¡ç®—è¾“å‡º</strong></p>
      <p style="text-align: center;">$$ h^{(t)} = o^{(t)} \odot \tanh(c^{(t)}) $$</p>
      <p style="font-size: 0.95em; color: #6b7280; margin: 0.5rem 0;">
        â†³ è¾“å‡ºé—¨ç­›é€‰è®°å¿†ç»†èƒçš„å†…å®¹
      </p>
    </div>
    
    <h5 style="color: #7c3aed; margin-top: 1.5rem;">ğŸ›¡ï¸ ä¸ºä»€ä¹ˆèƒ½è§£å†³æ¢¯åº¦æ¶ˆå¤±ï¼Ÿ</h5>
    <p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šè®°å¿†ç»†èƒçš„æ›´æ–°æ˜¯<strong>åŠ æ€§</strong>è€Œéä¹˜æ€§ï¼š</p>
    <p style="text-align: center;">$$ c^{(t)} = f^{(t)} \odot c^{(t-1)} + i^{(t)} \odot \tilde{c}^{(t)} $$</p>
    <ul>
      <li>æ¢¯åº¦å›ä¼ æ—¶ï¼š\( \frac{\partial c^{(t)}}{\partial c^{(t-1)}} = f^{(t)} \)</li>
      <li>å¦‚æœ \( f^{(t)} \approx 1 \)ï¼ˆé—å¿˜é—¨å®Œå…¨æ‰“å¼€ï¼‰ï¼Œæ¢¯åº¦å‡ ä¹ä¸è¡°å‡ï¼</li>
      <li>æ¨¡å‹å¯ä»¥<strong>å­¦ä¹ </strong> \( f^{(t)} \) çš„å€¼ï¼Œä»è€Œè‡ªé€‚åº”åœ°æ§åˆ¶æ¢¯åº¦æµåŠ¨</li>
    </ul>
    
    <p><strong>ğŸŒ ç”Ÿæ´»ç±»æ¯”</strong>ï¼šSimpleRNN åƒ"ä¼ è¯æ¸¸æˆ"ï¼Œæ¯ä¼ ä¸€æ¬¡ä¿¡æ¯å°±æ‰“æŠ˜æ‰£ï¼›LSTM åƒ"å†™ç¬”è®°"ï¼Œé‡è¦ä¿¡æ¯ç›´æ¥å†™ä¸‹æ¥ï¼ˆè®°å¿†ç»†èƒï¼‰ï¼Œéœ€è¦æ—¶å†ç¿»å‡ºæ¥ï¼Œä¿¡æ¯æŸå¤±å¾ˆå°ã€‚</p>
  </div>
</div>

<div class="enrichment-block" style="border-left-color: #10b981;">
  <h4>â±ï¸ æ—¶é—´æ‰­æ›²ä¸å˜æ€§çš„å‡ ä½•è§£é‡Š</h4>
  
  <div class="qa-pair" style="margin: 1.5rem 0;">
    <p><strong>ä¸€å¥è¯</strong>ï¼šæ—¶é—´æ‰­æ›²ä¸å˜æ€§æ„å‘³ç€ï¼Œæ— è®ºè¾“å…¥ä¿¡å·çš„é‡‡æ ·é€Ÿç‡å¦‚ä½•å˜åŒ–ï¼ˆåŠ é€Ÿæˆ–å‡é€Ÿï¼‰ï¼Œæ¨¡å‹éƒ½èƒ½ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç†ä¿¡æ¯â€”â€”è¿™æ˜¯ LSTM ç­‰é—¨æ§ RNN ç‰¹æœ‰çš„å‡ ä½•å¯¹ç§°æ€§ã€‚</p>
    
    <p><strong>è¯¦ç»†è§£é‡Š</strong>ï¼š</p>
    
    <div style="background: rgba(16,185,129,0.06); padding: 1.2rem; border-radius: 8px; margin: 1rem 0;">
      <h5 style="margin-top: 0; color: #059669;">ğŸŒ€ ä»€ä¹ˆæ˜¯æ—¶é—´æ‰­æ›²ï¼ˆTime Warpingï¼‰ï¼Ÿ</h5>
      <p>æ—¶é—´æ‰­æ›²æ˜¯ä¸€ä¸ªå•è°ƒé€’å¢çš„å¯å¾®å‡½æ•° \( \tau: \mathbb{R}_+ \to \mathbb{R}_+ \)ï¼Œå®ƒå°†æ—¶é—´ \( t \) æ˜ å°„åˆ°"æ‰­æ›²å"çš„æ—¶é—´ \( \tau(t) \)ã€‚</p>
      <p><strong>ä¾‹å­</strong>ï¼š</p>
      <ul>
        <li><strong>æ—¶é—´ç¼©æ”¾</strong>ï¼š\( \tau(t) = 0.7t \)ï¼ˆæ—¶é—´"å˜æ…¢"ï¼Œç›¸å½“äºæ¯ 1.43 æ­¥æ‰é‡‡æ ·ä¸€æ¬¡ï¼‰</li>
        <li><strong>éå‡åŒ€æ‰­æ›²</strong>ï¼š\( \tau(t) = t + 0.1\sin(t) \)ï¼ˆé‡‡æ ·é€Ÿç‡æ—¶å¿«æ—¶æ…¢ï¼‰</li>
      </ul>
    </div>
    
    <h5 style="color: #059669; margin-top: 1.5rem;">ğŸ“ å‡ ä½•å¯¹ç§°æ€§çš„è§†è§’</h5>
    <p>åœ¨è¿ç»­æ—¶é—´åŸŸï¼ŒRNN çš„éšè—çŠ¶æ€ \( h(t) \) æ»¡è¶³å¾®åˆ†æ–¹ç¨‹ï¼š</p>
    <p style="text-align: center;">$$ \frac{dh(t)}{dt} = R(z(t+1), h(t)) - h(t) $$</p>
    <p>å½“æ—¶é—´è¢«æ‰­æ›²ä¸º \( \tau(t) \) æ—¶ï¼Œè¾“å…¥ä¿¡å·å˜ä¸º \( z(\tau(t)) \)ï¼Œæˆ‘ä»¬å¸Œæœ›éšè—çŠ¶æ€ä¹Ÿç›¸åº”æ‰­æ›²ä¸º \( h(\tau(t)) \)ã€‚</p>
    
    <div style="background: #f9fafb; padding: 1.2rem; border-radius: 8px; margin: 1rem 0;">
      <p><strong>å…³é”®æ¨å¯¼</strong>ï¼ˆé“¾å¼æ³•åˆ™ï¼‰ï¼š</p>
      <p style="text-align: center;">$$ \frac{dh(\tau(t))}{dt} = \frac{dh(\tau(t))}{d\tau(t)} \cdot \frac{d\tau(t)}{dt} $$</p>
      <p>å±•å¼€åï¼š</p>
      <p style="text-align: center;">$$ \frac{dh(\tau(t))}{dt} = \frac{d\tau(t)}{dt} \left[ R(z(\tau(t+1)), h(\tau(t))) - h(\tau(t)) \right] $$</p>
    </div>
    
    <p><strong>ğŸ” æ ¸å¿ƒæ´å¯Ÿ</strong>ï¼š</p>
    <p>è¦ä¿æŒæ—¶é—´æ‰­æ›²ä¸å˜æ€§ï¼ŒRNN å¿…é¡»èƒ½å¤Ÿ<strong>æ˜¾å¼è¡¨ç¤ºæ—¶é—´æ‰­æ›²çš„å¯¼æ•°</strong> \( \frac{d\tau(t)}{dt} \)ï¼</p>
    
    <h5 style="color: #059669; margin-top: 1.5rem;">ğŸ¯ é—¨æ§æœºåˆ¶çš„å‡ ä½•è§’è‰²</h5>
    <p>å¼•å…¥å¯å­¦ä¹ çš„"æ‰­æ›²å¯¼æ•°ä¼°è®¡å‡½æ•°" \( \Gamma(z^{(t+1)}, h^{(t)}) \)ï¼Œç¦»æ•£ RNN çš„æ›´æ–°è§„åˆ™å˜ä¸ºï¼š</p>
    <p style="text-align: center;">$$ h^{(t+1)} = \Gamma(z^{(t+1)}, h^{(t)}) \cdot R(z^{(t+1)}, h^{(t)}) + \left(1 - \Gamma(z^{(t+1)}, h^{(t)})\right) h^{(t)} $$</p>
    
    <div style="border: 2px dashed #10b981; padding: 1rem; margin: 1rem 0; border-radius: 8px;">
      <p><strong>ğŸ‰ æƒŠäººçš„ç»“è®º</strong>ï¼š</p>
      <p>è¿™æ­£æ˜¯ LSTM çš„å½¢å¼ï¼å…¶ä¸­ï¼š</p>
      <ul>
        <li>\( \Gamma \equiv \) é—å¿˜é—¨ \( f^{(t)} \) / è¾“å…¥é—¨ \( i^{(t)} \)</li>
        <li>\( \Gamma \) çš„ä½œç”¨æ˜¯<strong>æ‹Ÿåˆæ—¶é—´æ‰­æ›²çš„å¯¼æ•°</strong> \( \frac{d\tau(t)}{dt} \)</li>
      </ul>
      <p style="margin-top: 0.5rem;">ç”±äº \( 0 < \frac{d\tau(t)}{dt} < 1 \)ï¼ˆæ—¶é—´æ‰­æ›²ä¸èƒ½"å‹ç¼©"å¤ªå¤šï¼‰ï¼Œ\( \Gamma \) è‡ªç„¶é€‰æ‹© logistic sigmoid æ¿€æ´»å‡½æ•°ï¼</p>
    </div>
    
    <h5 style="color: #059669; margin-top: 1.5rem;">ğŸ§  å‘é‡åŒ–é—¨æ§çš„æ„ä¹‰</h5>
    <p>LSTM è®¡ç®—çš„æ˜¯<strong>å‘é‡åŒ–çš„é—¨</strong>ï¼ˆæ¯ä¸ªç»´åº¦ç‹¬ç«‹ï¼‰ï¼š</p>
    <p style="text-align: center;">$$ \Gamma(z^{(t+1)}, h^{(t)}) \in [0,1]^m $$</p>
    <p><strong>å‡ ä½•æ„ä¹‰</strong>ï¼šå…è®¸ä¸åŒç»´åº¦æ‹Ÿåˆ<strong>ä¸åŒçš„æ—¶é—´å°ºåº¦</strong>ï¼ˆmulti-scale temporal reasoningï¼‰ï¼</p>
    <ul>
      <li>æŸäº›ç»´åº¦å¯èƒ½å…³æ³¨çŸ­æœŸä¾èµ–ï¼ˆ\( \Gamma \approx 0.8 \)ï¼‰</li>
      <li>æŸäº›ç»´åº¦å¯èƒ½å…³æ³¨é•¿æœŸä¾èµ–ï¼ˆ\( \Gamma \approx 0.01 \)ï¼‰</li>
    </ul>
    
    <h5 style="color: #059669; margin-top: 1.5rem;">ğŸŒ ç”Ÿæ´»ç±»æ¯”</h5>
    <p>æƒ³è±¡ä½ åœ¨çœ‹ä¸€åœºè¶³çƒæ¯”èµ›çš„å½•åƒï¼š</p>
    <ul>
      <li><strong>æ—¶é—´æ‰­æ›²</strong>ï¼šä½ å¯ä»¥å¿«è¿›ï¼ˆ2å€é€Ÿï¼‰æˆ–æ…¢æ”¾ï¼ˆ0.5å€é€Ÿï¼‰</li>
      <li><strong>SimpleRNN</strong>ï¼šåªèƒ½æŒ‰åŸé€Ÿæ’­æ”¾ï¼Œå¿«è¿›åå°±"çœ‹ä¸æ‡‚"äº†</li>
      <li><strong>LSTM</strong>ï¼šé€šè¿‡é—¨æ§æœºåˆ¶è‡ªåŠ¨è°ƒæ•´"ç†è§£é€Ÿåº¦"ï¼Œæ— è®ºä½ æ€ä¹ˆè°ƒæ’­æ”¾é€Ÿåº¦ï¼Œéƒ½èƒ½æ­£ç¡®ç†è§£æ¯”èµ›è¿›ç¨‹</li>
    </ul>
    
    <h5 style="color: #059669; margin-top: 1.5rem;">ğŸ’¡ å®ç”¨å¯ç¤ºï¼šChrono Initialization</h5>
    <p>å¦‚æœæˆ‘ä»¬å‡è®¾æ„Ÿå…´è¶£çš„æ—¶é—´ä¾èµ–èŒƒå›´åœ¨ \( [T_l, T_h] \) æ­¥ä¹‹é—´ï¼Œå¯ä»¥åˆå§‹åŒ–é—å¿˜é—¨çš„åç½®ä¸ºï¼š</p>
    <p style="text-align: center;">$$ b_f \sim -\log(U(T_l, T_h)^{-1}) $$</p>
    <p>è¿™æ ·èƒ½è®©æ¨¡å‹æ›´å¿«å­¦ä¼šå»ºæ¨¡é•¿ç¨‹ä¾èµ–ï¼</p>
  </div>
</div>

<div class="enrichment-block" style="border-left-color: #f59e0b;">
  <h4>ğŸ”— RNN ä¸ GNN çš„è”ç³»ï¼šåºåˆ— = é“¾å›¾</h4>
  
  <div class="qa-pair" style="margin: 1.5rem 0;">
    <p><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šRNN å¤„ç†åºåˆ—æœ¬è´¨ä¸Šæ˜¯åœ¨<strong>é“¾çŠ¶å›¾</strong>ä¸Šåšä¿¡æ¯ä¼ é€’ï¼Œè¿™ä¸ GNN çš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶å®Œå…¨ä¸€è‡´ï¼</p>
    
    <div style="background: rgba(245,158,11,0.06); padding: 1.2rem; border-radius: 8px; margin: 1rem 0;">
      <h5 style="margin-top: 0; color: #d97706;">ğŸ”„ ç»Ÿä¸€çš„è§†è§’ï¼šæ¶ˆæ¯ä¼ é€’</h5>
      <p><strong>GNN çš„æ¶ˆæ¯ä¼ é€’</strong>ï¼ˆåœ¨å›¾ä¸Šï¼‰ï¼š</p>
      <p style="text-align: center;">$$ h_u = \phi\left( x_u, \bigoplus_{v \in \mathcal{N}_u} \psi(x_u, x_v) \right) $$</p>
      <ul>
        <li>\( \mathcal{N}_u \)ï¼šèŠ‚ç‚¹ \( u \) çš„é‚»å±…</li>
        <li>\( \psi \)ï¼šæ¶ˆæ¯å‡½æ•°</li>
        <li>\( \bigoplus \)ï¼šèšåˆå‡½æ•°ï¼ˆsum/mean/maxï¼‰</li>
        <li>\( \phi \)ï¼šæ›´æ–°å‡½æ•°</li>
      </ul>
      
      <p style="margin-top: 1rem;"><strong>RNN çš„é€’å½’æ›´æ–°</strong>ï¼ˆåœ¨åºåˆ—ä¸Šï¼‰ï¼š</p>
      <p style="text-align: center;">$$ h^{(t)} = R(z^{(t)}, h^{(t-1)}) $$</p>
      <ul>
        <li>\( z^{(t)} \)ï¼šå½“å‰æ—¶åˆ»çš„è¾“å…¥ï¼ˆç±»æ¯”èŠ‚ç‚¹ç‰¹å¾ \( x_u \)ï¼‰</li>
        <li>\( h^{(t-1)} \)ï¼šä¸Šä¸€æ—¶åˆ»çš„éšè—çŠ¶æ€ï¼ˆç±»æ¯”é‚»å±…ä¿¡æ¯ï¼‰</li>
        <li>\( R \)ï¼šæ›´æ–°å‡½æ•°ï¼ˆç±»æ¯” \( \phi \)ï¼‰</li>
      </ul>
    </div>
    
    <h5 style="color: #d97706; margin-top: 1.5rem;">ğŸ”— åºåˆ— = æœ‰å‘é“¾å›¾</h5>
    <p>è€ƒè™‘ä¸€ä¸ªåºåˆ— \( z^{(1)}, z^{(2)}, z^{(3)}, \ldots, z^{(T)} \)ï¼Œå¯ä»¥è¡¨ç¤ºä¸º<strong>æœ‰å‘é“¾çŠ¶å›¾</strong>ï¼š</p>
    <div style="background: #f9fafb; padding: 1rem; border-radius: 8px; margin: 1rem 0; font-family: monospace; text-align: center;">
      zâ½Â¹â¾ â€”â€”â†’ zâ½Â²â¾ â€”â€”â†’ zâ½Â³â¾ â€”â€”â†’ ... â€”â€”â†’ zâ½áµ€â¾
    </div>
    <p><strong>å›¾ç»“æ„</strong>ï¼š</p>
    <ul>
      <li>èŠ‚ç‚¹ï¼šæ¯ä¸ªæ—¶é—´æ­¥ \( t \)</li>
      <li>è¾¹ï¼š\( (t-1) \to t \)ï¼ˆå•å‘ï¼Œä»è¿‡å»æŒ‡å‘æœªæ¥ï¼‰</li>
      <li>èŠ‚ç‚¹ç‰¹å¾ï¼š\( x_t = z^{(t)} \)</li>
      <li>é‚»å±…é›†åˆï¼š\( \mathcal{N}_t = \{t-1\} \)ï¼ˆåªæœ‰ä¸€ä¸ªé‚»å±…ï¼ï¼‰</li>
    </ul>
    
    <h5 style="color: #d97706; margin-top: 1.5rem;">ğŸ¯ RNN = ç‰¹æ®Šçš„ GNN</h5>
    <p>å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªé“¾å›¾ä¸Šåº”ç”¨ GNN çš„æ¶ˆæ¯ä¼ é€’ï¼š</p>
    <p style="text-align: center;">$$ h_t = \phi\left( z^{(t)}, \psi(h_{t-1}) \right) $$</p>
    <p>é€‰æ‹©ï¼š</p>
    <ul>
      <li><strong>èšåˆå‡½æ•°</strong> \( \bigoplus \)ï¼šç”±äºåªæœ‰ä¸€ä¸ªé‚»å±…ï¼Œèšåˆå°±æ˜¯æ’ç­‰å‡½æ•°</li>
      <li><strong>æ¶ˆæ¯å‡½æ•°</strong> \( \psi(h_{t-1}) = h_{t-1} \)ï¼šç›´æ¥ä¼ é€’éšè—çŠ¶æ€</li>
      <li><strong>æ›´æ–°å‡½æ•°</strong> \( \phi(z^{(t)}, h_{t-1}) = \sigma(W z^{(t)} + U h_{t-1} + b) \)</li>
    </ul>
    <p>è¿™æ­£æ˜¯ SimpleRNNï¼</p>
    
    <h5 style="color: #d97706; margin-top: 1.5rem;">ğŸŒ æ‰©å±•åˆ°æ›´å¤æ‚çš„å›¾ç»“æ„</h5>
    <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
      <thead>
        <tr style="background: rgba(245,158,11,0.1);">
          <th style="padding: 0.75rem; border: 1px solid #fbbf24;">æ•°æ®ç»“æ„</th>
          <th style="padding: 0.75rem; border: 1px solid #fbbf24;">å›¾æ‹“æ‰‘</th>
          <th style="padding: 0.75rem; border: 1px solid #fbbf24;">æ¨¡å‹</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">åºåˆ—</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">æœ‰å‘é“¾</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">RNN / LSTM</td>
        </tr>
        <tr>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">æ ‘</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">Tree-LSTM</td>
        </tr>
        <tr>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">é€šç”¨å›¾</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">ä»»æ„è¿é€šå›¾</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">GNN / GCN</td>
        </tr>
        <tr>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">ç½‘æ ¼ï¼ˆå›¾åƒï¼‰</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">2D æ­£åˆ™ç½‘æ ¼</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">CNN</td>
        </tr>
        <tr>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">é›†åˆ</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">æ— è¾¹ï¼ˆå®Œå…¨å›¾/ç©ºå›¾ï¼‰</td>
          <td style="padding: 0.75rem; border: 1px solid #fcd34d;">Deep Sets / Transformer</td>
        </tr>
      </tbody>
    </table>
    
    <h5 style="color: #d97706; margin-top: 1.5rem;">ğŸ’¡ ç»Ÿä¸€ç†è§£çš„ä»·å€¼</h5>
    <ul>
      <li><strong>æ¦‚å¿µè¿ç§»</strong>ï¼šGNN çš„æŠ€å·§ï¼ˆå¦‚æ³¨æ„åŠ›æœºåˆ¶ï¼‰å¯ä»¥è¿ç§»åˆ° RNN</li>
      <li><strong>æ¶æ„èåˆ</strong>ï¼šæ—¶ç©ºå›¾ç½‘ç»œï¼ˆSpatiotemporal GNNï¼‰= GNN + RNN</li>
      <li><strong>ç†è®ºæ´å¯Ÿ</strong>ï¼šRNN çš„è¡¨è¾¾èƒ½åŠ›å¯ä»¥ç”¨ GNN çš„ WL æµ‹è¯•ç†è®ºåˆ†æ</li>
    </ul>
    
    <div style="border: 2px solid #f59e0b; padding: 1.2rem; margin: 1.5rem 0; border-radius: 8px; background: rgba(245,158,11,0.03);">
      <p><strong>ğŸ¯ å…³é”®å¯ç¤º</strong>ï¼š</p>
      <p>Geometric Deep Learning çš„æ ¸å¿ƒæ€æƒ³æ˜¯<strong>è¯†åˆ«æ•°æ®ä¸­çš„å‡ ä½•ç»“æ„å’Œå¯¹ç§°æ€§</strong>ã€‚åºåˆ—çš„"æ—¶é—´å¯¹ç§°æ€§"ï¼ˆå¹³ç§»ç­‰å˜æ€§ï¼‰å’Œå›¾çš„"èŠ‚ç‚¹å¯¹ç§°æ€§"ï¼ˆç½®æ¢ç­‰å˜æ€§ï¼‰åœ¨è¿™ä¸ªæ¡†æ¶ä¸‹æ˜¯ç»Ÿä¸€çš„â€”â€”éƒ½æ˜¯åœ¨ç‰¹å®šå‡ ä½•ç»“æ„ä¸Šçš„å±€éƒ¨ä¿¡æ¯èšåˆã€‚</p>
      <p style="margin-top: 0.8rem;">RNN ä¸æ˜¯"å¦ä¸€ç§"ç¥ç»ç½‘ç»œï¼Œå®ƒåªæ˜¯ GNN åœ¨<strong>é“¾çŠ¶å›¾</strong>è¿™ä¸€ç‰¹æ®Šæ‹“æ‰‘ä¸Šçš„å®ä¾‹åŒ–ï¼</p>
    </div>
    
    <h5 style="color: #d97706; margin-top: 1.5rem;">ğŸŒ ç”Ÿæ´»ç±»æ¯”</h5>
    <p>æƒ³è±¡ä¿¡æ¯ä¼ æ’­ï¼š</p>
    <ul>
      <li><strong>é“¾çŠ¶ï¼ˆRNNï¼‰</strong>ï¼šåƒ"æ¥åŠ›èµ›"ï¼Œä¿¡æ¯ä»ç¬¬ä¸€ä¸ªäººä¼ åˆ°æœ€åä¸€ä¸ªäºº</li>
      <li><strong>æ ‘çŠ¶</strong>ï¼šåƒ"é‡‘å­—å¡”é”€å”®"ï¼Œä¿¡æ¯ä»æ ¹èŠ‚ç‚¹å‘ä¸‹æ‰©æ•£</li>
      <li><strong>é€šç”¨å›¾ï¼ˆGNNï¼‰</strong>ï¼šåƒ"ç¤¾äº¤ç½‘ç»œ"ï¼Œä¿¡æ¯åœ¨æœ‹å‹åœˆä¸­å¤šå‘ä¼ æ’­</li>
    </ul>
    <p>æœ¬è´¨ä¸Šéƒ½æ˜¯<strong>å±€éƒ¨æ¶ˆæ¯ä¼ é€’ + èšåˆ</strong>ï¼Œåªæ˜¯æ‹“æ‰‘ç»“æ„ä¸åŒï¼</p>
  </div>
</div>
<!-- === END ENRICHMENT: sec5-7 === -->


    <h3 id="rnn-equivariance">RNN çš„æ—¶é—´ç­‰å˜æ€§</h3>

    <p>RNN åœ¨æ¯ä¸€æ­¥è®¡ç®—æ‘˜è¦å‘é‡ $h^{(t)}$ï¼š</p>

    <div class="math-block">
      $$h^{(t)} = R(z^{(t)}, h^{(t-1)}) \tag{38}$$
      <div class="math-explain">
        $z^{(t)}$ æ˜¯ç¬¬ $t$ æ­¥çš„è¾“å…¥ç‰¹å¾ï¼Œ$h^{(t)}$ æ˜¯åˆ°ç¬¬ $t$ æ­¥ä¸ºæ­¢çš„"æ‘˜è¦"ï¼Œ$R$ æ˜¯<strong>å…±äº«çš„</strong>æ›´æ–°å‡½æ•°ã€‚å¯¹äº SimpleRNNï¼š$h^{(t)} = \sigma(Wz^{(t)} + Uh^{(t-1)} + b)$ã€‚
      </div>
    </div>

    <div class="figure">
      <img src="../assets/ch5_p95_img0.png" alt="RNN processing video">
      <figcaption>å›¾ 19ï¼šç”¨ RNN å¤„ç†è§†é¢‘è¾“å…¥ã€‚æ¯å¸§ $X^{(t)}$ ç”±å…±äº«ç¼–ç å™¨ $f$ï¼ˆå¦‚ CNNï¼‰å¤„ç†ä¸º $z^{(t)}$ï¼Œç„¶å RNN æ›´æ–°å‡½æ•° $R$ è¿­ä»£æ›´æ–°æ‘˜è¦å‘é‡ã€‚</figcaption>
    </div>

    <div class="derivation">
      <h4>æ—¶é—´å¹³ç§»ç­‰å˜æ€§çš„åˆ†æ</h4>
      <div class="step"><span class="step-num">1</span>è®¾ $z'^{(t)} = z^{(t+1)}$ï¼ˆå·¦ç§»ä¸€æ­¥ï¼‰ã€‚å¸Œæœ› $h'^{(t)} = h^{(t+1)}$ã€‚</div>
      <div class="step"><span class="step-num">2</span>ä½† $h'^{(1)} = R(z'^{(1)}, h^{(0)}) = R(z^{(2)}, h^{(0)})$ï¼Œè€Œ $h^{(2)} = R(z^{(2)}, R(z^{(1)}, h^{(0)}))$ã€‚</div>
      <div class="step"><span class="step-num">3</span>é™¤é $h^{(0)} = R(z^{(1)}, h^{(0)})$ï¼Œå¦åˆ™ç­‰å˜æ€§ä¸æˆç«‹ã€‚</div>
      <div class="step"><span class="step-num">4</span><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå¯¹åºåˆ—åšè¶³å¤Ÿçš„é›¶å¡«å……ï¼Œä½¿ $h^{(0)}$ æˆä¸º $\gamma(h) = R(0, h)$ çš„<strong>ä¸åŠ¨ç‚¹</strong>ã€‚å¦‚æœ $\gamma$ æ˜¯å‹ç¼©æ˜ å°„ï¼Œè¿­ä»£å¿…æ”¶æ•›åˆ°å”¯ä¸€ä¸åŠ¨ç‚¹ã€‚</div>
    </div>

    <h3 id="rnn-vanishing">æ¢¯åº¦æ¶ˆå¤±é—®é¢˜</h3>

    <p>RNN çš„ä¸€ä¸ªæ ¸å¿ƒæŒ‘æˆ˜ï¼š<strong>æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸</strong>ã€‚</p>

    <div class="callout callout-warning">
      <h4>ä¸ºä»€ä¹ˆ SimpleRNN æœ‰æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Ÿ</h4>
      <p>è€ƒè™‘ sigmoid æ¿€æ´» $\sigma$ï¼ˆå¦‚ tanhï¼‰ï¼Œå…¶å¯¼æ•° $|\sigma'| \in (0, 1)$ã€‚ç»è¿‡ $T$ æ­¥åå‘ä¼ æ’­ï¼š</p>
      $$\frac{\partial h^{(T)}}{\partial h^{(1)}} = \prod_{t=1}^{T-1} \frac{\partial h^{(t+1)}}{\partial h^{(t)}} \approx \prod_{t=1}^{T-1} \sigma'(\cdot) \cdot U$$
      <p>å¾ˆå¤š $|\sigma'| < 1$ çš„å€¼è¿ä¹˜ â†’ æ¢¯åº¦æŒ‡æ•°è¡°å‡ â†’ åºåˆ—å¼€å¤´çš„ä¿¡æ¯<strong>æ— æ³•å½±å“</strong>æœ«å°¾çš„æ¢¯åº¦æ›´æ–°ã€‚</p>
      <p><strong>ä¾‹å­</strong>ï¼š"Petar is Serbian. He was born on ...[å¾ˆé•¿ä¸€æ®µ]... Petar currently lives in ___"ã€‚é¢„æµ‹ "Serbia" éœ€è¦å›æº¯åˆ°åºåˆ—å¼€å¤´ï¼Œä½†æ¢¯åº¦å·²ç»æ¶ˆå¤±äº†ã€‚</p>
    </div>

    <div class="code-container">
      <span class="code-label">Python / PyTorch â€” SimpleRNN + æ¢¯åº¦åˆ†æ</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code>import torch
import torch.nn as nn
import torch.nn.functional as F

# ============================================================
# SimpleRNN å®ç°
# ============================================================
class SimpleRNN(nn.Module):
    """
    h^(t) = Ïƒ(W z^(t) + U h^(t-1) + b)
    
    å‡ ä½•è§†è§’: è¿™æ˜¯æ—¶é—´ç½‘æ ¼ Z ä¸Šçš„"å·ç§¯"æ“ä½œï¼Œ
    ä½†ä¸ CNN ä¸åŒï¼Œå‚æ•°å…±äº«çš„æ˜¯ W, U, bï¼ˆè€Œéæ»¤æ³¢å™¨ï¼‰ã€‚
    """
    def __init__(self, input_dim, hidden_dim):
        super().__init__()
        self.hidden_dim = hidden_dim
        self.W = nn.Linear(input_dim, hidden_dim)
        self.U = nn.Linear(hidden_dim, hidden_dim, bias=False)
    
    def forward(self, x_seq):
        """
        x_seq: (B, T, input_dim)
        è¿”å›: (B, T, hidden_dim) â€” æ¯æ­¥çš„ h^(t)
        """
        B, T, _ = x_seq.shape
        h = torch.zeros(B, self.hidden_dim, device=x_seq.device)
        outputs = []
        
        for t in range(T):
            h = torch.tanh(self.W(x_seq[:, t]) + self.U(h))
            outputs.append(h)
        
        return torch.stack(outputs, dim=1)


# ============================================================
# æ¢¯åº¦æ¶ˆå¤±å¯è§†åŒ–
# ============================================================
def analyze_gradient_vanishing():
    """åˆ†æ SimpleRNN ä¸­çš„æ¢¯åº¦æ¶ˆå¤±"""
    torch.manual_seed(42)
    
    rnn = SimpleRNN(input_dim=10, hidden_dim=32)
    x = torch.randn(1, 50, 10, requires_grad=True)  # 50 æ­¥åºåˆ—
    
    outputs = rnn(x)
    
    # å¯¹æœ€åä¸€æ­¥çš„è¾“å‡ºæ±‚å’Œå¹¶åå‘ä¼ æ’­
    loss = outputs[:, -1].sum()
    loss.backward()
    
    # æ£€æŸ¥æ¯ä¸€æ­¥çš„æ¢¯åº¦èŒƒæ•°
    grad_norms = []
    h = torch.zeros(1, 32)
    
    for t in range(50):
        h = torch.tanh(rnn.W(x[:, t]) + rnn.U(h))
    
    print("SimpleRNN æ¢¯åº¦åˆ†æ:")
    print(f"è¾“å…¥æ¢¯åº¦èŒƒæ•°: {x.grad.norm(dim=-1).squeeze()[:10].tolist()}")
    print("â†’ æ³¨æ„å‰é¢æ­¥éª¤çš„æ¢¯åº¦æ¯”åé¢æ­¥éª¤å°å¾—å¤šï¼ˆæ¢¯åº¦æ¶ˆå¤±ï¼‰")
    print("â†’ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦ LSTM çš„é—¨æ§æœºåˆ¶ï¼")


if __name__ == "__main__":
    rnn = SimpleRNN(10, 32)
    x = torch.randn(4, 20, 10)
    out = rnn(x)
    print(f"SimpleRNN: {x.shape} â†’ {out.shape}")
    analyze_gradient_vanishing()</code></pre>
    </div>


    <!-- ====================== 5.8 LSTM ====================== -->
    <h2 id="sec5-8">5.8 é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ (LSTM)<br><span style="font-size:0.65em;color:var(--text-secondary)">Long Short-Term Memory Networks</span></h2>

    <div class="bilingual">
      <div class="zh">
        <p>LSTM (Hochreiter & Schmidhuber, 1997) é€šè¿‡å¼•å…¥<span class="term">é—¨æ§æœºåˆ¶</span>ï¼ˆgating mechanismsï¼‰å¤§å¹…ç¼“è§£äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚é—¨æ§å…è®¸ç½‘ç»œä»¥æ•°æ®é©±åŠ¨çš„æ–¹å¼<strong>é€‰æ‹©æ€§åœ°è¦†å†™</strong>ä¿¡æ¯ã€‚</p>
      </div>
      <div class="en">
        LSTM significantly reduces vanishing gradients through gating mechanisms, which allow the network to selectively overwrite information in a data-driven way.
      </div>
    </div>

    <h3 id="lstm-gates">LSTM çš„é—¨æ§æœºåˆ¶</h3>

    <div class="figure">
      <img src="../assets/ch5_p95_img1.png" alt="LSTM dataflow">
      <figcaption>å›¾ 20ï¼šLSTM çš„æ•°æ®æµï¼ŒåŒ…å«è®°å¿†ç»†èƒ (M) å’Œä¸‰ä¸ªé—¨ï¼šè¾“å…¥é—¨ $i^{(t)}$ã€é—å¿˜é—¨ $f^{(t)}$ã€è¾“å‡ºé—¨ $o^{(t)}$ã€‚</figcaption>
    </div>

    <p>LSTM åœ¨ SimpleRNN çš„åŸºç¡€ä¸Šå¼•å…¥äº†<strong>è®°å¿†ç»†èƒ</strong>ï¼ˆmemory cellï¼‰$c^{(t)}$ï¼Œé€šè¿‡ä¸‰ä¸ª<strong>é—¨</strong>æ§åˆ¶ä¿¡æ¯æµï¼š</p>

    <div class="math-block">
      $$\tilde{c}^{(t)} = \tanh(W_c z^{(t)} + U_c h^{(t-1)} + b_c) \tag{43 â€” å€™é€‰ç‰¹å¾}$$
      $$i^{(t)} = \text{logistic}(W_i z^{(t)} + U_i h^{(t-1)} + b_i) \tag{44 â€” è¾“å…¥é—¨}$$
      $$f^{(t)} = \text{logistic}(W_f z^{(t)} + U_f h^{(t-1)} + b_f) \tag{45 â€” é—å¿˜é—¨}$$
      $$o^{(t)} = \text{logistic}(W_o z^{(t)} + U_o h^{(t-1)} + b_o) \tag{46 â€” è¾“å‡ºé—¨}$$
      $$c^{(t)} = i^{(t)} \odot \tilde{c}^{(t)} + f^{(t)} \odot c^{(t-1)} \tag{47 â€” ç»†èƒçŠ¶æ€æ›´æ–°}$$
      $$h^{(t)} = o^{(t)} \odot \tanh(c^{(t)}) \tag{48 â€” è¾“å‡º}$$
    </div>

    <div class="symbol-table">
      <h4>LSTM ç¬¦å·è¡¨</h4>
      <table>
        <thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th><th>èŒƒå›´</th></tr></thead>
        <tbody>
          <tr><td>$c^{(t)}$</td><td>è®°å¿†ç»†èƒçŠ¶æ€</td><td>$\mathbb{R}^m$</td></tr>
          <tr><td>$\tilde{c}^{(t)}$</td><td>å€™é€‰ç‰¹å¾</td><td>$[-1, 1]^m$</td></tr>
          <tr><td>$i^{(t)}$</td><td>è¾“å…¥é—¨ï¼šå…è®¸å¤šå°‘å€™é€‰è¿›å…¥ç»†èƒ</td><td>$[0, 1]^m$</td></tr>
          <tr><td>$f^{(t)}$</td><td>é—å¿˜é—¨ï¼šä¿ç•™å¤šå°‘æ—§ç»†èƒçŠ¶æ€</td><td>$[0, 1]^m$</td></tr>
          <tr><td>$o^{(t)}$</td><td>è¾“å‡ºé—¨ï¼šæš´éœ²å¤šå°‘æ–°ç»†èƒçŠ¶æ€</td><td>$[0, 1]^m$</td></tr>
          <tr><td>$\odot$</td><td>é€å…ƒç´ ä¹˜æ³•ï¼ˆHadamard ä¹˜ç§¯ï¼‰</td><td>â€”</td></tr>
          <tr><td>logistic</td><td>$\sigma(x) = \frac{1}{1 + e^{-x}}$</td><td>$[0, 1]$</td></tr>
        </tbody>
      </table>
    </div>

    <div class="callout callout-key">
      <h4>ä¸ºä»€ä¹ˆ LSTM è§£å†³äº†æ¢¯åº¦æ¶ˆå¤±ï¼Ÿ</h4>
      <p>å…³é”®åœ¨å…¬å¼ (47)ï¼š$c^{(t)} = i^{(t)} \odot \tilde{c}^{(t)} + f^{(t)} \odot c^{(t-1)}$ã€‚</p>
      <ul>
        <li>å½“ $f^{(t)} \approx 1$ æ—¶ï¼Œ$c^{(t)} \approx c^{(t-1)}$ï¼Œæ¢¯åº¦<strong>ç›´æ¥æµè¿‡</strong>ï¼ˆç±»ä¼¼ ResNet çš„è·³è·ƒè¿æ¥ï¼‰</li>
        <li>$f^{(t)}$ çš„å€¼ç›´æ¥å‡ºç°åœ¨åå‘ä¼ æ’­çš„å¯¼æ•°ä¸­ï¼Œç½‘ç»œå¯ä»¥<strong>å­¦ä¹ </strong>æ§åˆ¶æ¢¯åº¦çš„è¡°å‡ç¨‹åº¦</li>
        <li>å®è·µå»ºè®®ï¼šåˆå§‹åŒ–é—å¿˜é—¨åç½® $b_f$ ä¸ºæ­£å€¼ï¼ˆå¦‚ 1ï¼‰ï¼Œä½¿åˆå§‹ $f^{(t)} \approx 1$ï¼Œå€¾å‘äºè®°å¿†</li>
      </ul>
    </div>

    <h3 id="lstm-time-warp">æ—¶é—´æ‰­æ›²ä¸å˜æ€§ â€” LSTM çš„å‡ ä½•è§£é‡Š</h3>

    <p>é—¨æ§ RNN çš„ä¸€ä¸ªæ·±å±‚æ€§è´¨ï¼šå®ƒä»¬å¯¹<strong>æ—¶é—´æ‰­æ›²å˜æ¢</strong>ï¼ˆtime warpingï¼‰ä¸å˜ã€‚è¿™ä¸ªæ´å¯Ÿæ¥è‡ª Tallec & Ollivier (2018)ã€‚</p>

    <div class="blueprint">
      <h4>æ—¶é—´æ‰­æ›²ä¸å˜çš„ RNN</h4>
      <p>æ—¶é—´æ‰­æ›² $\tau: \mathbb{R}^+ \to \mathbb{R}^+$ æ˜¯å•è°ƒé€’å¢çš„å¾®åˆ†æ˜ å°„ã€‚è¦æ±‚ RNN ç±»å¯¹æ—¶é—´æ‰­æ›²ä¸å˜æ„å‘³ç€ï¼šå¯¹ä»»ä½• $\tau$ å’Œæ¨¡å‹å‚æ•°ï¼Œå­˜åœ¨<strong>å¦ä¸€ç»„å‚æ•°</strong>ä½¿å¾—æ¨¡å‹åœ¨æ‰­æ›²åçš„æ•°æ®ä¸Šè¡¨ç°ç›¸åŒã€‚</p>
      <p>é€šè¿‡è¿ç»­æ—¶é—´åˆ†æï¼Œä¸å˜æ€§è¦æ±‚ RNN æ›´æ–°æ»¡è¶³ï¼š</p>
      $$h^{(t+1)} = \Gamma(z^{(t+1)}, h^{(t)}) R(z^{(t+1)}, h^{(t)}) + (1 - \Gamma(z^{(t+1)}, h^{(t)})) h^{(t)} \tag{53}$$
      <p>å…¶ä¸­ $\Gamma$ è¾“å‡ºåœ¨ $(0, 1)$ èŒƒå›´â€”â€”<strong>è¿™æ­£æ˜¯ LSTM çš„é—¨æ§ï¼</strong></p>
    </div>

    <div class="derivation">
      <h4>ä»æ—¶é—´æ‰­æ›²ä¸å˜æ€§æ¨å¯¼å‡º LSTM é—¨æ§</h4>
      <div class="step"><span class="step-num">1</span><strong>è¿ç»­æ—¶é—´ RNN</strong>ï¼š$\frac{dh(\tau(t))}{d\tau(t)} = R(z(\tau(t+1)), h(\tau(t))) - h(\tau(t))$</div>
      <div class="step"><span class="step-num">2</span><strong>é“¾å¼æ³•åˆ™</strong>ï¼š$\frac{dh(\tau(t))}{dt} = \frac{d\tau(t)}{dt} \left[R(\cdots) - h(\tau(t))\right]$</div>
      <div class="step"><span class="step-num">3</span>$\frac{d\tau(t)}{dt}$ æœªçŸ¥ â†’ å¼•å…¥å¯å­¦ä¹ å‡½æ•° $\Gamma$ æ¥è¿‘ä¼¼å®ƒ</div>
      <div class="step"><span class="step-num">4</span>Taylor å±•å¼€ + ç¦»æ•£åŒ– â†’ $h^{(t+1)} = \Gamma \cdot R + (1 - \Gamma) \cdot h^{(t)}$</div>
      <div class="step"><span class="step-num">5</span>çº¦æŸ $0 < \Gamma < 1$ï¼ˆå› ä¸º $\tau$ å•è°ƒä¸” $\frac{d\tau}{dt} \leq 1$ï¼‰â†’ ä½¿ç”¨ logistic sigmoid â†’ <strong>LSTM çš„é—¨ï¼</strong></div>
    </div>

    <div class="callout callout-info">
      <h4>Chrono åˆå§‹åŒ–</h4>
      <p>å¦‚æœæˆ‘ä»¬å…³å¿ƒçš„ä¾èµ–èŒƒå›´æ˜¯ $[T_l, T_h]$ æ­¥ï¼Œé—¨æ§å€¼åº”åœ¨ $[\frac{1}{T_h}, \frac{1}{T_l}]$ èŒƒå›´å†…ã€‚åˆ©ç”¨ $E[\Gamma] \approx \text{logistic}(b_\Gamma)$ï¼Œå¯ä»¥åˆå§‹åŒ–ï¼š</p>
      $$b_\Gamma \sim -\log(\mathcal{U}(T_l, T_h) - 1)$$
      <p>è¿™ç§ "chrono åˆå§‹åŒ–" èƒ½æ˜¾è‘—æ”¹å–„é•¿ç¨‹ä¾èµ–å»ºæ¨¡ã€‚</p>
    </div>

    <div class="code-container">
      <span class="code-label">Python / PyTorch â€” LSTM å®Œæ•´å®ç° + é—¨æ§å¯è§†åŒ–</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code>import torch
import torch.nn as nn
import torch.nn.functional as F

# ============================================================
# LSTM ä»é›¶å®ç°
# ============================================================
class LSTMFromScratch(nn.Module):
    """
    LSTM å®Œæ•´å®ç°ï¼ˆå¯¹åº” GDL å…¬å¼ 43-48ï¼‰ã€‚
    
    å‡ ä½•è§†è§’:
    - é—¨æ§æœºåˆ¶ = æ—¶é—´æ‰­æ›²å¯¼æ•° dÏ„/dt çš„å­¦ä¹ 
    - é—å¿˜é—¨ â†’ æ§åˆ¶ "è®°å¿†æ—¶é—´å°ºåº¦"
    - Chrono åˆå§‹åŒ– â†’ æ§åˆ¶æœ‰æ•ˆè®°å¿†èŒƒå›´
    """
    def __init__(self, input_dim, hidden_dim):
        super().__init__()
        self.hidden_dim = hidden_dim
        
        # å››ä¸ªçº¿æ€§å±‚ï¼ˆå¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªå¤§çŸ©é˜µä»¥åŠ é€Ÿï¼‰
        # å€™é€‰ç‰¹å¾
        self.W_c = nn.Linear(input_dim, hidden_dim)
        self.U_c = nn.Linear(hidden_dim, hidden_dim, bias=False)
        # è¾“å…¥é—¨
        self.W_i = nn.Linear(input_dim, hidden_dim)
        self.U_i = nn.Linear(hidden_dim, hidden_dim, bias=False)
        # é—å¿˜é—¨ï¼ˆåˆå§‹åŒ–åç½®ä¸º 1ï¼Œå€¾å‘è®°å¿†ï¼‰
        self.W_f = nn.Linear(input_dim, hidden_dim)
        self.U_f = nn.Linear(hidden_dim, hidden_dim, bias=False)
        self.W_f.bias.data.fill_(1.0)  # â† å…³é”®åˆå§‹åŒ–ï¼
        # è¾“å‡ºé—¨
        self.W_o = nn.Linear(input_dim, hidden_dim)
        self.U_o = nn.Linear(hidden_dim, hidden_dim, bias=False)
    
    def forward(self, x_seq, initial_state=None):
        """
        x_seq: (B, T, input_dim)
        è¿”å›: outputs (B, T, hidden_dim), (h_final, c_final)
        """
        B, T, _ = x_seq.shape
        
        if initial_state is None:
            h = torch.zeros(B, self.hidden_dim, device=x_seq.device)
            c = torch.zeros(B, self.hidden_dim, device=x_seq.device)
        else:
            h, c = initial_state
        
        outputs = []
        gate_history = {'input': [], 'forget': [], 'output': []}
        
        for t in range(T):
            z = x_seq[:, t]
            
            # å…¬å¼ 43: å€™é€‰ç‰¹å¾
            c_tilde = torch.tanh(self.W_c(z) + self.U_c(h))
            
            # å…¬å¼ 44: è¾“å…¥é—¨
            i = torch.sigmoid(self.W_i(z) + self.U_i(h))
            
            # å…¬å¼ 45: é—å¿˜é—¨
            f = torch.sigmoid(self.W_f(z) + self.U_f(h))
            
            # å…¬å¼ 46: è¾“å‡ºé—¨
            o = torch.sigmoid(self.W_o(z) + self.U_o(h))
            
            # å…¬å¼ 47: ç»†èƒçŠ¶æ€æ›´æ–°
            c = i * c_tilde + f * c  # â† æ ¸å¿ƒï¼æ¢¯åº¦å¯ä»¥é€šè¿‡ f ç›´æ¥æµè¿‡
            
            # å…¬å¼ 48: è¾“å‡º
            h = o * torch.tanh(c)
            
            outputs.append(h)
            gate_history['input'].append(i.mean().item())
            gate_history['forget'].append(f.mean().item())
            gate_history['output'].append(o.mean().item())
        
        return torch.stack(outputs, dim=1), (h, c), gate_history


# ============================================================
# å¯¹æ¯” SimpleRNN vs LSTM çš„æ¢¯åº¦
# ============================================================
def compare_gradient_flow():
    """å¯¹æ¯” SimpleRNN å’Œ LSTM çš„æ¢¯åº¦æµ"""
    torch.manual_seed(42)
    
    T = 100  # é•¿åºåˆ—
    
    # LSTM
    lstm = LSTMFromScratch(10, 32)
    x = torch.randn(1, T, 10, requires_grad=True)
    outputs, _, gates = lstm(x)
    loss = outputs[:, -1].sum()
    loss.backward()
    lstm_grad = x.grad.norm(dim=-1).squeeze()
    
    print("LSTM vs SimpleRNN æ¢¯åº¦åˆ†æ (T=100):")
    print(f"LSTM å‰10æ­¥æ¢¯åº¦èŒƒæ•°:  {lstm_grad[:10].tolist()}")
    print(f"LSTM å10æ­¥æ¢¯åº¦èŒƒæ•°:  {lstm_grad[-10:].tolist()}")
    print(f"LSTM æ¢¯åº¦æ¯”å€¼ (é¦–/æœ«): {lstm_grad[0] / lstm_grad[-1]:.4f}")
    print(f"å¹³å‡é—å¿˜é—¨å€¼: {sum(gates['forget'])/len(gates['forget']):.4f}")
    print("â†’ LSTM çš„æ¢¯åº¦è¡°å‡è¿œæ…¢äº SimpleRNN âœ…")


if __name__ == "__main__":
    lstm = LSTMFromScratch(10, 32)
    x = torch.randn(4, 50, 10)
    out, (h, c), gates = lstm(x)
    print(f"LSTM: {x.shape} â†’ {out.shape}")
    print(f"å‚æ•°é‡: {sum(p.numel() for p in lstm.parameters()):,}")
    print()
    compare_gradient_flow()</code></pre>
    </div>


    <!-- ====================== 5.3 EXTENDED: DEEP DIVE ====================== -->
    <h2 id="gnn-deep-dive">5.3+ GNN æ·±åº¦è¿›é˜¶ï¼šè¿‡å¹³æ»‘ã€è¿‡å‹ç¼©ä¸è¡¨è¾¾åŠ›è¾¹ç•Œ</h2>

    <h3>è¿‡å¹³æ»‘é—®é¢˜ (Over-smoothing)</h3>

    <div class="callout callout-warning">
      <h4>GNN çš„æ·±åº¦é™åˆ¶</h4>
      <p>ä¸ CNN ä¸åŒï¼ŒGNN <strong>ä¸èƒ½ç®€å•åœ°å †å å¾ˆå¤šå±‚</strong>ã€‚åŸå› ï¼šæ¯ä¸€å±‚æ¶ˆæ¯ä¼ é€’éƒ½åœ¨é‚»åŸŸä¸­åš"å¹³å‡"ï¼Œå¤šå±‚ä¹‹åæ‰€æœ‰èŠ‚ç‚¹çš„è¡¨ç¤ºè¶‹äºç›¸åŒâ€”â€”è¿™å°±æ˜¯<strong>è¿‡å¹³æ»‘</strong>ï¼ˆover-smoothingï¼‰ã€‚</p>
    </div>

    <div class="math-block">
      $$\text{GCN å±‚å¯ä»¥è§†ä¸º: } \mathbf{H}^{(l+1)} = \hat{A} \mathbf{H}^{(l)} \mathbf{W}^{(l)}$$
      <div class="math-explain">
        åå¤å·¦ä¹˜ $\hat{A}$ï¼ˆå½’ä¸€åŒ–é‚»æ¥çŸ©é˜µï¼‰ç­‰æ•ˆäºåœ¨å›¾ä¸Šåš<strong>æ‰©æ•£</strong>ã€‚$\hat{A}^k$ çš„æé™æ˜¯ä¸èŠ‚ç‚¹åº¦æ•°æˆæ­£æ¯”çš„å¹³ç¨³åˆ†å¸ƒâ€”â€”æ‰€æœ‰èŠ‚ç‚¹ç‰¹å¾è¶‹åŒã€‚
      </div>
    </div>

    <div class="derivation">
      <h4>è¿‡å¹³æ»‘çš„æ•°å­¦è¯æ˜ï¼ˆç®€åŒ–ç‰ˆï¼‰</h4>
      <div class="step"><span class="step-num">1</span>$\hat{A}$ æ˜¯è¡ŒéšæœºçŸ©é˜µï¼ˆæ¯è¡Œå’Œä¸º 1ï¼‰ï¼Œå…¶ç‰¹å¾å€¼ $|\lambda_i| \leq 1$ã€‚</div>
      <div class="step"><span class="step-num">2</span>å¯¹è¿é€šå›¾ï¼Œæœ€å¤§ç‰¹å¾å€¼ $\lambda_1 = 1$ å¯¹åº”å¸¸å‘é‡ $\mathbf{1}$ï¼Œå…¶ä½™ $|\lambda_i| < 1$ã€‚</div>
      <div class="step"><span class="step-num">3</span>$\hat{A}^k \mathbf{H} = \sum_i \lambda_i^k \mathbf{v}_i \mathbf{v}_i^\top \mathbf{H} \xrightarrow{k \to \infty} \mathbf{v}_1 \mathbf{v}_1^\top \mathbf{H}$</div>
      <div class="step"><span class="step-num">4</span>æé™ä¸‹æ‰€æœ‰èŠ‚ç‚¹ç‰¹å¾ = å…¨å±€å¹³å‡çš„æŸä¸ªæŠ•å½± â†’ <strong>æ— æ³•åŒºåˆ†ä¸åŒèŠ‚ç‚¹</strong>ã€‚</div>
    </div>

    <p><strong>ç¼“è§£è¿‡å¹³æ»‘çš„ç­–ç•¥</strong>ï¼š</p>
    <ul>
      <li><strong>æ®‹å·®è¿æ¥</strong>ï¼š$h_i^{(l+1)} = h_i^{(l)} + \text{GNN}(h_i^{(l)})$ â€” æˆ‘ä»¬çš„ DynamicalGNN å°±ä½¿ç”¨äº†è¿™ä¸ª</li>
      <li><strong>JumpingKnowledge</strong>ï¼šæ‹¼æ¥æ‰€æœ‰å±‚çš„è¾“å‡º $h_i = [h_i^{(1)} \| h_i^{(2)} \| \cdots \| h_i^{(L)}]$</li>
      <li><strong>DropEdge</strong>ï¼šè®­ç»ƒæ—¶éšæœºåˆ é™¤è¾¹</li>
      <li><strong>PairNorm / NodeNorm</strong>ï¼šé˜²æ­¢ç‰¹å¾è¿‡äºç›¸ä¼¼</li>
    </ul>

    <h3>è¿‡å‹ç¼©é—®é¢˜ (Over-squashing)</h3>

    <p>è¿‡å‹ç¼©æ˜¯å¦ä¸€ä¸ª GNN çš„æ ¸å¿ƒé—®é¢˜ï¼š<strong>è¿œè·ç¦»èŠ‚ç‚¹çš„ä¿¡æ¯è¢«å‹ç¼©åˆ°å›ºå®šå¤§å°çš„å‘é‡ä¸­</strong>ï¼Œå¯¼è‡´é•¿ç¨‹ä¾èµ–æ— æ³•æœ‰æ•ˆä¼ æ’­ã€‚</p>

    <div class="math-block">
      $$\left|\frac{\partial h_u^{(L)}}{\partial x_v^{(0)}}\right| \leq c \cdot (\hat{A}^L)_{uv}$$
      <div class="math-explain">
        $L$ å±‚ GNN åï¼ŒèŠ‚ç‚¹ $u$ å¯¹èŠ‚ç‚¹ $v$ çš„æ•æ„Ÿåº¦ä»¥é‚»æ¥çŸ©é˜µçš„ $L$ æ¬¡å¹‚ä¸ºä¸Šç•Œã€‚å¦‚æœ $u, v$ è·ç¦»è¿œä¸”å›¾çš„ç“¶é¢ˆä¸¥é‡ï¼ˆå¦‚æ ‘ç»“æ„ï¼‰ï¼Œ$(\hat{A}^L)_{uv}$ æŒ‡æ•°è¡°å‡ã€‚è¿™ä¸ RNN çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜æœ¬è´¨ç›¸åŒï¼
      </div>
    </div>

    <div class="callout callout-project">
      <h4>PhysRobot ä¸­çš„è¿‡å¹³æ»‘/è¿‡å‹ç¼©</h4>
      <p>åœ¨æˆ‘ä»¬çš„ç²’å­ä»¿çœŸä¸­ï¼š</p>
      <ul>
        <li><strong>3 å±‚æ¶ˆæ¯ä¼ é€’</strong>ï¼ˆ<code>n_message_passing=3</code>ï¼‰æ˜¯ç²¾å¿ƒé€‰æ‹©çš„â€”â€”å¤šäº†ä¼šè¿‡å¹³æ»‘ï¼Œå°‘äº†ä¿¡æ¯ä¼ ä¸è¿œ</li>
        <li><strong>æ®‹å·®è¿æ¥</strong>ï¼ˆ<code>x_new = ... + x</code>ï¼‰ç›´æ¥ç¼“è§£è¿‡å¹³æ»‘</li>
        <li>ç²’å­ç³»ç»Ÿçš„äº¤äº’é€šå¸¸æ˜¯<strong>çŸ­ç¨‹</strong>çš„ï¼ˆå¼•åŠ›ã€å¼¹åŠ›ï¼‰ï¼Œæ‰€ä»¥ 3 å±‚è¶³å¤Ÿ</li>
        <li>å¦‚æœéœ€è¦é•¿ç¨‹äº¤äº’ï¼Œå¯ä»¥è€ƒè™‘ Transformer é£æ ¼çš„å…¨å±€æ³¨æ„åŠ›è¡¥å……</li>
      </ul>
    </div>

    <h3>WL æµ‹è¯•ä¸ GNN è¡¨è¾¾åŠ›ä¸Šç•Œ</h3>

    <div class="blueprint">
      <h4>Weisfeiler-Leman (1-WL) å›¾åŒæ„æµ‹è¯•</h4>
      <p>1-WL æµ‹è¯•é€šè¿‡è¿­ä»£é¢œè‰²ç»†åŒ–æ¥æ£€æµ‹å›¾åŒæ„ï¼š</p>
      $$c_v^{(k+1)} = \text{HASH}\left(c_v^{(k)}, \{\{c_u^{(k)} : u \in \mathcal{N}(v)\}\}\right)$$
      <p><strong>Xu et al. (2019) çš„æ ¸å¿ƒå®šç†</strong>ï¼šæ¶ˆæ¯ä¼ é€’ GNN çš„åŒºåˆ†èƒ½åŠ›<strong>è‡³å¤š</strong>ç­‰äº 1-WL æµ‹è¯•ã€‚GIN è¾¾åˆ°äº†è¿™ä¸ªä¸Šç•Œã€‚</p>
    </div>

    <div class="callout callout-warning">
      <h4>GNN æ— æ³•åŒºåˆ†çš„å›¾å¯¹</h4>
      <p>å­˜åœ¨ 1-WL æ— æ³•åŒºåˆ†ä½†ä¸åŒæ„çš„å›¾å¯¹ï¼ˆå¦‚æŸäº›æ­£åˆ™å›¾ï¼‰ã€‚è¿™æ„å‘³ç€æ¶ˆæ¯ä¼ é€’ GNN æœ‰<strong>å›ºæœ‰çš„è¡¨è¾¾åŠ›ç“¶é¢ˆ</strong>ã€‚è§£å†³æ–¹æ¡ˆï¼š</p>
      <ul>
        <li><strong>Higher-order GNN</strong>ï¼šä½¿ç”¨ $k$-WL æµ‹è¯•ï¼ˆ$k \geq 2$ï¼‰ï¼Œå¯¹èŠ‚ç‚¹<strong>å…ƒç»„</strong>åšæ¶ˆæ¯ä¼ é€’</li>
        <li><strong>éšæœºç‰¹å¾å¢å¼º</strong>ï¼šä¸ºèŠ‚ç‚¹æ·»åŠ éšæœº ID æ‰“ç ´å¯¹ç§°æ€§</li>
        <li><strong>å­å›¾ GNN</strong>ï¼šå¯¹æ¯ä¸ªèŠ‚ç‚¹æå–å­å›¾å†å¤„ç†</li>
      </ul>
    </div>

    <div class="code-container">
      <span class="code-label">Python â€” WL é¢œè‰²ç»†åŒ–ï¼ˆå›¾åŒæ„æµ‹è¯•ï¼‰</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code>import torch
from collections import Counter

# ============================================================
# Weisfeiler-Leman 1-WL å›¾åŒæ„æµ‹è¯•
# ============================================================
def weisfeiler_leman_test(edge_index_1, n1, edge_index_2, n2, iterations=10):
    """
    1-WL å›¾åŒæ„æµ‹è¯•ã€‚
    
    å¦‚æœè¿”å› Falseï¼Œä¸¤ä¸ªå›¾ä¸€å®šä¸åŒæ„ã€‚
    å¦‚æœè¿”å› Trueï¼Œä¸¤ä¸ªå›¾å¯èƒ½åŒæ„ï¼ˆWL æ— æ³•ç¡®å®šï¼‰ã€‚
    
    ä¸ GNN çš„å…³ç³»: GIN çš„è¡¨è¾¾åŠ› = 1-WL æµ‹è¯•ã€‚
    """
    def build_adj(edge_index, n):
        adj = {i: [] for i in range(n)}
        for s, t in edge_index.T.tolist():
            adj[s].append(t)
        return adj
    
    adj1 = build_adj(edge_index_1, n1)
    adj2 = build_adj(edge_index_2, n2)
    
    if n1 != n2:
        return False, "èŠ‚ç‚¹æ•°ä¸åŒ"
    
    # åˆå§‹é¢œè‰²ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ç›¸åŒï¼‰
    colors1 = [0] * n1
    colors2 = [0] * n2
    
    for k in range(iterations):
        # é¢œè‰²ç»†åŒ–
        new_colors1 = []
        new_colors2 = []
        
        for v in range(n1):
            neighbor_colors = tuple(sorted([colors1[u] for u in adj1[v]]))
            new_colors1.append(hash((colors1[v], neighbor_colors)))
        
        for v in range(n2):
            neighbor_colors = tuple(sorted([colors2[u] for u in adj2[v]]))
            new_colors2.append(hash((colors2[v], neighbor_colors)))
        
        # é‡æ–°ç¼–å·é¢œè‰²
        all_colors = sorted(set(new_colors1 + new_colors2))
        color_map = {c: i for i, c in enumerate(all_colors)}
        colors1 = [color_map[c] for c in new_colors1]
        colors2 = [color_map[c] for c in new_colors2]
        
        # æ¯”è¾ƒé¢œè‰²ç›´æ–¹å›¾
        hist1 = Counter(colors1)
        hist2 = Counter(colors2)
        
        if hist1 != hist2:
            return False, f"ç¬¬ {k+1} è½®åŒºåˆ†æˆåŠŸ"
    
    return True, f"ç»è¿‡ {iterations} è½®æ— æ³•åŒºåˆ†ï¼ˆå¯èƒ½åŒæ„ï¼‰"


# æµ‹è¯•: ä¸‰è§’å½¢ vs ä¸‰æ¡ç‹¬ç«‹è¾¹
triangle = torch.tensor([[0,1,1,2,2,0],[1,0,2,1,0,2]], dtype=torch.long)
three_edges = torch.tensor([[0,1,2,3,4,5],[1,0,3,2,5,4]], dtype=torch.long)

result, msg = weisfeiler_leman_test(triangle, 3, three_edges, 6)
print(f"ä¸‰è§’å½¢ vs ä¸‰æ¡è¾¹: {msg}")

# æµ‹è¯•: ä¸¤ä¸ªåŒæ„çš„å›¾
g1 = torch.tensor([[0,0,1,2],[1,2,2,0]], dtype=torch.long)
g2 = torch.tensor([[1,1,0,2],[0,2,2,1]], dtype=torch.long)  # é‡æ ‡å·
result, msg = weisfeiler_leman_test(g1, 3, g2, 3)
print(f"åŒæ„å›¾æµ‹è¯•: {msg}")</code></pre>
    </div>

    <h3>GNN åœ¨ç‰©ç†ä»¿çœŸä¸­çš„åº”ç”¨æ€»ç»“</h3>

    <div class="callout callout-project">
      <h4>ä» GNN åˆ°ç‰©ç†ä»¿çœŸ â€” PhysRobot çš„å®Œæ•´ç®¡çº¿</h4>
      <p>æˆ‘ä»¬çš„ <code>DynamicalGNN</code> éµå¾ª "Learning to Simulate" (Sanchez-Gonzalez et al., 2020) çš„èŒƒå¼ï¼š</p>
    </div>

    <div class="flow">
      <div class="flow-box">ç²’å­çŠ¶æ€<br><small>$(x_i, v_i)$</small></div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">æ„å›¾<br><small>r < cutoff</small></div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">EdgeFrame<br><small>$e_{ij}$</small></div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">Node Encode<br><small>$h_i^{(0)}$</small></div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">MP Ã—3<br><small>$h_i^{(L)}$</small></div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">Decode<br><small>$a_i$</small></div>
      <div class="flow-arrow">â†’</div>
      <div class="flow-box">ç§¯åˆ†<br><small>$v', x'$</small></div>
    </div>

    <div class="code-container">
      <span class="code-label">PhysRobot â€” å®Œæ•´å‰å‘ä¼ æ’­æµç¨‹ï¼ˆå¯¹ç…§ GDL ç†è®ºï¼‰</span>
      <button class="copy-btn" onclick="copyCode(this)">ğŸ“‹ å¤åˆ¶</button>
      <pre><code># å®Œæ•´çš„ DynamicalGNN å‰å‘ä¼ æ’­ï¼Œå¸¦ç†è®ºæ³¨é‡Š
# æºç : physics_core/dynamical_gnn.py

def forward(self, positions, velocities, edge_index, masses=None):
    """
    é¢„æµ‹åŠ é€Ÿåº¦ï¼Œç»™å®šå½“å‰çŠ¶æ€ã€‚
    
    GDL ç†è®ºå¯¹åº”:
    - åŸŸ Î©: ç²’å­ç³»ç»Ÿæ„æˆçš„å›¾ (V=ç²’å­, E=ç›¸äº’ä½œç”¨)
    - å¯¹ç§°ç¾¤: E(3) Ã— Î£_n (æ¬§å‡ é‡Œå¾—+ç½®æ¢)
    - ç­‰å˜æ“ä½œ: EGNN é£æ ¼çš„æ¶ˆæ¯ä¼ é€’
    
    ç®¡çº¿:
    1. EdgeFrame (Â§5.5 EGNN): ç¼–ç ç©ºé—´å…³ç³»ä¸º E(3) ä¸å˜ç‰¹å¾
    2. Node Encoder: åµŒå…¥ç²’å­çŠ¶æ€
    3. Message Passing (Â§5.3 MPNN): ä¼ æ’­ä¿¡æ¯ï¼Œå­¦ä¹ äº¤äº’
    4. Decoder: é¢„æµ‹åŠ é€Ÿåº¦ a = F/mï¼ˆç‰›é¡¿ç¬¬äºŒå®šå¾‹ï¼‰
    """
    # æ­¥éª¤ 1: Edge Frame â€” E(3) ä¸å˜ç‰¹å¾
    # e_ij = Encoder([r_ij, ||r_ij||, v_rel, ||v_rel||])
    # å¯¹åº” EGNN: åªé€šè¿‡è·ç¦» ||x_i - x_j|| ç¼–ç ç©ºé—´ä¿¡æ¯
    edge_features = self.edge_frame(positions, velocities, edge_index)
    
    # æ­¥éª¤ 2: èŠ‚ç‚¹ç¼–ç 
    # å°† (x, v) æ‹¼æ¥ä¸º 6 ç»´è¾“å…¥
    node_states = torch.cat([positions, velocities], dim=-1)  # (N, 6)
    node_features = self.node_encoder(node_states)  # (N, hidden_dim)
    
    # æ­¥éª¤ 3: æ¶ˆæ¯ä¼ é€’ Ã— L å±‚
    # å¯¹åº” Â§5.3 MPNN: x_i' = Î³(x_i, âŠ•_j Ï†(x_i, x_j, e_ij))
    x = node_features
    for mp_layer in self.mp_layers:
        x = mp_layer(x, edge_index, edge_features)
        # æ³¨æ„: æ¯å±‚ä½¿ç”¨ç›¸åŒçš„ edge_featuresï¼ˆä¸æ›´æ–°åæ ‡ï¼‰
        # è¿™ä¸ EGNN ä¸åŒï¼ˆEGNN æ¯å±‚æ›´æ–°åæ ‡ï¼‰
        # æˆ‘ä»¬çš„é€‰æ‹©æ›´é«˜æ•ˆï¼Œå› ä¸ºç‰©ç†ä»¿çœŸä¸­
        # ä¸€æ­¥å†…åæ ‡å˜åŒ–å¾ˆå°
    
    # æ­¥éª¤ 4: è§£ç åŠ é€Ÿåº¦
    # a = Decoder(h_i) âˆˆ RÂ³
    # è¿™æ˜¯ GDL ä¸­çš„ "è¯»å‡º" (readout)
    accelerations = self.decoder(x)  # (N, 3)
    
    return accelerations
    
    # åç»­æ­¥éª¤ï¼ˆä¸åœ¨ GNN å†…éƒ¨ï¼Œç”±ç§¯åˆ†å™¨å®Œæˆï¼‰:
    # v' = v + a * dt          (åŠéšå¼æ¬§æ‹‰)
    # x' = x + v' * dt
    # è¿™å°±å®Œæˆäº†ä¸€ä¸ªå®Œæ•´çš„ç‰©ç†ä»¿çœŸæ­¥ï¼</code></pre>
    </div>

    <h3>GNN å±‚æ•° vs æ„Ÿå—é‡ vs è®¡ç®—ä»£ä»·</h3>

    <div class="comparison-table">
      <table>
        <thead><tr><th>å±‚æ•° $L$</th><th>æ„Ÿå—é‡</th><th>è¿‡å¹³æ»‘é£é™©</th><th>è¿‡å‹ç¼©é£é™©</th><th>è®¡ç®—å¤æ‚åº¦</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>1-hop é‚»å±…</td><td>æ— </td><td>æ— </td><td>$O(|E| d)$</td><td>å±€éƒ¨ç‰¹å¾</td></tr>
          <tr><td>2</td><td>2-hop é‚»å±…</td><td>ä½</td><td>ä½</td><td>$O(2|E| d)$</td><td>å¤§å¤šæ•°ä»»åŠ¡</td></tr>
          <tr><td><strong>3</strong></td><td>3-hop é‚»å±…</td><td>ä¸­</td><td>ä¸­</td><td>$O(3|E| d)$</td><td><strong>PhysRobot âœ…</strong></td></tr>
          <tr><td>5</td><td>5-hop é‚»å±…</td><td>é«˜</td><td>é«˜</td><td>$O(5|E| d)$</td><td>éœ€è¦é•¿ç¨‹ä¿¡æ¯</td></tr>
          <tr><td>10+</td><td>å‡ ä¹å…¨å›¾</td><td>æé«˜</td><td>æé«˜</td><td>$O(10|E| d)$</td><td>éœ€ç‰¹æ®ŠæŠ€å·§</td></tr>
        </tbody>
      </table>
    </div>

    <!-- ====================== COMPREHENSIVE SUMMARY TABLE ====================== -->
    <h2 id="summary">å…¨ç« æ€»ç»“ï¼šæ‰€æœ‰æ¶æ„çš„ç»Ÿä¸€è§†è§’</h2>

    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>æ¶æ„</th>
            <th>åŸŸ $\Omega$</th>
            <th>å¯¹ç§°ç¾¤ $G$</th>
            <th>æ ¸å¿ƒæ“ä½œ</th>
            <th>ç­‰å˜/ä¸å˜</th>
            <th>å‚æ•°å…±äº«</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>CNN</td><td>ç½‘æ ¼ $\mathbb{Z}^d$</td><td>å¹³ç§» $(\mathbb{Z}^d, +)$</td><td>å·ç§¯ $F(x) = x \star \theta$</td><td>ç­‰å˜</td><td>æ»¤æ³¢å™¨éå†æ‰€æœ‰ä½ç½®</td></tr>
          <tr><td>G-CNN</td><td>é½æ¬¡ç©ºé—´</td><td>ä¸€èˆ¬ç¾¤ $G$</td><td>ç¾¤å·ç§¯ $(x \star \theta)(g)$</td><td>ç­‰å˜</td><td>æ»¤æ³¢å™¨éå†ç¾¤å…ƒç´ </td></tr>
          <tr><td>GCN</td><td>å›¾</td><td>$\Sigma_n$</td><td>$\hat{A}HW$</td><td>ç­‰å˜</td><td>$W$ å¯¹æ‰€æœ‰èŠ‚ç‚¹å…±äº«</td></tr>
          <tr><td>GAT</td><td>å›¾</td><td>$\Sigma_n$</td><td>æ³¨æ„åŠ›èšåˆ</td><td>ç­‰å˜</td><td>æ³¨æ„åŠ›å¤´å…±äº«</td></tr>
          <tr><td>GIN</td><td>å›¾</td><td>$\Sigma_n$</td><td>Sum + MLP</td><td>ç­‰å˜</td><td>MLP å…±äº«</td></tr>
          <tr><td>Transformer</td><td>å®Œå…¨å›¾</td><td>$\Sigma_n$</td><td>è‡ªæ³¨æ„åŠ›</td><td>ç­‰å˜</td><td>Q,K,V çŸ©é˜µå…±äº«</td></tr>
          <tr><td>Deep Sets</td><td>é›†åˆ</td><td>$\Sigma_n$</td><td>$\rho(\sum \phi(x_i))$</td><td>ä¸å˜</td><td>$\phi, \rho$ å…±äº«</td></tr>
          <tr><td>EGNN</td><td>å‡ ä½•å›¾</td><td>$E(3) \times \Sigma_n$</td><td>ç­‰å˜æ¶ˆæ¯ä¼ é€’</td><td>ç­‰å˜</td><td>æ¶ˆæ¯å‡½æ•°å…±äº«</td></tr>
          <tr><td>Mesh CNN</td><td>æµå½¢</td><td>ç­‰è· + è§„èŒƒ</td><td>æµ‹åœ°çº¿å·ç§¯</td><td>ç­‰å˜</td><td>æ»¤æ³¢å™¨+ä¼ è¾“çŸ©é˜µ</td></tr>
          <tr><td>RNN</td><td>$\mathbb{Z}$</td><td>æ—¶é—´å¹³ç§»</td><td>$R(z^{(t)}, h^{(t-1)})$</td><td>ç­‰å˜*</td><td>$R$ å¯¹æ‰€æœ‰æ—¶é—´æ­¥å…±äº«</td></tr>
          <tr><td>LSTM</td><td>$\mathbb{Z}$</td><td>æ—¶é—´æ‰­æ›²</td><td>é—¨æ§æ›´æ–°</td><td>ç±»ä¸å˜</td><td>æ‰€æœ‰é—¨å‚æ•°å…±äº«</td></tr>
        </tbody>
      </table>
      <p style="font-size:0.85rem;color:var(--text-muted)">* RNN çš„æ—¶é—´å¹³ç§»ç­‰å˜æ€§éœ€è¦é€‚å½“çš„è¾¹ç•Œæ¡ä»¶ï¼ˆé›¶å¡«å…… + ä¸åŠ¨ç‚¹åˆå§‹åŒ–ï¼‰ã€‚LSTM çš„æ—¶é—´æ‰­æ›²ä¸å˜æ€§æ˜¯"ç±»ä¸å˜æ€§"â€”â€”ç±»ä¸­å­˜åœ¨ç­‰ä»·æ¨¡å‹ï¼Œä½†ä¸èƒ½é›¶æ ·æœ¬è¿ç§»ã€‚</p>
    </div>


    <!-- ====================== EXERCISES ====================== -->
    <div class="exercises" id="exercises">
      <h3>ç»ƒä¹ é¢˜</h3>
      <ol>
        <li><strong>[CNN ç­‰å˜æ€§]</strong> è¯æ˜ï¼šå¦‚æœ CNN ä½¿ç”¨ circular paddingï¼ˆå¾ªç¯å¡«å……ï¼‰ï¼Œåˆ™å·ç§¯æ˜¯<strong>ç²¾ç¡®</strong>å¹³ç§»ç­‰å˜çš„ï¼ˆæ— è¾¹ç•Œæ•ˆåº”ï¼‰ã€‚æç¤ºï¼šè€ƒè™‘ DFT çš„å‘¨æœŸæ€§ã€‚</li>
        
        <li><strong>[GCN æ¨å¯¼]</strong> ä»è°±å›¾å·ç§¯ $g_\theta \star x = U g_\theta(\Lambda) U^\top x$ å‡ºå‘ï¼Œè¯¦ç»†æ¨å¯¼å½“ $g_\theta$ å–ä¸€é˜¶ Chebyshev è¿‘ä¼¼æ—¶å¦‚ä½•å¾—åˆ° GCN çš„å…¬å¼ã€‚ä¸ºä»€ä¹ˆéœ€è¦ renormalization trickï¼Ÿä¸åŠ è‡ªç¯ä¼šæ€æ ·ï¼Ÿ</li>
        
        <li><strong>[GAT vs GCN]</strong> æ„é€ ä¸€ä¸ªä¾‹å­ï¼Œè¯´æ˜ GAT ä¸¥æ ¼å¼ºäº GCNã€‚æç¤ºï¼šè€ƒè™‘ä¸¤ä¸ªèŠ‚ç‚¹ $u, v$ æœ‰ç›¸åŒçš„é‚»åŸŸç»“æ„ä½†ä¸åŒçš„ç‰¹å¾åˆ†å¸ƒã€‚</li>
        
        <li><strong>[GIN è¡¨è¾¾åŠ›]</strong> è¯æ˜ mean èšåˆæ— æ³•åŒºåˆ†å¤šé‡é›† $\{\{a, a, b\}\}$ å’Œ $\{\{a, b, b\}\}$ å½“ $a + b = 2a$ æˆ– $2b$ æ—¶ï¼Œä½† sum èšåˆæ€»èƒ½åŒºåˆ†ã€‚æ›´ä¸€èˆ¬åœ°ï¼Œè¯æ˜ sum èšåˆåœ¨å¤šé‡é›†ä¸Šæ˜¯å•å°„çš„ï¼ˆåœ¨é€‚å½“æ¡ä»¶ä¸‹ï¼‰ã€‚</li>
        
        <li><strong>[Transformer = GAT]</strong> å°†æ ‡å‡†çš„å¤šå¤´æ³¨æ„åŠ› $\text{Attention}(Q, K, V) = \text{softmax}(QK^\top / \sqrt{d_k})V$ æ”¹å†™ä¸º GNN çš„æ¶ˆæ¯ä¼ é€’å½¢å¼ã€‚å†™å‡ºå¯¹åº”çš„æ¶ˆæ¯å‡½æ•° $\phi$ã€æ³¨æ„åŠ›å‡½æ•° $a$ã€èšåˆå‡½æ•° $\bigoplus$ã€‚</li>
        
        <li><strong>[EGNN ç­‰å˜æ€§]</strong> éªŒè¯ EGNN çš„åæ ‡æ›´æ–°å…¬å¼ $x_u' = x_u + \sum_v (x_u - x_v) \psi_c(\cdots)$ åœ¨åå°„å˜æ¢ $x \mapsto -x$ ä¸‹ä¹Ÿæ˜¯ç­‰å˜çš„ï¼ˆä¸ä»…ä»…æ˜¯æ—‹è½¬å’Œå¹³ç§»ï¼‰ã€‚</li>
        
        <li><strong>[PhysRobot ç¼–ç¨‹]</strong> åœ¨æˆ‘ä»¬çš„ <code>DynamicalGNN</code> ä¸­ï¼š(a) è§£é‡Šä¸ºä»€ä¹ˆä½¿ç”¨ sum èšåˆè€Œé mean èšåˆã€‚(b) å¦‚æœæ”¹ç”¨ mean èšåˆï¼Œä¼šå¯¹åŠ¨é‡å®ˆæ’äº§ç”Ÿä»€ä¹ˆå½±å“ï¼Ÿ(c) å®ç°ä¸€ä¸ªå®éªŒæ¥éªŒè¯ã€‚</li>
        
        <li><strong>[LSTM é—¨æ§]</strong> ä»æ—¶é—´æ‰­æ›²ä¸å˜æ€§çš„è§’åº¦è§£é‡Šï¼šä¸ºä»€ä¹ˆé—å¿˜é—¨çš„åç½®åˆå§‹åŒ–ä¸º 1 æ˜¯åˆç†çš„ï¼Ÿå¦‚æœåˆå§‹åŒ–ä¸º -1 ä¼šæ€æ ·ï¼Ÿç”¨å…¬å¼è¯´æ˜ã€‚</li>
        
        <li><strong>[æ¶æ„é€‰æ‹©]</strong> ç»™å®šä»¥ä¸‹ä»»åŠ¡ï¼Œé€‰æ‹©æœ€åˆé€‚çš„æ¶æ„å¹¶è¯´æ˜ç†ç”±ï¼š(a) é¢„æµ‹è›‹ç™½è´¨æŠ˜å ç»“æ„ï¼›(b) ç¤¾äº¤ç½‘ç»œä¸­çš„èŠ‚ç‚¹åˆ†ç±»ï¼›(c) è‡ªåŠ¨é©¾é©¶çš„è§†é¢‘ç†è§£ï¼›(d) ç²’å­ç‰©ç†ä»¿çœŸã€‚</li>
        
        <li><strong>[ç»Ÿä¸€æ¡†æ¶]</strong> é€‰æ‹©æœ¬ç« çš„ä»»æ„ä¸¤ç§æ¶æ„ï¼ˆå¦‚ CNN å’Œ GCNï¼‰ï¼Œè¯¦ç»†è¯´æ˜å®ƒä»¬åœ¨å‡ ä½•æ·±åº¦å­¦ä¹ è“å›¾ä¸­çš„å¯¹åº”å…³ç³»ã€‚å†™å‡ºå…±åŒçš„æŠ½è±¡å…¬å¼ï¼Œå¹¶è¯´æ˜å“ªäº›è®¾è®¡é€‰æ‹©å¯¼è‡´äº†å…·ä½“çš„å·®å¼‚ã€‚</li>
      </ol>
    </div>


    <!-- ====================== FURTHER READING ====================== -->
    <h2 id="further-reading">æ¨èé˜…è¯»ä¸å‚è€ƒæ–‡çŒ®</h2>

    <h3>æ ¸å¿ƒè®ºæ–‡</h3>
    <div class="comparison-table">
      <table>
        <thead><tr><th>è®ºæ–‡</th><th>æ¶æ„</th><th>å¹´ä»½</th><th>æ ¸å¿ƒè´¡çŒ®</th></tr></thead>
        <tbody>
          <tr><td>Kipf & Welling</td><td>GCN</td><td>2016</td><td>åŠç›‘ç£åˆ†ç±»çš„è°±æ–¹æ³•ä¸€é˜¶è¿‘ä¼¼</td></tr>
          <tr><td>VeliÄkoviÄ‡ et al.</td><td>GAT</td><td>2018</td><td>å›¾ä¸Šçš„æ³¨æ„åŠ›æœºåˆ¶</td></tr>
          <tr><td>Hamilton et al.</td><td>GraphSAGE</td><td>2017</td><td>å½’çº³å­¦ä¹  + é‚»å±…é‡‡æ ·</td></tr>
          <tr><td>Xu et al.</td><td>GIN</td><td>2019</td><td>GNN è¡¨è¾¾åŠ›çš„ç†è®ºåˆ†æ</td></tr>
          <tr><td>Gilmer et al.</td><td>MPNN</td><td>2017</td><td>æ¶ˆæ¯ä¼ é€’ç»Ÿä¸€æ¡†æ¶</td></tr>
          <tr><td>Satorras et al.</td><td>EGNN</td><td>2021</td><td>E(n) ç­‰å˜æ¶ˆæ¯ä¼ é€’</td></tr>
          <tr><td>Vaswani et al.</td><td>Transformer</td><td>2017</td><td>è‡ªæ³¨æ„åŠ›æœºåˆ¶</td></tr>
          <tr><td>Hochreiter & Schmidhuber</td><td>LSTM</td><td>1997</td><td>é—¨æ§è®°å¿†ç»†èƒ</td></tr>
          <tr><td>He et al.</td><td>ResNet</td><td>2016</td><td>æ®‹å·®è¿æ¥ = ODE ç¦»æ•£åŒ–</td></tr>
          <tr><td>Cohen & Welling</td><td>G-CNN</td><td>2016</td><td>ç¾¤ç­‰å˜å·ç§¯</td></tr>
          <tr><td>Sanchez-Gonzalez et al.</td><td>GNS</td><td>2020</td><td>GNN å­¦ä¹ ç‰©ç†ä»¿çœŸï¼ˆPhysRobot å‚è€ƒï¼‰</td></tr>
        </tbody>
      </table>
    </div>

    <h3>PhysRobot ç›¸å…³çš„å­¦ä¹ è·¯çº¿</h3>
    <div class="callout callout-project">
      <h4>ä»æœ¬ç« åˆ°å®é™…é¡¹ç›®çš„æ¡¥æ¢</h4>
      <ol>
        <li><strong>åŸºç¡€</strong>ï¼šç†è§£æ¶ˆæ¯ä¼ é€’æ¡†æ¶ (Â§5.3) â€” è¿™æ˜¯ DynamicalGNN çš„éª¨æ¶</li>
        <li><strong>ç­‰å˜æ€§</strong>ï¼šæŒæ¡ EGNN (Â§5.5) â€” è¿™æ˜¯ EdgeFrame çš„ç†è®ºæ¥æº</li>
        <li><strong>å®è·µ</strong>ï¼šç”¨ PyG å®ç° MPNN â†’ åœ¨ç®€å•ç²’å­ç³»ç»Ÿä¸Šè®­ç»ƒ</li>
        <li><strong>è¿›é˜¶</strong>ï¼šç†è§£ GNS è®ºæ–‡ï¼Œå°† GNN + ç§¯åˆ†å™¨ç»„åˆä¸ºå®Œæ•´ä»¿çœŸå™¨</li>
        <li><strong>å‰æ²¿</strong>ï¼šæ¢ç´¢ SE(3)-Transformerã€Equiformer ç­‰æ›´å¼ºçš„ç­‰å˜æ¶æ„</li>
      </ol>
    </div>

    <h3>å¸¸è§é¢è¯•/è€ƒè¯•é—®é¢˜ä¸å›ç­”</h3>

    <div class="callout callout-info">
      <h4>Q: ä¸ºä»€ä¹ˆ GNN æ¯” MLP æ›´é€‚åˆå›¾æ•°æ®ï¼Ÿ</h4>
      <p><strong>A</strong>ï¼šMLP å¯¹èŠ‚ç‚¹æ’åˆ—æ•æ„Ÿï¼ˆè¾“å…¥ $[x_1, x_2, \ldots, x_n]$ å’Œ $[x_2, x_1, \ldots, x_n]$ äº§ç”Ÿä¸åŒè¾“å‡ºï¼‰ï¼Œä¸å…·æœ‰ç½®æ¢ç­‰å˜æ€§ã€‚GNN é€šè¿‡<strong>å±€éƒ¨èšåˆ</strong>ï¼ˆæ¶ˆæ¯ä¼ é€’ï¼‰ä¿è¯ç½®æ¢ç­‰å˜ï¼šèŠ‚ç‚¹ç‰¹å¾åªé€šè¿‡ç½®æ¢ä¸å˜çš„èšåˆå‡½æ•°ï¼ˆsum/mean/maxï¼‰å’Œå…±äº«çš„æ¶ˆæ¯å‡½æ•°æ›´æ–°ã€‚MLP æœ‰ $O(n^2 d^2)$ å‚æ•°ä¸”ä¸æ³›åŒ–åˆ°ä¸åŒå¤§å°çš„å›¾ï¼ŒGNN æœ‰ $O(d^2)$ å‚æ•°ä¸”å¤©ç„¶æ³›åŒ–ã€‚</p>
    </div>

    <div class="callout callout-info">
      <h4>Q: Transformer ä¸ºä»€ä¹ˆéœ€è¦ä½ç½®ç¼–ç è€Œ CNN ä¸éœ€è¦ï¼Ÿ</h4>
      <p><strong>A</strong>ï¼šä» GNN è§†è§’ç†è§£â€”â€”Transformer æ˜¯<strong>å®Œå…¨å›¾ä¸Šçš„æ³¨æ„åŠ› GNN</strong>ï¼Œå®Œå…¨å›¾<strong>æ²¡æœ‰ä½ç½®ç»“æ„</strong>ï¼ˆæ‰€æœ‰èŠ‚ç‚¹ç­‰ä»·ï¼‰ã€‚CNN åœ¨<strong>ç½‘æ ¼</strong>ä¸Šæ“ä½œï¼Œç½‘æ ¼æœ¬èº«è•´å«ä½ç½®ä¿¡æ¯ï¼ˆé‚»æ¥å…³ç³» = ç©ºé—´é‚»è¿‘ï¼‰ã€‚ä½ç½®ç¼–ç ä¸º Transformer çš„"èŠ‚ç‚¹"æ³¨å…¥ä½ç½®ä¿¡æ¯ï¼Œå¼¥è¡¥äº†å®Œå…¨å›¾ç¼ºå°‘çš„ç»“æ„å…ˆéªŒã€‚æ­£å¼¦ä½ç½®ç¼–ç å®é™…ä¸Šç­‰ä»·äº<strong>ç¯å½¢ç½‘æ ¼</strong>çš„ DFT ç‰¹å¾å‘é‡ï¼Œå› æ­¤ Transformer éšå¼å‡è®¾äº†ç½‘æ ¼åŸŸã€‚</p>
    </div>

    <div class="callout callout-info">
      <h4>Q: æˆ‘ä»¬çš„ DynamicalGNN ä½¿ç”¨ sum èšåˆè€Œé meanï¼Œä¸ºä»€ä¹ˆï¼Ÿ</h4>
      <p><strong>A</strong>ï¼šç‰©ç†åŸå› â€”â€”<strong>åŠ›æ˜¯åŠ æ€§çš„</strong>ï¼ˆç‰›é¡¿åŠ›å­¦ä¸­ï¼ŒåˆåŠ› = å„åˆ†åŠ›ä¹‹å’Œï¼‰ã€‚Sum èšåˆè‡ªç„¶å¯¹åº” $F_i = \sum_{j \in \mathcal{N}(i)} f_{ij}$ã€‚å¦‚æœä½¿ç”¨ mean èšåˆ $\frac{1}{|\mathcal{N}(i)|} \sum_j f_{ij}$ï¼Œåˆ™ä¸€ä¸ªç²’å­è¢«æ›´å¤šç²’å­åŒ…å›´æ—¶ï¼Œæ¯ä¸ªäº¤äº’çš„è´¡çŒ®åè€Œå˜å°â€”â€”è¿™è¿åç‰©ç†ç›´è§‰ã€‚æ•°å­¦ä¸Šï¼Œsum èšåˆè¿˜ä¿æŒäº†<strong>å•å°„æ€§</strong>ï¼ˆGIN çš„ç»“è®ºï¼‰ï¼Œä½¿æ¨¡å‹èƒ½åŒºåˆ†ä¸åŒçš„é‚»åŸŸå¤šé‡é›†ã€‚</p>
    </div>

    <h3>æ¦‚å¿µé€ŸæŸ¥å¡</h3>

    <div class="comparison-table">
      <table>
        <thead><tr><th>æ¦‚å¿µ</th><th>ä¸€å¥è¯è§£é‡Š</th><th>å…¬å¼</th></tr></thead>
        <tbody>
          <tr><td>ç­‰å˜æ€§</td><td>å˜æ¢è¾“å…¥ â†’ è¾“å‡ºä»¥ç›¸åŒæ–¹å¼å˜æ¢</td><td>$F(\rho(g)x) = \rho(g)F(x)$</td></tr>
          <tr><td>ä¸å˜æ€§</td><td>å˜æ¢è¾“å…¥ â†’ è¾“å‡ºä¸å˜</td><td>$F(\rho(g)x) = F(x)$</td></tr>
          <tr><td>å·ç§¯</td><td>æ»¤æ³¢å™¨æ»‘è¿‡ä¿¡å·çš„å†…ç§¯</td><td>$(f \star g)(t) = \sum f(\tau)g(t-\tau)$</td></tr>
          <tr><td>æ¶ˆæ¯ä¼ é€’</td><td>é‚»å±…å‘æ¶ˆæ¯ â†’ èšåˆ â†’ æ›´æ–°</td><td>$x_i' = \gamma(x_i, \bigoplus_j \phi(x_i, x_j))$</td></tr>
          <tr><td>æ³¨æ„åŠ›</td><td>å­¦ä¹ é‚»å±…çš„é‡è¦æ€§æƒé‡</td><td>$\alpha_{ij} = \text{softmax}(a(x_i, x_j))$</td></tr>
          <tr><td>é—¨æ§</td><td>å­¦ä¹ é€‰æ‹©æ€§é—å¿˜/è®°å¿†</td><td>$c = f \odot c_{\text{old}} + i \odot \tilde{c}_{\text{new}}$</td></tr>
          <tr><td>E(3) ç­‰å˜</td><td>æ—‹è½¬/å¹³ç§»è¾“å…¥ â†’ è¾“å‡ºä¸€è‡´å˜æ¢</td><td>é€šè¿‡è·ç¦»ä¸å˜é‡ $\|x_i - x_j\|$</td></tr>
          <tr><td>è§„èŒƒç­‰å˜</td><td>å±€éƒ¨å‚è€ƒç³»é€‰æ‹©ä¸å½±å“ç»“æœ</td><td>é€šè¿‡å¹³è¡Œç§»åŠ¨ $\rho(g_{v \to u})$</td></tr>
          <tr><td>è¿‡å¹³æ»‘</td><td>å±‚å¤ªå¤š â†’ æ‰€æœ‰èŠ‚ç‚¹è¡¨ç¤ºç›¸åŒ</td><td>$\hat{A}^k \to$ å¸¸å‘é‡</td></tr>
          <tr><td>è¿‡å‹ç¼©</td><td>è¿œç¨‹ä¿¡æ¯è¢«æŒ¤å‹åˆ°å°å‘é‡ä¸­</td><td>$|\partial h_u^L / \partial x_v^0| \to 0$</td></tr>
        </tbody>
      </table>
    </div>


    <!-- ====================== NAVIGATION ====================== -->
    <div class="chapter-nav">
      <a href="../chapter4/index.html">â† Chapter 4: å‡ ä½•åŸŸ</a>
      <a href="../index.html">ğŸ“š æ€»ç›®å½•</a>
    </div>


<!-- === FORMULAS START === -->
<div class="enrichment-block" style="border-left-color: #8b5cf6;">
  <h4>ğŸ“ ç¬¬5ç« æ ¸å¿ƒå…¬å¼è¯¦è§£</h4>
  <!-- å…¬å¼ 1: GCN -->
    <div class="formula-explain">
        <p>$$H^{(l+1)} = \sigma\left(\tilde{D}^{-1/2}\tilde{A}\tilde{D}^{-1/2}H^{(l)}W^{(l)}\right)$$</p>
        <table>
            <tr>
                <td>$H^{(l)}$</td>
                <td>ç¬¬ $l$ å±‚çš„èŠ‚ç‚¹ç‰¹å¾çŸ©é˜µï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªèŠ‚ç‚¹çš„ç‰¹å¾å‘é‡</td>
            </tr>
            <tr>
                <td>$H^{(l+1)}$</td>
                <td>ç¬¬ $l+1$ å±‚æ›´æ–°åçš„èŠ‚ç‚¹ç‰¹å¾</td>
            </tr>
            <tr>
                <td>$\tilde{A}$</td>
                <td>é‚»æ¥çŸ©é˜µ $A$ åŠ ä¸Šè‡ªè¿æ¥ï¼ˆ$A + I$ï¼‰ï¼Œè¡¨ç¤º"è¿æ¥å…³ç³»+è‡ªå·±"</td>
            </tr>
            <tr>
                <td>$\tilde{D}$</td>
                <td>åº¦çŸ©é˜µï¼Œå¯¹è§’çº¿å…ƒç´ æ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„è¿æ¥æ•°ï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰</td>
            </tr>
            <tr>
                <td>$\tilde{D}^{-1/2}$</td>
                <td>åº¦çŸ©é˜µçš„é€†å¹³æ–¹æ ¹ï¼Œç”¨äºå½’ä¸€åŒ–ï¼ˆé˜²æ­¢åº¦æ•°å¤§çš„èŠ‚ç‚¹å½±å“è¿‡å¤§ï¼‰</td>
            </tr>
            <tr>
                <td>$W^{(l)}$</td>
                <td>ç¬¬ $l$ å±‚çš„å¯å­¦ä¹ æƒé‡çŸ©é˜µ</td>
            </tr>
            <tr>
                <td>$\sigma$</td>
                <td>æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ ReLUï¼‰ï¼Œç»™ç½‘ç»œå¼•å…¥éçº¿æ€§</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>æ¯ä¸ªèŠ‚ç‚¹å…ˆæŠŠè‡ªå·±å’Œé‚»å±…çš„ç‰¹å¾æ”¶é›†èµ·æ¥ï¼ˆ$\tilde{A}H^{(l)}$ï¼‰ï¼Œç„¶åæ ¹æ®å¤§å®¶çš„è¿æ¥æ•°åšä¸ª"å…¬å¹³è°ƒæ•´"ï¼ˆ$\tilde{D}^{-1/2}$ å½’ä¸€åŒ–ï¼‰ï¼Œå†ç”¨æƒé‡çŸ©é˜µ $W$ åšçº¿æ€§å˜æ¢ï¼Œæœ€åè¿‡æ¿€æ´»å‡½æ•°æ›´æ–°ç‰¹å¾ã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>å¾®ä¿¡æœ‹å‹åœˆç‚¹èµã€‚ä½ çš„"æ–°å½±å“åŠ›"=ï¼ˆä½ çš„ç‚¹èµæ•° + æœ‹å‹ä»¬ç»™ä½ çš„ç‚¹èµæ•°ï¼‰Ã· å„è‡ªçš„æœ‹å‹æ€»æ•°ã€‚æœ‹å‹å¤šçš„äººå•æ¬¡ç‚¹èµæƒé‡ä¼šå°ä¸€ç‚¹ï¼Œé¿å…"å¤§V"å„æ–­ã€‚</p>
    </div>

    <!-- å…¬å¼ 2: MPNN -->
    <div class="formula-explain">
        <p>$$h_v^{(k+1)} = \phi\left(h_v^{(k)}, \bigoplus_{u \in N(v)} \psi(h_v^{(k)}, h_u^{(k)}, e_{uv})\right)$$</p>
        <table>
            <tr>
                <td>$h_v^{(k)}$</td>
                <td>èŠ‚ç‚¹ $v$ åœ¨ç¬¬ $k$ æ­¥çš„ç‰¹å¾å‘é‡</td>
            </tr>
            <tr>
                <td>$h_v^{(k+1)}$</td>
                <td>èŠ‚ç‚¹ $v$ åœ¨ç¬¬ $k+1$ æ­¥æ›´æ–°åçš„ç‰¹å¾</td>
            </tr>
            <tr>
                <td>$N(v)$</td>
                <td>èŠ‚ç‚¹ $v$ çš„é‚»å±…é›†åˆ</td>
            </tr>
            <tr>
                <td>$\psi$</td>
                <td>æ¶ˆæ¯å‡½æ•°ï¼Œè®¡ç®—ä»é‚»å±… $u$ å‘é€ç»™ $v$ çš„æ¶ˆæ¯</td>
            </tr>
            <tr>
                <td>$e_{uv}$</td>
                <td>è¾¹ $(u,v)$ çš„ç‰¹å¾ï¼ˆå¦‚æƒé‡ã€ç±»å‹ç­‰ï¼‰</td>
            </tr>
            <tr>
                <td>$\bigoplus$</td>
                <td>èšåˆæ“ä½œï¼ˆå¦‚æ±‚å’Œ sumã€å¹³å‡ meanã€æœ€å¤§ maxï¼‰</td>
            </tr>
            <tr>
                <td>$\phi$</td>
                <td>æ›´æ–°å‡½æ•°ï¼Œç»“åˆè‡ªå·±çš„æ—§ç‰¹å¾å’Œèšåˆåçš„é‚»å±…æ¶ˆæ¯</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>æ¯ä¸ªèŠ‚ç‚¹ $v$ å…ˆå‘æ‰€æœ‰é‚»å±… $u$ æ”¶é›†"æ¶ˆæ¯"ï¼ˆ$\psi$ å‡½æ•°æ ¹æ®åŒæ–¹ç‰¹å¾å’Œè¾¹ä¿¡æ¯ç”Ÿæˆï¼‰ï¼Œç„¶åæŠŠæ‰€æœ‰æ¶ˆæ¯èšåˆèµ·æ¥ï¼ˆ$\bigoplus$ï¼‰ï¼Œæœ€åå’Œè‡ªå·±çš„å½“å‰çŠ¶æ€ä¸€èµ·ï¼Œç”¨ $\phi$ å‡½æ•°æ›´æ–°æˆæ–°çŠ¶æ€ã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>ç¾¤èŠæ¶ˆæ¯ã€‚ä½ çœ‹ç¾¤é‡Œæœ‹å‹ä»¬çš„å‘è¨€ï¼ˆæ¶ˆæ¯ $\psi$ï¼‰ï¼ŒæŠŠå¤§å®¶çš„è§‚ç‚¹ç»¼åˆä¸€ä¸‹ï¼ˆèšåˆ $\bigoplus$ï¼‰ï¼Œå†ç»“åˆä½ è‡ªå·±ä¹‹å‰çš„æƒ³æ³•ï¼ˆ$h_v^{(k)}$ï¼‰ï¼Œå½¢æˆæ–°çš„çœ‹æ³•ï¼ˆ$h_v^{(k+1)}$ï¼‰ã€‚</p>
    </div>

    <!-- å…¬å¼ 3: GAT æ³¨æ„åŠ› -->
    <div class="formula-explain">
        <p>$$\alpha_{ij} = \text{softmax}_j\left(\text{LeakyReLU}\left(a^T[Wh_i \,\|\, Wh_j]\right)\right)$$</p>
        <table>
            <tr>
                <td>$\alpha_{ij}$</td>
                <td>èŠ‚ç‚¹ $j$ å¯¹èŠ‚ç‚¹ $i$ çš„æ³¨æ„åŠ›æƒé‡ï¼ˆå½’ä¸€åŒ–åçš„é‡è¦æ€§åˆ†æ•°ï¼‰</td>
            </tr>
            <tr>
                <td>$h_i, h_j$</td>
                <td>èŠ‚ç‚¹ $i$ å’Œ $j$ çš„ç‰¹å¾å‘é‡</td>
            </tr>
            <tr>
                <td>$W$</td>
                <td>å¯å­¦ä¹ çš„çº¿æ€§å˜æ¢çŸ©é˜µ</td>
            </tr>
            <tr>
                <td>$\|$</td>
                <td>æ‹¼æ¥æ“ä½œï¼ˆconcatenationï¼‰ï¼ŒæŠŠä¸¤ä¸ªå‘é‡é¦–å°¾ç›¸æ¥</td>
            </tr>
            <tr>
                <td>$a^T$</td>
                <td>æ³¨æ„åŠ›å‘é‡ï¼Œç”¨äºè®¡ç®—é‡è¦æ€§å¾—åˆ†</td>
            </tr>
            <tr>
                <td>LeakyReLU</td>
                <td>å¸¦"å¾®å°è´Ÿå€¼"çš„æ¿€æ´»å‡½æ•°ï¼Œé¿å…æ¢¯åº¦æ¶ˆå¤±</td>
            </tr>
            <tr>
                <td>softmax$_j$</td>
                <td>å¯¹æ‰€æœ‰é‚»å±… $j$ çš„å¾—åˆ†å½’ä¸€åŒ–ï¼Œä½¿æƒé‡å’Œä¸º 1</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>å…ˆæŠŠè‡ªå·±ï¼ˆ$i$ï¼‰å’Œé‚»å±…ï¼ˆ$j$ï¼‰çš„ç‰¹å¾å˜æ¢ä¸€ä¸‹ï¼ˆ$W$ï¼‰ï¼Œæ‹¼åœ¨ä¸€èµ·ï¼Œç”¨æ³¨æ„åŠ›å‘é‡ $a$ æ‰“ä¸ªåˆ†ï¼Œå†è¿‡æ¿€æ´»å‡½æ•°ï¼Œæœ€åç”¨ softmax å½’ä¸€åŒ–ï¼Œè®©æ‰€æœ‰é‚»å±…çš„æƒé‡åŠ èµ·æ¥ç­‰äº 1ã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>å¼€ä¼šå‘è¨€æƒé‡ã€‚ä½ ï¼ˆèŠ‚ç‚¹ $i$ï¼‰å¬åŒäº‹ä»¬ï¼ˆé‚»å±… $j$ï¼‰çš„å‘è¨€ï¼Œæ ¹æ®ä»–ä»¬çš„å†…å®¹å’Œä½ çš„å…³æ³¨ç‚¹ï¼ˆ$a$ï¼‰ç»™æ¯ä¸ªäººæ‰“åˆ†ï¼Œæ‰“åˆ†è¶Šé«˜è¯´æ˜è¿™ä¸ªäººè¯´çš„å¯¹ä½ è¶Šé‡è¦ï¼Œæœ€åæŠŠåˆ†æ•°å½’ä¸€åŒ–æˆç™¾åˆ†æ¯”ã€‚</p>
    </div>

    <!-- å…¬å¼ 4: GIN æ›´æ–° -->
    <div class="formula-explain">
        <p>$$h_v^{(k+1)} = \text{MLP}\left((1+\epsilon)h_v^{(k)} + \sum_{u \in N(v)} h_u^{(k)}\right)$$</p>
        <table>
            <tr>
                <td>$h_v^{(k)}$</td>
                <td>èŠ‚ç‚¹ $v$ åœ¨ç¬¬ $k$ æ­¥çš„ç‰¹å¾</td>
            </tr>
            <tr>
                <td>$h_u^{(k)}$</td>
                <td>é‚»å±… $u$ åœ¨ç¬¬ $k$ æ­¥çš„ç‰¹å¾</td>
            </tr>
            <tr>
                <td>$\epsilon$</td>
                <td>å¯å­¦ä¹ çš„æ ‡é‡å‚æ•°ï¼Œæ§åˆ¶"è‡ªå·±"çš„æƒé‡</td>
            </tr>
            <tr>
                <td>$\sum_{u \in N(v)}$</td>
                <td>å¯¹æ‰€æœ‰é‚»å±…çš„ç‰¹å¾æ±‚å’Œ</td>
            </tr>
            <tr>
                <td>MLP</td>
                <td>å¤šå±‚æ„ŸçŸ¥æœºï¼ˆå‡ å±‚å…¨è¿æ¥ç½‘ç»œï¼‰ï¼Œåšéçº¿æ€§å˜æ¢</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>èŠ‚ç‚¹ $v$ å…ˆæŠŠè‡ªå·±çš„ç‰¹å¾ä¹˜ä»¥ $(1+\epsilon)$ åŠ æƒï¼Œå†åŠ ä¸Šæ‰€æœ‰é‚»å±…ç‰¹å¾çš„å’Œï¼Œæœ€åç”¨ MLP åšéçº¿æ€§å˜æ¢ã€‚$\epsilon$ å¯å­¦ä¹ ï¼Œè®©ç½‘ç»œè‡ªå·±å†³å®š"è‡ªå·±"çš„é‡è¦æ€§ã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>å°ç»„é¡¹ç›®è¯„åˆ†ã€‚ä½ çš„æ€»åˆ† = ä½ è‡ªå·±çš„è´¡çŒ® Ã— $(1+\epsilon)$ + é˜Ÿå‹ä»¬çš„è´¡çŒ®ä¹‹å’Œï¼Œå†è¿‡ä¸€ä¸ª"ç»¼åˆè¯„ä¼°å‡½æ•°"ï¼ˆMLPï¼‰ã€‚$\epsilon$ è¶Šå¤§ï¼Œè¯´æ˜ä½ è‡ªå·±çš„è´¡çŒ®æƒé‡è¶Šé«˜ã€‚</p>
    </div>

    <!-- å…¬å¼ 5: GraphSAGE -->
    <div class="formula-explain">
        <p>$$h_v^{(k)} = \sigma\left(W \cdot \text{CONCAT}\left(h_v^{(k-1)}, \text{AGG}\left(\{h_u^{(k-1)}\}\right)\right)\right)$$</p>
        <table>
            <tr>
                <td>$h_v^{(k-1)}$</td>
                <td>èŠ‚ç‚¹ $v$ åœ¨ä¸Šä¸€å±‚ï¼ˆ$k-1$ï¼‰çš„ç‰¹å¾</td>
            </tr>
            <tr>
                <td>$\{h_u^{(k-1)}\}$</td>
                <td>é‚»å±… $u$ ä»¬åœ¨ä¸Šä¸€å±‚çš„ç‰¹å¾é›†åˆ</td>
            </tr>
            <tr>
                <td>AGG</td>
                <td>èšåˆå‡½æ•°ï¼ˆå¦‚ meanã€maxã€LSTM ç­‰ï¼‰</td>
            </tr>
            <tr>
                <td>CONCAT</td>
                <td>æ‹¼æ¥æ“ä½œï¼ŒæŠŠè‡ªå·±å’Œèšåˆåçš„é‚»å±…ç‰¹å¾åˆå¹¶</td>
            </tr>
            <tr>
                <td>$W$</td>
                <td>æƒé‡çŸ©é˜µ</td>
            </tr>
            <tr>
                <td>$\sigma$</td>
                <td>æ¿€æ´»å‡½æ•°</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>å…ˆèšåˆé‚»å±…çš„ç‰¹å¾ï¼ˆAGGï¼‰ï¼Œå†å’Œè‡ªå·±çš„ç‰¹å¾æ‹¼åœ¨ä¸€èµ·ï¼ˆCONCATï¼‰ï¼Œç„¶ååšçº¿æ€§å˜æ¢ï¼ˆ$W$ï¼‰+ æ¿€æ´»å‡½æ•°ï¼ˆ$\sigma$ï¼‰ã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>å›¢é˜Ÿæ±‡æŠ¥ã€‚ä½ å…ˆæ€»ç»“é˜Ÿå‹ä»¬çš„å·¥ä½œï¼ˆAGGï¼‰ï¼Œå†å’Œä½ è‡ªå·±çš„å·¥ä½œå†…å®¹æ‹¼åœ¨ä¸€èµ·ï¼Œæœ€åæäº¤ç»™è€æ¿å®¡æ ¸ï¼ˆ$W$ å’Œ $\sigma$ï¼‰ã€‚</p>
    </div>

    <!-- å…¬å¼ 6: Transformer æ³¨æ„åŠ› -->
    <div class="formula-explain">
        <p>$$\text{Attention}(Q,K,V) = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)V$$</p>
        <table>
            <tr>
                <td>$Q$</td>
                <td>Queryï¼ˆæŸ¥è¯¢çŸ©é˜µï¼‰ï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªèŠ‚ç‚¹çš„"é—®é¢˜"</td>
            </tr>
            <tr>
                <td>$K$</td>
                <td>Keyï¼ˆé”®çŸ©é˜µï¼‰ï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªèŠ‚ç‚¹çš„"æ ‡ç­¾"</td>
            </tr>
            <tr>
                <td>$V$</td>
                <td>Valueï¼ˆå€¼çŸ©é˜µï¼‰ï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªèŠ‚ç‚¹çš„"å†…å®¹"</td>
            </tr>
            <tr>
                <td>$QK^T$</td>
                <td>è®¡ç®— Query å’Œ Key çš„ç›¸ä¼¼åº¦ï¼ˆå†…ç§¯ï¼‰</td>
            </tr>
            <tr>
                <td>$\sqrt{d_k}$</td>
                <td>ç¼©æ”¾å› å­ï¼ˆ$d_k$ æ˜¯ Key çš„ç»´åº¦ï¼‰ï¼Œé˜²æ­¢å†…ç§¯è¿‡å¤§</td>
            </tr>
            <tr>
                <td>softmax</td>
                <td>å½’ä¸€åŒ–ç›¸ä¼¼åº¦ï¼Œå¾—åˆ°æ³¨æ„åŠ›æƒé‡</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>æ¯ä¸ªèŠ‚ç‚¹ï¼ˆQueryï¼‰å»å’Œæ‰€æœ‰èŠ‚ç‚¹ï¼ˆKeyï¼‰ç®—ç›¸ä¼¼åº¦ï¼ˆ$QK^T$ï¼‰ï¼Œé™¤ä»¥ $\sqrt{d_k}$ é˜²æ­¢æ•°å€¼çˆ†ç‚¸ï¼Œå†ç”¨ softmax å½’ä¸€åŒ–ï¼Œæœ€åç”¨è¿™äº›æƒé‡åŠ æƒæ‰€æœ‰èŠ‚ç‚¹çš„ Valueï¼Œå¾—åˆ°è¾“å‡ºã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>å›¾ä¹¦é¦†æ‰¾ä¹¦ã€‚ä½ æœ‰ä¸ªé—®é¢˜ï¼ˆQueryï¼‰ï¼Œå›¾ä¹¦é¦†æ¯æœ¬ä¹¦æœ‰æ ‡ç­¾ï¼ˆKeyï¼‰å’Œå†…å®¹ï¼ˆValueï¼‰ã€‚ä½ å…ˆçœ‹æ ‡ç­¾å’Œé—®é¢˜çš„åŒ¹é…åº¦ï¼ˆ$QK^T$ï¼‰ï¼ŒåŒ¹é…åº¦é«˜çš„ä¹¦æƒé‡å¤§ï¼Œæœ€åæŠŠè¿™äº›ä¹¦çš„å†…å®¹æŒ‰æƒé‡ç»„åˆèµ·æ¥ä½œä¸ºç­”æ¡ˆã€‚</p>
    </div>

    <!-- å…¬å¼ 7: EGNN ä½ç½®æ›´æ–° -->
    <div class="formula-explain">
        <p>$$x_i^{l+1} = x_i^l + C \sum_{j \neq i} (x_i^l - x_j^l) \phi_x(m_{ij})$$</p>
        <table>
            <tr>
                <td>$x_i^l$</td>
                <td>èŠ‚ç‚¹ $i$ åœ¨ç¬¬ $l$ å±‚çš„ç©ºé—´åæ ‡ï¼ˆ3D ä½ç½®ï¼‰</td>
            </tr>
            <tr>
                <td>$x_i^{l+1}$</td>
                <td>èŠ‚ç‚¹ $i$ æ›´æ–°åçš„åæ ‡</td>
            </tr>
            <tr>
                <td>$x_i^l - x_j^l$</td>
                <td>èŠ‚ç‚¹ $i$ åˆ° $j$ çš„æ–¹å‘å‘é‡</td>
            </tr>
            <tr>
                <td>$m_{ij}$</td>
                <td>èŠ‚ç‚¹ $j$ å‘ç»™ $i$ çš„æ¶ˆæ¯ï¼ˆæ ‡é‡æˆ–å‘é‡ï¼‰</td>
            </tr>
            <tr>
                <td>$\phi_x$</td>
                <td>å¯å­¦ä¹ å‡½æ•°ï¼Œæ ¹æ®æ¶ˆæ¯è®¡ç®—"æ‹‰åŠ›/æ¨åŠ›"å¤§å°</td>
            </tr>
            <tr>
                <td>$C$</td>
                <td>å½’ä¸€åŒ–å¸¸æ•°</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>èŠ‚ç‚¹ $i$ çš„æ–°ä½ç½® = æ—§ä½ç½® + æ‰€æœ‰é‚»å±…çš„"æ‹‰æ‰¯åŠ›"ã€‚æ¯ä¸ªé‚»å±… $j$ æ ¹æ®æ¶ˆæ¯ $m_{ij}$ å’Œæ–¹å‘å‘é‡ $(x_i - x_j)$ å¯¹ $i$ æ–½åŠ ä¸€ä¸ªåŠ›ï¼Œ$\phi_x$ å†³å®šåŠ›çš„å¤§å°ã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>ç£é“äº’ç›¸å¸å¼•/æ’æ–¥ã€‚æ¯ä¸ªç£é“ï¼ˆèŠ‚ç‚¹ï¼‰å—åˆ°å…¶ä»–ç£é“çš„åŠ›ï¼ŒåŠ›çš„æ–¹å‘æ˜¯è¿çº¿æ–¹å‘ï¼ŒåŠ›çš„å¤§å°ç”±æ¶ˆæ¯ $m_{ij}$ å’Œå‡½æ•° $\phi_x$ å†³å®šã€‚æœ€ç»ˆä½ç½®æ˜¯åŸä½ç½®åŠ ä¸Šæ‰€æœ‰åŠ›çš„å åŠ ã€‚</p>
    </div>

    <!-- å…¬å¼ 8: EGNN æ¶ˆæ¯ -->
    <div class="formula-explain">
        <p>$$m_{ij} = \phi_e(h_i^l, h_j^l, \|x_i^l - x_j^l\|^2, a_{ij})$$</p>
        <table>
            <tr>
                <td>$m_{ij}$</td>
                <td>èŠ‚ç‚¹ $j$ å‘ç»™ $i$ çš„æ¶ˆæ¯</td>
            </tr>
            <tr>
                <td>$h_i^l, h_j^l$</td>
                <td>èŠ‚ç‚¹ $i$ å’Œ $j$ çš„ç‰¹å¾ï¼ˆä¸å«åæ ‡ä¿¡æ¯ï¼‰</td>
            </tr>
            <tr>
                <td>$\|x_i^l - x_j^l\|^2$</td>
                <td>èŠ‚ç‚¹ $i$ å’Œ $j$ çš„è·ç¦»å¹³æ–¹</td>
            </tr>
            <tr>
                <td>$a_{ij}$</td>
                <td>è¾¹ $(i,j)$ çš„å±æ€§ï¼ˆå¯é€‰ï¼‰</td>
            </tr>
            <tr>
                <td>$\phi_e$</td>
                <td>æ¶ˆæ¯å‡½æ•°ï¼ˆå¯å­¦ä¹ çš„ç¥ç»ç½‘ç»œï¼‰</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>æ¶ˆæ¯ $m_{ij}$ ç”±èŠ‚ç‚¹ $i$ å’Œ $j$ çš„ç‰¹å¾ã€å®ƒä»¬ä¹‹é—´çš„è·ç¦»å¹³æ–¹ã€ä»¥åŠè¾¹å±æ€§å…±åŒå†³å®šã€‚$\phi_e$ æ˜¯ä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œå­¦ä¹ å¦‚ä½•ä»è¿™äº›ä¿¡æ¯ç”Ÿæˆæ¶ˆæ¯ã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>æœ‹å‹é—´çš„å»ºè®®ã€‚ä½ æœ‹å‹ç»™ä½ çš„å»ºè®®ï¼ˆæ¶ˆæ¯ï¼‰å–å†³äºï¼šä½ ä¿©çš„æ€§æ ¼ï¼ˆ$h_i, h_j$ï¼‰ã€ä½ ä¿©çš„"å…³ç³»è¿œè¿‘"ï¼ˆè·ç¦» $\|x_i - x_j\|^2$ï¼‰ã€ä»¥åŠä½ ä¿©ä¹‹é—´çš„ç‰¹æ®Šå…³ç³»ï¼ˆè¾¹å±æ€§ $a_{ij}$ï¼‰ã€‚$\phi_e$ å°±æ˜¯"å¦‚ä½•ç»¼åˆè¿™äº›å› ç´ ç»™å»ºè®®"çš„è§„åˆ™ã€‚</p>
    </div>

    <!-- å…¬å¼ 9: ç¾¤å·ç§¯ -->
    <div class="formula-explain">
        <p>$$(f * \psi)(g) = \int_G f(h)\psi(g^{-1}h)\,dh$$</p>
        <table>
            <tr>
                <td>$f$</td>
                <td>å®šä¹‰åœ¨ç¾¤ $G$ ä¸Šçš„ä¿¡å·/å‡½æ•°</td>
            </tr>
            <tr>
                <td>$\psi$</td>
                <td>å·ç§¯æ ¸/æ»¤æ³¢å™¨</td>
            </tr>
            <tr>
                <td>$g, h$</td>
                <td>ç¾¤ $G$ ä¸­çš„å…ƒç´ ï¼ˆå¦‚æ—‹è½¬ã€å¹³ç§»ç­‰å˜æ¢ï¼‰</td>
            </tr>
            <tr>
                <td>$g^{-1}h$</td>
                <td>ç¾¤è¿ç®—ï¼Œè¡¨ç¤º"å…ˆåš $h$ å†æ’¤é”€ $g$"</td>
            </tr>
            <tr>
                <td>$\int_G \, dh$</td>
                <td>å¯¹ç¾¤ $G$ ä¸Šçš„æ‰€æœ‰å…ƒç´ ç§¯åˆ†ï¼ˆç¦»æ•£æ—¶æ˜¯æ±‚å’Œï¼‰</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>åœ¨ç¾¤ $G$ ä¸Šåšå·ç§¯ï¼Œå°±æ˜¯æŠŠä¿¡å· $f$ å’Œæ»¤æ³¢å™¨ $\psi$ åœ¨æ‰€æœ‰ç¾¤å…ƒç´  $h$ ä¸Š"åŒ¹é…"ï¼Œç„¶åç´¯åŠ ã€‚$g^{-1}h$ ä¿è¯äº†æ»¤æ³¢å™¨åœ¨ä¸åŒä½ç½®/è§’åº¦ä¸Š"å¯¹é½"ä¿¡å·ã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>å›¾åƒæ—‹è½¬è¯†åˆ«ã€‚ä½ æœ‰ä¸€å¼ æ—‹è½¬äº†çš„çŒ«å›¾ç‰‡ï¼ˆä¿¡å· $f$ï¼‰ï¼Œç”¨ä¸€ä¸ª"çŒ«æ¨¡æ¿"ï¼ˆ$\psi$ï¼‰å»åŒ¹é…ã€‚ä½ æŠŠæ¨¡æ¿ä¹Ÿæ—‹è½¬åˆ°å„ä¸ªè§’åº¦ï¼ˆ$h$ï¼‰ï¼Œçœ‹å“ªä¸ªè§’åº¦åŒ¹é…åº¦æœ€é«˜ï¼ˆç§¯åˆ†ï¼‰ï¼Œ$g^{-1}h$ ç¡®ä¿æ¨¡æ¿å’Œå›¾ç‰‡çš„æ—‹è½¬è§’åº¦å¯¹é½ã€‚</p>
    </div>

    <!-- å…¬å¼ 10: Deep Sets -->
    <div class="formula-explain">
        <p>$$f(\{x_1, \ldots, x_n\}) = \rho\left(\sum_i \phi(x_i)\right)$$</p>
        <table>
            <tr>
                <td>$\{x_1, \ldots, x_n\}$</td>
                <td>ä¸€ä¸ªæ— åºé›†åˆï¼ŒåŒ…å« $n$ ä¸ªå…ƒç´ </td>
            </tr>
            <tr>
                <td>$\phi$</td>
                <td>å¯¹æ¯ä¸ªå…ƒç´ å•ç‹¬ä½œç”¨çš„å‡½æ•°ï¼ˆå¦‚å°å‹ç¥ç»ç½‘ç»œï¼‰</td>
            </tr>
            <tr>
                <td>$\sum_i$</td>
                <td>å¯¹æ‰€æœ‰å…ƒç´ çš„å˜æ¢ç»“æœæ±‚å’Œï¼ˆä¹Ÿå¯ä»¥æ˜¯ maxã€meanï¼‰</td>
            </tr>
            <tr>
                <td>$\rho$</td>
                <td>å¯¹èšåˆç»“æœåšæœ€ç»ˆå˜æ¢çš„å‡½æ•°</td>
            </tr>
        </table>
        <p><strong>ğŸ—£ï¸ ç”¨äººè¯è¯´ï¼š</strong>å¤„ç†æ— åºé›†åˆçš„ä¸‡èƒ½å…¬å¼ï¼å…ˆç”¨å‡½æ•° $\phi$ å•ç‹¬å¤„ç†æ¯ä¸ªå…ƒç´ ï¼Œå†æŠŠå¤„ç†ç»“æœåŠ èµ·æ¥ï¼ˆ$\sum$ï¼‰ï¼Œæœ€åç”¨å‡½æ•° $\rho$ å¾—åˆ°æœ€ç»ˆç»“æœã€‚å› ä¸ºæ±‚å’Œé¡ºåºæ— å…³ï¼Œæ‰€ä»¥æ•´ä¸ªè¿‡ç¨‹å¯¹é›†åˆçš„é¡ºåºä¸æ•æ„Ÿã€‚</p>
        <p><strong>ğŸ” ç±»æ¯”ï¼š</strong>ç­çº§å¹³å‡åˆ†ã€‚æ¯ä¸ªå­¦ç”Ÿçš„æˆç»©å…ˆæ ‡å‡†åŒ–ï¼ˆ$\phi$ï¼‰ï¼Œå†æ±‚å’Œï¼ˆ$\sum$ï¼‰ï¼Œæœ€åé™¤ä»¥äººæ•°å¹¶åšè°ƒæ•´ï¼ˆ$\rho$ï¼‰ã€‚æ— è®ºå­¦ç”Ÿåå•æ€ä¹ˆæ’åˆ—ï¼Œå¹³å‡åˆ†éƒ½ä¸€æ ·ï¼</p>
    </div>

    <hr style="margin: 2rem 0; border: none; border-top: 2px solid #8b5cf6;">
    <p style="text-align: center; color: #666; font-size: 0.9em;">
        <strong>æç¤ºï¼š</strong>è¿™äº›å…¬å¼æ˜¯ Geometric Deep Learning çš„æ ¸å¿ƒç§¯æœ¨ã€‚ç†è§£å®ƒä»¬ï¼Œå°±èƒ½ç†è§£å‡ ä¹æ‰€æœ‰å›¾ç¥ç»ç½‘ç»œæ¶æ„ï¼
    </p>
</div>
<!-- === FORMULAS END === -->

  </main>

  <!-- ====================== SCRIPTS ====================== -->
  <script>
// Theme toggle
function toggleTheme() {
  const html = document.documentElement;
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  html.setAttribute('data-theme', next);
  localStorage.setItem('theme', next);
  document.querySelector('.theme-toggle').textContent = next === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
}

// Load saved theme
(function() {
  const saved = localStorage.getItem('theme');
  if (saved === 'dark') {
    document.documentElement.setAttribute('data-theme', 'dark');
    document.querySelector('.theme-toggle').textContent = 'â˜€ï¸';
  }
})();

// Sidebar toggle (mobile)
function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('open');
}

// Progress bar
window.addEventListener('scroll', function() {
  const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
  const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
  const scrolled = (winScroll / height) * 100;
  document.getElementById('progressBar').style.width = scrolled + '%';
});

// Active sidebar link
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
      const link = document.querySelector(`.sidebar a[href="#${entry.target.id}"]`);
      if (link) link.classList.add('active');
    }
  });
}, { rootMargin: '-20% 0px -80% 0px' });

document.querySelectorAll('h2[id], h3[id]').forEach(el => observer.observe(el));

// Copy code
function copyCode(btn) {
  const code = btn.closest('.code-container').querySelector('code');
  navigator.clipboard.writeText(code.textContent).then(() => {
    btn.textContent = 'âœ… å·²å¤åˆ¶';
    setTimeout(() => { btn.textContent = 'ğŸ“‹ å¤åˆ¶'; }, 2000);
  });
}

// Tab switching
function switchTab(event, tabId) {
  const container = event.target.closest('.tab-container');
  container.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  container.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  event.target.classList.add('active');
  container.querySelector('#' + tabId).classList.add('active');
}
  </script>
</body>
</html>